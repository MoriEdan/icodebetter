if(!window.webix)webix={};webix.assert=function(test,message){if(!test){webix.assert_error(message)}};webix.assert_config=function(obj){var coll=obj.cells||obj.rows||obj.elements||obj.cols;if(coll)for(var i=0;i<coll.length;i++)if(coll[i]===null||typeof coll[i]==="undefined")webix.assert_error("You have trailing comma or Null element in collection's configuration")};webix.assert_error=function(message){webix.log("error",message);if(webix.message&&typeof message=="string")webix.message({type:"debug",text:message,expire:-1});if(webix.debug!==false)debugger};webix.assert_core_ready=function(){if(window.webix_on_core_ready)window.webix_on_core_ready()};webix.assert_level=0;webix.assert_level_in=function(){webix.assert_level++;if(webix.assert_level==100)webix.assert_error("Attempt to copy object with self reference")};webix.assert_level_out=function(){webix.assert_level--};webix.version="4.4.8";webix.codebase="./";webix.name="core";webix.cdn="//cdn.webix.com";webix.clone=function(source){var f=webix.clone._function;f.prototype=source;return new f};webix.clone._function=function(){};webix.extend=function(base,source,force){webix.assert(base,"Invalid mixing target");webix.assert(source,"Invalid mixing source");if(base.$protoWait){webix.PowerArray.insertAt.call(base.$protoWait,source,1);return base}for(var method in source)if(!(method in base)||force)base[method]=source[method];if(source.defaults)webix.extend(base.defaults,source.defaults);if(source.$init)source.$init.call(base);return base};webix.copy=function(source){webix.assert(source,"Invalid mixing target");webix.assert_level_in();var target;if(arguments.length>1){target=arguments[0];source=arguments[1]}else target=webix.isArray(source)?[]:{};for(var method in source){var from=source[method];if(from&&typeof from=="object"&&!(from instanceof RegExp)){if(!webix.isDate(from)){target[method]=webix.isArray(from)?[]:{};webix.copy(target[method],from)}else target[method]=new Date(from)}else{target[method]=from}}webix.assert_level_out();return target};webix.single=function(source){var instance=null;var t=function(config){if(!instance)instance=new source({});if(instance._reinit)instance._reinit.apply(instance,arguments);return instance};return t};webix.protoUI=function(){if(webix.debug_proto)webix.log("UI registered: "+arguments[0].name);var origins=arguments;var selfname=origins[0].name;var t=function(data){if(!t)return webix.ui[selfname].prototype;var origins=t.$protoWait;if(origins){var params=[origins[0]];for(var i=1;i<origins.length;i++){params[i]=origins[i];if(params[i].$protoWait)params[i]=params[i].call(webix,params[i].name);if(params[i].prototype&&params[i].prototype.name)webix.ui[params[i].prototype.name]=params[i]}webix.ui[selfname]=webix.proto.apply(webix,params);if(t._webix_type_wait)for(var i=0;i<t._webix_type_wait.length;i++)webix.type(webix.ui[selfname],t._webix_type_wait[i]);t=origins=null}if(this!=webix)return new webix.ui[selfname](data);else return webix.ui[selfname]};t.$protoWait=Array.prototype.slice.call(arguments,0);return webix.ui[selfname]=t};webix.proto=function(){if(webix.debug_proto)webix.log("Proto chain:"+arguments[0].name+"["+arguments.length+"]");var origins=arguments;var compilation=origins[0];var has_constructor=!!compilation.$init;var construct=[];webix.assert(compilation,"Invalid mixing target");for(var i=origins.length-1;i>0;i--){webix.assert(origins[i],"Invalid mixing source");if(typeof origins[i]=="function")origins[i]=origins[i].prototype;if(origins[i].$init)construct.push(origins[i].$init);if(origins[i].defaults){var defaults=origins[i].defaults;if(!compilation.defaults)compilation.defaults={};for(var def in defaults)if(webix.isUndefined(compilation.defaults[def]))compilation.defaults[def]=defaults[def]}if(origins[i].type&&compilation.type){for(var def in origins[i].type)if(!compilation.type[def])compilation.type[def]=origins[i].type[def]}for(var key in origins[i]){if(!compilation[key]&&compilation[key]!==false)compilation[key]=origins[i][key]}}if(has_constructor)construct.push(compilation.$init);compilation.$init=function(){for(var i=0;i<construct.length;i++)construct[i].apply(this,arguments)};if(compilation.$skin)compilation.$skin();var result=function(config){this.$ready=[];webix.assert(this.$init,"object without init method");this.$init(config);if(this._parseSettings)this._parseSettings(config,this.defaults);for(var i=0;i<this.$ready.length;i++)this.$ready[i].call(this)};result.prototype=compilation;compilation=origins=null;return result};webix.bind=function(functor,object){return function(){return functor.apply(object,arguments)}};webix.require=function(module,callback,master){var promise=webix.promise.defer();if(callback&&callback!==true)promise=promise.then(function(){callback.call(master||this)});if(webix.require.disabled){promise.resolve();return promise}if(typeof module!="string"){var count=module.length||0;if(!count){for(var file in module)count++;var callback2=function(){count--;if(count===0)promise.resolve()};for(var file in module)webix.require(file,callback2,master)}else{var callback2=function(){if(count){count--;webix.require(module[module.length-count-1],callback2,master)}else{promise.resolve()}};callback2()}return}if(webix._modules[module]!==true){var fullpath=module;if(!module.toString().match(/^([a-z]+\:)*\/\//i))fullpath=webix.codebase+module;if(module.substr(module.length-4)==".css"){var link=webix.html.create("LINK",{type:"text/css",rel:"stylesheet",href:fullpath});document.getElementsByTagName("head")[0].appendChild(link);promise.resolve();return promise}if(callback===true){webix.exec(webix.ajax().sync().get(fullpath).responseText);webix._modules[module]=true}else{if(!webix._modules[module]){webix._modules[module]=[promise];webix.ajax(fullpath,function(text){webix.exec(text);var calls=webix._modules[module];webix._modules[module]=true;for(var i=0;i<calls.length;i++)calls[i].resolve()})}else webix._modules[module].push(promise)}}else promise.resolve();return promise};webix._modules={};webix.exec=function(code){if(window.execScript)window.execScript(code);else window.eval(code)};webix.wrap=function(code,wrap){if(!code)return wrap;return function(){var result=code.apply(this,arguments);wrap.apply(this,arguments);return result}};webix.isUndefined=function(a){return typeof a=="undefined"};webix.delay=function(method,obj,params,delay){return window.setTimeout(function(){if(!(obj&&obj.$destructed)){var ret=method.apply(obj,params||[]);method=obj=params=null;return ret}},delay||1)};webix.once=function(method){var flag=true;return function(){if(flag){flag=false;method.apply(this,arguments)}}};webix.uid=function(){if(!this._seed)this._seed=(new Date).valueOf();this._seed++;return this._seed};webix.toNode=function(node){if(typeof node=="string")return document.getElementById(node);return node};webix.toArray=function(array){return webix.extend(array||[],webix.PowerArray,true)};webix.toFunctor=function(str,scope){if(typeof str=="string"){var method=str.replace("()","");if(scope&&scope[method])return scope[method];return window[method]||eval(str)}return str};webix.isArray=function(obj){return Array.isArray?Array.isArray(obj):Object.prototype.toString.call(obj)==="[object Array]"};webix.isDate=function(obj){return obj instanceof Date};webix.stringify=function(obj){var origin=Date.prototype.toJSON;Date.prototype.toJSON=function(){return webix.i18n.parseFormatStr(this)};var result;if(obj instanceof Date)result=obj.toJSON();else result=JSON.stringify(obj);Date.prototype.toJSON=origin;return result};webix._events={};webix._event=function(a,b,c,d){d=d||{};d.inner=true;webix.event(a,b,c,d)};webix.event=function(node,event,handler,context){context=context||{};node=webix.toNode(node);webix.assert(node,"Invalid node as target for webix.event");var id=context.id||webix.uid();if(context.bind)handler=webix.bind(handler,context.bind);var info=[node,event,handler,context.capture];if(!context.inner)webix._events[id]=info;if(node.addEventListener)node.addEventListener(event,handler,!!context.capture);else if(node.attachEvent)node.attachEvent("on"+event,info[2]=function(){return handler.apply(node,arguments)});return id};webix.eventRemove=function(id){if(!id)return;webix.assert(this._events[id],"Removing non-existing event");var ev=webix._events[id];if(ev[0].removeEventListener)ev[0].removeEventListener(ev[1],ev[2],!!ev[3]);else if(ev[0].detachEvent)ev[0].detachEvent("on"+ev[1],ev[2]);delete this._events[id]};webix.log=function(type,message,details){if(arguments.length==1){message=type;type="log"}if(window.console&&window.console.log){type=type.toLowerCase();if(window.console[type])window.console[type](message||"unknown error");else window.console.log(type+": "+message);if(details)window.console.log(details)}};webix.log_full_time=function(name){webix._start_time_log=new Date;webix.log("Timing start ["+name+"]");window.setTimeout(function(){var time=new Date;webix.log("Timing end ["+name+"]:"+(time.valueOf()-webix._start_time_log.valueOf())/1e3+"s")},1)};webix.log_time=function(name){var fname="_start_time_log"+name;if(!webix[fname]){webix[fname]=new Date;webix.log("Info","Timing start ["+name+"]")}else{var time=new Date;webix.log("Info","Timing end ["+name+"]:"+(time.valueOf()-webix[fname].valueOf())/1e3+"s");webix[fname]=null}};webix.debug_code=function(code){code.call(webix)};webix.EventSystem={$init:function(){if(!this._evs_events){this._evs_events={};this._evs_handlers={};this._evs_map={}}},blockEvent:function(){this._evs_events._block=true},unblockEvent:function(){this._evs_events._block=false},mapEvent:function(map){webix.extend(this._evs_map,map,true)},on_setter:function(config){if(config){for(var i in config){var method=webix.toFunctor(config[i],this.$scope);var sub=i.indexOf("->");if(sub!==-1){this[i.substr(0,sub)].attachEvent(i.substr(sub+2),webix.bind(method,this))}else this.attachEvent(i,method)}}},callEvent:function(type,params){if(this._evs_events._block)return true;type=type.toLowerCase();var event_stack=this._evs_events[type.toLowerCase()];var return_value=true;if(webix.log)if((webix.debug||this.debug)&&!webix.debug_blacklist[type])webix.log("info","["+this.name+"@"+(this._settings||{}).id+"] event:"+type,params);if(event_stack)for(var i=0;i<event_stack.length;i++){if(event_stack[i].apply(this,params||[])===false)return_value=false}if(this._evs_map[type]){var target=this._evs_map[type];target.$eventSource=this;if(!target.callEvent(type,params))return_value=false;target.$eventSource=null}return return_value},attachEvent:function(type,functor,id){webix.assert(functor,"Invalid event handler for "+type);type=type.toLowerCase();id=id||webix.uid();functor=webix.toFunctor(functor,this.$scope);var event_stack=this._evs_events[type]||webix.toArray();if(arguments[3])event_stack.unshift(functor);else event_stack.push(functor);this._evs_events[type]=event_stack;this._evs_handlers[id]={f:functor,t:type};return id},detachEvent:function(id){if(!this._evs_handlers[id]){var name=(id+"").toLowerCase();if(this._evs_events[name]){this._evs_events[name]=webix.toArray()}return}var type=this._evs_handlers[id].t;var functor=this._evs_handlers[id].f;var event_stack=this._evs_events[type];event_stack.remove(functor);delete this._evs_handlers[id]},hasEvent:function(type){type=type.toLowerCase();var stack=this._evs_events[type];if(stack&&stack.length)return true;var parent=this._evs_map[type];if(parent)return parent.hasEvent(type);return false}};webix.extend(webix,webix.EventSystem,true);webix.PowerArray={removeAt:function(pos,len){if(pos>=0)this.splice(pos,len||1)},remove:function(value){this.removeAt(this.find(value))},insertAt:function(data,pos){if(!pos&&pos!==0)this.push(data);else{var b=this.splice(pos,this.length-pos);this[pos]=data;this.push.apply(this,b)}},find:function(data){for(var i=0;i<this.length;i++)if(data==this[i])return i;return-1},each:function(functor,master){for(var i=0;i<this.length;i++)functor.call(master||this,this[i])},map:function(functor,master){for(var i=0;i<this.length;i++)this[i]=functor.call(master||this,this[i]);return this},filter:function(functor,master){for(var i=0;i<this.length;i++)if(!functor.call(master||this,this[i])){this.splice(i,1);i--}return this}};webix.env={};(function(){webix.env.strict=!!window.webix_strict;webix.env.https=document.location.protocol==="https:";var agent=navigator.userAgent;if(agent.indexOf("Mobile")!=-1||agent.indexOf("Windows Phone")!=-1)webix.env.mobile=true;if(webix.env.mobile||agent.indexOf("iPad")!=-1||agent.indexOf("Android")!=-1)webix.env.touch=true;if(agent.indexOf("Opera")!=-1)webix.env.isOpera=true;else{webix.env.isIE=!!document.all||agent.indexOf("Trident")!==-1;if(webix.env.isIE){var version=parseFloat(navigator.appVersion.split("MSIE")[1]);if(version==8)webix.env.isIE8=true}webix.env.isEdge=agent.indexOf("Edge")!=-1;webix.env.isFF=agent.indexOf("Firefox")!=-1;webix.env.isWebKit=agent.indexOf("KHTML")!=-1;webix.env.isSafari=webix.env.isWebKit&&agent.indexOf("Mac")!=-1&&agent.indexOf("Chrome")==-1;if(webix.env.isIE||webix.env.isEdge||webix.env.isFF)webix.env.maxHTMLElementSize=1e7;if(webix.env.isSafari)webix.env.maxHTMLElementSize=1e8}if(agent.toLowerCase().indexOf("android")!=-1){webix.env.isAndroid=true;if(agent.toLowerCase().indexOf("trident")!=-1){webix.env.isAndroid=false;webix.env.isIEMobile=true}}webix.env.transform=false;webix.env.transition=false;var found_index=-1;var js_list=["","webkit","Moz","O","ms"];var css_list=["","-webkit-","-Moz-","-o-","-ms-"];var d=document.createElement("DIV");for(var j=0;j<js_list.length;j++){var name=js_list[j]?js_list[j]+"Transform":"transform";if(typeof d.style[name]!="undefined"){found_index=j;break}}if(found_index>-1){webix.env.cssPrefix=css_list[found_index];var jp=webix.env.jsPrefix=js_list[found_index];webix.env.transform=jp?jp+"Transform":"transform";webix.env.transition=jp?jp+"Transition":"transition";webix.env.transitionDuration=jp?jp+"TransitionDuration":"transitionDuration";d.style[webix.env.transform]="translate3d(0,0,0)";webix.env.translate=d.style[webix.env.transform]?"translate3d":"translate";webix.env.transitionEnd=webix.env.cssPrefix=="-Moz-"?"transitionend":jp?jp+"TransitionEnd":"transitionend"}webix.env.pointerevents=!webix.env.isIE||new RegExp("Trident/.*rv:11").exec(agent)!==null})();webix.env.svg=function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}();webix.env.svganimation=function(){return document.implementation.hasFeature("https://www.w3.org/TR/SVG11/feature#SVG-animation","1.1")}();webix.html={_native_on_selectstart:0,_style_element:{},denySelect:function(){if(!webix._native_on_selectstart)webix._native_on_selectstart=document.onselectstart;document.onselectstart=webix.html.stopEvent},allowSelect:function(){if(webix._native_on_selectstart!==0){document.onselectstart=webix._native_on_selectstart||null}webix._native_on_selectstart=0},index:function(node){var k=0;while(node=node.previousSibling)k++;return k},_style_cache:{},createCss:function(rule,sufix){var text="";sufix=sufix||"";for(var key in rule)text+=key+":"+rule[key]+";";var name=this._style_cache[text+sufix];if(!name){name="s"+webix.uid();this.addStyle("."+name+(sufix||"")+"{"+text+"}");this._style_cache[text+sufix]=name}return name},addStyle:function(rule,group){var style=group?this._style_element[group]:this._style_element["default"];if(!style){style=document.createElement("style");style.setAttribute("type","text/css");style.setAttribute("media","screen,print");document.getElementsByTagName("head")[0].appendChild(style);if(group)this._style_element[group]=style;else this._style_element["default"]=style}if(style.styleSheet)style.styleSheet.cssText+=rule;else style.appendChild(document.createTextNode(rule))},removeStyle:function(group){var box=this._style_element[group||"default"];if(box)box.innerHTML=""},create:function(name,attrs,html){attrs=attrs||{};var node=document.createElement(name);for(var attr_name in attrs)node.setAttribute(attr_name,attrs[attr_name]);if(attrs.style)node.style.cssText=attrs.style;if(attrs["class"])node.className=attrs["class"];if(html)node.innerHTML=html;return node},getValue:function(node){node=webix.toNode(node);if(!node)return"";return webix.isUndefined(node.value)?node.innerHTML:node.value},remove:function(node){if(node instanceof Array)for(var i=0;i<node.length;i++)this.remove(node[i]);else if(node&&node.parentNode)node.parentNode.removeChild(node)},insertBefore:function(node,before,rescue){if(!node)return;if(before&&before.parentNode)before.parentNode.insertBefore(node,before);else rescue.appendChild(node)},locate:function(e,id){var trg;if(e.tagName)trg=e;else{e=e||event;trg=e.target||e.srcElement}while(trg){if(trg.getAttribute){var test=trg.getAttribute(id);if(test)return test}trg=trg.parentNode}return null},offset:function(elem){if(elem.getBoundingClientRect){var box=elem.getBoundingClientRect();var body=document.body;var docElem=document.documentElement;var scrollTop=window.pageYOffset||docElem.scrollTop||body.scrollTop;var scrollLeft=window.pageXOffset||docElem.scrollLeft||body.scrollLeft;var clientTop=docElem.clientTop||body.clientTop||0;var clientLeft=docElem.clientLeft||body.clientLeft||0;var top=box.top+scrollTop-clientTop;var left=box.left+scrollLeft-clientLeft;return{y:Math.round(top),x:Math.round(left),width:elem.offsetWidth,height:elem.offsetHeight}}else{var top=0,left=0;while(elem){top=top+parseInt(elem.offsetTop,10);left=left+parseInt(elem.offsetLeft,10);elem=elem.offsetParent}return{y:top,x:left,width:elem.offsetHeight,height:elem.offsetWidth}}},posRelative:function(ev){ev=ev||event;if(!webix.isUndefined(ev.offsetX))return{x:ev.offsetX,y:ev.offsetY};else return{x:ev.layerX,y:ev.layerY}},pos:function(ev){ev=ev||event;if(ev.touches&&ev.touches[0])ev=ev.touches[0];if(ev.pageX||ev.pageY)return{x:ev.pageX,y:ev.pageY};var d=webix.env.isIE&&document.compatMode!="BackCompat"?document.documentElement:document.body;return{x:ev.clientX+d.scrollLeft-d.clientLeft,y:ev.clientY+d.scrollTop-d.clientTop}},preventEvent:function(e){if(e&&e.preventDefault)e.preventDefault();if(e)e.returnValue=false;return webix.html.stopEvent(e)},stopEvent:function(e){e=e||event;if(e.stopPropagation)e.stopPropagation();e.cancelBubble=true;return false},triggerEvent:function(node,type,name){if(document.createEventObject){var ev=document.createEventObject();if(node.fireEvent)node.fireEvent("on"+name,ev)}else{var ev=document.createEvent(type);ev.initEvent(name,true,true);if(node.dispatchEvent)node.dispatchEvent(ev)}},addCss:function(node,name,check){if(!check||node.className.indexOf(name)===-1)node.className+=" "+name},removeCss:function(node,name){node.className=node.className.replace(RegExp(" "+name,"g"),"")},getTextSize:function(text,css,width){var d=webix.html.create("DIV",{class:"webix_view webix_measure_size "+(css||"")},"");d.style.cssText="height:auto;visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;"+(width?"width:"+width+"px;":"width:auto;white-space:nowrap;");document.body.appendChild(d);var all=typeof text!=="object"?[text]:text;var width=0;var height=0;for(var i=0;i<all.length;i++){d.innerHTML=all[i];width=Math.max(width,d.offsetWidth);height=Math.max(height,d.offsetHeight)}webix.html.remove(d);return{width:width,height:height}},download:function(data,filename){var objUrl=false;if(typeof data=="object"){if(window.navigator.msSaveBlob)return window.navigator.msSaveBlob(data,filename);else{data=window.URL.createObjectURL(data);objUrl=true}}var link=document.createElement("a");link.href=data;link.download=filename;document.body.appendChild(link);link.click();webix.delay(function(){if(objUrl)window.URL.revokeObjectURL(data);document.body.removeChild(link);link.remove()})},_getClassName:function(node){if(!node)return"";var className=node.className||"";if(className.baseVal)className=className.baseVal;if(!className.indexOf)className="";return className},setSelectionRange:function(node,start,end){start=start||0;end=end||start;node.focus();if(node.setSelectionRange)node.setSelectionRange(start,end);else{var textRange=node.createTextRange();textRange.collapse(true);textRange.moveEnd("character",end);textRange.moveStart("character",start);textRange.select()}},getSelectionRange:function(node){if("selectionStart"in node)return{start:node.selectionStart||0,end:node.selectionEnd||0};else{node.focus();var selection=document.selection.createRange();var bookmark=selection.getBookmark();var textRange=node.createTextRange();textRange.moveToBookmark(bookmark);var length=textRange.text.length;textRange.collapse(true);textRange.moveStart("character",-node.value.length);var start=textRange.text.length;return{start:start,end:start+length}}}};webix.ready=function(code){if(this._ready)code.call();else this._ready_code.push(code)};webix.debug_ready=webix.ready;webix._ready_code=[];(function(){var temp=document.getElementsByTagName("SCRIPT");webix.assert(temp.length,"Can't locate codebase");if(temp.length){temp=(temp[temp.length-1].getAttribute("src")||"").split("/");temp.splice(temp.length-1,1);webix.codebase=temp.slice(0,temp.length).join("/")+"/"}var ready=function(){if(webix.env.isIE)document.body.className+=" webix_ie";webix.callEvent("onReady",[])};var doit=function(){webix._ready=true;if(window.webix_ready&&webix.isArray(webix_ready))webix._ready_code=webix_ready.concat(webix._ready_code);for(var i=0;i<webix._ready_code.length;i++)webix._ready_code[i].call();webix._ready_code=[]};webix.attachEvent("onReady",function(force){if(force)doit();else webix.delay(doit)});if(document.readyState=="complete")ready();else webix.event(window,"load",ready)})();webix.locale=webix.locale||{};webix.assert_core_ready();webix.ready(function(){webix.event(document.body,"click",function(e){webix.callEvent("onClick",[e||event])})});webix.editStop=function(){webix.callEvent("onEditEnd",[])};webix.debug_blacklist={onmousemoving:1};(function(){var key="VGhpcyBhcHAgdXNlcyBhIHRyaWFsIHZlcnNpb24gb2YgV2ViaXggVUkuIFRoZSB0cmlhbCBwZXJpb2QgaGFzIGV4cGlyZWQuIDxicj4gSWYgeW91ciB3YW50IHRvIGNvbnRpbnVlIHVzaW5nIFdlYml4IFVJLCBwbGVhc2UgdXBncmFkZSB0byBDb21tZXJjaWFsIG9yIEdQTCBlZGl0aW9uLg==";if(window.atob&&new Date>new Date(2027,9,1))setTimeout(function(){webix.message({type:"error",expire:-1,text:atob(key)})},Math.floor(Math.random()*5e3)+1e3)})();(function(self){var now=typeof setImmediate!=="undefined"?setImmediate:function(cb){setTimeout(cb,0)};function promise(fn,er){var self=this;self.promise=self;self.state="pending";self.val=null;self.fn=fn||null;self.er=er||null;self.next=[]}promise.prototype.resolve=function(v){var self=this;if(self.state==="pending"){self.val=v;self.state="resolving";now(function(){self.fire()})}};promise.prototype.reject=function(v){var self=this;if(self.state==="pending"){self.val=v;self.state="rejecting";now(function(){self.fire()})}};promise.prototype.then=function(fn,er){var self=this;var p=new promise(fn,er);self.next.push(p);if(self.state==="resolved"){p.resolve(self.val)}if(self.state==="rejected"){p.reject(self.val)}return p};promise.prototype.fail=function(er){return this.then(null,er)};promise.prototype.finish=function(type){var self=this;self.state=type;if(self.state==="resolved"){for(var i=0;i<self.next.length;i++)self.next[i].resolve(self.val)}if(self.state==="rejected"){for(var i=0;i<self.next.length;i++)self.next[i].reject(self.val);if(webix.assert&&!self.next.length)throw self.val}};promise.prototype.thennable=function(ref,cb,ec,cn,val){var self=this;val=val||self.val;if(typeof val==="object"&&typeof ref==="function"){try{var cnt=0;ref.call(val,function(v){if(cnt++!==0)return;cb(v)},function(v){if(cnt++!==0)return;ec(v)})}catch(e){ec(e)}}else{cn(val)}};promise.prototype.fire=function(){var self=this;var ref;try{ref=self.val&&self.val.then}catch(e){self.val=e;self.state="rejecting";return self.fire()}self.thennable(ref,function(v){self.val=v;self.state="resolving";self.fire()},function(v){self.val=v;self.state="rejecting";self.fire()},function(v){self.val=v;if(self.state==="resolving"&&typeof self.fn==="function"){try{self.val=self.fn.call(undefined,self.val)}catch(e){self.val=e;return self.finish("rejected")}}if(self.state==="rejecting"&&typeof self.er==="function"){try{self.val=self.er.call(undefined,self.val);self.state="resolving"}catch(e){self.val=e;return self.finish("rejected")}}if(self.val===self){self.val=TypeError();return self.finish("rejected")}self.thennable(ref,function(v){self.val=v;self.finish("resolved")},function(v){self.val=v;self.finish("rejected")},function(v){self.val=v;self.state==="resolving"?self.finish("resolved"):self.finish("rejected")})})};promise.prototype.done=function(){if(this.state="rejected"&&!this.next){throw this.val}return null};promise.prototype.nodeify=function(cb){if(typeof cb==="function")return this.then(function(val){try{cb(null,val)}catch(e){setImmediate(function(){throw e})}return val},function(val){try{cb(val)}catch(e){setImmediate(function(){throw e})}return val});return this};promise.prototype.spread=function(fn,er){return this.all().then(function(list){return typeof fn==="function"&&fn.apply(null,list)},er)};promise.prototype.all=function(){var self=this;return this.then(function(list){var p=new promise;if(!(list instanceof Array)){p.reject(TypeError);return p}var cnt=0;var target=list.length;function done(){if(++cnt===target)p.resolve(list)}for(var i=0,l=list.length;i<l;i++){var value=list[i];var ref;try{ref=value&&value.then}catch(e){p.reject(e);break}(function(i){self.thennable(ref,function(val){list[i]=val;done()},function(val){p.reject(val)},function(){done()},value)})(i)}return p})};var promiz={all:function(list){var p=new promise(null,null);p.resolve(list);return p.all()},defer:function(){return new promise(null,null)},reject:function(v){var t=this.defer();t.state="rejected";t.val=v;return t},resolve:function(v){var t=this.defer();t.state="resolved";t.val=v;return t},fcall:function(){var def=new promise;var args=Array.apply([],arguments);var fn=args.shift();try{var val=fn.apply(null,args);def.resolve(val)}catch(e){def.reject(e)}return def},nfcall:function(){var def=new promise;var args=Array.apply([],arguments);var fn=args.shift();try{args.push(function(err,val){if(err){return def.reject(err)}return def.resolve(val)});fn.apply(null,args)}catch(e){def.reject(e)}return def}};self.promise=promiz})(webix);(function(){var error_key="__webix_remote_error";function RemoteContext(url,config){this._proxy={};this._queue=[];this._url=url;this._key="";if(config)this._process(config);else this._ready=webix.ajax(url).then(function(data){return data.text()}).then(webix.bind(function(text){text=text.split("/*api*/")[1];this._process(JSON.parse(text));return this._proxy},this))}RemoteContext.prototype={_process:function(config){if(config.$key)this._key=config.$key;if(config.$vars)for(var key in config.$vars)this._proxy[key]=config.$vars[key];this._parse(config,this._proxy,"")},_parse:function(api,obj,prefix){for(var key in api){if(key==="$key"||key==="$vars")continue;var val=api[key];if(typeof val=="object"){var sub=obj[key]={};this._parse(val,sub,prefix+key+".")}else obj[key]=this._proxy_call(this,prefix+key)}},_call:function(name,args){var def=this._deffer(this,name,args);this._queue.push(def);this._start_queue();return def},_start_queue:function(){if(!this._timer)this._timer=setTimeout(webix.bind(this._run_queue,this),1)},_run_queue:function(){var data=[],defs=this._queue;for(var i=0;i<this._queue.length;i++){var def=this._queue[i];if(def.$sync){defs.splice(i,1);i--}else data.push({name:def.$name,args:def.$args})}if(defs.length){var ajax=webix.ajax();var pack=this._pack(data);webix.callEvent("onBeforeRemoteCall",[ajax,pack,{}]);var promise=ajax.post(this._url,pack).then(function(res){var data=res.json();var results=data.data;for(var i=0;i<results.length;i++){var res=results[i];var error=results[i]&&results[i][error_key];if(error){webix.callEvent("onRemoteError",[error]);defs[i].reject(error)}else{defs[i].resolve(res)}}},function(res){for(var i=0;i<defs.length;i++)defs[i].reject(res);throw res});webix.callEvent("onAfterRemoteCall",[promise])}this._queue=[];this._timer=null},_sync:function(){var value=null;this.$sync=true;var data=[{name:this.$name,args:this.$args}];try{var ajax=webix.ajax();var pack=this.$context._pack(data);webix.callEvent("onBeforeRemoteCall",[ajax,pack,{sync:true}]);var xhr=ajax.sync().post(this.$context._url,pack);webix.callEvent("onAfterRemoteCall",[null]);var value=JSON.parse(xhr.responseText).data[0];if(value[error_key])value=null}catch(e){}return value},_deffer:function(master,name,args){var pr=webix.promise.defer();pr.sync=master._sync;pr.$name=name;pr.$args=args;pr.$context=this;return pr},_proxy_call:function(master,name){return function(){return master._call(name,[].slice.call(arguments))}},_getProxy:function(){return this._ready||this._proxy},_pack:function(obj){return{key:this._key,payload:obj}}};function getApi(url,config){var ctx=new RemoteContext(url,config);return ctx._getProxy()}webix.remote=function(url,config){if(typeof url==="object"){var scripts=document.getElementsByTagName("script");config=url;url=scripts[scripts.length-1].src;webix.remote=getApi(url,config)}else return getApi(url,config)}})();webix.skin={};webix.skin.air={topLayout:"wide",barHeight:34,tabbarHeight:36,rowHeight:34,toolbarHeight:22,listItemHeight:28,inputHeight:34,inputPadding:2,menuHeight:34,menuMargin:0,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:10,wide:4,clean:0,head:4,line:-1,toolbar:4,form:8},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:8},tabMargin:0,popupPadding:8,calendarHeight:70,padding:0,optionHeight:27};webix.skin["aircompact"]={topLayout:"wide",barHeight:24,tabbarHeight:26,rowHeight:26,toolbarHeight:22,listItemHeight:28,inputHeight:29,inputPadding:2,menuHeight:25,menuMargin:0,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:10,wide:4,clean:0,head:4,line:-1,toolbar:4,form:8},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:8},tabMargin:0,popupPadding:8,calendarHeight:70,padding:0,optionHeight:23};webix.skin.web={name:"web",topLayout:"space",barHeight:28,tabbarHeight:30,rowHeight:30,toolbarHeight:22,listItemHeight:28,inputHeight:28,inputPadding:2,menuMargin:0,menuHeight:27,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:10,wide:4,clean:0,head:4,line:-1,toolbar:4,form:8,accordion:9},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:8,accordion:0},tabMargin:3,tabTopOffset:3,popupPadding:8,calendarHeight:70,padding:0,optionHeight:22};webix.skin.clouds={topLayout:"wide",barHeight:36,tabbarHeight:46,rowHeight:34,toolbarHeight:22,listItemHeight:32,inputHeight:30,inputPadding:2,menuHeight:34,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:10,wide:4,clean:0,head:4,line:-1,toolbar:4,form:8},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:8},tabMargin:2,tabOffset:0,tabBottomOffset:10,popupPadding:8,calendarHeight:70,padding:0};webix.skin.terrace={topLayout:"space",barHeight:37,tabbarHeight:39,rowHeight:38,toolbarHeight:22,listItemHeight:28,inputHeight:30,inputPadding:2,menuMargin:0,menuHeight:32,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:20,wide:20,clean:0,head:4,line:-1,toolbar:4,form:8},layoutPadding:{space:20,wide:0,clean:0,head:0,line:0,toolbar:4,form:8},tabMargin:2,tabOffset:0,popupPadding:8,calendarHeight:70,padding:17,optionHeight:24};webix.skin.metro={topLayout:"space",barHeight:36,tabbarHeight:46,rowHeight:34,toolbarHeight:36,listItemHeight:32,inputHeight:30,buttonHeight:45,inputPadding:2,menuHeight:36,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:10,wide:4,clean:0,head:4,line:-1,toolbar:4,form:8,accordion:9},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:0,form:8,accordion:0},tabMargin:2,tabOffset:0,tabBottomOffset:10,popupPadding:8,calendarHeight:70,padding:0,optionHeight:23};webix.skin.light={topLayout:"space",barHeight:36,tabbarHeight:46,rowHeight:32,toolbarHeight:36,listItemHeight:32,inputHeight:34,buttonHeight:45,inputPadding:3,menuHeight:36,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:15,wide:15,clean:0,head:4,line:-1,toolbar:4,form:8,accordion:10},layoutPadding:{space:15,wide:0,clean:0,head:0,line:0,toolbar:0,form:8,accordion:0},tabMargin:2,tabOffset:0,tabBottomOffset:10,popupPadding:8,calendarHeight:70,padding:0,optionHeight:27};webix.skin.glamour={topLayout:"space",barHeight:39,tabbarHeight:39,rowHeight:32,toolbarHeight:39,listItemHeight:32,inputHeight:34,buttonHeight:34,inputPadding:3,menuHeight:36,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:15,wide:15,clean:0,head:4,line:-1,toolbar:4,form:8,accordion:10},layoutPadding:{space:15,wide:0,clean:0,head:0,line:0,toolbar:3,form:8,accordion:0},tabMargin:1,tabOffset:0,tabBottomOffset:1,popupPadding:8,calendarHeight:70,padding:0,optionHeight:27};webix.skin.touch={topLayout:"space",barHeight:42,tabbarHeight:50,rowHeight:42,toolbarHeight:42,listItemHeight:42,inputHeight:42,inputPadding:4,menuHeight:42,labelTopHeight:24,unitHeaderHeight:34,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:10,wide:4,clean:0,head:4,line:-1,toolbar:0,form:0,accordion:9},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:8,accordion:0},tabMargin:2,tabOffset:0,tabBottomOffset:10,calendar:{headerHeight:70,timepickerHeight:35,height:310,width:300},padding:0,customCheckbox:true,customRadio:true,popupPadding:8,optionHeight:32};webix.skin.flat={topLayout:"space",barHeight:46,tabbarHeight:46,rowHeight:34,toolbarHeight:46,listItemHeight:34,inputHeight:38,buttonHeight:38,inputPadding:3,menuHeight:34,labelTopHeight:22,propertyItemHeight:28,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:10,wide:10,clean:0,head:4,line:-1,toolbar:4,form:8,accordion:10},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:17,accordion:0},tabMargin:4,tabOffset:0,tabBottomOffset:6,tabTopOffset:1,customCheckbox:true,customRadio:true,popupPadding:8,calendarHeight:70,padding:0,accordionType:"accordion",optionHeight:32};webix.skin.compact={topLayout:"space",barHeight:34,tabbarHeight:34,rowHeight:24,toolbarHeight:34,listItemHeight:28,inputHeight:30,buttonHeight:30,inputPadding:3,menuHeight:28,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:5,wide:5,clean:0,head:4,line:-1,toolbar:4,form:4,accordion:5},layoutPadding:{space:5,wide:0,clean:0,head:0,line:0,toolbar:2,form:12,accordion:0},tabMargin:3,tabOffset:0,tabBottomOffset:3,tabTopOffset:1,customCheckbox:true,customRadio:true,popupPadding:8,calendarHeight:70,padding:0,accordionType:"accordion",optionHeight:23};webix.skin.material={topLayout:"space",barHeight:45,tabbarHeight:47,rowHeight:38,toolbarHeight:22,listItemHeight:34,inputHeight:38,buttonHeight:38,inputPadding:2,menuMargin:0,menuHeight:34,labelTopHeight:16,propertyItemHeight:34,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{material:10,space:10,wide:10,clean:0,head:4,line:-1,toolbar:4,form:16,accordion:0},layoutPadding:{material:10,space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:16,accordion:0},tabMargin:0,tabOffset:0,tabBottomOffset:0,tabTopOffset:0,customCheckbox:true,customRadio:true,popupPadding:8,calendarHeight:70,padding:0,accordionType:"accordion"};webix.skin.contrast={topLayout:"space",barHeight:46,tabbarHeight:46,rowHeight:34,toolbarHeight:46,listItemHeight:34,inputHeight:38,buttonHeight:38,inputPadding:3,menuHeight:34,labelTopHeight:22,propertyItemHeight:28,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{space:10,wide:10,clean:0,head:4,line:-1,toolbar:8,form:8,accordion:10},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:17,accordion:0},tabMargin:4,tabOffset:0,tabBottomOffset:6,tabTopOffset:1,customCheckbox:true,customRadio:true,popupPadding:8,calendarHeight:70,padding:0,accordionType:"accordion",optionHeight:32};webix.skin.set=function(name){webix.assert(webix.skin[name],"Incorrect skin name: "+name);webix.skin.$active=webix.skin[name];webix.skin.$name=name;if(webix.ui){for(var key in webix.ui){var view=webix.ui[key];if(view&&view.prototype&&view.prototype.$skin)view.prototype.$skin(view.prototype)}}};webix.skin.set(window.webix_skin||"flat");webix.Destruction={$init:function(){var t=this._destructor_handler={obj:this};webix.destructors.push(t)},destructor:function(){var config=this._settings;if(this._last_editor)this.editCancel();if(this.callEvent)this.callEvent("onDestruct",[]);this.destructor=function(){};this._destructor_handler.obj=null;if(this.getChildViews){var cells=this.getChildViews();if(cells)for(var i=0;i<cells.length;i++)cells[i].destructor();if(this._destroy_with_me)for(var i=0;i<this._destroy_with_me.length;i++)this._destroy_with_me[i].destructor()}delete webix.ui.views[config.id];if(config.$id){var top=this.getTopParentView();if(top&&top._destroy_child)top._destroy_child(config.$id)}this._htmlmap=null;this._htmlrows=null;this._html=null;if(this._contentobj){this._contentobj.innerHTML="";this._contentobj._htmlmap=null}if(this._viewobj&&this._viewobj.parentNode){this._viewobj.parentNode.removeChild(this._viewobj)}if(this.data&&this.data.destructor)this.data.destructor();if(this.unbind)this.unbind();this.data=null;this._viewobj=this.$view=this._contentobj=this._dataobj=null;this._evs_events=this._evs_handlers={};if(webix.UIManager._view==this)webix.UIManager._view=null;var url=config.url;if(url&&url.$proxy&&url.release)url.release();this.$scope=null;this.$destructed=true}};webix.destructors=[];webix.event(window,"unload",function(){webix.callEvent("unload",[]);webix._final_destruction=true;for(var i=0;i<webix.destructors.length;i++){var obj=webix.destructors[i].obj;if(obj)obj.destructor()}webix.destructors=[];webix.ui._popups=webix.toArray();for(var a in webix._events)webix.eventRemove(a)});(function(){var _cache={};var _csp_cache={};var newlines=new RegExp("(\\r\\n|\\n)","g");var quotes=new RegExp('(\\")',"g");var slashes=new RegExp("(\\\\)","g");var escape={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var badChars=/[&<>"'`]/g;var escapeChar=function(chr){return escape[chr]||"&amp;"};webix.template=function(str){if(typeof str=="function")return str;if(_cache[str])return _cache[str];str=(str||"").toString();if(str.indexOf("->")!=-1){var teststr=str.split("->");switch(teststr[0]){case"html":str=webix.html.getValue(teststr[1]);break;case"http":str=(new webix.ajax).sync().get(teststr[1],{uid:webix.uid()}).responseText;break;default:break}}str=(str||"").toString();if(webix.env.strict){if(!_csp_cache[str]){_csp_cache[str]=[];var temp_res=[];str.replace(/\{obj\.([^}?]+)\?([^:]*):([^}]*)\}/g,function(search,s1,s2,s3,pos){temp_res.push({pos:pos,str:search,fn:function(obj,common){return obj[s1]?s2:s3}})});str.replace(/\{common\.([^}\(]*)\}/g,function(search,s,pos){temp_res.push({pos:pos,str:search,fn:function(obj,common){return common[s]||""}})});str.replace(/\{common\.([^\}\(]*)\(\)\}/g,function(search,s,pos){temp_res.push({pos:pos,str:search,fn:function(obj,common){return common[s]?common[s].apply(this,arguments):""}})});str.replace(/\{obj\.([^:}]*)\}/g,function(search,s,pos){temp_res.push({pos:pos,str:search,fn:function(obj,common){return obj[s]}})});str.replace("{obj}",function(search,s,pos){temp_res.push({pos:pos,str:search,fn:function(obj,common){return obj}})});str.replace(/#([^#'";, ]+)#/gi,function(search,s,pos){if(s.charAt(0)=="!"){s=s.substr(1);temp_res.push({pos:pos,str:search,fn:function(obj,common){if(s.indexOf(".")!=-1)obj=webix.CodeParser.collapseNames(obj);return webix.template.escape(obj[s])}})}else{temp_res.push({pos:pos,str:search,fn:function(obj,common){if(s.indexOf(".")!=-1)obj=webix.CodeParser.collapseNames(obj);return obj[s]}})}});temp_res.sort(function(a,b){return a.pos>b.pos?1:-1});if(temp_res.length){var lastPos=0;var addStr=function(str,n0,n1){_csp_cache[str].push(function(){return str.slice(n0,n1)})};for(var i=0;i<temp_res.length;i++){var pos=temp_res[i].pos;addStr(str,lastPos,pos);_csp_cache[str].push(temp_res[i].fn);lastPos=pos+temp_res[i].str.length}addStr(str,lastPos,str.length)}else _csp_cache[str].push(function(){return str})}return function(){var s="";for(var i=0;i<_csp_cache[str].length;i++){s+=_csp_cache[str][i].apply(this,arguments)}return s}}str=str.replace(slashes,"\\\\");str=str.replace(newlines,"\\n");str=str.replace(quotes,'\\"');str=str.replace(/\{obj\.([^}?]+)\?([^:]*):([^}]*)\}/g,'"+(obj.$1?"$2":"$3")+"');str=str.replace(/\{common\.([^}\(]*)\}/g,"\"+(common.$1||'')+\"");str=str.replace(/\{common\.([^\}\(]*)\(\)\}/g,'"+(common.$1?common.$1.apply(this, arguments):"")+"');str=str.replace(/\{obj\.([^}]*)\}/g,'"+(obj.$1)+"');str=str.replace("{obj}",'"+obj+"');str=str.replace(/#([^#'";, ]+)#/gi,function(str,key){if(key.charAt(0)=="!")return'"+webix.template.escape(obj.'+key.substr(1)+')+"';else return'"+(obj.'+key+')+"'});try{_cache[str]=Function("obj","common",'return "'+str+'";')}catch(e){webix.assert_error("Invalid template:"+str)}return _cache[str]};webix.template.escape=function(str){if(str===webix.undefined||str===null)return"";return(str.toString()||"").replace(badChars,escapeChar)};webix.template.empty=function(){return""};webix.template.bind=function(value){return webix.bind(webix.template(value),this)};webix.type=function(obj,data){if(obj.$protoWait){if(!obj._webix_type_wait)obj._webix_type_wait=[];obj._webix_type_wait.push(data);return}if(typeof obj=="function")obj=obj.prototype;if(!obj.types){obj.types={default:obj.type};obj.type.name="default"}var name=data.name;var type=obj.type;if(name)type=obj.types[name]=webix.clone(data.baseType?obj.types[data.baseType]:obj.type);for(var key in data){if(key.indexOf("template")===0)type[key]=webix.template(data[key]);else type[key]=data[key]}return name}})();webix.Settings={$init:function(){this._settings=this.config={}},define:function(property,value){if(typeof property=="object")return this._parseSeetingColl(property);return this._define(property,value)},_define:function(property,value){var setter=this[property+"_setter"];return this._settings[property]=setter?setter.call(this,value,property):value},_parseSeetingColl:function(coll){if(coll){for(var a in coll)this._define(a,coll[a])}},_parseSettings:function(obj,initial){var settings={};if(initial)settings=webix.extend(settings,initial);if(typeof obj=="object"&&!obj.tagName)webix.extend(settings,obj,true);this._parseSeetingColl(settings)},_mergeSettings:function(config,defaults){for(var key in defaults)switch(typeof config[key]){case"object":config[key]=this._mergeSettings(config[key]||{},defaults[key]);break;case"undefined":config[key]=defaults[key];break;default:break}return config}};webix.proxy=function(name,source,extra){webix.assert(webix.proxy[name],"Invalid proxy name: "+name);var copy=webix.copy(webix.proxy[name]);copy.source=source;if(extra)webix.extend(copy,extra,true);if(copy.init)copy.init();return copy};webix.proxy.$parse=function(value){if(typeof value=="string"&&value.indexOf("->")!=-1){var parts=value.split("->");return webix.proxy(parts[0],parts[1])}return value};webix.proxy.post={$proxy:true,load:function(view,callback,params){params=webix.extend(params||{},this.params||{},true);webix.ajax().bind(view).post(this.source,params,callback)}};webix.proxy.sync={$proxy:true,load:function(view,callback){webix.ajax().sync().bind(view).get(this.source,null,callback)}};webix.proxy.connector={$proxy:true,connectorName:"!nativeeditor_status",load:function(view,callback){webix.ajax(this.source,callback,view)},saveAll:function(view,updates,dp,callback){var url=this.source;var data={};var ids=[];for(var i=0;i<updates.length;i++){var action=updates[i];ids.push(action.id);for(var j in action.data)if(j.indexOf("$")!==0)data[action.id+"_"+j]=action.data[j];data[action.id+"_"+this.connectorName]=action.operation}data.ids=ids.join(",");data.webix_security=webix.securityKey;url+=url.indexOf("?")==-1?"?":"&";url+="editing=true";webix.ajax().post(url,data,callback)},result:function(state,view,dp,text,data,loader){data=data.xml();if(!data)return dp._processError(null,text,data,loader);var actions=data.data.action;if(!actions.length)actions=[actions];var hash=[];for(var i=0;i<actions.length;i++){var obj=actions[i];hash.push(obj);obj.status=obj.type;obj.id=obj.sid;obj.newid=obj.tid;dp.processResult(obj,obj,{text:text,data:data,loader:loader})}return hash}};webix.proxy.debug={$proxy:true,load:function(){},save:function(v,u,d,c){webix.delay(function(){window.console.log("[DP] "+u.id+" -> "+u.operation,u.data);var data={id:u.data.id,newid:u.data.id,status:u.data.operation};d.processResult(data,data)})}};webix.proxy.rest={$proxy:true,load:function(view,callback){webix.ajax(this.source,callback,view)},save:function(view,update,dp,callback){return webix.proxy.rest._save_logic.call(this,view,update,dp,callback,webix.ajax())},_save_logic:function(view,update,dp,callback,ajax){var url=this.source;var query="";var mark=url.indexOf("?");if(mark!==-1){query=url.substr(mark);url=url.substr(0,mark)}url+=url.charAt(url.length-1)=="/"?"":"/";var mode=update.operation;var data=update.data;if(mode=="insert")delete data.id;if(mode=="update"){ajax.put(url+data.id+query,data,callback)}else if(mode=="delete"){ajax.del(url+data.id+query,data,callback)}else{ajax.post(url+query,data,callback)}}};webix.proxy.json={$proxy:true,load:function(view,callback){webix.ajax(this.source,callback,view)},save:function(view,update,dp,callback){var ajax=webix.ajax().headers({"Content-Type":"application/json"});return webix.proxy.rest._save_logic.call(this,view,update,dp,callback,ajax)}};webix.proxy.faye={$proxy:true,init:function(){this.clientId=this.clientId||webix.uid()},load:function(view){var selfid=this.clientId;this.client.subscribe(this.source,function(update){if(update.clientId==selfid)return;webix.dp(view).ignore(function(){if(update.operation=="delete")view.remove(update.data.id);else if(update.operation=="insert")view.add(update.data);else if(update.operation=="update"){var item=view.getItem(update.data.id);if(item){webix.extend(item,update.data,true);view.refresh(item.id)}}})})},save:function(view,update,dp,callback){update.clientId=this.clientId;this.client.publish(this.source,update)}};webix.proxy.indexdb={$proxy:true,create:function(db,config,version,callback){this.source=db+"/";this._get_db(callback,version,function(e){var db=e.target.result;for(var key in config){var data=config[key];var store=db.createObjectStore(key,{keyPath:"id",autoIncrement:true});for(var i=0;i<data.length;i++)store.put(data[i])}})},_get_db:function(callback,version,upgrade){if(this.source.indexOf("/")!=-1){var parts=this.source.split("/");this.source=parts[1];version=version||parts[2];var _index=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB;var db;if(version)db=_index.open(parts[0],version);else db=_index.open(parts[0]);if(upgrade)db.onupgradeneeded=upgrade;db.onerror=function(){};db.onblocked=function(){};db.onsuccess=webix.bind(function(e){this.db=e.target.result;if(callback)callback.call(this)},this)}else if(this.db)callback.call(this);else webix.delay(this._get_db,this,[callback],50)},load:function(view,callback){this._get_db(function(){var store=this.db.transaction(this.source).objectStore(this.source);var data=[];store.openCursor().onsuccess=function(e){var result=e.target.result;if(result){data.push(result.value);result["continue"]()}else{view.parse(data);webix.ajax.$callback(view,callback,"[]",data)}}})},save:function(view,update,dp,callback){this._get_db(function(){var mode=update.operation;var data=update.data;var id=update.id;var store=this.db.transaction([this.source],"readwrite").objectStore(this.source);var req;if(mode=="delete")req=store["delete"](id);else if(mode=="update")req=store.put(data);else if(mode=="insert"){delete data.id;req=store.add(data)}req.onsuccess=function(e){var result={status:mode,id:update.id};if(mode=="insert")result.newid=e.target.result;dp.processResult(result,result)}})}};webix.proxy.binary={$proxy:true,load:function(view,callback){var parts=this.source.split("@");var ext=parts[0].split(".").pop();return webix.ajax().response("arraybuffer").get(parts[0]).then(function(res){var options={ext:ext,dataurl:parts[1]};webix.ajax.$callback(view,callback,"",{data:res,options:options},-1)})}};webix.ajax=function(url,params,call){if(arguments.length!==0)return(new webix.ajax).get(url,params,call);if(!this.getXHR)return new webix.ajax;return this};webix.ajax.count=0;webix.ajax.prototype={master:null,getXHR:function(){return new XMLHttpRequest},stringify:function(obj){return webix.stringify(obj)},_send:function(url,params,call,mode){var master;if(params&&(webix.isArray(params)||typeof(params.success||params.error||params)=="function")){master=call;call=params;params=null}var defer=webix.promise.defer();var x=this.getXHR();if(!webix.isArray(call))call=[call];call.push({success:function(t,d){defer.resolve(d)},error:function(t,d){defer.reject(x)}});var headers=this._header||{};if(!webix.callEvent("onBeforeAjax",[mode,url,params,x,headers,null,defer]))return;var json_mode=false;if(mode!=="GET"){var found=false;for(var key in headers)if(key.toString().toLowerCase()=="content-type"){found=true;if(headers[key]=="application/json")json_mode=true}if(!found)headers["Content-Type"]="application/x-www-form-urlencoded"}if(typeof params=="object"&&!(window.FormData&&params instanceof window.FormData)){if(json_mode)params=this.stringify(params);else{var t=[];for(var a in params){var value=params[a];if(value===null||value===webix.undefined)value="";if(typeof value==="object")value=this.stringify(value);t.push(a+"="+encodeURIComponent(value))}params=t.join("&")}}if(params&&mode==="GET"){url=url+(url.indexOf("?")!=-1?"&":"?")+params;params=null}x.open(mode,url,!this._sync);var type=this._response;if(type)x.responseType=type;for(var key in headers)x.setRequestHeader(key,headers[key]);var self=this;this.master=this.master||master;x.onreadystatechange=function(){if(!x.readyState||x.readyState==4){if(webix.debug_time)webix.log_full_time("data_loading");webix.ajax.count++;if(call&&self&&!x.aborted){if(webix._xhr_aborted.find(x)!=-1)return webix._xhr_aborted.remove(x);var owner=self.master||self;var is_error=x.status>=400||x.status===0;var text,data;if(x.responseType=="blob"||x.responseType=="arraybuffer"){text="";data=x.response}else{text=x.responseText||"";data=self._data(x)}webix.ajax.$callback(owner,call,text,data,x,is_error)}if(self)self.master=null;call=self=master=null}};if(this._timeout)x.timeout=this._timeout;if(!this._sync)setTimeout(function(){if(!x.aborted){if(webix._xhr_aborted.find(x)!=-1)webix._xhr_aborted.remove(x);else x.send(params||null)}},1);else x.send(params||null);if(this.master&&this.master._ajax_queue)this.master._ajax_queue.push(x);return this._sync?x:defer},_data:function(x){return{xml:function(){try{return webix.DataDriver.xml.tagToObject(webix.DataDriver.xml.toObject(x.responseText,this))}catch(e){webix.log(x.responseText);webix.log(e.toString());webix.assert_error("Invalid xml data for parsing")}},rawxml:function(){if(!window.XPathResult)return webix.DataDriver.xml.fromString(x.responseText);return x.responseXML},text:function(){return x.responseText},json:function(){return webix.DataDriver.json.toObject(x.responseText,false)}}},get:function(url,params,call){return this._send(url,params,call,"GET")},post:function(url,params,call){return this._send(url,params,call,"POST")},put:function(url,params,call){return this._send(url,params,call,"PUT")},del:function(url,params,call){return this._send(url,params,call,"DELETE")},patch:function(url,params,call){return this._send(url,params,call,"PATCH")},sync:function(){this._sync=true;return this},timeout:function(num){this._timeout=num;return this},response:function(value){this._response=value;return this},header:function(header){webix.assert(false,"ajax.header is deprecated in favor of ajax.headers");this._header=header;return this},headers:function(header){this._header=webix.extend(this._header||{},header);return this},bind:function(master){this.master=master;return this}};webix.ajax.$callback=function(owner,call,text,data,x,is_error){if(owner.$destructed)return;if(x===-1&&data&&typeof data.json=="function")data=data.json();if(is_error)webix.callEvent("onAjaxError",[x]);if(!webix.isArray(call))call=[call];if(!is_error)for(var i=0;i<call.length;i++){if(call[i]){var before=call[i].before;if(before)before.call(owner,text,data,x)}}for(var i=0;i<call.length;i++)if(call[i]){var method=call[i].success||call[i];if(is_error)method=call[i].error;if(method&&method.call)method.call(owner,text,data,x)}};webix.send=function(url,values,method,target){var form=webix.html.create("FORM",{target:target||"_self",action:url,method:method||"POST"},"");for(var k in values){var field=webix.html.create("INPUT",{type:"hidden",name:k,value:values[k]},"");form.appendChild(field)}form.style.display="none";document.body.appendChild(form);form.submit();document.body.removeChild(form)};webix.AtomDataLoader={$init:function(config){this.data={};this.waitData=webix.promise.defer();if(config)this._settings.datatype=config.datatype||"json";this.$ready.push(this._load_when_ready)},_load_when_ready:function(){this._ready_for_data=true;if(this._settings.url)this.url_setter(this._settings.url);if(this._settings.data)this.data_setter(this._settings.data)},url_setter:function(value){value=webix.proxy.$parse(value);if(!this._ready_for_data)return value;this.load(value,this._settings.datatype);return value},data_setter:function(value){if(!this._ready_for_data)return value;this.parse(value,this._settings.datatype);return true},load:function(url,call){var details=arguments[2]||null;if(!this.callEvent("onBeforeLoad",[]))return webix.promise.reject();if(typeof call=="string"){this.data.driver=webix.DataDriver[call];call=arguments[2]}else if(!this.data.driver)this.data.driver=webix.DataDriver.json;var callback=[{success:this._onLoad,error:this._onLoadError}];if(call){if(webix.isArray(call))callback.push.apply(callback,call);else callback.push(call)}url=webix.proxy.$parse(url);if(url.$proxy&&url.load)return url.load(this,callback,details);if(typeof url==="function"){return url(details).then(webix.bind(function(data){webix.ajax.$callback(this,callback,"",data,-1)},this),webix.bind(function(x){webix.ajax.$callback(this,callback,"",null,x,true)},this))}return webix.ajax(url,callback,this)},parse:function(data,type){if(data&&data.then&&typeof data.then=="function"){return data.then(webix.bind(function(data){if(data&&typeof data.json=="function")data=data.json();this.parse(data,type)},this))}if(data&&data.sync&&this.sync)return this._syncData(data);if(!this.callEvent("onBeforeLoad",[]))return webix.promise.reject();this.data.driver=webix.DataDriver[type||"json"];this._onLoad(data,null)},_syncData:function(data){if(this.data)this.data.attachEvent("onSyncApply",webix.bind(function(){if(this._call_onready)this._call_onready()},this));this.sync(data)},_parse:function(data){var parsed,record,driver=this.data.driver;record=driver.getRecords(data)[0];parsed=record?driver.getDetails(record):{};if(this.setValues)this.setValues(parsed);else this.data=parsed},_onLoadContinue:function(data,text,response,loader){if(data){if(!this.$onLoad||!this.$onLoad(data,this.data.driver)){if(this.data&&this.data._parse)this.data._parse(data);else this._parse(data)}}else this._onLoadError(text,response,loader);if(this._call_onready)this._call_onready();this.callEvent("onAfterLoad",[]);this.waitData.resolve()},_onLoad:function(text,response,loader){var driver=this.data.driver;var data;if(loader===-1)data=driver.toObject(response);else{if(this._ajax_queue)this._ajax_queue.remove(loader);data=driver.toObject(text,response)}if(!data||!data.then)this._onLoadContinue(data);else if(data.then&&typeof data.then=="function")data.then(webix.bind(this._onLoadContinue,this))},_onLoadError:function(text,xml,xhttp){this.callEvent("onAfterLoad",[]);this.callEvent("onLoadError",arguments);webix.callEvent("onLoadError",[text,xml,xhttp,this])},_check_data_feed:function(data){if(!this._settings.dataFeed||this._ignore_feed||!data)return true;var url=this._settings.dataFeed;if(typeof url=="function")return url.call(this,data.id||data,data);url=url+(url.indexOf("?")==-1?"?":"&")+"action=get&id="+encodeURIComponent(data.id||data);if(!this.callEvent("onBeforeLoad",[]))return false;webix.ajax(url,function(text,xml,loader){this._ignore_feed=true;var driver=webix.DataDriver.json;var data=driver.toObject(text,xml);if(data)this.setValues(driver.getDetails(driver.getRecords(data)[0]));else this._onLoadError(text,xml,loader);this._ignore_feed=false;this.callEvent("onAfterLoad",[])},this);return false}};webix.DataDriver={};webix.DataDriver.json={toObject:function(data){if(!data)return null;if(typeof data=="string"){try{if(this.parseDates){var isodate=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(.\d{1-3})?Z/;data=JSON.parse(data,function(key,value){if(typeof value=="string"){if(isodate.test(value))return new Date(value)}return value})}else{data=JSON.parse(data)}}catch(e){webix.log(e);webix.log(data);webix.assert_error("Invalid JSON data for parsing");return null}}return data},getRecords:function(data){if(data&&data.data)data=data.data;if(data&&!webix.isArray(data))return[data];return data},getDetails:function(data){if(typeof data=="string")return{id:data||webix.uid(),value:data};return data},getOptions:function(data){return data.collections},getInfo:function(data){return{size:data.total_count||0,from:data.pos||0,parent:data.parent||0,config:data.config,key:data.webix_security}},child:"data",parseDates:false};webix.DataDriver.html={toObject:function(data){if(typeof data=="string"){var t=null;if(data.indexOf("<")==-1)t=webix.toNode(data);if(!t){t=document.createElement("DIV");t.innerHTML=data}return t.firstChild}return data},getRecords:function(node){return node.getElementsByTagName(this.tag)},getDetails:function(data){return webix.DataDriver.xml.tagToObject(data)},getOptions:function(){return false},getInfo:function(data){return{size:0,from:0}},tag:"LI"};webix.DataDriver.jsarray={toObject:function(data){if(typeof data=="string")return JSON.parse(data);return data},getRecords:function(data){if(data&&data.data)data=data.data;return data},getDetails:function(data){var result={};for(var i=0;i<data.length;i++)result["data"+i]=data[i];if(this.idColumn!==null)result.id=data[this.idColumn];return result},getOptions:function(){return false},getInfo:function(data){return{size:0,from:0}},idColumn:null};webix.DataDriver.csv={toObject:function(data){return data},getRecords:function(data){return data.split(this.row)},getDetails:function(data){data=this.stringToArray(data);var result={};for(var i=0;i<data.length;i++)result["data"+i]=data[i];if(this.idColumn!==null)result.id=data[this.idColumn];return result},getOptions:function(){return false},getInfo:function(data){return{size:0,from:0}},stringToArray:function(data){data=data.split(this.cell);for(var i=0;i<data.length;i++)data[i]=data[i].replace(/^[ \t\n\r]*(\"|)/g,"").replace(/(\"|)[ \t\n\r]*$/g,"");return data},idColumn:null,row:"\n",cell:","};webix.DataDriver.xml={_isValidXML:function(data){if(!data||!data.documentElement)return null;if(data.getElementsByTagName("parsererror").length)return null;return data},toObject:function(text,response){var data=response?response.rawxml?response.rawxml():response:null;if(this._isValidXML(data))return data;if(typeof text=="string")data=this.fromString(text.replace(/^[\s]+/,""));else data=text;if(this._isValidXML(data))return data;return null},getRecords:function(data){return this.xpath(data,this.records)},records:"/*/item",child:"item",config:"/*/config",getDetails:function(data){return this.tagToObject(data,{})},getOptions:function(){return false},getInfo:function(data){var config=this.xpath(data,this.config);if(config.length)config=this.assignTypes(this.tagToObject(config[0],{}));else config=null;return{size:data.documentElement.getAttribute("total_count")||0,from:data.documentElement.getAttribute("pos")||0,parent:data.documentElement.getAttribute("parent")||0,config:config,key:data.documentElement.getAttribute("webix_security")||null}},xpath:function(xml,path){if(window.XPathResult){var node=xml;if(xml.nodeName.indexOf("document")==-1)xml=xml.ownerDocument;var res=[];var col=xml.evaluate(path,node,null,XPathResult.ANY_TYPE,null);var temp=col.iterateNext();while(temp){res.push(temp);temp=col.iterateNext()}return res}else{var test=true;try{if(typeof xml.selectNodes=="undefined")test=false}catch(e){}if(test)return xml.selectNodes(path);else{var name=path.split("/").pop();return xml.getElementsByTagName(name)}}},assignTypes:function(obj){for(var k in obj){var test=obj[k];if(typeof test=="object")this.assignTypes(test);else if(typeof test=="string"){if(test==="")continue;if(test=="true")obj[k]=true;else if(test=="false")obj[k]=false;else if(test==test*1)obj[k]=obj[k]*1}}return obj},tagToObject:function(tag,z){var isArray=tag.nodeType==1&&tag.getAttribute("stack");var hasSubTags=0;if(!isArray){z=z||{};var a=tag.attributes;if(a&&a.length)for(var i=0;i<a.length;i++){z[a[i].name]=a[i].value;hasSubTags=1}var b=tag.childNodes;for(var i=0;i<b.length;i++)if(b[i].nodeType==1){var name=b[i].tagName;if(z[name]){if(typeof z[name].push!="function")z[name]=[z[name]];z[name].push(this.tagToObject(b[i],{}))}else z[name]=this.tagToObject(b[i],{});hasSubTags=2}if(!hasSubTags)return this.nodeValue(tag);if(hasSubTags<2)z.value=z.value||this.nodeValue(tag)}else{z=[];var b=tag.childNodes;for(var i=0;i<b.length;i++)if(b[i].nodeType==1)z.push(this.tagToObject(b[i],{}))}return z},nodeValue:function(node){if(node.firstChild){return node.firstChild.wholeText||node.firstChild.data}return""},fromString:function(xmlString){try{if(window.DOMParser)return(new DOMParser).parseFromString(xmlString,"text/xml");if(window.ActiveXObject){var temp=new ActiveXObject("Microsoft.xmlDOM");temp.loadXML(xmlString);return temp}}catch(e){webix.assert_error(e);return null}webix.assert_error("Load from xml string is not supported")}};webix.debug_code(function(){webix.debug_load_event=webix.attachEvent("onLoadError",function(text,xml,xhttp,owner){text=text||"[EMPTY DATA]";var error_text="Data loading error, check console for details";if(text.indexOf("<?php")===0)error_text="PHP support missed";else if(text.indexOf("WEBIX_ERROR:")===0)error_text=text.replace("WEBIX_ERROR:","");if(webix.message)webix.message({type:"debug",text:error_text,expire:-1});if(window.console){var logger=window.console;logger.log("Data loading error");logger.log("Object:",owner);logger.log("Response:",text);logger.log("XHTTP:",xhttp)}});webix.ready(function(){var path=document.location.href;if(path.indexOf("file:")===0){if(webix.message)webix.message({type:"error",text:"Please open sample by http,<br>not as file://",expire:-1});else window.alert("Please open sample by http, not as file://")}})});webix.BaseBind={bind:function(target,rule,format){if(!this.attachEvent)webix.extend(this,webix.EventSystem);if(typeof target=="string")target=webix.$$(target);if(target._initBindSource)target._initBindSource();if(this._initBindSource)this._initBindSource();if(!target.getBindData)webix.extend(target,webix.BindSource);this._bind_ready();target.addBind(this._settings.id,rule,format);this._bind_source=target._settings.id;if(webix.debug_bind)webix.log("[bind] "+this.name+"@"+this._settings.id+" <= "+target.name+"@"+target._settings.id);var target_id=this._settings.id;this._bind_refresh_handler=this.attachEvent(this.touchable?"onAfterRender":"onBindRequest",function(){return target.getBindData(target_id)});if(this.refresh&&this.isVisible(this._settings.id))this.refresh()},unbind:function(){if(this._bind_source){var target=webix.$$(this._bind_source);if(target)target.removeBind(this._settings.id);this.detachEvent(this._bind_refresh_handler);this._bind_source=null}},_bind_ready:function(){var config=this._settings;if(this.filter){var key=config.id;this.data._on_sync=webix.bind(function(){webix.$$(this._bind_source)._bind_updated[key]=false},this)}var old_render=this.render;this.render=function(){if(this._in_bind_processing)return;this._in_bind_processing=true;var result=this.callEvent("onBindRequest");this._in_bind_processing=false;return old_render.apply(this,result===false?arguments:[])};if(this.getValue||this.getValues)this.save=function(data){var source=webix.$$(this._bind_source);if(data)source.setBindData(data);else{if(this.validate&&!this.validate())return false;var values=this.getValue?this.getValue:this.getValues();source.setBindData(values,this._settings.id);if(this.setDirty)this.setDirty(false)}};this._bind_ready=function(){}}};webix.BindSource={$init:function(){this._bind_hash={};this._bind_updated={};this._ignore_binds={};this._bind_specific_rules(this)},saveBatch:function(code){this._do_not_update_binds=true;code.call(this);this._do_not_update_binds=false;this._update_binds()},setBindData:function(data,key){if(key)this._ignore_binds[key]=true;if(webix.debug_bind)webix.log("[bind:save] "+this.name+"@"+this._settings.id+" <= "+"@"+key);if(this.setValue)this.setValue(data);else if(this.setValues)this.setValues(data);else{var id=this.getCursor();if(id)this.updateItem(id,data);else this.add(data)}this.callEvent("onBindUpdate",[data,key]);if(this.save)this.save();if(key)this._ignore_binds[key]=false},getBindData:function(key,update){if(this._bind_updated[key])return false;var target=webix.$$(key);if(target.isVisible(target._settings.id)){this._bind_updated[key]=true;if(webix.debug_bind)webix.log("[bind:request] "+this.name+"@"+this._settings.id+" => "+target.name+"@"+target._settings.id);this._bind_update(target,this._bind_hash[key][0],this._bind_hash[key][1]);if(update&&target.filter)target.refresh()}},addBind:function(source,rule,format){this._bind_hash[source]=[rule,format]},removeBind:function(source){delete this._bind_hash[source];delete this._bind_updated[source];delete this._ignore_binds[source]},_bind_specific_rules:function(obj){if(obj.filter)webix.extend(this,webix.CollectionBind);else if(obj.setValue)webix.extend(this,webix.ValueBind);else webix.extend(this,webix.RecordBind)},_update_binds:function(){if(!this._do_not_update_binds)for(var key in this._bind_hash){if(this._ignore_binds[key])continue;this._bind_updated[key]=false;this.getBindData(key,true)}},_bind_update_common:function(target,rule,data){if(target.setValue)target.setValue(data&&rule?data[rule]:data);else if(!target.filter){if(!data&&target.clear)target.clear();else{if(target._check_data_feed(data))target.setValues(webix.clone(data))}}else{target.data.silent(function(){this.filter(rule,data)})}target.callEvent("onBindApply",[data,rule,this])}};webix.DataValue=webix.proto({name:"DataValue",isVisible:function(){return true},$init:function(config){if(!config||webix.isUndefined(config.value))this.data=config||"";var id=config&&config.id?config.id:webix.uid();this._settings={id:id};webix.ui.views[id]=this},setValue:function(value){this.data=value;this.callEvent("onChange",[value])},getValue:function(){return this.data},refresh:function(){this.callEvent("onBindRequest")}},webix.EventSystem,webix.BaseBind);webix.DataRecord=webix.proto({name:"DataRecord",isVisible:function(){return true},$init:function(config){this.data=config||{};var id=config&&config.id?config.id:webix.uid();this._settings={id:id};webix.ui.views[id]=this},getValues:function(){return this.data},setValues:function(data,update){this.data=update?webix.extend(this.data,data,true):data;this.callEvent("onChange",[data])},refresh:function(){this.callEvent("onBindRequest")}},webix.EventSystem,webix.BaseBind,webix.AtomDataLoader,webix.Settings);webix.ValueBind={$init:function(){this.attachEvent("onChange",this._update_binds)},_bind_update:function(target,rule,format){rule=rule||"value";var data=this.getValue()||"";if(format)data=format(data);if(target.setValue)target.setValue(data);else if(!target.filter){var pod={};pod[rule]=data;if(target._check_data_feed(data))target.setValues(pod)}else{target.data.silent(function(){this.filter(rule,data)})}target.callEvent("onBindApply",[data,rule,this])}};webix.RecordBind={$init:function(){this.attachEvent("onChange",this._update_binds)},_bind_update:function(target,rule,format){var data=this.getValues()||null;if(format)data=format(data);this._bind_update_common(target,rule,data)}};webix.CollectionBind={$init:function(){this._cursor=null;this.attachEvent("onSelectChange",function(data){var sel=this.getSelectedId();this.setCursor(sel?sel.id||sel:null)});this.attachEvent("onAfterCursorChange",this._update_binds);this.attachEvent("onAfterDelete",function(id){if(id==this.getCursor())this.setCursor(null)});this.data.attachEvent("onStoreUpdated",webix.bind(function(id,data,mode){if(id&&id==this.getCursor()&&mode!="paint"&&mode!="delete")this._update_binds()},this));this.data.attachEvent("onClearAll",webix.bind(function(){this._cursor=null},this));this.data.attachEvent("onIdChange",webix.bind(function(oldid,newid){if(this._cursor==oldid){this._cursor=newid;this._update_binds()}},this))},refreshCursor:function(){if(this._cursor)this.callEvent("onAfterCursorChange",[this._cursor])},setCursor:function(id){if(id==this._cursor||id!==null&&!this.getItem(id))return;this.callEvent("onBeforeCursorChange",[this._cursor]);this._cursor=id;this.callEvent("onAfterCursorChange",[id])},getCursor:function(){return this._cursor},_bind_update:function(target,rule,format){if(rule=="$level"&&this.data.getBranch)return(target.data||target).importData(this.data.getBranch(this.getCursor()));var data=this.getItem(this.getCursor())||this._settings.defaultData||null;if(rule=="$data"){if(typeof format==="function")format.call(target,data,this);else target.data.importData(data?data[format]:[]);target.callEvent("onBindApply",[data,rule,this])}else{if(format)data=format(data);this._bind_update_common(target,rule,data)}}};webix.AtomRender={_toHTML:function(obj){if(obj.$empty)return"";return this._settings.template(obj,this)},render:function(){var cfg=this._settings;if(this.isVisible(cfg.id)){if(webix.debug_render)webix.log("Render: "+this.name+"@"+cfg.id);if(!this.callEvent||this.callEvent("onBeforeRender",[this.data])){if(this.data&&!cfg.content){this._dataobj.innerHTML="";this._dataobj.innerHTML=this._toHTML(this.data)}if(this.callEvent)this.callEvent("onAfterRender",[])}return true}return false},sync:function(source){this._backbone_sync=false;if(source.name!="DataStore"){if(source.data&&source.name=="DataStore"){source=source.data}else{this._backbone_sync=true}}if(this._backbone_sync)source.bind("change",webix.bind(function(data){if(data.id==this.data.id){this.data=data.attributes;this.refresh()}},this));else source.attachEvent("onStoreUpdated",webix.bind(function(id){if(!id||id==this.data.id){this.data=source.pull[id];this.refresh()}},this))},template_setter:webix.template};webix.SingleRender=webix.proto({template_setter:function(value){this.type.template=webix.template(value)},_toHTML:function(obj){var type=this.type;return(type.templateStart?type.templateStart(obj,type):"")+type.template(obj,type)+(type.templateEnd?type.templateEnd(obj,type):"")},customize:function(obj){webix.type(this,obj)}},webix.AtomRender);webix.UIManager={_view:null,_hotkeys:{},_focus_time:0,_controls:{enter:13,tab:9,esc:27,escape:27,up:38,down:40,left:37,right:39,pgdown:34,pagedown:34,pgup:33,pageup:33,end:35,home:36,insert:45,delete:46,backspace:8,space:32,meta:91,win:91,mac:91,multiply:106,add:107,subtract:109,decimal:110,divide:111,scrollock:145,pausebreak:19,numlock:144,"5numlocked":12,shift:16,capslock:20},_inputs:{input:1,button:1,textarea:1,select:1},_enable:function(){webix.event(document.body,"click",webix.bind(this._focus_click,this));webix.event(document,"keydown",webix.bind(this._keypress,this));if(document.body.addEventListener)webix.event(document.body,"focus",this._focus_tab,{capture:true,bind:this});webix.destructors.push({obj:this})},destructor:function(){webix.UIManager._view=null},getFocus:function(){return this._view},_focus_action:function(view){this._focus_was_there=this._focus_was_there||view._settings.id},setFocus:function(view,only_api){view=webix.$$(view);if(view&&!view.$view)view=null;this._focus_time=webix._focus_time=new Date;if(this._view===view)return true;if(this._view&&this._view.callEvent)this._view.callEvent("onBlur",[this._view]);if(view&&view.callEvent)view.callEvent("onFocus",[view,this._view]);webix.callEvent("onFocusChange",[view,this._view]);if(this._view&&this._view.blur&&!only_api)this._view.blur();this._view=view;if(view&&view.focus&&!only_api)view.focus();return true},applyChanges:function(element){var view=this.getFocus();if(view&&view!=element&&view._applyChanges)view._applyChanges(element)},hasFocus:function(view){return view===this._view?true:false},_focus:function(e,dont_clear){var view=webix.html.locate(e,"view_id")||this._focus_was_there;view=webix.$$(view);this._focus_was_there=null;webix._focus_time=new Date;if(view==this._view)return;if(!dont_clear)this._focus_was_there=null;if(view){view=webix.$$(view);if(this.canFocus(view)){if(view.getNode)view.getNode(e);this.setFocus(view)}}else if(!dont_clear)this.setFocus(null);return true},_focus_click:function(e){if(new Date-this._focus_time<100){this._focus_was_there=null;return false}return this._focus(e)},_focus_tab:function(e){if(!this._inputs[e.target.nodeName.toLowerCase()])return false;return this._focus(e,true)},canFocus:function(view){return view.isVisible()&&view.isEnabled()},_moveChildFocus:function(check_view){var focus=this.getFocus();if(check_view&&!this._is_child_of(check_view,focus))return false;if(!this._focus_logic("getPrev",check_view))this._view=null},_translation_table:{},_is_child_of:function(parent,child){if(!parent)return false;if(!child)return false;while(child){if(child===parent)return true;child=child.getParentView()}return false},_keypress_timed:function(){if(this&&this.callEvent)this.callEvent("onTimedKeyPress",[])},_isNumPad:function(code){return code<112&&code>105},_keypress:function(e){var code=e.which||e.keyCode;if(code>95&&code<106)code-=48;code=this._translation_table[code]||code;var ctrl=e.ctrlKey;var shift=e.shiftKey;var alt=e.altKey;var meta=e.metaKey;var codeid=this._keycode(code,ctrl,shift,alt,meta);var view=this.getFocus();if(view&&view.callEvent){if(view.callEvent("onKeyPress",[code,e])===false)webix.html.preventEvent(e);if(view.hasEvent("onTimedKeyPress")){clearTimeout(view._key_press_timeout);view._key_press_timeout=webix.delay(this._keypress_timed,view,[],view._settings.keyPressTimeout||250)}}if(!this._isNumPad(code))codeid=this._keycode(String.fromCharCode(code),ctrl,shift,alt,meta);var is_any=!ctrl&&!alt&&!meta&&code!=9&&code!=27&&code!=13;if(this._check_keycode(codeid,is_any,e)===false){webix.html.preventEvent(e);return false}},_focus_logic:function(dir){if(!this.getFocus())return null;dir=dir||"getNext";var next=this.getFocus();var start=next;var marker=webix.uid();while(true){next=this[dir](next);if(next&&this.canFocus(next))return this.setFocus(next);if(next===start||next.$fmarker==marker)return null;next.$fmarker=marker}},_tab_logic:function(view,e){var mode=!e.shiftKey;webix.UIManager._tab_time=new Date;if(view&&view._custom_tab_handler&&!view._custom_tab_handler(mode,e))return false;if(view&&view._in_edit_mode){if(view.editNext)return view.editNext(mode);else if(view.editStop){view.editStop();return true}}else webix.delay(function(){webix.UIManager.setFocus(webix.$$(document.activeElement),true)},1)},getTop:function(id){var next,view=webix.$$(id);while(view&&(next=view.getParentView()))view=next;return view},getNext:function(view,_inner_call){var cells=view.getChildViews();if(cells.length&&!_inner_call)return cells[0];var parent=view.getParentView();if(!parent)return view;var p_cells=parent.getChildViews();if(p_cells.length){var index=webix.PowerArray.find.call(p_cells,view)+1;while(index<p_cells.length){if(this.canFocus(p_cells[index]))return p_cells[index];index++}}return this.getNext(parent,true)},getPrev:function(view,_inner_call){var cells=view.getChildViews();if(cells.length&&_inner_call)return this.getPrev(cells[cells.length-1],true);if(_inner_call)return view;var parent=view.getParentView();if(!parent)return this.getPrev(view,true);var p_cells=parent.getChildViews();if(p_cells){var index=webix.PowerArray.find.call(p_cells,view)-1;while(index>=0){if(this.canFocus(p_cells[index]))return this.getPrev(p_cells[index],true);index--}}return parent},addHotKey:function(keys,handler,view){webix.assert(handler,"Hot key handler is not defined");var pack=this._parse_keys(keys);webix.assert(pack.letter,"Unknown key code");if(!view)view=null;pack.handler=handler;pack.view=view;var code=this._keycode(pack.letter,pack.ctrl,pack.shift,pack.alt,pack.meta);if(!this._hotkeys[code])this._hotkeys[code]=[];this._hotkeys[code].push(pack);return keys},removeHotKey:function(keys,func,view){var pack=this._parse_keys(keys);var code=this._keycode(pack.letter,pack.ctrl,pack.shift,pack.alt,pack.meta);if(!func&&!view)delete this._hotkeys[code];else{var t=this._hotkeys[code];if(t){for(var i=t.length-1;i>=0;i--){if(view&&t[i].view!==view)continue;if(func&&t[i].handler!==func)continue;t.splice(i,1)}if(!t.length)delete this._hotkeys[code]}}},_keycode:function(code,ctrl,shift,alt,meta){return code+"_"+["",ctrl?"1":"0",shift?"1":"0",alt?"1":"0",meta?"1":"0"].join("")},_check_keycode:function(code,is_any,e){var focus=this.getFocus();if(this._hotkeys[code])return this._process_calls(this._hotkeys[code],focus,e);else if(is_any&&this._hotkeys["ANY_0000"])return this._process_calls(this._hotkeys["ANY_0000"],focus,e);return true},_process_calls:function(calls,focus,e){for(var i=0;i<calls.length;i++){var key=calls[i];var call=false;if(key.view!==null&&focus!==key.view&&(typeof key.view!=="string"||!focus||focus.name!==key.view))continue;var temp_result=key.handler(focus,e);if(!!temp_result===temp_result)return temp_result}return true},_parse_keys:function(keys){var controls=this._controls;var parts=keys.toLowerCase().split(/[\+\-_]/);var ctrl,shift,alt,meta;ctrl=shift=alt=meta=0;var letter="";for(var i=0;i<parts.length;i++){if(parts[i]==="ctrl")ctrl=1;else if(parts[i]==="shift")shift=1;else if(parts[i]==="alt")alt=1;else if(parts[i]==="command")meta=1;else{if(controls[parts[i]]){var code=controls[parts[i]];if(this._isNumPad(code))letter=code.toString();else letter=String.fromCharCode(code)}else{letter=parts[i]}}}return{letter:letter.toUpperCase(),ctrl:ctrl,shift:shift,alt:alt,meta:meta,debug:keys}}};webix.ready(function(){webix.UIManager._enable();webix.UIManager.addHotKey("enter",function(view,ev){if(view&&view.editStop&&view._in_edit_mode){view.editStop();return true}else if(view&&view.touchable){var form=view.getFormView();if(form&&!view._skipSubmit)form.callEvent("onSubmit",[view,ev])}});webix.UIManager.addHotKey("esc",function(view){if(view){if(view.editCancel&&view._in_edit_mode){view.editCancel();return true}var top=view.getTopParentView();if(top&&top.setPosition)top._hide()}});webix.UIManager.addHotKey("shift+tab",webix.UIManager._tab_logic);webix.UIManager.addHotKey("tab",webix.UIManager._tab_logic)});webix.IdSpace={$init:function(){this._elements={};this._translate_ids={};this.getTopParentView=this._get_self=webix.bind(function(){return this},this);this._run_inner_init_logic();this.$ready.push(this._run_after_inner_init_logic)},$$:function(id){return this._elements[id]},innerId:function(id){return this._translate_ids[id]},_run_inner_init_logic:function(callback){this._prev_global_col=webix._global_collection;webix._global_collection=this},_run_after_inner_init_logic:function(temp){for(var name in this._elements){var input=this._elements[name];if(this.callEvent&&input.mapEvent&&!input._evs_map.onitemclick)input.mapEvent({onitemclick:this});input.getTopParentView=this._get_self}webix._global_collection=this._prev_global_col;this._prev_global_col=0},_destroy_child:function(id){delete this._elements[id]},ui:function(){this._run_inner_init_logic();var temp=webix.ui.apply(webix,arguments);this._run_after_inner_init_logic();return temp}};(function(){var resize=[];var ui=webix.ui;if(!webix.ui){ui=webix.ui=function(config,parent,id){webix._ui_creation=true;var multiset=webix.isArray(config);var node=webix.toNode(config.container||parent||document.body);if(node._settings)id=_correctId(node,multiset,id);var top_node;var body_child=node==document.body;if(config._settings||node&&multiset){top_node=config}else{if(node&&body_child)config.$topView=true;if(!config._inner)config._inner={};top_node=ui._view(config)}if(body_child&&!top_node.setPosition&&!top_node.$apiOnly)webix.ui._fixHeight();if(top_node._settings&&top_node._settings._hidden&&!node.$view){top_node._settings._container=node}else if(!top_node.$apiOnly){if(node.appendChild)_appendDom(node,top_node,config);else if(node.destructor){var target=node;if(!id&&id!==0&&!webix.isArray(top_node)){id=node;node=node.getParentView()}if(node&&node._replace){if(top_node.getParentView&&top_node.getParentView())top_node.getParentView()._remove(top_node);node._replace(top_node,id)}else{var parent=target.$view.parentNode;target.destructor();_appendDom(parent,top_node,config)}}else webix.assert_error("Not existing parent:"+config.container)}webix._ui_creation=false;return top_node};var _appendDom=function(node,top_node,config){node.appendChild(top_node._viewobj);if((!top_node.setPosition||top_node._settings.fullscreen)&&node==document.body||top_node._settings.position)resize.push(top_node._destructor_handler);if(!config.skipResize)top_node.adjust()};var _correctId=function(target,multiset,id){var views=[target];if(multiset)views=target.getChildViews();else if(target._body_cell)views=[target._body_cell];else if(typeof id=="number"){return id}else if(id){views=[webix.$$(id)];_deleteIds(views);return views[0].config.id}_deleteIds(views);return id};var _deleteIds=function(views){for(var i=views.length-1;i>=0;i--){delete webix.ui.views[views[i].config.id];views[i].config.id="x"+webix.uid();webix.ui.views[views[i].config.id]=views[i];_deleteIds(views[i].getChildViews())}}}webix.ui.animate=function(ui,parent,config){var pobj=webix.$$(parent);if(pobj){var aniset=config||{type:"slide",direction:"left"};var d=pobj._viewobj.cloneNode(true);var view=webix.ui(ui,parent);view._viewobj.parentNode.appendChild(d);var line=webix.animate.formLine(view._viewobj,d,aniset);aniset.callback=function(){webix.animate.breakLine(line)};webix.animate(line,aniset);return view}};webix.ui.animateView=function(view,stateHandler,config){view=webix.$$(view);if(view){config=config||{type:"slide",direction:"left"};var getHTML=function(view){var el=view._viewobj;var css=el.className;var content=el.innerHTML;return"<div class='"+css+"' style='width:"+el.offsetWidth+"px;height:"+el.offsetHeight+"px;'>"+content+"</div>"};var display=[];for(var i=0;i<view._viewobj.childNodes.length;i++){var node=view._viewobj.childNodes[i];var value=node.currentStyle?node.currentStyle.display:getComputedStyle(node,null).display;display.push(value||"")}var currentState=getHTML(view);if(typeof stateHandler=="function"){stateHandler.call(this)}var newState=getHTML(view);var tempParent=view._viewobj.insertBefore(webix.html.create("DIV",{class:"webix_view_animate",style:"width:"+view._viewobj.offsetWidth+"px;height:"+view._viewobj.offsetHeight+"px;"},newState+currentState),view._viewobj.firstChild);for(var i=1;i<view._viewobj.childNodes.length;i++){view._viewobj.childNodes[i].style.display="none"}var line=webix.animate.formLine(tempParent.childNodes[0],tempParent.childNodes[1],config);config.callback=function(){if(tempParent){view._viewobj.removeChild(tempParent);tempParent=null;for(var i=0;i<view._viewobj.childNodes.length;i++){view._viewobj.childNodes[i].style.display=display[i]}}};webix.animate(line,config);return view}};webix.ui._detectScrollSize=function(){var div=webix.html.create("div");div.className="webix_skin_mark";div.style.cssText="position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;min-height:100px;overflow-y:scroll;";document.body.appendChild(div);var width=div.offsetWidth-div.clientWidth;var skin={110:"air",120:"aircompact",130:"clouds",140:"web",150:"terrace",160:"metro",170:"light",180:"glamour",190:"touch",200:"flat",210:"compact",220:"material",230:"contrast"}[Math.floor(div.offsetHeight/10)*10];document.body.removeChild(div);if(skin){var skinobj=webix.skin[skin];if(skinobj&&skinobj!=webix.skin.$active)webix.skin.set(skin)}if(webix.env.$customScroll)return 0;return width};webix.ui.scrollSize=webix.env.touch||webix.env.$customScroll?0:17;webix.ready(function(){var size=webix.ui._detectScrollSize();webix.ui.scrollSize=webix.env.touch?0:size});webix.ui._uid=function(name){return"$"+name+(this._namecount[name]=(this._namecount[name]||0)+1)};webix.ui._namecount={};webix.ui._fixHeight=function(){webix.html.addStyle("html, body{ height:100%; }");document.body.className+=" webix_full_screen";webix.ui._fixHeight=function(){};webix.Touch.limit(false)};webix.ui.resize=function(){webix.UIManager.applyChanges();webix.callEvent("onClick",[]);if(!webix.ui.$freeze)for(var i=resize.length-1;i>=0;i--){if(resize[i].obj)resize[i].obj.adjust()}};webix.ui.each=function(parent,logic,master,include){if(parent){var children=include?[parent]:parent.getChildViews();for(var i=0;i<children.length;i++){if(logic.call(master||webix,children[i])!==false)webix.ui.each(children[i],logic,master)}}};webix.event(window,"resize",function(){if(webix.env.touch&&(webix.edit_open_time&&new Date-webix.edit_open_time<750||webix._focus_time&&new Date-webix._focus_time<750)){if(webix.env.isWebKit&&document.activeElement){var wactiv=webix.$$(document.activeElement);if(wactiv&&wactiv.getInputNode&&document.activeElement.scrollIntoView)document.activeElement.scrollIntoView()}return}else{webix.ui.resize()}});ui._delays={};ui.delay=function(config){webix.ui._delays[config.id]=config};ui.hasMethod=function(view,method){var obj=webix.ui[view];if(!obj)return false;if(obj.$protoWait)obj=obj.call(webix);return!!webix.ui[view].prototype[method]};webix.ui.zIndex=function(){return webix.ui.zIndexBase++};webix.ui.zIndexBase=100;ui._view=function(config){webix.assert_config(config);if(config.view){var view=config.view;webix.assert(ui[view],"unknown view:"+view);return new ui[view](config)}else if(config.rows||config.cols){var cells=config.rows||config.cols;var accordion=false;for(var i=0;i<cells.length;i++){if(cells[i].body&&!cells[i].view&&!cells[i].align)accordion=true}if(accordion){return new ui.headerlayout(config)}else return new ui.layout(config)}else if(config.cells)return new ui.multiview(config);else if(config.template||config.content)return new ui.template(config);else if(config.align&&config.body){return new ui.align(config)}else return new ui.spacer(config)};ui.views={};webix.$$=function(id){if(!id)return null;if(ui.views[id])return ui.views[id];if(ui._delays[id])return webix.ui(ui._delays[id]);var name=id;if(typeof id=="object"){if(id._settings)return id;name=id.target||id.srcElement||id}return ui.views[webix.html.locate({target:webix.toNode(name)},"view_id")]};if(webix.isUndefined(window.$$))window.$$=webix.$$;webix.UIExtension=window.webix_view||{};webix.protoUI({name:"baseview",$init:function(config){if(!config.id)config.id=webix.ui._uid(this.name);this._parent_cell=webix._parent_cell;webix._parent_cell=null;this.$scope=config.$scope||(this._parent_cell?this._parent_cell.$scope:null);if(!this._viewobj){this._contentobj=this._viewobj=webix.html.create("DIV",{class:"webix_view"});this.$view=this._viewobj}},$skin:false,defaults:{width:0,height:0,gravity:1},getNode:function(){return this._viewobj},getParentView:function(){return this._parent_cell||null},getTopParentView:function(){var parent=this.getParentView();return parent?parent.getTopParentView():this},getFormView:function(){var parent=this.getParentView();return!parent||parent.setValues?parent:parent.getFormView()},getChildViews:function(){return[]},isVisible:function(base_id,prev_id){if(this._settings.hidden){if(base_id){if(!this._hidden_render){this._hidden_render=[];this._hidden_hash={}}if(!this._hidden_hash[base_id]){this._hidden_hash[base_id]=true;this._hidden_render.push(base_id)}}return false}var parent=this.getParentView();if(parent)return parent.isVisible(base_id,this._settings.id);return true},isEnabled:function(){if(this._disable_cover)return false;var parent=this.getParentView();if(parent)return parent.isEnabled();return true},disable:function(){webix.html.remove(this._disable_cover);this._settings.disabled=true;this._disable_cover=webix.html.create("div",{class:"webix_disabled"});if(window.getComputedStyle)this._disabled_view_pos=window.getComputedStyle(this._viewobj,null).getPropertyValue("position");if(this._disabled_view_pos!="absolute")this._viewobj.style.position="relative";this._viewobj.appendChild(this._disable_cover);this._viewobj.setAttribute("aria-disabled","true");webix.html.addCss(this._viewobj,"webix_disabled_view",true);webix.UIManager._moveChildFocus(this)},enable:function(){this._settings.disabled=false;if(this._disable_cover){webix.html.remove(this._disable_cover);webix.html.removeCss(this._viewobj,"webix_disabled_view");this._viewobj.removeAttribute("aria-disabled");this._disable_cover=null;if(this._disabled_view_pos)this._viewobj.style.position=this._disabled_view_pos}},disabled_setter:function(value){if(value)this.disable();else this.enable();return value},container_setter:function(value){webix.assert(webix.toNode(value),"Invalid container");return true},css_setter:function(value){if(typeof value=="object")value=webix.html.createCss(value);this._viewobj.className+=" "+value;return value},id_setter:function(value){if(webix._global_collection&&(webix._global_collection!=this||this._prev_global_col)){var oldvalue=this.config.$id=value;(this._prev_global_col||webix._global_collection)._elements[value]=this;value=webix.ui._uid(this.name);(this._prev_global_col||webix._global_collection)._translate_ids[value]=oldvalue}webix.assert(!webix.ui.views[value],"Non unique view id: "+value);webix.ui.views[value]=this;this._viewobj.setAttribute("view_id",value);return value},$setSize:function(x,y){var last=this._last_size;if(last&&last[0]==x&&last[1]==y){webix.debug_size_box(this,[x,y,"not changed"]);return false}webix.debug_size_box(this,[x,y]);this._last_size=[x,y];this.$width=this._content_width=x-(this._scroll_y?webix.ui.scrollSize:0);this.$height=this._content_height=y-(this._scroll_x?webix.ui.scrollSize:0);var config=this._settings;if(!config.flex){this._viewobj.style.width=x+"px";this._viewobj.style.height=y+"px"}return true},$getSize:function(dx,dy){var s=this._settings;var size=[(s.width||s.minWidth||0)*1,(s.width||s.maxWidth||1e5)*1,(s.height||s.minHeight||0)*1,(s.height||s.maxHeight||1e5)*1,s.gravity];if(webix.assert){var check=isNaN(size[0])||isNaN(size[1])||isNaN(size[2])||isNaN(size[3]);if(check){webix.assert(false,"Size is not a number "+this._settings.id);s.width=s.height=s.maxWidth=s.maxHeight=s.minWidth=s.minHeight=0;size=[0,0,1e5,1e5,1]}}size[0]+=dx;size[1]+=dx;size[2]+=dy;size[3]+=dy;return size},show:function(force,animate_settings){var parent=this.getParentView();var show=!arguments[2];if(parent){if(!animate_settings&&animate_settings!==false&&this._settings.animate)if(parent._settings.animate)animate_settings=webix.extend(parent._settings.animate?webix.extend({},parent._settings.animate):{},this._settings.animate,true);if(show?parent._show:parent._hide)(show?parent._show:parent._hide).call(parent,this,animate_settings);if(show)this._render_hidden_views();if(force&&show)parent.show(parent.$$?false:force)}else{if(this._settings.hidden){if(show){var node=webix.toNode(this._settings._container||document.body);node.appendChild(this._viewobj);this._settings.hidden=false;this.adjust();this._render_hidden_views()}}else{if(!show){this._settings.hidden=this._settings._hidden=true;if(this._viewobj){this._settings._container=this._viewobj.parentNode;webix.html.remove(this._viewobj)}}}}},_render_hidden_views:function(){if(this._hidden_render){for(var i=0;i<this._hidden_render.length;i++){var ui_to_render=webix.$$(this._hidden_render[i]);if(ui_to_render)ui_to_render.render()}this._hidden_render=[];this._hidden_hash={}}},_onKeyPress:function(code,e){var target=e.srcElement||e.target,role=target.getAttribute("role");if((code===13||code===32)&&role=="button"&&!this._settings.disabled){webix.html.triggerEvent(target,"MouseEvents","click");webix.html.preventEvent(e)}},hidden_setter:function(value){if(value)this.hide();return this._settings.hidden},hide:function(){this.show(null,null,true);webix.UIManager._moveChildFocus(this)},adjust:function(){if(!this._viewobj.parentNode)return false;var x=this._viewobj.parentNode.clientWidth||0;var y=this._viewobj.parentNode.clientHeight||0;var sizes=this.$getSize(0,0);var fullscreen=this._viewobj.parentNode==document.body&&!this.setPosition;if(sizes[0]>x)x=sizes[0];if(sizes[2]>y)y=sizes[2];if((!fullscreen||this._settings.width)&&x>sizes[1])x=sizes[1];if((!fullscreen||this._settings.height)&&y>sizes[3])y=sizes[3];this.$setSize(x,y);if(webix._responsive_exception){webix._responsive_exception=false;this.adjust()}},resize:function(force){if(webix._child_sizing_active||webix.ui.$freeze||webix._responsive_tinkery)return;var parent=this.getParentView();if(parent){if(parent.resizeChildren)parent.resizeChildren();else parent.resize()}else{this.adjust();webix.callEvent("onResize",[])}}},webix.Settings,webix.Destruction,webix.BaseBind,webix.UIExtension);webix.protoUI({name:"view",$init:function(config){this._set_inner(config)},_set_inner:function(config){var border_not_set=webix.isUndefined(config.borderless);if(border_not_set&&!this.setPosition&&config.$topView){config.borderless=true;border_not_set=false}if(border_not_set&&this.defaults.borderless||config.borderless){config._inner={top:true,left:true,bottom:true,right:true}}else{if(!config._inner)config._inner={};this._contentobj.style.borderWidth="1px"}},$getSize:function(dx,dy){var _borders=this._settings._inner;if(_borders){dx+=(_borders.left?0:1)+(_borders.right?0:1);dy+=(_borders.top?0:1)+(_borders.bottom?0:1)}var size=webix.ui.baseview.prototype.$getSize.call(this,dx,dy);webix.debug_size_box(this,size,true);return size},$setSize:function(x,y){webix.debug_size_box(this,[x,y]);var _borders=this._settings._inner;if(_borders){x-=(_borders.left?0:1)+(_borders.right?0:1);y-=(_borders.top?0:1)+(_borders.bottom?0:1)}return webix.ui.baseview.prototype.$setSize.call(this,x,y)}},webix.ui.baseview)})();webix.ui.view.call(webix);webix.debug_size_indent=0;webix.debug_size_step=function(){var str="";for(var i=0;i<webix.debug_size_indent;i++)str+="|  ";return str};webix.debug_size_box_start=function(comp,get){if(!webix.debug_size)return;if(!webix.debug_size_indent)webix.log(get?"--- get sizes ---":"--- set sizes ---");webix.log(webix.debug_size_step()+comp.name+"@"+comp.config.id);webix.debug_size_indent++};webix.debug_size_box_end=function(comp,sizes){if(!webix.debug_size)return;webix.debug_size_indent--;webix.log(webix.debug_size_step()+sizes.join(","))};webix.debug_size_box=function(comp,sizes,get){if(!webix.debug_size)return;if(!webix.debug_size_indent)webix.log(get?"--- get sizes ---":"--- set sizes ---");webix.log(webix.debug_size_step()+comp.name+"@"+comp.config.id+" "+sizes.join(","))};webix.protoUI({name:"spacer",defaults:{borderless:true},$init:function(){this._viewobj.className+=" webix_spacer"}},webix.ui.view);webix.protoUI({name:"baselayout",$init:function(config){this.$ready.push(this._parse_cells);this._dataobj=this._contentobj;this._layout_sizes=[];this._responsive=[];if(config.$topView){config.borderless=true;config._inner={top:true,left:true,bottom:true,right:true}}if(config.isolate)webix.extend(this,webix.IdSpace)},rows_setter:function(value){this._vertical_orientation=1;this._collection=value},cols_setter:function(value){this._vertical_orientation=0;this.$view.style.whiteSpace="nowrap";this._collection=value},_remove:function(view){webix.PowerArray.removeAt.call(this._cells,webix.PowerArray.find.call(this._cells,view));this.resizeChildren(true)},_replace:function(new_view,target_id){if(webix.isUndefined(target_id)){for(var i=0;i<this._cells.length;i++)this._cells[i].destructor();this._collection=new_view;this._parse_cells()}else{var source;if(typeof target_id=="number"){if(target_id<0||target_id>this._cells.length)target_id=this._cells.length;var prev_node=(this._cells[target_id]||{})._viewobj;webix.PowerArray.insertAt.call(this._cells,new_view,target_id);if(!new_view._settings.hidden)webix.html.insertBefore(new_view._viewobj,prev_node,this._dataobj)}else{source=webix.$$(target_id);target_id=webix.PowerArray.find.call(this._cells,source);webix.assert(target_id!=-1,"Attempt to replace the non-existing view");var parent=source._viewobj.parentNode;if(parent&&!new_view._settings.hidden)parent.insertBefore(new_view._viewobj,source._viewobj);source.destructor();this._cells[target_id]=new_view}if(!this._vertical_orientation)this._fix_vertical_layout(new_view);this._cells[target_id]._parent_cell=this}this.resizeChildren(true);var form=this.elements?this:this.getFormView();if(form)form._recollect_elements();webix.callEvent("onReconstruct",[this])},_fix_vertical_layout:function(cell){cell._viewobj.style.display="inline-block";cell._viewobj.style.verticalAlign="top"},addView:function(view,index){if(webix.isUndefined(index))index=this._cells.length;var top=this.$$?this:this.getTopParentView();top=top&&top.ui?top:webix;return top.ui(view,this,index)._settings.id},removeView:function(id){var view;if(typeof id!="object")view=webix.$$(id)||(this.$$?this.$$(id):null);else view=id;var target=webix.PowerArray.find.call(this._cells,view);if(target>=0){if(this._beforeRemoveView)this._beforeRemoveView(target,view);var form=this.elements?this:this.getFormView();this._cells.splice(target,1);if(form)webix.ui.each(view,function(sub){if(sub.name)delete form.getCleanValues()[sub.config.name]},form,true);view.destructor();this.resizeChildren(true);if(form)form._recollect_elements()}else webix.assert(false,"Attemp to remove not existing view: "+id);webix.callEvent("onReconstruct",[this])},reconstruct:function(){this._hiddencells=0;this._replace(this._collection)},_hide:function(obj,settings,silent){if(obj._settings.hidden)return;obj._settings.hidden=true;webix.html.remove(obj._viewobj);this._hiddencells++;if(!silent&&!webix._ui_creation)this.resizeChildren(true)},_signal_hidden_cells:function(view){if(view.callEvent)view.callEvent("onViewShow",[])},resizeChildren:function(){if(webix.ui.$freeze)return;if(this._layout_sizes){var parent=this.getParentView();if(parent){if(parent.resizeChildren)return parent.resizeChildren();else return parent.resize()}var sizes=this.$getSize(0,0);var x,y,nx,ny;nx=x=this._layout_sizes[0]||0;ny=y=this._layout_sizes[1]||0;if((sizes[1]>=1e5||sizes[3]>=1e5)&&this._viewobj.parentNode){nx=x=Math.max(sizes[0],this._settings.width||this._viewobj.parentNode.offsetWidth||x||0);ny=y=Math.max(sizes[2],this._settings.height||this._viewobj.parentNode.offsetHeight||y||0)}if(!parent){if(sizes[0]>x)nx=sizes[0];if(sizes[2]>y)ny=sizes[2];if(x>sizes[1])nx=sizes[1];if(y>sizes[3])ny=sizes[3];this.$setSize(nx,ny)}else this._set_child_size(x,y);if(webix._responsive_exception){webix._responsive_exception=false;this.resizeChildren()}webix.callEvent("onResize",[])}},getChildViews:function(){return this._cells},index:function(obj){if(obj._settings)obj=obj._settings.id;for(var i=0;i<this._cells.length;i++)if(this._cells[i]._settings.id==obj)return i;return-1},_show:function(obj,settings,silent){if(!obj._settings.hidden)return;obj._settings.hidden=false;var index=this.index(obj)+1;while(this._cells[index]&&this._cells[index]._settings.hidden)index++;var view=this._cells[index]?this._cells[index]._viewobj:null;webix.html.insertBefore(obj._viewobj,view,this._dataobj||this._viewobj);this._hiddencells--;if(!silent){this.resizeChildren(true);if(obj.refresh)obj.refresh()}if(obj.callEvent){obj.callEvent("onViewShow",[]);webix.ui.each(obj,this._signal_hidden_cells)}},showBatch:function(name,mode){var preserve=typeof mode!="undefined";mode=mode!==false;if(!preserve){if(this._settings.visibleBatch==name)return;this._settings.visibleBatch=name}else this._settings.visibleBatch="";var show=[];for(var i=0;i<this._cells.length;i++){if(!this._cells[i]._settings.batch)show.push(this._cells[i]);else if(this._cells[i]._settings.batch==name){if(mode)show.push(this._cells[i]);else this._hide(this._cells[i],null,true)}else if(!preserve)this._hide(this._cells[i],null,true)}for(var i=0;i<show.length;i++){this._show(show[i],null,true);show[i]._render_hidden_views()}this.resizeChildren(true)},_parse_cells:function(collection){this._cells=[];webix.assert(collection,this.name+" was incorrectly defined. <br><br> You have missed rows|cols|cells|elements collection");for(var i=0;i<collection.length;i++){webix._parent_cell=this;if(!collection[i]._inner)collection[i].borderless=true;this._cells[i]=webix.ui._view(collection[i],this);if(!this._vertical_orientation)this._fix_vertical_layout(this._cells[i]);if(this._settings.visibleBatch&&this._settings.visibleBatch!=this._cells[i]._settings.batch&&this._cells[i]._settings.batch){this._cells[i]._settings.hidden=true;this._hiddencells++}if(!this._cells[i]._settings.hidden){(this._dataobj||this._contentobj).appendChild(this._cells[i]._viewobj);if(this._cells[i].$nospace)this._hiddencells++}}if(this._parse_cells_ext_end)this._parse_cells_ext_end(collection)},_bubble_size:function(prop,size,vertical){if(this._vertical_orientation!=vertical)for(var i=0;i<this._cells.length;i++){this._cells[i]._settings[prop]=size;if(this._cells[i]._bubble_size)this._cells[i]._bubble_size(prop,size,vertical)}},$getSize:function(dx,dy){webix.debug_size_box_start(this,true);var minWidth=0;var maxWidth=1e5;var maxHeight=1e5;var minHeight=0;if(this._vertical_orientation)maxHeight=0;else maxWidth=0;var fixed=0;var fixed_count=0;var gravity=0;this._sizes=[];for(var i=0;i<this._cells.length;i++){if(this._cells[i]._settings.hidden)continue;var sizes=this._sizes[i]=this._cells[i].$getSize(0,0);if(this._cells[i].$nospace){fixed_count++;continue}if(this._vertical_orientation){if(sizes[0]>minWidth)minWidth=sizes[0];if(sizes[1]<maxWidth)maxWidth=sizes[1];minHeight+=sizes[2];maxHeight+=sizes[3];if(sizes[2]==sizes[3]&&sizes[2]!=-1){fixed+=sizes[2];fixed_count++}else gravity+=sizes[4]}else{if(sizes[2]>minHeight)minHeight=sizes[2];if(sizes[3]<maxHeight)maxHeight=sizes[3];minWidth+=sizes[0];maxWidth+=sizes[1];if(sizes[0]==sizes[1]&&sizes[0]!=-1){fixed+=sizes[0];fixed_count++}else gravity+=sizes[4]}}if(minHeight>maxHeight)maxHeight=minHeight;if(minWidth>maxWidth)maxWidth=minWidth;this._master_size=[fixed,this._cells.length-fixed_count,gravity];this._desired_size=[minWidth+dx,minHeight+dy];var self_size=webix.ui.baseview.prototype.$getSize.call(this,0,0);if(self_size[1]>=1e5)self_size[1]=0;if(self_size[3]>=1e5)self_size[3]=0;self_size[0]=(self_size[0]||minWidth)+dx;self_size[1]=Math.max(self_size[0],(self_size[1]||maxWidth)+dx);self_size[2]=(self_size[2]||minHeight)+dy;self_size[3]=Math.max(self_size[2],(self_size[3]||maxHeight)+dy);webix.debug_size_box_end(this,self_size);if(!this._vertical_orientation&&this._settings.responsive)self_size[0]=0;return self_size},$setSize:function(x,y){this._layout_sizes=[x,y];webix.debug_size_box_start(this);webix.ui.baseview.prototype.$setSize.call(this,x,y);this._set_child_size(x,y);webix.debug_size_box_end(this,[x,y])},_set_child_size_a:function(sizes,min,max){min=sizes[min];max=sizes[max];var height=min;if(min!=max){var ps=this._set_size_delta*sizes[4]/this._set_size_gravity;if(ps<min){height=min;this._set_size_gravity-=sizes[4];this._set_size_delta-=height}else if(ps>max){height=max;this._set_size_gravity-=sizes[4];this._set_size_delta-=height}else{return-1}}return height},_responsive_hide:function(cell,mode){var target=webix.$$(mode);if(target==="hide"||!target){cell.hide();cell._responsive_marker="hide"}else{if(!target)target=webix.ui({view:"popup",body:[{}]});cell._responsive_width=cell._settings.width;cell._responsive_height=cell._settings.height;cell._responsive_marker=target._settings.id;cell._settings.width=0;if(!cell._settings.height)cell._settings.autoheight=true;webix.ui(cell,target,this._responsive.length)}this._responsive.push(cell)},_responsive_show:function(cell){var target=cell._responsive_marker;cell._responsive_marker=0;if(target==="hide"||!target){cell.show()}else{cell._settings.width=cell._responsive_width;cell._settings.height=cell._responsive_height;delete cell._settings.autoheight;var index=0;while(this._cells[index]&&this._cells[index]._settings.responsiveCell===false)index++;webix.ui(cell,this,index)}this._responsive.pop()},_responsive_cells:function(x,y){webix._responsive_tinkery=true;if(x+this._paddingX*2+this._margin*(this._cells.length-1)<this._desired_size[0]){var max=this._cells.length-1;for(var i=0;i<max;i++){var cell=this._cells[i];if(!cell._responsive_marker){if(cell._settings.responsiveCell!==false){this._responsive_hide(cell,this._settings.responsive);webix.callEvent("onResponsiveHide",[cell._settings.id]);webix._responsive_exception=true;break}else{max=this._cells.length}}}}else if(this._responsive.length){var cell=this._responsive[this._responsive.length-1];var dx=cell._responsive_marker=="hide"?0:cell._responsive_width;var px=cell.$getSize(dx,0);if(px[0]+this._desired_size[0]+this._margin+20<=x){this._responsive_show(cell);webix.callEvent("onResponsiveShow",[cell._settings.id]);webix._responsive_exception=true}}webix._responsive_tinkery=false},_set_child_size:function(x,y){webix._child_sizing_active=(webix._child_sizing_active||0)+1;if(!this._vertical_orientation&&this._settings.responsive)this._responsive_cells(x,y);this._set_size_delta=(this._vertical_orientation?y:x)-this._master_size[0];this._set_size_gravity=this._master_size[2];var width=x;var height=y;var auto=[];for(var i=0;i<this._cells.length;i++){if(this._cells[i]._settings.hidden||!this._sizes[i])continue;var sizes=this._sizes[i];if(this._vertical_orientation){var height=this._set_child_size_a(sizes,2,3);if(height<0){auto.push(i);continue}}else{var width=this._set_child_size_a(sizes,0,1);if(width<0){auto.push(i);continue}}this._cells[i].$setSize(width,height)}for(var i=0;i<auto.length;i++){var index=auto[i];var sizes=this._sizes[index];var dx=Math.round(this._set_size_delta*sizes[4]/this._set_size_gravity);this._set_size_delta-=dx;this._set_size_gravity-=sizes[4];if(this._vertical_orientation)height=dx;else{width=dx}this._cells[index].$setSize(width,height)}webix._child_sizing_active-=1},_next:function(obj,mode){var index=this.index(obj);if(index==-1)return null;return this._cells[index+mode]},_first:function(){return this._cells[0]}},webix.EventSystem,webix.ui.baseview);webix.protoUI({name:"layout",$init:function(config){this._hiddencells=0},defaults:{type:"line"},_parse_cells:function(){if(this._parse_cells_ext)collection=this._parse_cells_ext(collection);if(!this._parse_once){this._viewobj.className+=" webix_layout_"+(this._settings.type||"");this._parse_once=1}if(this._settings.margin!==webix.undefined)this._margin=this._settings.margin;if(this._settings.padding!=webix.undefined)this._paddingX=this._paddingY=this._settings.padding;if(this._settings.paddingX!==webix.undefined)this._paddingX=this._settings.paddingX;if(this._settings.paddingY!==webix.undefined)this._paddingY=this._settings.paddingY;if(this._paddingY||this._paddingX)this._padding=true;if(this._hasBorders()&&!this._settings.borderless){this._contentobj.style.borderWidth="1px";this._render_borders=true}var collection=this._collection;if(this._settings.borderless)this._settings._inner={top:true,left:true,right:true,bottom:true};this._beforeResetBorders(collection);webix.ui.baselayout.prototype._parse_cells.call(this,collection);this._afterResetBorders(collection)},$getSize:function(dx,dy){dx=dx||0;dy=dy||0;var correction=this._margin*(this._cells.length-this._hiddencells-1);if(this._render_borders||this._hasBorders()){var _borders=this._settings._inner;if(_borders){dx+=(_borders.left?0:1)+(_borders.right?0:1);dy+=(_borders.top?0:1)+(_borders.bottom?0:1)}}if(!this._settings.height)dy+=(this._paddingY||0)*2+(this._vertical_orientation?correction:0);if(!this._settings.width)dx+=(this._paddingX||0)*2+(this._vertical_orientation?0:correction);return webix.ui.baselayout.prototype.$getSize.call(this,dx,dy)},$setSize:function(x,y){this._layout_sizes=[x,y];webix.debug_size_box_start(this);var result;if(this._hasBorders()||this._render_borders)result=webix.ui.view.prototype.$setSize.call(this,x,y);else result=webix.ui.baseview.prototype.$setSize.call(this,x,y);y=this._content_height;x=this._content_width;var config=this._settings;if(config.scroll){y=Math.max(y,this._desired_size[1]);x=Math.max(x,this._desired_size[0])}this._set_child_size(x,y);webix.debug_size_box_end(this,[x,y])},_set_child_size:function(x,y){var correction=this._margin*(this._cells.length-this._hiddencells-1);if(this._vertical_orientation){y-=correction+this._paddingY*2;x-=this._paddingX*2}else{x-=correction+this._paddingX*2;y-=this._paddingY*2}return webix.ui.baselayout.prototype._set_child_size.call(this,x,y)},resizeChildren:function(structure_changed){if(structure_changed){this._last_size=null;var config=[];for(var i=0;i<this._cells.length;i++){var cell=this._cells[i];config[i]=cell._settings;var n=cell._layout_sizes&&!cell._render_borders||cell._settings.borderless?"0px":"1px";cell._viewobj.style.borderTopWidth=cell._viewobj.style.borderBottomWidth=cell._viewobj.style.borderLeftWidth=cell._viewobj.style.borderRightWidth=n}this._beforeResetBorders(config);for(var i=0;i<config.length;i++)if(config[i].borderless&&this._cells[i]._set_inner)this._cells[i]._set_inner(config[i]);this._afterResetBorders(this._cells)}if(webix._responsive_tinkery)return;webix.ui.baselayout.prototype.resizeChildren.call(this)},_hasBorders:function(){return this._padding&&this._margin>0&&!this._cleanlayout},_beforeResetBorders:function(collection){if(this._hasBorders()&&(!this._settings.borderless||this._settings.type=="space")){for(var i=0;i<collection.length;i++){if(!collection[i]._inner||!collection[i].borderless)collection[i]._inner={top:false,left:false,right:false,bottom:false}}}else{for(var i=0;i<collection.length;i++)collection[i]._inner=webix.clone(this._settings._inner);var mode=false;if(this._cleanlayout)mode=true;var maxlength=collection.length;if(this._vertical_orientation){for(var i=1;i<maxlength-1;i++)collection[i]._inner.top=collection[i]._inner.bottom=mode;if(maxlength>1){if(this._settings.type!="head")collection[0]._inner.bottom=mode;while(collection[maxlength-1].hidden&&maxlength>1)maxlength--;if(maxlength>0)collection[maxlength-1]._inner.top=mode}}else{for(var i=1;i<maxlength-1;i++)collection[i]._inner.left=collection[i]._inner.right=mode;if(maxlength>1){if(this._settings.type!="head")collection[0]._inner.right=mode;collection[maxlength-1]._inner.left=mode;while(maxlength>1&&collection[maxlength-1].hidden)maxlength--;if(maxlength>0)collection[maxlength-1]._inner.left=mode}}}},_fix_container_borders:function(style,inner){if(inner.top)style.borderTopWidth="0px";if(inner.left)style.borderLeftWidth="0px";if(inner.right)style.borderRightWidth="0px";if(inner.bottom)style.borderBottomWidth="0px"},_afterResetBorders:function(collection){var start=0;for(var i=0;i<collection.length;i++){var cell=this._cells[i];var s_inner=cell._settings._inner;if(cell._settings.hidden&&this._cells[i+1]){var s_next=this._cells[i+1]._settings._inner;if(!s_inner.top)s_next.top=false;if(!s_inner.left)s_next.left=false;if(i==start)start++}this._fix_container_borders(cell._viewobj.style,cell._settings._inner)}var style=this._vertical_orientation?"marginLeft":"marginTop";var contrstyle=this._vertical_orientation?"marginTop":"marginLeft";var padding=this._vertical_orientation?this._paddingX:this._paddingY;var contrpadding=this._vertical_orientation?this._paddingY:this._paddingX;for(var i=0;i<collection.length;i++)this._cells[i]._viewobj.style[style]=(padding||0)+"px";if(this._cells.length)this._cells[start]._viewobj.style[contrstyle]=(contrpadding||0)+"px";for(var index=start+1;index<collection.length;index++)this._cells[index]._viewobj.style[contrstyle]=this._margin+"px"},type_setter:function(value){this._margin=typeof this._margin_set[value]!="undefined"?this._margin_set[value]:this._margin_set["line"];this._paddingX=this._paddingY=typeof this._margin_set[value]!="undefined"?this._padding_set[value]:this._padding_set["line"];this._cleanlayout=value=="material"||value=="clean";if(value=="material")this._settings.borderless=true;return value},$skin:function(){var skin=webix.skin.$active;this._margin_set=skin.layoutMargin;this._padding_set=skin.layoutPadding}},webix.ui.baselayout);webix.ui.layout.call(webix);webix.FlexLayout={$init:function(){this.$view.className+=" webix_flexlayout"},_fix_vertical_layout:function(){},_beforeResetBorders:function(){},_afterResetBorders:function(){},$getSize:function(dx,dy){webix.debug_size_box_start(this,true);var w=0,h=0,g=this._settings.gravity;this._sizes=[];for(var i=0;i<this._cells.length;i++){var size=this._cells[i].$getSize(0,0);this._sizes.push(size);w=Math.max(w,size[0]);h=Math.max(h,size[2])}w+=(this._paddingX||0)*2;h+=(this._paddingY||0)*2;if(this._settings.width)w=Math.max(w,this._settings.width);if(this._settings.height)h=Math.max(h,this._settings.height);var self_size=[w,1e5,h,1e5,g];webix.debug_size_box_end(this,self_size);return self_size},_set_child_size:function(x,y){var st=this.$view.style;var margin=Math.round(this._margin/2);st.paddingTop=st.paddingBottom=this._paddingY-margin+"px";st.paddingLeft=st.paddingRight=this._paddingX-margin+"px";for(var i=0;i<this._cells.length;i++){if(this._cells[i]._settings.hidden)continue;var view=this._cells[i].$view;var size=this._sizes[i];var config=this._cells[i]._settings;if(view){view.style.minWidth=size[0]+"px";if(size[1]<1e5&&size[1]!=size[0])view.style.maxWidth=size[1]+"px";view.style.flexBasis=config.flexBasis||size[0]+"px";view.style.flexGrow=config.flexGrow||(size[1]!=size[0]?size[4]:0);view.style.height=size[3]!=size[2]?"auto":size[2]+"px";view.style.minHeight=size[2]+"px";if(size[3]<1e5&&size[3]!=size[2])view.style.maxHeight=size[3]+"px";view.style.margin=margin+"px"}}var whs=[];for(var i=0;i<this._cells.length;i++){if(this._cells[i]._settings.hidden)continue;var view=this._cells[i].$view;whs[i]=[view.offsetWidth,view.offsetHeight]}for(var i=0;i<this._cells.length;i++){if(this._cells[i]._settings.hidden)continue;var cell=this._cells[i];var view=cell.$view;if(view){cell._settings.flex=true;var size=this._sizes[i];var h=size[2]==size[3]?size[2]:whs[i][1];cell.$setSize(whs[i][0],h);cell._settings.flex=false}}this.$height=this._content_height=this.$view.scrollHeight;this.$view.style.height=this._content_height+"px"}};webix.protoUI({$init:function(){webix.extend(this,webix.FlexLayout,true)},name:"flexlayout"},webix.ui.layout);webix.protoUI({name:"align",defaults:{borderless:true,left:0,top:0,right:0,bottom:0},$init:function(){this._viewobj.className+=" webix_view_align"},body_setter:function(value){value._inner={top:false,left:false,right:false,bottom:false};this._body_cell=webix.ui._view(value);this._body_cell._parent_cell=this;this._viewobj.appendChild(this._body_cell._viewobj);return value},align_setter:function(value){if(typeof value==="string")value=value.split(",");this._x_align=this._y_align=this._p_align="";for(var i=0;i<value.length;i++){var c=value[i];if(c==="center"||c==="left"||c==="right")this._x_align=c;if(c==="top"||c==="bottom"||c==="middle")this._y_align=c;if(c==="absolute")this._x_align=this._y_align=this._p_align="precise"}return value},getBody:function(){return this._body_cell},$setSize:function(x,y){webix.ui.view.prototype.$setSize.call(this,x,y);var dx,dy;if(this._p_align){dx=x-this._settings.left-this._settings.right;dy=y-this._settings.top-this._settings.bottom}else{dx=this._desired_size[0]||x;dy=this._desired_size[2]||y}this._body_cell.$setSize(dx,dy);var box=this._body_cell._viewobj;if(this._x_align=="center")box.style.marginLeft=Math.ceil((x-dx)/2)+"px";else if(this._x_align=="right")box.style.marginLeft=x-dx+"px";else box.style.marginLeft=(this._p_align?this._settings.left:0)+"px";if(this._y_align=="middle")box.style.marginTop=Math.ceil((y-dy)/2)+"px";else if(this._y_align=="bottom")box.style.marginTop=y-dy+"px";else box.style.marginTop=(this._p_align?this._settings.top:0)+"px"},$getSize:function(dx,dy){var size=this._desired_size=this._body_cell.$getSize(0,0);var self_size=webix.ui.baseview.prototype.$getSize.call(this,0,0);if(this._p_align){dx+=this._settings.left+this._settings.right;dy+=this._settings.top+this._settings.bottom}if(!this._x_align||this._p_align){self_size[0]=size[0]+dx;self_size[1]=size[1]+dx}else{self_size[0]=(self_size[0]||size[0])+dy;self_size[1]+=dx}if(!this._y_align||this._p_align){self_size[2]=size[2]+dy;self_size[3]=size[3]+dy}else{self_size[2]=(self_size[2]||size[2])+dy;self_size[3]+=dy}return self_size}},webix.ui.view);webix.animate=function(html_element,config){var animation=config;if(webix.isArray(html_element)){for(var i=0;i<html_element.length;i++){if(webix.isArray(config))animation=config[i];if(animation.type=="slide"){if(animation.subtype=="out"&&i===0){continue}if(animation.subtype=="in"&&i==1){continue}}if(animation.type=="flip"){var animation_copy=webix.clone(animation);if(i===0){animation_copy.type="flipback"}if(i==1){animation_copy.callback=null}webix.animate(html_element[i],animation_copy);continue}webix.animate(html_element[i],animation)}return}var node=webix.toNode(html_element);if(node._has_animation)webix.animate.end(node,animation);else webix.animate.start(node,animation)};webix.animate.end=function(node,animation){node.style[webix.env.transitionDuration]="1ms";node._has_animation=null;if(webix._wait_animate)window.clearTimeout(webix._wait_animate);webix._wait_animate=webix.delay(webix.animate,webix,[node,animation],10)};webix.animate.isSupported=function(){return!webix.$testmode&&!webix.noanimate&&webix.env.transform&&webix.env.transition&&!webix.env.isOpera};webix.animate.formLine=function(next,current,animation){var direction=animation.direction;if(current.parentNode)current.parentNode.style.position="relative";current.style.position="absolute";next.style.position="absolute";var defAniPos=webix.env.isFF?direction=="top"||direction=="left"?-1:1:0;if(direction=="top"||direction=="bottom"){next.style.left="0px";next.style.top=(animation.top||defAniPos)+(direction=="top"?1:-1)*current.offsetHeight+"px"}else{next.style.top=(animation.top||0)+"px";next.style.left=defAniPos+(direction=="left"?1:-1)*current.offsetWidth+"px"}if(current.parentNode==next.parentNode&&animation.keepViews)next.style.display="";else webix.html.insertBefore(next,current.nextSibling,current.parentNode);if(animation.type=="slide"&&animation.subtype=="out"){next.style.left="0px";next.style.top=(animation.top||0)+"px";current.parentNode.removeChild(current);webix.html.insertBefore(current,next.nextSibling,next.parentNode)}return[next,current]};webix.animate.breakLine=function(line){if(arguments[1])line[1].style.display="none";else webix.html.remove(line[1]);webix.animate.clear(line[0]);webix.animate.clear(line[1]);line[0].style.position=""};webix.animate.clear=function(node){node.style[webix.env.transform]="none";node.style[webix.env.transition]="none";node.style.top=node.style.left=""};webix.animate.defaults={type:"slide",delay:"0",duration:"500",timing:"ease-in-out",x:0,y:0};webix.animate.start=function(node,animation){if(typeof animation=="string")animation={type:animation};animation=webix.Settings._mergeSettings(animation,webix.animate.defaults);var prefix=webix.env.cssPrefix;var settings=node._has_animation=animation;var skew_options,scale_type;switch(settings.type=="slide"&&settings.direction){case"right":settings.x=node.offsetWidth;break;case"left":settings.x=-node.offsetWidth;break;case"top":settings.y=-node.offsetHeight;break;case"bottom":default:settings.y=settings.y||node.offsetHeight;break}if(settings.type=="flip"||settings.type=="flipback"){skew_options=[0,0];scale_type="scaleX";if(settings.subtype=="vertical"){skew_options[0]=20;scale_type="scaleY"}else skew_options[1]=20;if(settings.direction=="right"||settings.direction=="bottom"){skew_options[0]*=-1;skew_options[1]*=-1}}var duration=settings.duration+"ms "+settings.timing+" "+settings.delay+"ms";var css_general=prefix+"TransformStyle: preserve-3d;";var css_transition="";var css_transform="";switch(settings.type){case"fade":css_transition="opacity "+duration;css_general="opacity: 0;";break;case"show":css_transition="opacity "+duration;css_general="opacity: 1;";break;case"flip":duration=settings.duration/2+"ms "+settings.timing+" "+settings.delay+"ms";css_transform="skew("+skew_options[0]+"deg, "+skew_options[1]+"deg) "+scale_type+"(0.00001)";css_transition="all "+duration;break;case"flipback":settings.delay+=settings.duration/2;duration=settings.duration/2+"ms "+settings.timing+" "+settings.delay+"ms";node.style[webix.env.transform]="skew("+-1*skew_options[0]+"deg, "+-1*skew_options[1]+"deg) "+scale_type+"(0.00001)";node.style.left="0";css_transform="skew(0deg, 0deg) "+scale_type+"(1)";css_transition="all "+duration;break;case"slide":var x=settings.x+"px";var y=settings.y+"px";css_transform=webix.env.translate+"("+x+", "+y+(webix.env.translate=="translate3d"?", 0":"")+")";css_transition=prefix+"transform "+duration;break;default:break}webix.delay(function(){node.style[webix.env.transition]=css_transition;webix.delay(function(){if(css_general)node.style.cssText+=css_general;if(css_transform)node.style[webix.env.transform]=css_transform;var transitionEnded=false;var tid=webix.event(node,webix.env.transitionEnd,function(ev){node._has_animation=null;if(settings.callback)settings.callback.call(settings.master||window,node,settings,ev);transitionEnded=true;webix.eventRemove(tid)});window.setTimeout(function(){if(!transitionEnded){node._has_animation=null;if(settings.callback)settings.callback.call(settings.master||window,node,settings);transitionEnded=true;webix.eventRemove(tid)}},(settings.duration*1+settings.delay*1)*1.3)})})};webix.MouseEvents={$init:function(config){config=config||{};this._clickstamp=0;this._dbl_sensetive=300;this._item_clicked=null;this._mouse_action_extend(config.onClick,"on_click");this._mouse_action_extend(config.onContext,"on_context");this._mouse_action_extend(config.onDblClick,"on_dblclick");this._mouse_action_extend(config.onMouseMove,"on_mouse_move");if(this.on_click){webix._event(this._contentobj,"click",this._onClick,{bind:this});if(webix.env.isIE8&&this.on_dblclick)webix._event(this._contentobj,"dblclick",this._onDblClick,{bind:this})}if(this.on_context)webix._event(this._contentobj,"contextmenu",this._onContext,{bind:this});if(this.on_mouse_move)this._enable_mouse_move()},_enable_mouse_move:function(){if(!this._mouse_move_enabled){this.on_mouse_move=this.on_mouse_move||{};webix._event(this._contentobj,"mousemove",this._onMouse,{bind:this});webix._event(this._contentobj,webix.env.isIE?"mouseleave":"mouseout",this._onMouse,{bind:this});this._mouse_move_enabled=1;this.attachEvent("onDestruct",function(){if(this._mouse_move_timer)window.clearTimeout(this._mouse_move_timer)})}},_mouse_action_extend:function(config,key){if(config){var now=this[key];var step=now?webix.extend({},now):{};this[key]=webix.extend(step,config)}},_onClick:function(e){if(!this.isEnabled())return false;webix.UIManager._focus_action(this);if(this.on_dblclick){var stamp=(new Date).valueOf();if(stamp-this._clickstamp<=this._dbl_sensetive&&this.locate){var item=this.locate(e);if(""+item==""+this._item_clicked){this._clickstamp=0;return this._onDblClick(e)}}this._clickstamp=stamp}var result=this._mouseEvent(e,this.on_click,"ItemClick");return result},_onDblClick:function(e){return this._mouseEvent(e,this.on_dblclick,"ItemDblClick")},_onContext:function(e){this._mouseEvent(e,this.on_context,"BeforeContextMenu","AfterContextMenu")},_onMouse:function(e){if(this.$destructed)return;if(document.createEventObject)e=document.createEventObject(event);else if(!webix.$testmode&&!webix.isUndefined(e.movementY)&&!e.movementY&&!e.movementX)return;if(this._mouse_move_timer)window.clearTimeout(this._mouse_move_timer);this.callEvent("onMouseMoving",[e]);this._mouse_move_timer=window.setTimeout(webix.bind(function(){if(e.type=="mousemove")this._onMouseMove(e);else this._onMouseOut(e)},this),this._settings.mouseEventDelay||500)},_onMouseMove:function(e){if(!this._mouseEvent(e,this.on_mouse_move,"MouseMove"))this.callEvent("onMouseOut",[e||event])},_onMouseOut:function(e){this.callEvent("onMouseOut",[e||event])},_mouseEvent:function(e,hash,name,pair){e=e||event;if(e.processed||!this._viewobj)return;e.processed=true;var trg=e.target||e.srcElement;if(webix.env.isIE8){var vid=this._settings.id;var wid=trg.w_view;if(!wid)trg.w_view=vid;else if(wid!==vid)return}var css="";var id=null;var found=false;while(trg&&trg.parentNode&&this._viewobj&&trg!=this._viewobj.parentNode){if(!found&&trg.getAttribute){id=trg.getAttribute(this._id);if(id){this._item_clicked=id;if(this.callEvent){if(!this.callEvent("on"+name,[id,e,trg]))return;if(pair)this.callEvent("on"+pair,[id,e,trg])}found=true}}css=webix.html._getClassName(trg);if(css){css=css.toString().split(" ");for(var i=0;i<css.length;i++){if(hash[css[i]]){var functor=webix.toFunctor(hash[css[i]],this.$scope);var res=functor.call(this,e,id||webix.html.locate(e,this._id),trg);if(res===false)return found}}}trg=trg.parentNode}return found}};webix.protoUI({name:"accordionitem",$init:function(config){this._viewobj.innerHTML="<div webix_ai_id='"+config.id+"'  class='webix_accordionitem_header'><div tabindex='0' role='button' class='webix_accordionitem_button' ></div><div class='webix_accordionitem_label' ></div></div><div class='webix_accordionitem_body'></div>";this._contentobj=this._viewobj;this._headobj=this._contentobj.childNodes[0];if(!config.header)this._headobj.style.display="none";this._headlabel=this._contentobj.childNodes[0].childNodes[1];this._headbutton=this._contentobj.childNodes[0].childNodes[0];this._bodyobj=this._contentobj.childNodes[1];this._viewobj.className+=" webix_accordionitem";this._head_cell=this._body_cell=null;this._cells=true;this._bodyobj.setAttribute("role","tabpanel");this._headobj.setAttribute("role","tab");this.attachEvent("onKeyPress",this._onKeyPress)},_remove:function(){this._body_cell={destructor:function(){}}},_replace:function(new_view){this._body_cell.destructor();this._body_cell=new_view;this._body_cell._parent_cell=this;this._bodyobj.appendChild(this._body_cell._viewobj);this.resize()},_id:"webix_ai_id",getChildViews:function(){return[this._body_cell]},body_setter:function(value){if(typeof value!="object")value={template:value};value._inner={top:true,left:true,right:true,bottom:true};this._body_cell=webix.ui._view(value);this._body_cell.$view.style.border="0px solid red";this._body_cell._parent_cell=this;this._bodyobj.appendChild(this._body_cell._viewobj);return value},header_setter:function(value){if(value)value=webix.template(value);return value},headerAlt_setter:function(value){if(value)value=webix.template(value);return value},$getSize:function(dx,dy){var size=this._body_cell.$getSize(0,0);var _borders=this._settings._inner;if(_borders){dx+=(_borders.left?0:1)+(_borders.right?0:1);dy+=(_borders.top?0:1)+(_borders.bottom?0:1)}var header=0;var self_size=webix.ui.baseview.prototype.$getSize.call(this,0,0);self_size[0]=(self_size[0]||size[0])+dx;if(self_size[1]>=1e5)self_size[1]=size[1];self_size[1]+=dx;self_size[2]=(self_size[2]||size[2])+dy;var fixedHeight=self_size[3]<1e5;if(!fixedHeight)self_size[3]=size[3];self_size[3]+=dy;if(this.getParentView()._vertical_orientation){if(this._settings.collapsed){self_size[2]=self_size[3]=this._getHeaderSize()}else if(this._settings.header)header=this._settings.headerHeight}else{if(this._settings.collapsed)self_size[0]=self_size[1]=this._getHeaderSize();if(this._settings.header)header=this._settings.headerHeight}if(!fixedHeight){self_size[2]+=header;self_size[3]+=header}webix.debug_size_box(this,self_size,true);return self_size},on_click:{webix_accordionitem_header:function(e,id){this._toggle(e);return false},webix_accordionitem_header_v:function(e,id){this._toggle(e);return false}},_toggle:function(e){this.define("collapsed",!this._settings.collapsed)},collapsed_setter:function(value){if(this._settings.header===false)return;var parent=this.getParentView();if(parent){if(!value)this._expand();else{if(parent._canCollapse(this))this._collapse();else{var success=0;if(parent._cells.length>1)for(var i=0;i<parent._cells.length;i++){var sibl=parent._cells[i];if(this!=sibl&&sibl.isVisible()&&sibl.expand){sibl.expand();this._collapse();success=1;break}}if(!success)return}}this._settings.collapsed=value;if(!value)parent._afterOpen(this);this.refresh();if(!webix._ui_creation)this.resize();parent.callEvent("onAfter"+(value?"Collapse":"Expand"),[this._settings.id]);this._settings.$noresize=value}return value},collapse:function(){this.define("collapsed",true);webix.UIManager._moveChildFocus(this)},expand:function(){this.define("collapsed",false)},_show:function(){this.show()},_hide:function(){this.hide()},_expand:function(){this._bodyobj.style.display="";webix.html.removeCss(this.$view,"collapsed");webix.html.removeCss(this._headobj,"collapsed");this._headobj.setAttribute("aria-expanded","true")},_collapse:function(){var vertical=this.getParentView()._vertical_orientation;if(this._settings.headerAlt)this._headlabel.innerHTML=this._settings.headerAlt();this._bodyobj.style.display="none";webix.html.addCss(this.$view,"collapsed");webix.html.addCss(this._headobj,"collapsed");this._headobj.setAttribute("aria-expanded","false")},refresh:function(){var template=this._settings[this._settings.collapsed?"headerAlt":"header"]||this._settings.header;if(template){this._headlabel.innerHTML=template();this._headbutton.setAttribute("aria-label",template())}var css=this.getParentView()._vertical_orientation?"vertical":"horizontal";if(this._viewobj.className.indexOf(" "+css)<0){webix.html.addCss(this._viewobj,css)}if(!webix.env.transform){webix.html.addCss(this._viewobj,"webix_ie",true)}},_getHeaderSize:function(){return this._settings.collapsed?this._settings.headerAltHeight:this._settings.headerHeight},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)||this._getHeaderSize()!=this._last_set_header_size){x=this._content_width;y=this._content_height;var headerSize=this._last_set_header_size=this._getHeaderSize();if(this._settings.header){this._headobj.style.height=headerSize+"px";this._headobj.style.width="auto";this._headobj.style[webix.env.transform]="";this._headobj.style.borderBottomWidth=(this._settings.collapsed?0:1)+"px";if(this.getParentView()._vertical_orientation||!this._settings.collapsed){y-=this._getHeaderSize()}else if(this._settings.collapsed){if(webix.animate.isSupported()){this._headobj.style.width=y+"px";this._headobj.style.height=x+3+"px";var d=Math.floor(y/2-x/2)+(x-this._settings.headerAltHeight)/2;this._headobj.style[webix.env.transform]="rotate(90deg) translate("+d+"px, "+(d+1)+"px)"}else{this._headobj.style.width=x+"px";this._headobj.style.height=y+3+"px"}}}if(!this._settings.collapsed){this._body_cell.$setSize(x,y);this._last_size_y=y}}else if(!this._settings.collapsed){var body=this._body_cell;if(this._last_size_y)body.$setSize(this._content_width,this._last_size_y)}},$skin:function(){var defaults=this.defaults;defaults.headerAltHeight=defaults.headerHeight=webix.skin.$active.barHeight;if(webix.skin.$active.borderlessAccordion)defaults.borderless=true},defaults:{header:false,headerAlt:false,body:""}},webix.MouseEvents,webix.EventSystem,webix.ui.view);webix.protoUI({name:"accordion",defaults:{panelClass:"accordionitem",multi:false,collapsed:false},$init:function(){this._viewobj.setAttribute("role","tablist");this._viewobj.setAttribute("aria-multiselectable","true")},addView:function(view){var id=webix.ui.layout.prototype.addView.apply(this,arguments);var child=webix.$$(id);if(child.collapsed_setter&&child.refresh)child.refresh();return id},_parse_cells:function(){var panel=this._settings.panelClass;var cells=this._collection;for(var i=0;i<cells.length;i++){if((cells[i].body||cells[i].header)&&!cells[i].view&&!cells[i].align)cells[i].view=panel;if(webix.isUndefined(cells[i].collapsed))cells[i].collapsed=this._settings.collapsed}this._skin_render_collapse=true;webix.ui.layout.prototype._parse_cells.call(this);this._skin_render_collapse=false;for(var i=0;i<this._cells.length;i++){if(this._cells[i].name==panel)this._cells[i].refresh();this._cells[i]._accLastChild=false}var found=false;for(var i=this._cells.length-1;i>=0&&!found;i--){if(!this._cells[i]._settings.hidden){this._cells[i]._accLastChild=true;found=true}}},_afterOpen:function(view){if(this._settings.multi===false&&this._skin_render_collapse!==true){for(var i=0;i<this._cells.length;i++){if(view!=this._cells[i]&&!this._cells[i]._settings.collapsed&&this._cells[i].collapse)this._cells[i].collapse()}}if(view.callEvent){view.callEvent("onViewShow",[]);webix.ui.each(view,this._signal_hidden_cells)}},_canCollapse:function(view){if(this._settings.multi===true||this._skin_render_collapse)return true;for(var i=0;i<this._cells.length;i++)if(view!=this._cells[i]&&!this._cells[i]._settings.collapsed&&this._cells[i].isVisible()&&!this._cells[i].$nospace)return true;return false},$skin:function(){var defaults=this.defaults;if(webix.skin.$active.accordionType)defaults.type=webix.skin.$active.accordionType}},webix.ui.layout);webix.protoUI({name:"headerlayout",defaults:{type:"accordion",multi:"mixed",collapsed:false}},webix.ui.accordion);webix.DragControl={_drag_masters:webix.toArray(["dummy"]),addDrop:function(node,ctrl,master_mode){node=webix.toNode(node);node.webix_drop=this._getCtrl(ctrl);if(master_mode)node.webix_master=true},_getCtrl:function(ctrl){ctrl=ctrl||webix.DragControl;var index=this._drag_masters.find(ctrl);if(index<0){index=this._drag_masters.length;this._drag_masters.push(ctrl)}return index},_createTouchDrag:function(e){var dragCtrl=webix.DragControl;var master=this._getActiveDragMaster();if(master&&master._getDragItemPos){if(!dragCtrl._html)dragCtrl.createDrag(e);var ctx=dragCtrl._drag_context;dragCtrl._html.style.left=e.x+dragCtrl.left+(ctx.x_offset||0)+"px";dragCtrl._html.style.top=e.y+dragCtrl.top+(ctx.y_offset||0)+"px"}},addDrag:function(node,ctrl){node=webix.toNode(node);node.webix_drag=this._getCtrl(ctrl);webix._event(node,webix.env.mouse.down,this._preStart,{bind:node});webix._event(node,"dragstart",webix.html.preventEvent)},_preStart:function(e){if(webix.DragControl._active){if(webix.DragControl._saved_event==e)return;webix.DragControl._preStartFalse();webix.DragControl.destroyDrag(e)}webix.DragControl._active=this;var evobj=webix.env.mouse.context(e);webix.DragControl._start_pos=evobj;webix.DragControl._saved_event=e;webix.DragControl._webix_drag_mm=webix.event(document.body,webix.env.mouse.move,webix.DragControl._startDrag);webix.DragControl._webix_drag_mu=webix.event(document,webix.env.mouse.up,webix.DragControl._preStartFalse);webix.html.addCss(document.body,"webix_noselect",1)},_preStartFalse:function(){webix.DragControl._clean_dom_after_drag()},_startDrag:function(e){var pos=webix.env.mouse.context(e);var master=webix.DragControl._getActiveDragMaster();var longTouchLimit=master&&webix.env.touch&&master._getDragItemPos&&!webix.Touch._long_touched;if(longTouchLimit||Math.abs(pos.x-webix.DragControl._start_pos.x)<5&&Math.abs(pos.y-webix.DragControl._start_pos.y)<5)return;webix.DragControl._clean_dom_after_drag(true);if(!webix.DragControl._html)if(!webix.DragControl.createDrag(webix.DragControl._saved_event))return;webix.DragControl.sendSignal("start");webix.DragControl._webix_drag_mm=webix.event(document.body,webix.env.mouse.move,webix.DragControl._moveDrag);webix.DragControl._webix_drag_mu=webix.event(document,webix.env.mouse.up,webix.DragControl._stopDrag);webix.DragControl._moveDrag(e);if(webix.env.touch)return webix.html.preventEvent(e)},_stopDrag:function(e){webix.DragControl._clean_dom_after_drag();webix.DragControl._saved_event=null;if(webix.DragControl._last){webix.DragControl.$drop(webix.DragControl._active,webix.DragControl._last,e);webix.DragControl.$dragOut(webix.DragControl._active,webix.DragControl._last,null,e)}webix.DragControl.destroyDrag(e);webix.DragControl.sendSignal("stop")},_clean_dom_after_drag:function(still_drag){this._webix_drag_mm=webix.eventRemove(this._webix_drag_mm);this._webix_drag_mu=webix.eventRemove(this._webix_drag_mu);if(!still_drag)webix.html.removeCss(document.body,"webix_noselect")},_moveDrag:function(e){var dragCtrl=webix.DragControl;var pos=webix.html.pos(e);var evobj=webix.env.mouse.context(e);var customPos=dragCtrl.$dragPos(pos,e);var ctx=dragCtrl._drag_context;dragCtrl._html.style.top=pos.y+dragCtrl.top+(customPos||!ctx.y_offset?0:ctx.y_offset)+"px";dragCtrl._html.style.left=pos.x+dragCtrl.left+(customPos||!ctx.x_offset?0:ctx.x_offset)+"px";if(dragCtrl._skip)dragCtrl._skip=false;else{var target=evobj.target=webix.env.touch?document.elementFromPoint(evobj.x,evobj.y):evobj.target;var touch_event=webix.env.touch?evobj:e;dragCtrl._checkLand(target,touch_event)}return webix.html.preventEvent(e)},_checkLand:function(node,e){while(node&&node.tagName!="BODY"){if(node.webix_drop){if(this._last&&(this._last!=node||node.webix_master))this.$dragOut(this._active,this._last,node,e);if(!this._last||this._last!=node||node.webix_master){this._last=null;this._landing=this.$dragIn(webix.DragControl._active,node,e);if(this._landing)this._last=node;return}return}node=node.parentNode}if(this._last)this._last=this._landing=this.$dragOut(this._active,this._last,null,e)},sendSignal:function(signal){webix.DragControl.active=signal=="start"},getMaster:function(t){return this._drag_masters[t.webix_drag||t.webix_drop]},getContext:function(){return this._drag_context},getNode:function(){return this._html},createDrag:function(e){var dragCtl=webix.DragControl;var a=dragCtl._active;dragCtl._drag_context={};var master=this._drag_masters[a.webix_drag];var drag_container;if(master.$dragCreate){drag_container=master.$dragCreate(a,e);if(!drag_container)return false;this._setDragOffset(e);drag_container.style.position="absolute"}else{var text=dragCtl.$drag(a,e);dragCtl._setDragOffset(e);if(!text)return false;drag_container=document.createElement("DIV");drag_container.innerHTML=text;drag_container.className="webix_drag_zone";document.body.appendChild(drag_container);var context=dragCtl._drag_context;if(context.html&&webix.env.pointerevents){context.x_offset=-Math.round(drag_container.offsetWidth*.5);context.y_offset=-Math.round(drag_container.offsetHeight*.75)}}drag_container.style.zIndex=Math.max(drag_container.style.zIndex,webix.ui.zIndex());webix.DragControl._skipDropH=webix.event(drag_container,webix.env.mouse.move,webix.DragControl._skip_mark);if(!webix.DragControl._drag_context.from)webix.DragControl._drag_context={source:a,from:a};webix.DragControl._html=drag_container;return true},_skip_mark:function(){webix.DragControl._skip=true},destroyDrag:function(e){var a=webix.DragControl._active;var master=this._drag_masters[a.webix_drag];if(master&&master.$dragDestroy){webix.DragControl._skipDropH=webix.eventRemove(webix.DragControl._skipDropH);if(webix.DragControl._html)master.$dragDestroy(a,webix.DragControl._html,e)}else{webix.html.remove(webix.DragControl._html)}webix.DragControl._landing=webix.DragControl._active=webix.DragControl._last=webix.DragControl._html=null},_getActiveDragMaster:function(){return webix.DragControl._drag_masters[webix.DragControl._active.webix_drag]},top:5,left:5,_setDragOffset:function(e){var dragCtl=webix.DragControl;var pos=dragCtl._start_pos;var ctx=dragCtl._drag_context;if(typeof ctx.x_offset!="undefined"&&typeof ctx.y_offset!="undefined")return null;ctx.x_offset=ctx.y_offset=0;if(webix.env.pointerevents){var m=webix.DragControl._getActiveDragMaster();if(m._getDragItemPos&&m!==this){var itemPos=m._getDragItemPos(pos,e);if(itemPos){ctx.x_offset=itemPos.x-pos.x;ctx.y_offset=itemPos.y-pos.y}}}},$dragPos:function(pos,e){var m=this._drag_masters[webix.DragControl._active.webix_drag];if(m.$dragPos&&m!=this){m.$dragPos(pos,e,webix.DragControl._html);return true}},$dragIn:function(s,t,e){var m=this._drag_masters[t.webix_drop];if(m.$dragIn&&m!=this)return m.$dragIn(s,t,e);t.className=t.className+" webix_drop_zone";return t},$dragOut:function(s,t,n,e){var m=this._drag_masters[t.webix_drop];if(m.$dragOut&&m!=this)return m.$dragOut(s,t,n,e);t.className=t.className.replace("webix_drop_zone","");return null},$drop:function(s,t,e){var m=this._drag_masters[t.webix_drop];webix.DragControl._drag_context.from=webix.DragControl.getMaster(s);if(m.$drop&&m!=this)return m.$drop(s,t,e);t.appendChild(s)},$drag:function(s,e){var m=this._drag_masters[s.webix_drag];if(m.$drag&&m!=this)return m.$drag(s,e);return"<div style='"+s.style.cssText+"'>"+s.innerHTML+"</div>"}};webix.attachEvent("onLongTouch",function(ev){if(webix.DragControl._active)webix.DragControl._createTouchDrag(ev)});webix.DataMove={copy:function(sid,tindex,tobj,details){details=details||{};var new_id=details.newId||sid;tobj=tobj||this;var data=this.getItem(sid);webix.assert(data,"Incorrect ID in DataMove::copy");if(tobj)data=tobj._externalData(data);return tobj.data.add(tobj._externalData(data,new_id),tindex,details.parent||0)},_next_move_index:function(nid,next,source){if(next&&nid){var new_index=this.getIndexById(nid);return new_index+(source==this&&source.getIndexById(next)<new_index?0:1)}},move:function(sid,tindex,tobj,details){details=details||{};var new_id=details.newId||sid;tobj=tobj||this;webix.assert(tobj.data,"moving attempt to component without datastore");if(!tobj.data)return;if(webix.isArray(sid)){if(sid.length>3)this.$blockRender=tobj.$blockRender=true;for(var i=0;i<sid.length;i++){var nid=this.move(sid[i],tindex,tobj,details);tindex=tobj._next_move_index(nid,sid[i+1],this)}this.$blockRender=tobj.$blockRender=false;if(sid.length>3){this.refresh();if(tobj!=this)tobj.refresh()}return}var nid=sid;var data=this.getItem(sid);webix.assert(data,"Incorrect ID in DataMove::move");if(!tobj||tobj==this){if(tindex<0)tindex=this.data.order.length-1;this.data.move(this.getIndexById(sid),tindex);this.data.callEvent("onDataMove",[sid,tindex,null,this.data.order[tindex+1]])}else{nid=tobj.data.add(tobj._externalData(data,new_id),tindex,details.parent||0);this.data.remove(sid)}return nid},moveUp:function(id,step){return this.move(id,this.getIndexById(id)-(step||1))},moveDown:function(id,step){return this.moveUp(id,(step||1)*-1)},moveTop:function(id){return this.move(id,0)},moveBottom:function(id){return this.move(id,this.data.count()-1)},_externalData:function(data,id){var newdata=webix.extend({},data);newdata.id=!id||this.data.pull[id]?webix.uid():id;newdata.$template=null;if(this._settings.externalData)newdata=this._settings.externalData.call(this,newdata,id,data);return newdata}};webix.Movable={move_setter:function(value){if(value){this._move_admin=webix.clone(this._move_admin);this._move_admin.master=this;webix.DragControl.addDrag(this._headobj,this._move_admin)}return value},_move_admin:{$dragCreate:function(object,e){if(this.master.config.move){var offset=webix.html.offset(object);var pos=webix.html.pos(e);webix.DragControl.top=offset.y-pos.y;webix.DragControl.left=offset.x-pos.x;return webix.toNode(this.master._viewobj)}},$dragDestroy:function(node,drag){var view=this.master;if(view._settings){view._settings.top=parseInt(drag.style.top,10);view._settings.left=parseInt(drag.style.left,10)}webix.DragControl.top=webix.DragControl.left=5;this.master.callEvent("onViewMoveEnd",[]);return},$dragPos:function(pos,e){this.master.callEvent("onViewMove",[pos,e])}}};webix.Modality={_modal_set:function(value){if(value){if(!this._modal_cover){this._modal_cover=webix.html.create("div",{class:"webix_modal"});var zIndex=this._settings.zIndex||webix.ui.zIndex();this._previous_modality=webix._modality;webix._modality=zIndex;this._modal_cover.style.zIndex=zIndex-1;this._viewobj.style.zIndex=zIndex;document.body.appendChild(this._modal_cover);document.body.style.overflow="hidden";webix._event(this._modal_cover,"click",webix.bind(this._ignore_clicks,this))}}else{if(this._modal_cover){webix.html.remove(this._modal_cover);document.body.style.overflow="";var topmost=this._previous_modality;setTimeout(function(){webix._modality=topmost},1);this._modal_cover=null}}return value}};webix.protoUI({name:"window",$init:function(config){this._viewobj.innerHTML="<div class='webix_win_content'><div class='webix_win_head'></div><div class='webix_win_body'></div></div>";this._contentobj=this._viewobj.firstChild;this._headobj=this._contentobj.childNodes[0];this._dataobj=this._bodyobj=this._contentobj.childNodes[1];this._viewobj.className+=" webix_window";this._viewobj.setAttribute("role","dialog");this._viewobj.setAttribute("tabindex","0");this._head_cell=this._body_cell=null;this._settings._inner={top:false,left:false,right:false,bottom:false};if(!config.id)config.id=webix.uid();webix._event(this._contentobj,"click",webix.bind(this._ignore_clicks,this));if(this._contentobj.addEventListener)webix._event(this._contentobj,"click",function(){if(!this._settings.zIndex&&this._settings.toFront){this._viewobj.style.zIndex=webix.ui.zIndex()}},{bind:this,capture:true});if(config.modal)this._modal=true;this.attachEvent("onViewMoveEnd",function(){if(this._settings.position)delete this._settings.position})},_ignore_clicks:function(e){var popups=webix.ui._popups;var index=popups.find(this);if(index==-1)index=popups.length-1;e.click_view=index;if(webix.env.isIE8)e.srcElement.click_view=index},getChildViews:function(){if(this._head_cell)return[this._head_cell,this._body_cell];else return[this._body_cell]},zIndex_setter:function(value){this._viewobj.style.zIndex=value;return value},_remove:function(){this._body_cell={destructor:function(){}}},_replace:function(new_view){this._body_cell.destructor();this._body_cell=new_view;this._body_cell._parent_cell=this;this._bodyobj.appendChild(this._body_cell._viewobj);var cell=this._body_cell._viewobj.style;cell.borderTopWidth=cell.borderBottomWidth=cell.borderLeftWidth=cell.borderRightWidth="1px";this._body_cell._settings._inner=webix.clone(this._settings._inner);this.resize(true)},show:function(node,mode,point){if(node===true){if(!this._settings.hidden)return;node=null}if(!this.callEvent("onBeforeShow",arguments))return false;this._settings.hidden=false;this._viewobj.style.zIndex=this._settings.zIndex||webix.ui.zIndex();if(this._settings.modal||this._modal){this._modal_set(true);this._modal=null}var pos,dx,dy;mode=mode||{};if(!mode.pos)mode.pos=this._settings.relative;if(node){if(typeof node=="object"&&!node.tagName){if(node.target||node.srcElement){pos=webix.html.pos(node);dx=20;dy=5}else pos=node}else{node=webix.toNode(node);webix.assert(node,"Not existing target for window:show");pos=webix.html.offset(node)}var x=Math.max(window.innerWidth||0,document.body.offsetWidth);var y=Math.max(window.innerHeight||0,document.body.offsetHeight);dx=dx||node.offsetWidth||0;dy=dy||node.offsetHeight||0;var size=this._last_size;var fin_x=pos.x;var fin_y=pos.y;var point_y=0;var point_x=0;var fit=this._settings.autofit;if(fit){var nochange=fit==="node";var delta_x=6;var delta_y=6;var delta_point=6;point="top";fin_y=0;fin_x=0;var scrollLeft=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft;if(x-pos.x-dx<size[0]&&mode.pos=="right"&&!nochange)mode.pos="left";if(mode.pos=="right"){fin_x=pos.x+delta_x+dx;delta_y=-dy;point="left";point_y=Math.round(pos.y+dy/2);point_x=fin_x-delta_point}else if(mode.pos=="left"){fin_x=pos.x-delta_x-size[0]-1;delta_y=-dy;point="right";point_y=Math.round(pos.y+dy/2);point_x=fin_x+size[0]+1}else{if(pos.x<scrollLeft){fin_x=scrollLeft}else if(x+scrollLeft-pos.x>size[0]){fin_x=pos.x}else{fin_x=x+scrollLeft-delta_x-size[0]}point_x=Math.round(pos.x+dx/2);point_x=Math.min(point_x,fin_x+size[0]-delta_point*3)}var scrollTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;if((!size[1]||y+scrollTop-dy-pos.y-delta_y>size[1]||nochange)&&mode.pos!="top"){fin_y=dy+pos.y+delta_y-4;if(!point_y){point="top";point_y=fin_y-delta_point}}else{fin_y=pos.y-delta_y-size[1];if(fin_y<0){fin_y=0;if(point=="top")point=false}else if(!point_y){point="bottom";fin_y--;point_y=fin_y+size[1]+1}}}var deltax=mode.x||0;var deltay=mode.y||0;this.setPosition(fin_x+deltax,fin_y+deltay);if(this._set_point){if(point)this._set_point(point,point_x+deltax,point_y+deltay);else this._hide_point()}}else if(this._settings.position)this._setPosition();this._viewobj.style.display="block";this._hide_timer=1;webix.delay(function(){this._hide_timer=0},this,[],webix.env.touch?400:100);this._render_hidden_views();if(this.config.autofocus){this._prev_focus=webix.UIManager.getFocus();webix.UIManager.setFocus(this)}if(-1==webix.ui._popups.find(this))webix.ui._popups.push(this);this.callEvent("onShow",[])},_hide:function(e){if(this._settings.hidden||this._settings.modal||this._hide_timer||e&&e.showpopup)return;if(webix._modality&&this._settings.zIndex<=webix._modality)return;if(e){var index=webix.env.isIE8?e.srcElement.click_view:e.click_view;if(!index&&index!==0)index=-1;var myindex=webix.ui._popups.find(this);if(myindex<=index)return}this.hide()},hidden_setter:function(value){if(value)this.hide();else this.show();return!!value},hide:function(force){if(this.$destructed)return;if(!force)if(this._settings.hidden)return;if(this._settings.modal)this._modal_set(false);if(this._settings.position=="top"){webix.animate(this._viewobj,{type:"slide",x:0,y:-(this._content_height+20),duration:300,callback:this._hide_callback,master:this})}else this._hide_callback();if(this._settings.autofocus){var el=document.activeElement;if(el&&this._viewobj&&(this._viewobj.contains(el)||el===document.body)){webix.UIManager.setFocus(this._prev_focus);this._prev_focus=null}}this._hide_sub_popups()},_hide_sub_popups:function(){var order=webix.ui._popups;var index=order.find(this);var size=order.length-1;if(index>-1)for(var i=size;i>index;i--)if(order[i]._hide_point)order[i].hide();order.removeAt(index)},destructor:function(){this._modal_set(false);webix.html.remove(this._viewobj);if(this._settings.autofocus){if(!webix._final_destruction)webix.UIManager.setFocus(this._prev_focus);this._prev_focus=null}this._hide_sub_popups();if(this._hide_point)this._hide_point();webix.Destruction.destructor.apply(this,[])},_hide_callback:function(){if(!this.$destructed){this._viewobj.style.display="none";this._settings.hidden=true;this.callEvent("onHide",[])}},close:function(){this.destructor()},_inner_body_set:function(value){value.borderless=true},body_setter:function(value){if(typeof value!="object")value={template:value};this._inner_body_set(value);webix._parent_cell=this;this._body_cell=webix.ui._view(value);this._body_cell._parent_cell=this;this._bodyobj.appendChild(this._body_cell._viewobj);return value},head_setter:function(value){if(value===false)return value;if(typeof value!="object"){this._viewobj.setAttribute("aria-label",value);value={template:value,padding:0}}value.borderless=true;webix._parent_cell=this;this._head_cell=webix.ui._view(value);this._head_cell._parent_cell=this;this._headobj.appendChild(this._head_cell._viewobj);return value},getBody:function(){return this._body_cell},getHead:function(){return this._head_cell},adjust:function(){return this.resize()},resizeChildren:function(){if(this._body_cell)this.resize()},resize:function(){webix.ui.baseview.prototype.adjust.call(this);this._setPosition(this._settings.left,this._settings.top)},_setPosition:function(x,y){if(this._settings.position){this.$view.style.position="fixed";var width=this._content_width;var height=this._content_height;webix.assert(width&&height,"Attempt to show not rendered window");var maxWidth=window.innerWidth||document.documentElement.offsetWidth;var maxHeight=window.innerHeight||document.documentElement.offsetHeight;var left=Math.round((maxWidth-width)/2);var top=Math.round((maxHeight-height)/2);if(typeof this._settings.position=="function"){var state={left:left,top:top,width:width,height:height,maxWidth:maxWidth,maxHeight:maxHeight};this._settings.position.call(this,state);if(state.width!=width||state.height!=height)this.$setSize(state.width,state.height);this.setPosition(state.left,state.top)}else{if(this._settings.position=="top"){if(webix.animate.isSupported())top=-1*height;else top=10}this.setPosition(left,top)}if(this._settings.position=="top")webix.animate(this._viewobj,{type:"slide",x:0,y:height-(this._settings.padding||0)*2,duration:300,callback:this._topPositionCallback,master:this})}else this.setPosition(x,y)},_topPositionCallback:function(node){webix.animate.clear(node);this._settings.top=-((this._settings.padding||0)*2);this.setPosition(this._settings.left,this._settings.top)},setPosition:function(x,y){this._viewobj.style.top=y+"px";this._viewobj.style.left=x+"px";this._settings.left=x;this._settings.top=y},$getSize:function(dx,dy){var _borders=this._settings._inner;if(_borders){dx+=(_borders.left?0:1)+(_borders.right?0:1);dy+=(_borders.top?0:1)+(_borders.bottom?0:1)}if(this._settings.head)dy+=1;var size=this._body_cell.$getSize(0,0);var headMinWidth=0;if(this._head_cell){var head_size=this._head_cell.$getSize(0,0);if(head_size[3]==head_size[2])this._settings.headHeight=head_size[3];dy+=this._settings.headHeight;headMinWidth=head_size[0]}if(this._settings.fullscreen){var width=window.innerWidth||document.body.clientWidth;var height=window.innerHeight||document.body.clientHeight;return[width,width,height,height]}var self_size=webix.ui.view.prototype.$getSize.call(this,0,0);if(headMinWidth&&size[1]>1e5)size[0]=Math.max(headMinWidth,size[0]);self_size[1]=Math.min(self_size[1],(size[1]>=1e5&&self_size[1]>=1e5?Math.max(size[0],300):size[1])+dx);self_size[3]=Math.min(self_size[3],(size[3]>=1e5&&self_size[3]>=1e5?Math.max(size[2],200):size[3])+dy);self_size[0]=Math.min(Math.max(self_size[0],size[0]+dx),self_size[1]);self_size[2]=Math.min(Math.max(self_size[2],size[2]+dy),self_size[3]);return self_size},$setSize:function(x,y){webix.ui.view.prototype.$setSize.call(this,x,y);x=this._content_width;y=this._content_height;if(this._settings.head===false){this._headobj.style.display="none";this._body_cell.$setSize(x,y)}else{this._head_cell.$setSize(x,this._settings.headHeight);this._body_cell.$setSize(x,y-this._settings.headHeight)}},$skin:function(){this.defaults.headHeight=webix.skin.$active.barHeight},defaults:{top:0,left:0,autofit:true,relative:"bottom",body:"",head:"",hidden:true,autofocus:true}},webix.ui.view,webix.Movable,webix.Modality,webix.EventSystem);webix.protoUI({name:"popup",$init:function(){this._settings.head=false;this.$view.className+=" webix_popup";webix.attachEvent("onClick",webix.bind(this._hide,this));this.attachEvent("onHide",this._hide_point)},$skin:function(){this.defaults.headHeight=webix.skin.$active.barHeight;this.defaults.padding=webix.skin.$active.popupPadding},close:function(){webix.html.remove(this._point_element);webix.ui.window.prototype.close.call(this)},$getSize:function(x,y){return webix.ui.window.prototype.$getSize.call(this,x+this._settings.padding*2,y+this._settings.padding*2)},$setSize:function(x,y){webix.ui.view.prototype.$setSize.call(this,x,y);x=this._content_width-this._settings.padding*2;y=this._content_height-this._settings.padding*2;this._contentobj.style.padding=this._settings.padding+"px";this._headobj.style.display="none";this._body_cell.$setSize(x,y)},_inner_body_set:function(){},head_setter:function(){},_set_point:function(mode,left,top){this._hide_point();document.body.appendChild(this._point_element=webix.html.create("DIV",{class:"webix_point_"+mode},""));this._point_element.style.zIndex=webix.ui.zIndex();this._point_element.style.top=top+"px";this._point_element.style.left=left+"px"},_hide_point:function(){this._point_element=webix.html.remove(this._point_element)}},webix.ui.window);webix.ui._popups=webix.toArray();webix.extend(webix.ui.window,{resize_setter:function(value){if(value&&!this._resizeHandlers)this._renderResizeHandler();return value},_renderResizeHandler:function(){if(!this._rwHandle){this._viewobj.firstChild.style.position="relative";this._rwHandle=webix.html.create("DIV",{class:"webix_resize_handle"});this._viewobj.firstChild.appendChild(this._rwHandle);webix._event(this._rwHandle,webix.env.mouse.down,this._wrDown,{bind:this})}},_showResizeFrame:function(width,height){if(!this._resizeFrame){this._resizeFrame=webix.html.create("div",{class:"webix_resize_frame"},"");document.body.appendChild(this._resizeFrame);var pos=webix.html.offset(this._viewobj);this._resizeFrame.style.left=pos.x+"px";this._resizeFrame.style.top=pos.y+"px";this._resizeFrame.style.zIndex=webix.ui.zIndex()}this._resizeFrame.style.width=width+"px";this._resizeFrame.style.height=height+"px"},_wrDown:function(e){if(this.config.resize){webix.html.addCss(document.body,"webix_noselect webix_resize_cursor");this._wsReady=webix.html.offset(this._viewobj);this._resizeHandlersMove=webix.event(document.body,webix.env.mouse.move,this._wrMove,{bind:this});this._resizeHandlersUp=webix.event(document.body,webix.env.mouse.up,this._wrUp,{bind:this})}},_wrMove:function(e){if(this._wsReady!==false){var pos=webix.html.pos(e);var progress={x:pos.x-this._wsReady.x+10,y:pos.y-this._wsReady.y+10};if(Math.abs(this._wsReady.x-pos.x)<(this.config.minWidth||100)||Math.abs(this._wsReady.y-pos.y)<(this.config.maxHeight||100))return;this._wsProgress=progress;this._showResizeFrame(progress.x,progress.y)}},_wrUp:function(){if(this._resizeFrame)this._resizeFrame=webix.html.remove(this._resizeFrame);webix.html.removeCss(document.body,"webix_resize_cursor");webix.html.removeCss(document.body,"webix_noselect");webix.eventRemove(this._resizeHandlersMove);webix.eventRemove(this._resizeHandlersUp);if(this._wsProgress){this.config.width=this._wsProgress.x;this.config.height=this._wsProgress.y;this.resize()}this._wsReady=this._wsProgress=false;this.callEvent("onViewResize",[])}});webix.protoUI({name:"suggest",defaults:{autofocus:false,type:"list",keyPressTimeout:1,body:{yCount:10,autoheight:true,body:true,select:true,borderless:true,navigation:true},filter:function(item,value){if(item.value.toString().toLowerCase().indexOf(value.toLowerCase())===0)return true;return false}},template_setter:webix.template,filter_setter:function(value){return webix.toFunctor(value,this.$scope)},$init:function(obj){var temp={};webix.extend(temp,webix.copy(this.defaults.body));temp.view=obj.type||this.defaults.type;var etemp=this._get_extendable_cell(temp);if(obj.body)webix.extend(etemp,obj.body,true);if(obj.data)etemp.data=obj.data;if(obj.url)etemp.url=obj.url;if(obj.datatype)etemp.datatype=obj.datatype;if(obj.id)temp.id=temp.id||obj.id+"_"+temp.view;obj.body=temp;this.$ready.push(this._set_on_popup_click);this.attachEvent("onShow",function(){if(this._settings.master){var master=webix.$$(this._settings.master);if(master){var node=master._getInputDiv?master._getInputDiv():master.getInputNode();node.setAttribute("aria-expanded","true")}}this._show_selection()});this.attachEvent("onHide",function(){if(this._settings.master){var master=webix.$$(this._settings.master);if(master){var node=master._getInputDiv?master._getInputDiv():master.getInputNode();node.setAttribute("aria-expanded","false")}}});this._old_text={}},_get_extendable_cell:function(obj){return obj},_preselectMasterOption:function(data){var master,node,text="";if(data){if(this._settings.master){master=webix.$$(this._settings.master);node=master.getInputNode();if(node&&master.$setValueHere){master.$setValueHere(data.value)}else if(node){if(master.options_setter)text=this.getItemText(data.id);else if(data.value)text=master._get_visible_text?master._get_visible_text(data.value):data.value.toString();if(webix.isUndefined(node.value))node.innerHTML=text;else node.value=text.replace(/<[^>]*>/g,"")}}}node=node||this._last_input_target;if(node)node.focus()},setMasterValue:function(data,refresh){var text=data.id?this.getItemText(data.id):data.text||data.value;if(this._settings.master){var master=webix.$$(this._settings.master);if(refresh&&data.id)master.refresh();else if(master.options_setter)master.setValue(data.$empty?"":data.id);else if(master.setValueHere)master.setValueHere(text);else master.setValue(text)}else if(this._last_input_target){this._last_input_target.value=text}if(!refresh){this.hide(true);if(this._last_input_target)this._last_input_target.focus()}this.callEvent("onValueSuggest",[data,text]);webix.delay(function(){webix.callEvent("onEditEnd",[])})},getMasterValue:function(){if(this._settings.master)return webix.$$(this._settings.master).getValue();return null},getItemId:function(text){var list=this.getList();var type=list.type;for(var key in list.data.pull){var obj=list.getItem(key);if(this._settings.filter.call(this,obj,text))return obj.id}},getItemText:function(id){var item=this.getList().getItem(id);if(!item)return this._old_text[id]||"";if(this._settings.template)return this._settings.template.call(this,item,this.type);if(this._settings.textValue)return item[this._settings.textValue];var type=this.getList().type;var text=type.template.call(type,item,type);return this._old_text[id]=text},getSuggestion:function(){var id,list=this.getList(),order=list.data.order;if(list.getSelectedId)id=list.getSelectedId();if(order.length&&(!id||order.find(id)<0))id=order[0];if(id&&typeof id=="object")id=id+"";return id},getList:function(){return this._body_cell},_set_on_popup_click:function(){var list=this.getList();var type=this._settings.type;if(list.count){list.attachEvent("onItemClick",webix.bind(function(item){this.setMasterValue(list.getItem(item))},this));list.data.attachEvent("onstoreupdated",webix.bind(function(id,obj,mode){if(mode=="delete"&&id==this.getMasterValue())this.setMasterValue({id:"",text:""},1);else if(mode=="update"&&id==this.getMasterValue()){this.setMasterValue(obj,1)}},this));list.data.attachEvent("onAfterFilter",webix.bind(this._suggest_after_filter,this));list.data.attachEvent("onStoreLoad",webix.bind(this._suggest_after_filter,this));if(webix.isUndefined(this._settings.fitMaster))this._settings.fitMaster=true}else if(type=="calendar"){list.attachEvent("onDateSelect",function(date){this.getParentView().setMasterValue({value:date})});list.attachEvent("onTodaySet",function(date){this.getParentView().setMasterValue({value:date})});list.attachEvent("onDateClear",function(date){this.getParentView().setMasterValue({value:date})})}else if(type=="colorboard"){list.attachEvent("onItemClick",function(value){this.getParentView().setMasterValue({value:value})})}},input_setter:function(value){this.linkInput(value);return 0},linkInput:function(input){var node;if(input.getInputNode){node=input.getInputNode();node.webix_master_id=input._settings.id}else node=webix.toNode(input);webix._event(node,"keydown",function(e){if((node!=document.body||this.isVisible())&&(input.config?!input.config.readonly:!node.getAttribute("readonly")))this._suggestions(e)},{bind:this});if(input._getInputDiv)node=input._getInputDiv();node.setAttribute("aria-autocomplete","list");node.setAttribute("aria-expanded","false");if(node.tagName==="DIV"){node.setAttribute("aria-live","assertive");node.setAttribute("aria-atomic","true")}this._non_ui_mode=true},_suggestions:function(e){e=e||event;var list=this.getList();var trg=e.target||e.srcElement;this._last_input_target=trg;this._settings.master=trg.webix_master_id;window.clearTimeout(this._key_timer);var code=e.keyCode;if(code==16||code==17)return;if(code==9)return this._tab_key(this,list);if(code==27)return this._escape_key(this,list);if(code==13)return this.$enterKey(this,list);if(this._navigate(e)){webix.html.preventEvent(e);return false}if(webix.isUndefined(trg.value))return;clearTimeout(this._last_delay);this._last_delay=webix.delay(function(){if(!this._non_ui_mode&&webix.UIManager.getFocus()!=webix.$$(this._settings.master))return;this._resolve_popup=true;var val=trg.value;if(list.config.dataFeed)list.filter("value",val);else if(list.filter){list.filter(webix.bind(function(item){return this._settings.filter.call(this,item,val)},this))}},this,[],this._settings.keyPressTimeout)},_suggest_after_filter:function(){if(!this._resolve_popup)return true;this._resolve_popup=false;var list=this.getList();if(list.count()>0){this.adjust();if(!this.isVisible())this._dont_unfilter=true;this.show(this._last_input_target,null,true);this._dont_unfilter=false}else{this.hide(true);this._last_input_target=null}},show:function(node){if(!this.isVisible()){var list=this.getList();if(list.filter&&!this._dont_unfilter){list.filter("")}if(this.$customWidth){this.$customWidth(node)}if(node.tagName&&this._settings.fitMaster){this._settings.width=node.offsetWidth-2}if(list._zoom_level)list.render();this.adjust();if(node.tagName=="INPUT")this._last_input_target=node}webix.ui.popup.prototype.show.apply(this,arguments)},_show_selection:function(list){list=list||this.getList();var value=this.getMasterValue();if(list.select&&list.showItem){if(value&&list.exists&&list.exists(value)){list.select(value);list.showItem(value)}else{list.unselect();list.showItem(list.getFirstId())}}else if(list.setValue){if(this._settings.master)value=webix.$$(this._settings.master).$prepareValue(value);list.setValue(value)}},$enterKey:function(popup,list){var value;if(popup.isVisible()){if(list.count&&list.count()){value=list.getSelectedId(false,true);if(list.count()==1&&list.getFirstId()!=value)value=list.getFirstId();if(value)value=list.getItem(value)}else if(list.getSelectedDate&&list.getSelectedDate())value={value:list.getSelectedDate()};else if(list.getValue&&list.getValue())value={value:list.getValue()};if(value)this.setMasterValue(value);popup.hide(true)}else popup.show(this._last_input_target)},_escape_key:function(popup,list){return popup.hide(true)},_tab_key:function(popup,list){return popup.hide(true)},_navigate:function(e){var list=this.getList();var code=e.keyCode;var data;if(list.moveSelection&&code<41&&code>32&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&!e.altKey){if(code===40){var visible=this.isVisible();if(!visible)this.show(this._last_input_target);list.moveSelection("down",false,false)}else{if(list.count&&code!==38||!list.count&&!list.isVisible())return false;var dir;if(code==33)dir="pgup";if(code==34)dir="pgdown";if(code==35)dir="bottom";if(code==36)dir="top";if(code==37)dir="left";if(code==38)dir="up";if(code==39)dir="right";list.moveSelection(dir,false,false)}if(list.count)data=list.getSelectedItem();else if(list.getSelectedDate)data={value:list.getVisibleDate()};else if(list.getValue)data={value:list.getValue()};this._preselectMasterOption(data);return true}return false},getValue:function(){var list=this.getList();var value=(list.getValue?list.getValue():list.getSelectedId())||"";value=value.id||value;if(list.getItem){var item=list.getItem(value);if(item&&item.$empty)return""}return value},setValue:function(value){var list=this.getList();if(value){if(list.exists(value)){list.select(value);list.showItem(value)}}else{list.unselect();list.showItem(list.getFirstId())}}},webix.ui.popup);webix.HTMLOptions={$init:function(config){if(webix.skin.$active.customRadio||this.addOption)webix._event(this.$view,"keydown",this._moveSelection,{bind:this})},_focus:function(){var input=this._getInputNode();if(input)for(var i=0;i<input.length;i++){if(input[i].getAttribute("tabindex")=="0")input[i].focus()}},_blur:function(){var input=this._getInputNode();if(input)for(var i=0;i<input.length;i++){if(input[i].getAttribute("tabindex")=="0")input[i].blur()}},_moveSelection:function(e){var code=e.which||e.keyCode;var startCode=this.addOption?34:36;if(code>startCode&&code<41){webix.html.preventEvent(e);var index;var inp=this._getInputNode();if(code==35)index=inp.length-1;else if(code===36)index=0;else{var dir=code===37||code===38?-1:1;for(var i=0;i<inp.length;i++){if(inp[i].getAttribute("tabindex")=="0"){index=i+dir;if(index<0)index=inp.length-1;else if(index>=inp.length)index=0;break}}}if(!webix.isUndefined(index)){var id=this.addOption?inp[index].getAttribute("button_id"):inp[index].value;if(webix.skin.$active.customRadio&&!this.addOption)inp=this.$view.getElementsByTagName("BUTTON");this.setValue(id);inp[index].focus()}}}};webix.attachEvent("onClick",function(e){var element=webix.$$(e);if(element&&element.touchable){webix.UIManager.applyChanges(element);element.getNode(e);var trg=e.target||e.srcElement;if(trg.className=="webix_disabled")return;var css="";var id=null;var found=false;if(trg.className&&trg.className.toString().indexOf("webix_view")===0)return;if(element)webix.UIManager._focus_action(element);while(trg&&trg.parentNode){if(trg.getAttribute){if(trg.getAttribute("view_id"))break;css=trg.className;if(css){css=css.toString().split(" ");for(var i=0;i<css.length;i++){if(element.on_click[css[i]]){var res=element.on_click[css[i]].call(element,e,element._settings.id,trg);if(res===false)return}}}}trg=trg.parentNode}if(element._settings.click){var code=webix.toFunctor(element._settings.click,element.$scope);if(code&&code.call)code.call(element,element._settings.id,e)}var popup=element._settings.popup;if(element._settings.popup&&!element._settings.readonly){if(typeof popup=="object"&&!popup.name)popup=element._settings.popup=webix.ui(popup)._settings.id;var popup=webix.$$(popup);webix.assert(popup,"Unknown popup");if(!popup.isVisible()){popup._settings.master=element._settings.id;popup.show(element.getInputNode()||element.getNode(),null,true)}}element.callEvent("onItemClick",[element._settings.id,e])}});webix.protoUI({name:"button",touchable:true,$skin:function(){this.defaults.height=webix.skin.$active.buttonHeight||webix.skin.$active.inputHeight;this._labelTopHeight=webix.skin.$active.labelTopHeight||15;this._borderWidth=webix.skin.$active.borderWidth},defaults:{template:function(obj,common){var text=common.$renderInput(obj,common);if(obj.badge)text=text.replace("</button>","<span class='webix_badge'>"+obj.badge+"</span></button>");return"<div class='webix_el_box' style='width:"+obj.awidth+"px; height:"+obj.aheight+"px'>"+text+"</div>"},label:"",borderless:true},$renderInput:function(obj){var css="class='webixtype_"+(obj.type||"base")+"' ";return"<button type='button' "+(obj.popup?"aria-haspopup='true'":"")+css+">"+webix.template.escape(obj.label||obj.value)+"</button>"},$init:function(config){this._viewobj.className+=" webix_control webix_el_"+(this.$cssName||this.name);this.data=this._settings;this._dataobj=this._viewobj;this._calc_size(config)},hotkey_setter:function(key){var control=this;this._addElementHotKey(key,function(view,ev){var elem=control.$view.firstChild;webix.html.triggerEvent(elem,"MouseEvents","click");webix.html.preventEvent(ev)})},_addElementHotKey:function(key,func,view){var keyCode=webix.UIManager.addHotKey(key,func,view);this.attachEvent("onDestruct",function(){webix.UIManager.removeHotKey(keyCode,func,view)})},tooltip_setter:function(value){var box=this._getBox()||this.$view.firstChild;if(box)box.title=value;return value},type_setter:function(value){if(this._types[value])this.$renderInput=webix.template(this._types[value]);if(value=="prev"||value=="next")this._set_inner_size=this._set_inner_size_next;else this._set_inner_size=false;return value},_types:{htmlbutton:"<button type='button' class='webix_el_htmlbutton webixtype_base'>#label#</button>",prev:"<input type='button' class='webixtype_prev' value='#label#' /><div class='webix_el_arrow webixtype_prev_arrow'></div>",next:"<input type='button' class='webixtype_next' value='#label#' /><div class='webix_el_arrow webixtype_next_arrow'></div>",imageButton:"<button type='button' class='webix_img_btn_abs webixtype_base' style='width:100%; line-height:#cheight#px'><div class='webix_image' style='width:#dheight#px;height:#dheight#px;background-image:url(#image#);'> </div> #label#</button>",imageButtonTop:"<button type='button' class='webix_img_btn_abs webix_img_btn_abs_top webixtype_base'><div class='webix_image' style='width:100%;height:100%;background-image:url(#image#);'> </div> <div class='webix_img_btn_text'>#label#</div></button>",image:"<button type='button' class='webix_img_btn' style='line-height:#cheight#px;'><div class='webix_image' style='width:#cheight#px;height:#cheight#px;background-image:url(#image#);'> </div> #label#</button>",imageTop:"<button type='button' class='webix_img_btn_top'><div class='webix_image' style='width:100%;height:100%;background-image:url(#image#);'></div> <div class='webix_img_btn_text'>#label#</div></button>",icon:"<button type='button' class='webix_img_btn' style='line-height:#cheight#px;'><span class='webix_icon_btn fa-#icon#' style='max-width:#cheight#px;'></span>#label#</button>",iconButton:"<button type='button' class='webix_img_btn_abs webixtype_base' style='width:100%;'><span class='webix_icon fa-#icon#'></span> #label#</button>",iconTop:"<button type='button' class='webix_img_btn_top' style='width:100%;top:4px;text-align:center;'><span class='webix_icon fa-#icon#'></span><div class='webix_img_btn_text'>#label#</div></button>",iconButtonTop:"<button type='button' class='webix_img_btn_abs webix_img_btn_abs_top webixtype_base' style='width:100%;top:0px;text-align:center;'><span class='webix_icon fa-#icon#'></span><div class='webix_img_btn_text'>#label#</div></button>"},_findAllInputs:function(){var result=[];var tagNames=["input","select","textarea","button"];for(var i=0;i<tagNames.length;i++){var inputs=this.$view.getElementsByTagName(tagNames[i]);for(var j=0;j<inputs.length;j++){result.push(inputs[j])}}return result},disable:function(){var i,node,elem=this._getBox();webix.ui.baseview.prototype.disable.apply(this,arguments);if(elem&&elem.className.indexOf(" webix_disabled_box")==-1){elem.className+=" webix_disabled_box";var inputs=this._findAllInputs();for(i=0;i<inputs.length;i++)inputs[i].setAttribute("disabled",true);node=this.getInputNode();if(node&&node.tagName.toLowerCase()=="div"){this._disabledTabIndex=node.getAttribute("tabIndex");node.removeAttribute("tabIndex")}if(this._settings.labelPosition=="top"){var label=this._dataobj.firstChild;if(label)label.className+=" webix_disabled_top_label"}}},enable:function(){webix.ui.baseview.prototype.enable.apply(this,arguments);var node,elem=this._getBox();if(elem){elem.className=elem.className.replace(" webix_disabled_box","");var inputs=this._findAllInputs();for(var i=0;i<inputs.length;i++)inputs[i].removeAttribute("disabled");node=this.getInputNode();if(node&&!webix.isUndefined(this._disabledTabIndex))node.setAttribute("tabIndex",this._disabledTabIndex);if(this._settings.labelPosition=="top"){var label=this._dataobj.firstChild;if(label)label.className=label.className.replace(" webix_disabled_top_label","")}}},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)){this.render()}},setValue:function(value){value=this.$prepareValue(value);var oldvalue=this._settings.value;if(this.$compareValue(oldvalue,value))return false;this._settings.value=value;if(this._rendered_input)this.$setValue(value);this.callEvent("onChange",[value,oldvalue])},$compareValue:function(oldvalue,value){return oldvalue==value},$prepareValue:function(value){return this._pattern(value,false)},_pattern:function(value){return value},$setValue:function(value){(this.getInputNode()||{}).value=value},getValue:function(){var value=this._rendered_input?this.$getValue():this._settings.value;return typeof value=="undefined"?"":value},$getValue:function(){return this._settings.value||""},focus:function(){if(!this._settings.disabled){var input=this.getInputNode();if(input&&input.focus)input.focus()}},blur:function(){var input=this.getInputNode();if(input&&input.blur)input.blur()},getInputNode:function(){return this._dataobj.getElementsByTagName("input")[0]||this._dataobj.getElementsByTagName("button")[0]},_getBox:function(){for(var i=0;i<this._dataobj.childNodes.length;i++){if(this._dataobj.childNodes[i].className.indexOf("webix_el_box")>=0)return this._dataobj.childNodes[i]}return null},_sqrt_2:Math.sqrt(2),_set_inner_size_next:function(){var cfg=this._settings;var arrow=this._getBox().childNodes[1];var button=arrow.previousSibling;var style=cfg.type=="next"?"right":"left";var height=cfg.aheight-webix.skin.$active.inputPadding*2-2*this._borderWidth;var arrowEdge=height*this._sqrt_2/2;arrow.style.width=arrowEdge+"px";arrow.style.height=arrowEdge+"px";arrow.style.top=(height-arrowEdge)/2+webix.skin.$active.inputPadding+"px";arrow.style[style]=(height-arrowEdge)/2+this._sqrt_2/2+"px";button.style.width=cfg.awidth-height/2-2+"px";button.style.height=height+2+"px";button.style[style]=height/2+2+"px";button.style.top=webix.skin.$active.inputPadding+"px"},_calc_size:function(config){config=config||this._settings;if(config.autowidth)config.width=webix.html.getTextSize(config.value||config.label,"webixbutton").width+(config.badge?15:0)+(config.type==="iconButton"?30:0)+(config.type==="icon"?20:0)},_calck_input_size:function(){this._input_width=this._settings.inputWidth||(this._content_width-this._settings.width>2?this._settings.width:0)||this._content_width;this._input_height=this._settings.inputHeight||this._inputHeight||0},resize:function(){this._calc_size();return webix.ui.view.prototype.resize.apply(this,arguments)},render:function(){this._calck_input_size();this._settings.awidth=this._input_width||this._content_width;this._settings.aheight=this._input_height||this._content_height;this._settings.bheight=this._settings.aheight+2;this._settings.cheight=this._settings.aheight-2*webix.skin.$active.inputPadding;this._settings.dheight=this._settings.cheight-2;if(webix.AtomRender.render.call(this)){this._rendered_input=true;if(this._set_inner_size)this._set_inner_size();if(this._settings.align){var handle=this._dataobj.firstChild;if(this._settings.labelPosition=="top"&&handle.nextSibling)handle=handle.nextSibling;switch(this._settings.align){case"right":handle.style.cssFloat="right";break;case"center":handle.style.display="inline-block";handle.parentNode.style.textAlign="center";break;case"middle":handle.style.marginTop=Math.round((this._content_height-this._input_height)/2)+"px";break;case"bottom":handle.style.marginTop=this._content_height-this._input_height+"px";break;case"left":handle.style.cssFloat="left";break;default:webix.assert(false,"Unknown align mode: "+this._settings.align);break}}if(this.$render)this.$render(this.data);if(this._settings.disabled)this.disable();if(this._settings.tooltip)this.define("tooltip",this._settings.tooltip);if(this._init_once){this._init_once(this.data);this._init_once=0}}},refresh:function(){this.render()},on_click:{_handle_tab_click:function(ev,button){var id=webix.html.locate(ev,"button_id");if(id&&this.callEvent("onBeforeTabClick",[id,ev])){this.setValue(id);this.callEvent("onAfterTabClick",[id,ev])}},webix_all_segments:function(ev,button){this.on_click._handle_tab_click.call(this,ev,button)},webix_all_tabs:function(ev,button){this.on_click._handle_tab_click.call(this,ev,button)},webix_inp_counter_next:function(e,obj,node){if(!this._settings.readonly)this.next()},webix_inp_counter_prev:function(e,obj,node){if(!this._settings.readonly)this.prev()},webix_input_icon:function(e,obj,node){this.getInputNode().focus()},webix_inp_checkbox_border:function(e,obj,node){if(!this._settings.disabled&&(e.target||e.srcElement).tagName!="DIV"&&!this._settings.readonly)this.toggle()},webix_inp_checkbox_label:function(e,obj,node){if(!this._settings.readonly)this.toggle()},webix_inp_radio_border:function(e,obj,node){var value=webix.html.locate(e,"radio_id");this.setValue(value)},webix_inp_radio_label:function(e,obj,node){node=node.parentNode.getElementsByTagName("input")[0];return this.on_click.webix_inp_radio_border.call(this,node,obj,node)},webix_tab_more_icon:function(ev,obj,node){this.getPopup().resize();this.getPopup().show(node,null,true)},webix_tab_close:function(ev,obj,node){var id=webix.html.locate(ev,"button_id");if(id&&this.callEvent("onBeforeTabClose",[id,ev]))this.removeOption(id)}},_check_options:function(opts){webix.assert(opts,this.name+": options not defined");for(var i=0;i<opts.length;i++){webix.assert(!opts[i].text,"Please replace .text with .value in control config");webix.assert(!opts[i].label,"Please replace .label with .value in control config");if(typeof opts[i]=="string"){opts[i]={id:opts[i],value:opts[i]}}else{if(webix.isUndefined(opts[i].id))opts[i].id=opts[i].value;if(webix.isUndefined(opts[i].value))opts[i].value=opts[i].id}}return opts},_get_div_placeholder:function(obj){var placeholder=obj?obj.placeholder:this._settings.placeholder;return placeholder?"<span class='webix_placeholder'>"+placeholder+"</span>":""}},webix.ui.view,webix.AtomRender,webix.Settings,webix.EventSystem);webix.protoUI({name:"label",defaults:{template:"<div style='height:100%;line-height:#cheight#px'>#label#</div>"},$skin:function(){this.defaults.height=webix.skin.$active.inputHeight},focus:function(){return false},_getBox:function(){return this._dataobj.firstChild},setHTML:function(html){this._settings.template=function(){return html};this.refresh()},setValue:function(value){this._settings.label=value;webix.ui.button.prototype.setValue.apply(this,arguments)},$setValue:function(value){this._dataobj.firstChild.innerHTML=value},_set_inner_size:function(){}},webix.ui.button);webix.protoUI({name:"icon",$skin:function(){this.defaults.height=webix.skin.$active.inputHeight},defaults:{template:function(obj){return"<button type='button' "+" style='height:100%;width:100%;' class='webix_icon_button'><span class='webix_icon fa-"+obj.icon+" '></span>"+(obj.badge?"<span class='webix_badge'>"+obj.badge+"</span>":"")+"</button>"},width:33},_set_inner_size:function(){}},webix.ui.button);webix.protoUI({name:"text",_allowsClear:true,_init_onchange:function(){if(this._allowsClear){if(!this._onBlur)webix._event(this.getInputNode(),"change",this._applyChanges,{bind:this});if(this._settings.suggest)webix.$$(this._settings.suggest).linkInput(this)}},_applyChanges:function(){var newvalue=this.getValue();if(newvalue!=this._settings.value)this.setValue(newvalue,true)},$skin:function(){this.defaults.height=webix.skin.$active.inputHeight;this.defaults.inputPadding=webix.skin.$active.inputPadding;this._inputSpacing=webix.skin.$active.inputSpacing},$init:function(config){if(config.labelPosition=="top")if(webix.isUndefined(config.height)&&this.defaults.height)config.height=this.defaults.height+this._labelTopHeight;this._destroy_with_me=[];this.attachEvent("onAfterRender",this._init_onchange);this.attachEvent("onBlur",function(){if(this._onBlur)this._onBlur()})},$renderIcon:function(){var config=this._settings;if(config.icon){var height=config.aheight-2*config.inputPadding,padding=(height-18)/2-1,aria=this.addSection?"role='button' tabindex='0' aria-label='"+webix.i18n.aria["multitext"+(config.mode||"")+"Section"]+"'":"";return"<span style='height:"+(height-padding)+"px;padding-top:"+padding+"px;' class='webix_input_icon fa-"+config.icon+"' "+aria+"></span>"}return""},relatedView_setter:function(value){this.attachEvent("onChange",function(){var value=this.getValue();var mode=this._settings.relatedAction;var viewid=this._settings.relatedView;var view=webix.$$(viewid);if(!view){var top=this.getTopParentView();if(top&&top.$$)view=top.$$(viewid)}webix.assert(view,"Invalid relatedView: "+viewid);if(mode=="enable"){if(value)view.enable();else view.disable()}else{if(value)view.show();else view.hide()}});return value},validateEvent_setter:function(value){if(value=="blur")this.attachEvent("onBlur",this.validate);if(value=="key")this.attachEvent("onTimedKeyPress",this.validate);return value},validate:function(){var rule=this._settings.validate;if(!rule&&this._settings.required)rule=webix.rules.isNotEmpty;var form=this.getFormView();var name=this._settings.name;var value=this.getValue();var data={};data[name]=value;webix.assert(form,"Validation works only for fields in the form");webix.assert(name,"Validation works only for fields with name");if(rule&&!form._validate(rule,value,data,name))return false;return true},bottomLabel_setter:function(value){if(!this._settings.bottomPadding)this._settings.bottomPadding=18;return value},_getInvalidText:function(){var text=this._settings.invalidMessage;if(typeof text=="function"){text.call(this)}return text},setBottomText:function(text,height){var config=this._settings;if(typeof text!="undefined"){if(config.bottomLabel==text)return;config.bottomLabel=text}var message=(config.invalid?config.invalidMessage:"")||config.bottomLabel;if(!message&&!config.bottomPadding)config.inputHeight=0;if(message&&!config.bottomPadding){this._restorePadding=1;config.bottomPadding=config.bottomPadding||height||18;this.render();this.resize()}else if(!message&&this._restorePadding){config.bottomPadding=this._restorePadding=0;if(!config.height)this.render();this.resize()}else this.render()},$getSize:function(){var sizes=webix.ui.view.prototype.$getSize.apply(this,arguments);var heightInc=this.config.bottomPadding;if(heightInc){sizes[2]+=heightInc;sizes[3]+=heightInc}return sizes},$setSize:function(x,y){var config=this._settings;if(webix.ui.view.prototype.$setSize.call(this,x,y)){if(!x||!y)return;if(config.labelPosition=="top"){if(!config.inputHeight)this._inputHeight=this._content_height-this._labelTopHeight-(this.config.bottomPadding||0);config.labelWidth=0}else if(config.bottomPadding){config.inputHeight=this._content_height-this.config.bottomPadding}this.render()}},_get_input_width:function(config){var width=(this._input_width||0)-(config.label?this._settings.labelWidth:0)-this._inputSpacing-(config.iconWidth||0);return width<0?0:width},_render_div_block:function(obj,common){var id="x"+webix.uid();var width=common._get_input_width(obj);var inputAlign=obj.inputAlign||"left";var icon=this.$renderIcon?this.$renderIcon(obj):"";var height=this._settings.aheight-2*webix.skin.$active.inputPadding-2*this._borderWidth;var text=obj.text||obj.value||this._get_div_placeholder(obj);var html="<div class='webix_inp_static' role='combobox' aria-label='"+webix.template.escape(obj.label)+"' tabindex='0'"+(obj.readonly?" aria-readonly='true'":"")+(obj.invalid?"aria-invalid='true'":"")+" onclick='' style='line-height:"+height+"px;width: "+width+"px; text-align: "+inputAlign+";' >"+text+"</div>";return common.$renderInput(obj,html,id)},_baseInputHTML:function(tag){var html="<"+tag+(this._settings.placeholder?" placeholder='"+this._settings.placeholder+"' ":" ");if(this._settings.readonly)html+="readonly='true' aria-readonly=''";if(this._settings.required)html+="aria-required='true'";if(this._settings.invalid)html+="aria-invalid='true'";var attrs=this._settings.attributes;if(attrs)for(var prop in attrs)html+=prop+"='"+attrs[prop]+"' ";return html},$renderLabel:function(config,id){var labelAlign=config.labelAlign||"left";var top=this._settings.labelPosition=="top";var labelTop=top?"display:block;":"width: "+this._settings.labelWidth+"px;";var label="";var labelHeight=top?this._labelTopHeight-2*this._borderWidth:this._settings.aheight-2*this._settings.inputPadding;if(config.label)label="<label style='"+labelTop+"text-align: "+labelAlign+";line-height:"+labelHeight+"px;' onclick='' for='"+id+"' class='webix_inp_"+(top?"top_":"")+"label "+(config.required?"webix_required":"")+"'>"+(config.label||"")+"</label>";return label},$renderInput:function(config,div_start,id){var inputAlign=config.inputAlign||"left";var top=config.labelPosition=="top";var inputWidth=this._get_input_width(config);id=id||webix.uid();var label=this.$renderLabel(config,id);var html="";if(div_start){html+=div_start}else{var value=webix.template.escape(config.text||this._pattern(config.value)||(config.value===0?"0":""));html+=this._baseInputHTML("input")+"id='"+id+"' type='"+(config.type||this.name)+"'"+(config.editable?" role='combobox'":"")+" value='"+value+"' style='width: "+inputWidth+"px; text-align: "+inputAlign+";'";var attrs=config.attributes;if(attrs)for(var prop in attrs)html+=" "+prop+"='"+attrs[prop]+"'";html+=" />"}var icon=this.$renderIcon?this.$renderIcon(config):"";html+=icon;var result="";if(top)result=label+"<div class='webix_el_box' style='width:"+config.awidth+"px; height:"+config.aheight+"px'>"+html+"</div>";else result="<div class='webix_el_box' style='width:"+config.awidth+"px; height:"+config.aheight+"px'>"+label+html+"</div>";var padding=config.awidth-inputWidth-webix.skin.$active.inputPadding*2;var message=(config.invalid?config.invalidMessage:"")||config.bottomLabel;if(message)result+="<div class='webix_inp_bottom_label'"+(config.invalid?"role='alert' aria-relevant='all'":"")+" style='width:"+(inputWidth||config.awidth)+"px;margin-left:"+Math.max(padding,webix.skin.$active.inputPadding)+"px;'>"+message+"</div>";return result},defaults:{template:function(obj,common){return common.$renderInput(obj)},label:"",labelWidth:80},type_setter:function(value){return value},_set_inner_size:false,$setValue:function(value){this.getInputNode().value=this._pattern(value)},$getValue:function(){return this._pattern(this.getInputNode().value,false)},suggest_setter:function(value){if(value){webix.assert(value!==true,"suggest options can't be set as true, data need to be provided instead");if(typeof value=="string"){var attempt=webix.$$(value);if(attempt)return webix.$$(value)._settings.id;value={body:{url:value,dataFeed:value}}}else if(webix.isArray(value))value={body:{data:this._check_options(value)}};else if(!value.body)value.body={};webix.extend(value,{view:"suggest"});var view=webix.ui(value);this._destroy_with_me.push(view);return view._settings.id}return false}},webix.ui.button);webix.protoUI({name:"segmented",_allowsClear:false,$init:function(){this.attachEvent("onChange",function(value){if(this._settings.multiview)this._show_view(value)});this.attachEvent("onAfterRender",webix.once(function(){if(this._settings.multiview&&this._settings.value)this._show_view(this._settings.value)}))},_show_view:function(value){var top=this.getTopParentView();var view=null;if(top&&top.$$)view=top.$$(value);if(!view)view=webix.$$(value);if(view&&view.show)view.show()},defaults:{template:function(obj,common){if(!obj.options)webix.assert(false,"segmented: options undefined");var options=obj.options;common._check_options(options);options=common._filterOptions(options);var width=common._get_input_width(obj);var id=webix.uid();var html="<div style='width:"+width+"px' class='webix_all_segments' role='tablist' aria-label='"+webix.template.escape(obj.label)+"'>";var optionWidth=obj.optionWidth||Math.floor(width/options.length);if(!obj.value)obj.value=options[0].id;for(var i=0;i<options.length;i++){html+="<button type='button' style='width:"+(options[i].width||optionWidth)+"px' role='tab' aria-selected='"+(obj.value==options[i].id?"true":"false")+"' tabindex='"+(obj.value==options[i].id?"0":"-1")+"'";html+="class='"+"webix_segment_"+(i==options.length-1?"N":i>0?1:0)+(obj.value==options[i].id?" webix_selected ":"")+"' button_id='"+options[i].id+"' >";html+=options[i].value+"</button>"}return common.$renderInput(obj,html+"</div>",id)}},_getInputNode:function(){return this.$view.getElementsByTagName("BUTTON")},focus:function(){this._focus()},blur:function(){this._blur()},$setValue:function(value){var options=this._getInputNode();for(var i=0;i<options.length;i++){var id=options[i].getAttribute("button_id");options[i].setAttribute("aria-selected",value==id?"true":"false");options[i].setAttribute("tabindex",value==id?"0":"-1");if(value==id)webix.html.addCss(options[i],"webix_selected");else webix.html.removeCss(options[i],"webix_selected")}var popup=this.config.tabbarPopup;if(popup&&webix.$$(popup)&&webix.$$(popup).getBody().exists(value))this.refresh()},getValue:function(){return this._settings.value},getInputNode:function(){return null},optionIndex:function(id){var pages=this._settings.options;for(var i=0;i<pages.length;i++)if(pages[i].id==id)return i;return-1},addOption:function(id,value,show,index){var obj=id;if(typeof id!="object"){value=value||id;obj={id:id,value:value}}else{id=obj.id;index=show;show=value}if(this.optionIndex(id)<0)webix.PowerArray.insertAt.call(this._settings.options,obj,index);this.refresh();if(show)this.setValue(id)},removeOption:function(id,value){var index=this.optionIndex(id);var options=this._settings.options;if(index>=0)webix.PowerArray.removeAt.call(options,index);if(this._settings.value==id)this._setNextVisible(options,index);this.refresh();this.callEvent("onOptionRemove",[id,this._settings.value])},_setNextVisible:function(options,index){var size=options.length;if(size){index=Math.min(index,size-1);for(var i=index;i<size;i++)if(!options[i].hidden)return this.setValue(options[i].id);for(var i=index;i>=0;i--)if(!options[i].hidden)return this.setValue(options[i].id)}this.setValue("")},_filterOptions:function(options){var copy=[];for(var i=0;i<options.length;i++)if(!options[i].hidden)copy.push(options[i]);return copy},_setOptionVisibility:function(id,state){var options=this._settings.options;var index=this.optionIndex(id);var option=options[index];if(option&&state==!!option.hidden){option.hidden=!state;if(state||this._settings.value!=id){this.refresh()}else{this._setNextVisible(options,index)}}},hideOption:function(id){this._setOptionVisibility(id,false)},showOption:function(id){this._setOptionVisibility(id,true)},_set_inner_size:false},webix.HTMLOptions,webix.ui.text);webix.protoUI({name:"search",$init:function(){this.on_click["fa-search"]=function(e){this.callEvent("onSearchIconClick",[e])}},$skin:function(){this.defaults.inputPadding=webix.skin.$active.inputPadding},defaults:{type:"text",icon:"search"}},webix.ui.text);webix.protoUI({name:"toggle",_allowsClear:true,$init:function(){this.attachEvent("onItemClick",function(){this.toggle()})},$setValue:function(value){var input=this.getInputNode();var obj=this._settings;var isPressed=value&&value!="0";var text=(isPressed?obj.onLabel:obj.offLabel)||obj.label;input.setAttribute("aria-pressed",isPressed?"true":false);input.value=text;if(input.lastChild)input.lastChild.nodeValue=" "+text;if(input.firstChild&&input.firstChild.nodeName==="SPAN"&&obj.onIcon&&obj.offIcon&&obj.onIcon!==obj.offIcon)input.firstChild.className=input.firstChild.className.replace(isPressed?obj.offIcon:obj.onIcon,isPressed?obj.onIcon:obj.offIcon);var parent=input.parentNode;if(isPressed)webix.html.addCss(parent,"webix_pressed");else webix.html.removeCss(parent,"webix_pressed")},toggle:function(){this.setValue(!this.getValue())},getValue:function(){var value=this._settings.value;return!value||value=="0"?0:1},defaults:{template:function(obj,common){var isPressed=obj.value&&obj.value!="0";var css=isPressed?" webix_pressed":"";obj.label=(isPressed?obj.onLabel:obj.offLabel)||obj.label;obj.icon=(isPressed?obj.onIcon:obj.offIcon)||obj.icon;var html="<div class='webix_el_box"+css+"' style='width:"+obj.awidth+"px; height:"+obj.aheight+"px'>"+common.$renderInput(obj,common)+"</div>";html=html.replace(/(button)\s*(?=\w)/,"$1"+(" aria-pressed='"+(isPressed?"true":"false")+"' "));return html}},_set_inner_size:false},webix.ui.button);webix.protoUI({name:"select",defaults:{template:function(obj,common){var options=common._check_options(obj.options);var id="x"+webix.uid();var html=common._baseInputHTML("select")+"id='"+id+"' style='width:"+common._get_input_width(obj)+"px;'>";var optview=webix.$$(options);if(optview&&optview.data&&optview.data.each){optview.data.each(function(option){html+="<option"+(option.id==obj.value?" selected='true'":"")+" value='"+option.id+"'>"+option.value+"</option>"})}else for(var i=0;i<options.length;i++){html+="<option"+(options[i].id==obj.value?" selected='true'":"")+" value='"+options[i].id+"'>"+options[i].value+"</option>"}html+="</select>";return common.$renderInput(obj,html,id)}},options_setter:function(value){if(value){if(typeof value=="string"){var collection=new webix.DataCollection({url:value});collection.data.attachEvent("onStoreLoad",webix.bind(this.refresh,this));return collection}else return value}},getInputNode:function(){return this._dataobj.getElementsByTagName("select")[0]}},webix.ui.text);webix.protoUI({name:"textarea",defaults:{template:function(obj,common){var name=obj.name||obj.id;var id="x"+webix.uid();var html=common._baseInputHTML("textarea")+"style='width:"+common._get_input_width(obj)+"px;'";html+=" id='"+id+"' name='"+name+"' class='webix_inp_textarea'>"+common._pattern(obj.value||(obj.value===0?"0":""))+"</textarea>";return common.$renderInput(obj,html,id)},height:0,minHeight:60},$skin:function(){this.defaults.inputPadding=webix.skin.$active.inputPadding;this._inputSpacing=webix.skin.$active.inputSpacing},_skipSubmit:true,$renderLabel:function(config,id){var labelAlign=config.labelAlign||"left";var top=this._settings.labelPosition=="top";var labelTop=top?"display:block;":"width: "+this._settings.labelWidth+"px;";var label="";var labelHeight=top?this._labelTopHeight-2*this._borderWidth:(webix.skin.$active.inputHeight||this._settings.aheight)-2*this._settings.inputPadding;if(config.label)label="<label style='"+labelTop+"text-align: "+labelAlign+";' onclick='' for='"+id+"' class='webix_inp_"+(top?"top_":"")+"label "+(config.required?"webix_required":"")+"'>"+(config.label||"")+"</label>";return label},getInputNode:function(){return this._dataobj.getElementsByTagName("textarea")[0]}},webix.ui.text);webix.protoUI({name:"counter",defaults:{template:function(config,common){var value=config.value||0;var id="x"+webix.uid();var html="<div role='spinbutton' aria-label='"+webix.template.escape(config.label)+"' aria-valuemin='"+config.min+"' aria-valuemax='"+config.max+"' aria-valuenow='"+config.value+"' class='webix_el_group' style='width:"+common._get_input_width(config)+"px'>";html+="<button type='button' class='webix_inp_counter_prev' tabindex='-1' aria-label='"+webix.i18n.aria.decreaseValue+"'>-</button>";html+=common._baseInputHTML("input")+" id='"+id+"' type='text' class='webix_inp_counter_value' aria-live='assertive'"+" value='"+value+"'></input>";html+="<button type='button' class='webix_inp_counter_next' tabindex='-1' aria-label='"+webix.i18n.aria.increaseValue+"'>+</button></div>";return common.$renderInput(config,html,id)},min:0,max:Infinity,step:1},$init:function(){webix._event(this.$view,"keydown",this._keyshift,{bind:this})},_keyshift:function(e){var code=e.which||e.keyCode,c=this._settings,value=c.value||c.min;if(code>32&&code<41){if(code===35)value=c.min;else if(code===36)value=c.max===Infinity?1e6:c.max;else if(code===33)this.next();else if(code===34)this.prev();else value=value+(code===37||code===40?-1:1);if(code>34&&value>=c.min&&value<=c.max)this.setValue(value)}},$setValue:function(value){this.getInputNode().value=value},getInputNode:function(){return this._dataobj.getElementsByTagName("input")[0]},getValue:function(obj){return webix.ui.button.prototype.getValue.apply(this,arguments)*1},next:function(step){step=this._settings.step;this.shift(step)},prev:function(step){step=-1*this._settings.step;this.shift(step)},shift:function(step){var min=this._settings.min;var max=this._settings.max;var new_value=this.getValue()+step;if(new_value>=min&&new_value<=max)this.setValue(new_value)}},webix.ui.text);webix.protoUI({name:"checkbox",defaults:{checkValue:1,uncheckValue:0,template:function(config,common){var id="x"+webix.uid();var rightlabel="";if(config.labelRight){rightlabel="<label class='webix_label_right'>"+config.labelRight+"</label>";if(config.labelWidth)config.label=config.label||"&nbsp;"}var checked=config.checkValue==config.value;var margin=Math.floor((common._settings.aheight-16)/2);var ch=common._baseInputHTML("input")+"style='margin-top:"+margin+"px;"+(config.customCheckbox?"display:none":"")+"' id='"+id+"' type='checkbox' "+(checked?"checked='1'":"")+(config.labelRight?" aria-label='"+webix.template.escape(config.labelRight)+"'":"")+"/>";var className="webix_inp_checkbox_border webix_el_group webix_checkbox_"+(checked?"1":"0");var customCheckbox=config.customCheckbox||"";if(customCheckbox){customCheckbox=customCheckbox.replace(/(aria-checked=')\w*(?=')/,"$1"+(config.value==config.checkValue?"true":"false"));customCheckbox=customCheckbox.replace(/(aria-label=')\w*(?=')/,"$1"+webix.template.escape(config.labelRight||config.label));customCheckbox=customCheckbox.replace(/(aria-invalid=')\w*(?=')/,"$1"+(config.invalid?"true":"false"))}var html="<div style='line-height:"+common._settings.cheight+"px' class='"+className+"'>"+ch+customCheckbox+rightlabel+"</div>";return common.$renderInput(config,html,id)}},customCheckbox_setter:function(value){if(value===true&&webix.skin.$active.customCheckbox){value="<a role='presentation' onclick='javascript:void(0)'><button role='checkbox' aria-checked='false' aria-label='' type='button' aria-invalid='' class='webix_custom_checkbox'></button></a>"}return value},focus:function(){var input=this.$view.getElementsByTagName(this._settings.customCheckbox?"button":"input")[0];if(input)input.focus()},blur:function(){var input=this.$view.getElementsByTagName(this._settings.customCheckbox?"button":"input")[0];if(input)input.blur()},_init_onchange:function(){},$setValue:function(value){var isChecked=value==this._settings.checkValue;var parentNode=this.getInputNode()?this.getInputNode().parentNode:null;if(parentNode&&this._settings.customCheckbox){var button=parentNode.getElementsByTagName("BUTTON");if(button[0])button[0].setAttribute("aria-checked",isChecked?"true":"false")}if(parentNode){parentNode.className=parentNode.className.replace(/(webix_checkbox_)\d/,"$1"+(isChecked?1:0))}this.getInputNode().checked=isChecked},toggle:function(){var value=this.getValue()!=this._settings.checkValue?this._settings.checkValue:this._settings.uncheckValue;this.setValue(value)},getValue:function(){var value=this._settings.value;return value==this._settings.checkValue?this._settings.checkValue:this._settings.uncheckValue},$skin:function(){if(webix.skin.$active.customCheckbox)this.defaults.customCheckbox=true}},webix.ui.text);webix.protoUI({name:"radio",defaults:{template:function(config,common){var options=common._check_options(config.options);var html=[];var id;for(var i=0;i<options.length;i++){var eachid="x"+webix.uid();id=id||eachid;if(i&&(options[i].newline||config.vertical))html.push("<div class='webix_line_break'></div>");var isChecked=options[i].id==config.value;var label=options[i].value||"";var customRadio=config.customRadio||"";if(customRadio){var optlabel=(i===0?config.label+" ":"")+label;customRadio=customRadio.replace(/(aria-label=')\w*(?=')/,"$1"+webix.template.escape(optlabel));customRadio=customRadio.replace(/(aria-checked=')\w*(?=')/,"$1"+(isChecked?"true":"false"));customRadio=customRadio.replace(/(tabindex=')\w*(?=')/,"$1"+(isChecked||i===0&&!config.value?"0":"-1"));customRadio=customRadio.replace(/(aria-invalid=')\w*(?=')/,"$1"+(config.invalid?"true":"false"))}var rd=common._baseInputHTML("input")+" name='"+(config.name||config.id)+"' type='radio' "+(isChecked?"checked='1'":"")+"tabindex="+(isChecked||i===0&&!config.value?"0":"-1")+" value='"+options[i].id+"' id='"+eachid+"' style='"+(customRadio?"display:none":"")+"' />";var input="<div radio_id='"+options[i].id+"' class='webix_inp_radio_border webix_radio_"+(isChecked?"1":"0")+"' role='presentation'>"+rd+customRadio+"</div>";if(label)label="<label for='"+eachid+"' class='webix_label_right'>"+label+"</label>";html.push("<div class='webix_radio_option' role='presentation'>"+input+label+"</div>")}html="<div class='webix_el_group' role='radiogroup' style='margin-left:"+(config.label?config.labelWidth:0)+"px;'>"+html.join("")+"</div>";return common.$renderInput(config,html,id)}},refresh:function(){this.render();if(this._last_size&&this.$getSize(0,0)[2]!=this._last_size[1])this.resize()},$getSize:function(dx,dy){var size=webix.ui.button.prototype.$getSize.call(this,dx,dy);if(this._settings.options){var count=this._settings.vertical?0:1;for(var i=0;i<this._settings.options.length;i++)if(this._settings.vertical||this._settings.options[i].newline)count++;size[3]=size[2]=Math.max(size[2],(this._settings.optionHeight||25)*count+this._settings.inputPadding*2+(this._settings.labelPosition=="top"?this._labelTopHeight:0))}var heightInc=this.config.bottomPadding;if(heightInc){size[2]+=heightInc;size[3]+=heightInc}return size},_getInputNode:function(){return this._dataobj.getElementsByTagName("input")},$setValue:function(value){var inp=this._getInputNode();for(var i=0;i<inp.length;i++){if(inp[i].parentNode.getAttribute("radio_id")==value){inp[i].className="webix_inp_radio_on";inp[i].checked=true;inp[i].setAttribute("tabindex","0")}else{inp[i].className="webix_inp_radio_on webix_hidden";inp[i].checked=false;inp[i].setAttribute("tabindex","-1")}var parentNode=inp[i]?inp[i].parentNode:null;if(parentNode){parentNode.className=parentNode.className.replace(/(webix_radio_)\d/,"$1"+(inp[i].checked?1:0));if(this._settings.customRadio){var button=parentNode.getElementsByTagName("BUTTON");if(button[0]){button[0].setAttribute("aria-checked",inp[i].checked?"true":"false");button[0].setAttribute("tabindex",inp[i].checked?"0":"-1")}}}}},getValue:function(obj){return this._settings.value},focus:function(){this._focus()},blur:function(){this._blur()},customRadio_setter:function(value){if(value===true&&webix.skin.$active.customRadio)value="<a role='presentation' onclick='javascript:void(0)'><button type='button' class='webix_custom_radio' role='radio' aria-checked='false' aria-label='' aria-invalid='' tabindex=''></button></a>";return value},$skin:function(){if(webix.skin.$active.customRadio)this.defaults.customRadio=true;if(webix.skin.$active.optionHeight)this.defaults.optionHeight=webix.skin.$active.optionHeight}},webix.HTMLOptions,webix.ui.text);webix.protoUI({name:"richselect",defaults:{template:function(obj,common){return common._render_div_block(obj,common)},popupWidth:200,icon:"angle-down"},_onBlur:function(){if(this._settings.text==this.getText()||webix.isUndefined(this._settings.text)&&!this.getText())return;var suggest=this.getPopup(),value=suggest.getSuggestion();if(value&&!(this.getInputNode().value===""&&suggest.getItemText(value)!==""))this.setValue(value);else if(this._revertValue)this._revertValue()},suggest_setter:function(value){return this.options_setter(value)},options_setter:function(value){value=this._suggest_config?this._suggest_config(value):value;var suggest=this._settings.popup=this._settings.suggest=webix.ui.text.prototype.suggest_setter.call(this,value);var list=webix.$$(suggest).getList();if(list)list.attachEvent("onAfterLoad",webix.bind(this._reset_value,this));return suggest},getList:function(){var suggest=webix.$$(this._settings.suggest);webix.assert(suggest,"Input doesn't have a list");return suggest.getList()},_reset_value:function(){var value=this._settings.value;if(!webix.isUndefined(value)&&!this.getPopup().isVisible()&&!this._settings.text&&this._dataobj.firstChild)this.$setValue(value)},$skin:function(){this.defaults.inputPadding=webix.skin.$active.inputPadding},$render:function(obj){if(webix.isUndefined(obj.value))return;this.$setValue(obj.value)},getInputNode:function(){return this._dataobj.getElementsByTagName("DIV")[1]},getPopup:function(){return webix.$$(this._settings.popup)},getText:function(){var value=this._settings.value,node=this.getInputNode();if(!node)return value?this.getPopup().getItemText(value):"";return typeof node.value=="undefined"?this.getValue()?node.innerHTML:"":node.value},$setValue:function(value){if(!this._rendered_input)return;var text=value;var popup=this.getPopup();if(popup)var text=this.getPopup().getItemText(value);if(!text&&value&&value.id){this.getPopup().getList().add(value);text=this.getPopup().getItemText(value.id);this._settings.value=value.id}var node=this.getInputNode();if(webix.isUndefined(node.value))node.innerHTML=text||this._get_div_placeholder();else node.value=text=text.replace(/<[^>]*>/g,"");this._settings.text=text},getValue:function(){return this._settings.value||""}},webix.ui.text);webix.protoUI({name:"combo",getInputNode:function(){return this._dataobj.getElementsByTagName("input")[0]},$render:function(obj){if(webix.isUndefined(obj.value))return;this.$setValue(obj.value)},_revertValue:function(){if(!this._settings.editable){var value=this.getValue();this.$setValue(webix.isUndefined(value)?"":value)}},_applyChanges:function(){var input=this.getInputNode(),value="",suggest=this.getPopup();if(input.value){value=this._settings.value;if(suggest.getItemText(value)!=this.getText())value=suggest.getSuggestion()||value}if(value!=this._settings.value)this.setValue(value,true);else this.$setValue(value)},defaults:{template:function(config,common){return common.$renderInput(config).replace(/(<input)\s*(?=\w)/,"$1"+" role='combobox'")},icon:"angle-down"}},webix.ui.richselect);webix.protoUI({name:"datepicker",$init:function(){this.$ready.push(this._init_popup)},defaults:{template:function(obj,common){if(common._settings.type=="time"){common._settings.icon=common._settings.timeIcon}var t=obj.type;obj.type="";var res=obj.editable?common.$renderInput(obj):common._render_div_block(obj,common);obj.type=t;return res},stringResult:false,timepicker:false,icon:"calendar",icons:true,timeIcon:"clock-o"},_onBlur:function(){if(this._settings.text==this.getText()||webix.isUndefined(this._settings.text)&&!this.getText())return;var value=this.getPopup().getValue();if(value)this.setValue(value)},$skin:function(){this.defaults.inputPadding=webix.skin.$active.inputPadding},getPopup:function(){return webix.$$(this._settings.popup)},_init_popup:function(){var obj=this._settings;if(obj.suggest)obj.popup=obj.suggest;else if(!obj.popup){var timepicker=this._settings.timepicker;obj.popup=obj.suggest=this.suggest_setter({type:"calendar",height:240+(timepicker?30:0),width:250,padding:0,body:{timepicker:timepicker,type:this._settings.type,icons:this._settings.icons}})}this._init_once=function(){}},$render:function(obj){if(webix.isUndefined(obj.value))return;obj.value=this.$prepareValue(obj.value);this.$setValue(obj.value)},$prepareValue:function(value){var type=this._settings.type;var timeMode=type=="time";if(!isNaN(parseFloat(value)))value=""+value;if(typeof value=="string"&&value){var formatDate=null;if((type=="month"||type=="year")&&this._formatDate){formatDate=this._formatDate}else formatDate=timeMode?webix.i18n.parseTimeFormatDate:webix.i18n.parseFormatDate;value=formatDate(value)}if(value){if(timeMode){if(webix.isArray(value)){var time=new Date;time.setHours(value[0]);time.setMinutes(value[1]);value=time}}if(isNaN(value.getTime()))value=""}return value},_get_visible_text:function(value){var timeMode=this._settings.type=="time";var timepicker=this.config.timepicker;var formatStr=this._formatStr||(timeMode?webix.i18n.timeFormatStr:timepicker?webix.i18n.fullDateFormatStr:webix.i18n.dateFormatStr);return formatStr(value)},_set_visible_text:function(){var node=this.getInputNode();if(node.value==webix.undefined){node.innerHTML=this._settings.text||this._get_div_placeholder()}else{node.value=this._settings.text||""}},$compareValue:function(oldvalue,value){if(!oldvalue&&!value)return true;return webix.Date.equal(oldvalue,value)},$setValue:function(value){this._settings.text=value?this._get_visible_text(value):"";this._set_visible_text()},format_setter:function(value){if(value){if(typeof value==="function")this._formatStr=value;else{this._formatStr=webix.Date.dateToStr(value);this._formatDate=webix.Date.strToDate(value)}}else this._formatStr=this._formatDate=null;return value},getInputNode:function(){return this._settings.editable?this._dataobj.getElementsByTagName("input")[0]:this._dataobj.getElementsByTagName("DIV")[1]},getValue:function(){var type=this._settings.type;var timeMode=type=="time";var timepicker=this.config.timepicker;var value=this._settings.value;if(!this._rendered_input)value=this.$prepareValue(value)||null;else if(this._settings.editable){var formatDate=this._formatDate||(timeMode?webix.i18n.timeFormatDate:timepicker?webix.i18n.fullDateFormatDate:webix.i18n.dateFormatDate);value=formatDate(this.getInputNode().value)}if(this._settings.stringResult){var formatStr=webix.i18n.parseFormatStr;if(timeMode)formatStr=webix.i18n.parseTimeFormatStr;if(this._formatStr&&(type=="month"||type=="year")){formatStr=this._formatStr}return value?formatStr(value):""}return value||null},getText:function(){var node=this.getInputNode();return node?typeof node.value=="undefined"?this.getValue()?node.innerHTML:"":node.value:""}},webix.ui.text);webix.protoUI({name:"colorpicker",$init:function(){this.$ready.push(this._init_popup)},defaults:{icon:true},_init_popup:function(){var obj=this._settings;if(obj.suggest)obj.popup=obj.suggest;else if(!obj.popup)obj.popup=obj.suggest=this.suggest_setter({type:"colorboard",height:200});this._init_once=function(){}},$render:function(obj){if(webix.isUndefined(obj.value))return;obj.value=this.$prepareValue(obj.value);this.$setValue(obj.value)},getValue:function(){if(this._rendered_input&&this._settings.editable)return this.getInputNode().value;else return this._settings.value},$prepareValue:function(value){if(value&&value.charAt&&value.charAt(0)!="#")value="#"+value;return value||""},_getColorNode:function(){return this.$view.getElementsByTagName("DIV")[this._settings.editable?1:2]},_get_visible_text:function(value){return value},$setValue:function(value){this._getColorNode().style.backgroundColor=value;this._settings.text=value;var node=this.getInputNode();if(node.value==webix.undefined)node.innerHTML=value;else node.value=value},$renderIcon:function(){var config=this.config;return'<div class="webix_input_icon" style="background-color:'+config.value+';"> </div>'}},webix.ui.datepicker);webix.RenderStack={$init:function(){webix.assert(this.data,"RenderStack :: Component doesn't have DataStore");webix.assert(webix.template,"webix.template :: webix.template is not accessible");this._html=document.createElement("DIV");this.data.attachEvent("onIdChange",webix.bind(this._render_change_id,this));this.attachEvent("onItemClick",this._call_onclick);if(!this.types){this.types={default:this.type};this.type.name="default"}this.type=webix.clone(this.type)},customize:function(obj){webix.type(this,obj)},item_setter:function(value){return this.type_setter(value)},type_setter:function(value){if(!this.types[value])this.customize(value);else{this.type=webix.clone(this.types[value]);if(this.type.css)this._contentobj.className+=" "+this.type.css}if(this.type.on_click)webix.extend(this.on_click,this.type.on_click);return value},template_setter:function(value){this.type.template=webix.template(value)},_toHTML:function(obj){var mark=this.data._marks[obj.id];webix.assert(!obj.$template||this.type["template"+obj.$template],"RenderStack :: Unknown template: "+obj.$template);this.callEvent("onItemRender",[obj]);return this.type.templateStart(obj,this.type,mark)+(obj.$template?this.type["template"+obj.$template]:this.type.template)(obj,this.type,mark)+this.type.templateEnd(obj,this.type,mark)},_toHTMLObject:function(obj){this._html.innerHTML=this._toHTML(obj);return this._html.firstChild},_render_change_id:function(old,newid){var obj=this.getItemNode(old);if(obj){obj.setAttribute(this._id,newid);this._htmlmap[newid]=this._htmlmap[old];delete this._htmlmap[old]}},_call_onclick:function(){if(this._settings.click){var code=webix.toFunctor(this._settings.click,this.$scope);if(code&&code.call)code.apply(this,arguments)}},getItemNode:function(search_id){if(this._htmlmap)return this._htmlmap[search_id];this._htmlmap={};var t=this._dataobj.childNodes;for(var i=0;i<t.length;i++){var id=t[i].getAttribute(this._id);if(id)this._htmlmap[id]=t[i]}return this.getItemNode(search_id)},locate:function(e){return webix.html.locate(e,this._id)},showItem:function(id){var html=this.getItemNode(id);if(html&&this.scrollTo){var txmin=Math.abs(this._contentobj.offsetLeft-html.offsetLeft);var txmax=txmin+html.offsetWidth;var tymin=Math.abs(this._contentobj.offsetTop-html.offsetTop);var tymax=tymin+html.offsetHeight;var state=this.getScrollState();var x=state.x;if(x>txmin||x+this._content_width<txmax)x=txmin;var y=state.y;if(y>tymin||y+this._content_height<tymax)y=tymin-5;this.scrollTo(x,y);if(this._setItemActive)this._setItemActive(id)}},render:function(id,data,type){if(!this.isVisible(this._settings.id)||this.$blockRender)return;if(webix.debug_render)webix.log("Render: "+this.name+"@"+this._settings.id+", mode:"+(type||"#")+", item:"+(id||"#"));if(id){var cont=this.getItemNode(id);switch(type){case"paint":case"update":if(!cont)return;var t=this._htmlmap[id]=this._toHTMLObject(data);webix.html.insertBefore(t,cont);webix.html.remove(cont);break;case"delete":if(!cont)return;webix.html.remove(cont);delete this._htmlmap[id];break;case"add":var t=this._htmlmap[id]=this._toHTMLObject(data);webix.html.insertBefore(t,this.getItemNode(this.data.getNextId(id)),this._dataobj);break;case"move":webix.html.insertBefore(this.getItemNode(id),this.getItemNode(this.data.getNextId(id)),this._dataobj);break;default:webix.assert_error("Unknown render command: "+type);break}}else{if(this.callEvent("onBeforeRender",[this.data])){(this._renderobj||this._dataobj).innerHTML=this.data.getRange().map(this._toHTML,this).join("");this._htmlmap=null;this.callEvent("onAfterRender",[]);var t=this._dataobj.offsetHeight}}}};webix.ValidateData={$init:function(){if(this._events)this.attachEvent("onChange",this.clearValidation)},clearValidation:function(){if(this.elements){for(var id in this.elements){this._clear_invalid(id)}}},validate:function(mode,obj){webix.assert(this.callEvent,"using validate for eventless object");this.callEvent("onBeforeValidate",[]);var failed=this._validate_details={};var result=true;var rules=this._settings.rules;var isHidden=this.isVisible&&!this.isVisible();var validateHidden=mode&&mode.hidden;var validateDisabled=mode&&mode.disabled;var elements={},hidden={};for(var i in this.elements){var name=this.elements[i].config.name;if((isHidden||this.elements[i].isVisible()||validateHidden)&&(this.elements[i].isEnabled()||validateDisabled))elements[name]=this.elements[i];else{hidden[name]=true}}if(rules||elements)if(!obj&&this.getValues)obj=this.getValues();if(rules){if(rules.$obj)result=this._validate(rules.$obj,obj,obj,"")&&result;var all=rules.$all;var data=obj;if(this._settings.complexData)data=webix.CodeParser.collapseNames(obj);if(all)for(var key in obj){if(hidden[key])continue;var subresult=this._validate(all,data[key],obj,key);if(!subresult)failed[key]=true;result=subresult&&result}for(var key in rules){if(hidden[key])continue;if(key.indexOf("$")!==0&&!failed[key]){webix.assert(rules[key],"Invalid rule for:"+key);var subresult=this._validate(rules[key],data[key],obj,key);if(!subresult)failed[key]=true;result=subresult&&result}}}if(elements){for(var key in elements){if(failed[key])continue;var subview=elements[key];if(subview.validate){var subresult=subview.validate();result=subresult&&result;if(!subresult)failed[key]=true}else{var input=subview._settings;if(input){var validator=input.validate;if(!validator&&input.required)validator=webix.rules.isNotEmpty;if(validator){var subresult=this._validate(validator,obj[key],obj,key);if(!subresult)failed[key]=true;result=subresult&&result}}}}}this.callEvent("onAfterValidation",[result,this._validate_details]);return result},_validate:function(rule,data,obj,key){if(typeof rule=="string")rule=webix.rules[rule];if(rule.call(this,data,obj,key)){if(this.callEvent("onValidationSuccess",[key,obj])&&this._clear_invalid)this._clear_invalid(key);return true}else{if(this.callEvent("onValidationError",[key,obj])&&this._mark_invalid)this._mark_invalid(key)}return false}};webix.ValidateCollection={_validate_init_once:function(){this.data.attachEvent("onStoreUpdated",webix.bind(function(id,data,mode){if(id&&(mode=="add"||mode=="update"))this.validate(id)},this));this.data.attachEvent("onClearAll",webix.bind(this.clearValidation,this));this._validate_init_once=function(){}},rules_setter:function(value){if(value){this._validate_init_once()}return value},clearValidation:function(){this.data.clearMark("webix_invalid",true)},validate:function(id){var result=true;if(!id)for(var key in this.data.pull)var result=this.validate(key)&&result;else{this._validate_details={};var obj=this.getItem(id);result=webix.ValidateData.validate.call(this,null,obj);if(result){if(this.callEvent("onValidationSuccess",[id,obj]))this._clear_invalid(id)}else{if(this.callEvent("onValidationError",[id,obj,this._validate_details]))this._mark_invalid(id,this._validate_details)}}return result},_validate:function(rule,data,obj,key){if(typeof rule=="string")rule=webix.rules[rule];var res=rule.call(this,data,obj,key);if(!res){this._validate_details[key]=true}return res},_clear_invalid:function(id){this.data.removeMark(id,"webix_invalid",true)},_mark_invalid:function(id,details){this.data.addMark(id,"webix_invalid",true)}};webix.rules={isEmail:function(value){return/\S+@[^@\s]+\.[^@\s]+$/.test((value||"").toString())},isNumber:function(value){return parseFloat(value)==value},isChecked:function(value){return!!value||value==="0"},isNotEmpty:function(value){return value===0||value}};webix.MapCollection={$init:function(){this.$ready.push(this._create_scheme_init);this.attachEvent("onStructureUpdate",this._create_scheme_init);this.attachEvent("onStructureLoad",function(){if(!this._scheme_init_order.length)this._create_scheme_init()})},_create_scheme_init:function(order){var order=this._scheme_init_order=[];var config=this._settings;if(config.columns)this._build_data_map(config.columns);if(this._settings.map)this._process_field_map(config.map);if(this._scheme_init_order.length){try{this.data._scheme_init=Function("obj",order.join("\n"))}catch(e){webix.assert_error("Invalid data map:"+order.join("\n"))}}},_process_field_map:function(map){for(var key in map)this._scheme_init_order.push(this._process_single_map(key,map[key]))},_process_single_map:function(id,map,extra){var start="";var end="";if(map.indexOf("(date)")===0){start="webix.i18n.parseFormatDate(";end=")";if(extra&&!extra.format)extra.format=webix.i18n.dateFormatStr;map=map.replace("(date)","")}else if(map.indexOf("(number)")===0){start="(";end=")*1";map=map.replace("(number)","")}if(map!==""){map=map.replace(/\{obj\.([^}]*)\}/g,"\"+(obj.$1||'')+\"");map=map.replace(/#([^#'";, ]+)#/gi,"\"+(obj.$1||'')+\"")}else map='"+(obj.'+id+"||'')+\"";return"obj."+id+" = "+start+'"'+map+'"'+end+";"},_build_data_map:function(columns){for(var i=0;i<columns.length;i++){var map=columns[i].map;var id=columns[i].id;if(!id){id=columns[i].id="i"+webix.uid();if(!columns[i].header)columns[i].header=""}if(map)this._scheme_init_order.push(this._process_single_map(id,map,columns[i]));this._map_options(columns[i])}},_map_options:function(element){var options=element.options||element.collection;if(options){if(typeof options==="string"){var options_view=webix.$$(options);if(!options_view){options_view=new webix.DataCollection({url:options});this._destroy_with_me.push(options_view)}if(options_view.getBody)options_view=options_view.getBody();this._bind_collection(options_view,element)}else if(!options.loadNext){if(options[0]&&typeof options[0]=="object"){options=new webix.DataCollection({data:options});this._bind_collection(options,element);this._destroy_with_me.push(options)}else{if(webix.isArray(options)){var data={};for(var ij=0;ij<options.length;ij++)data[options[ij]]=options[ij];element.options=options=data}element.template=element.template||this._collection_accesser(options,element.id,element.optionslist)}}else{this._bind_collection(options,element)}}},_bind_collection:function(options,element){if(element){delete element.options;element.collection=options;element.template=element.template||this._bind_accesser(options,element.id,element.optionslist);var id=options.data.attachEvent("onStoreUpdated",webix.bind(function(){this.refresh();if(this.refreshFilter)this.refreshFilter(element.id)},this));this.attachEvent("onDestruct",function(){if(!options.$destructed)options.data.detachEvent(id)})}},_collection_accesser:function(options,id,multi){if(multi){var separator=typeof multi=="string"?multi:",";return function(obj,common){var value=obj[id]||obj.value;if(!value)return"";var ids=value.split(separator);for(var i=0;i<ids.length;i++)ids[i]=options[ids[i]]||"";return ids.join(", ")}}else{return function(obj,common){return options[obj[id]]||obj.value||""}}},_bind_accesser:function(col,id,multi){if(multi){var separator=typeof multi=="string"?multi:",";return function(obj,common){var value=obj[id]||obj.value;if(!value)return"";var ids=value.split(separator);for(var i=0;i<ids.length;i++){var data=col.data.pull[ids[i]];ids[i]=data?data.value||"":""}return ids.join(", ")}}else{return function(obj,common){var prop=obj[id]||obj.value,data=col.data.pull[prop];if(data&&(data.value||data.value===0))return data.value;return""}}}};webix.Undo={$init:function(){this._undoHistory=webix.extend([],webix.PowerArray,true);this._undoCursor=-1},undo_setter:function(value){if(value){this._init_undo();this._init_undo=function(){}}return value},_init_undo:function(){var view=this;this.attachEvent("onBeforeDrop",function(context){if(context.from==context.to){var item=view._draggedItem=webix.copy(this.getItem(context.start));if(this.data.branch){item.$index=this.getBranchIndex(item.id)}else item.$index=this.getIndexById(item.id)}});this.data.attachEvent("onDataMove",function(sid){if(view._draggedItem&&view._draggedItem.id==sid){var data=view._draggedItem;view._draggedItem=null;view._addToHistory(sid,data,"move")}});this.data.attachEvent("onBeforeDelete",function(id){if(this.getItem(id)){var item=view._deletedItem=webix.copy(this.getItem(id));if(this.branch){item.$index=this.getBranchIndex(id);if(this.branch[id])item.$branch=webix.copy(this.serialize(id))}else item.$index=this.getIndexById(id)}});this.data.attachEvent("onDataUpdate",function(id,data,old){view._addToHistory(id+"",old,"update")});this.data.attachEvent("onStoreUpdated",function(id,item,mode){var data=null;if(id){if(mode=="add"){data=webix.copy(item)}else if(mode=="delete"){data=view._deletedItem}if(data)view._addToHistory(id,data,mode)}});this.data.attachEvent("onIdChange",function(oldId,newId){if(typeof oldId=="object")oldId=oldId.row;for(var i=0;i<view._undoHistory.length;i++){if(view._undoHistory[i].id==oldId){view._undoHistory[i].id=newId}}})},_addToHistory:function(id,data,action){if(!this._skipHistory&&this._settings.undo){this._undoHistory.push({id:id,action:action,data:data});if(this._undoHistory.length==20)this._undoHistory.splice(0,1);if(!this._skipCursorInc)this._undoCursor=this._undoHistory.length-1}},ignoreUndo:function(func,master){this._skipHistory=true;func.call(master||this);this._skipHistory=false},removeUndo:function(id){for(var i=this._undoHistory.length-1;i>=0;i--){if(this._undoHistory[i].id==id){if(this._undoHistory[i].action=="id"){id=this._undoHistory[i].data}this._undoHistory.removeAt(i)}}this._undoCursor=this._undoHistory.length-1},undo:function(id){if(id){this.ignoreUndo(function(){var data,i;for(i=this._undoHistory.length-1;!data&&i>=0;i--){if(this._undoHistory[i].id==id)data=this._undoHistory[i]}if(data){this._undoAction(data);this._undoHistory.removeAt(i+1);this._undoCursor=this._undoHistory.length-1}})}else{var data=this._undoHistory[this._undoCursor];if(data){this.ignoreUndo(function(){this._undoAction(data);this._undoHistory.removeAt(this._undoCursor)});this._undoCursor--}}},_undoAction:function(obj){if(obj.action=="delete"){var branch=null,parentId=obj.data.$parent;if(obj.data.$branch){branch={parent:obj.id,data:webix.copy(obj.data.$branch)};delete obj.data.$branch;if(parentId&&!this.data.branch[parentId])parentId=0}this.add(obj.data,obj.data.$index,parentId);if(branch){this.parse(branch)}}else if(obj.action=="add"){this.remove(obj.id)}else if(obj.action=="update"){this.updateItem(obj.id,obj.data)}else if(obj.action=="move"){if(obj.data.$parent){if(this.getItem(obj.data.$parent))this.move(obj.id,obj.data.$index,null,{parent:obj.data.$parent})}else this.move(obj.id,obj.data.$index)}}};webix.DataLoader=webix.proto({$init:function(config){config=config||"";this._ajax_queue=webix.toArray();this._feed_last={};this.data=new webix.DataStore;this.data.attachEvent("onClearAll",webix.bind(this._call_onclearall,this));this.data.attachEvent("onServerConfig",webix.bind(this._call_on_config,this));this.attachEvent("onDestruct",this._call_onclearall);this.data.feed=this._feed;this.data.owner=config.id},_feed:function(from,count,callback){if(this._load_count)return this._load_count=[from,count,callback];else this._load_count=true;this._feed_last.from=from;this._feed_last.count=count;this._feed_common.call(this,from,count,callback)},_feed_common:function(from,count,callback,url,details){var state=null,url=url||this.data.url;var final_callback=[{success:this._feed_callback,error:this._feed_callback},callback];if(from<0)from=0;if(!details)details={start:from,count:count};if(this.count())details["continue"]="true";if(this.getState)state=this.getState();if(url&&typeof url!="string"){if(state){if(state.sort)details.sort=state.sort;if(state.filter)details.filter=state.filter}this.load(url,final_callback,details)}else{url=url+(url.indexOf("?")==-1?"?":"&");var params=[];for(var d in details){params.push(d+"="+details[d])}if(state){if(state.sort)params.push("sort["+state.sort.id+"]="+encodeURIComponent(state.sort.dir));if(state.filter)for(var key in state.filter){var filterValue=state.filter[key];if(typeof filterValue=="object")filterValue=webix.ajax().stringify(filterValue);params.push("filter["+key+"]="+encodeURIComponent(filterValue))}}url+=params.join("&");if(this._feed_last.url!==url){this._feed_last.url=url;this.load(url,final_callback)}else{this._load_count=false}}},_feed_callback:function(){var temp=this._load_count;this._load_count=false;if(typeof temp=="object")this.data.feed.apply(this,temp)},load:function(url,call){var url=webix.proxy.$parse(url);var ajax=webix.AtomDataLoader.load.apply(this,arguments);if(!this.data.url)this.data.url=url;return ajax},loadNext:function(count,start,callback,url,now){var config=this._settings;if(config.datathrottle&&!now){if(this._throttle_request)window.clearTimeout(this._throttle_request);this._throttle_request=webix.delay(function(){this.loadNext(count,start,callback,url,true)},this,0,config.datathrottle);return}if(!start&&start!==0)start=this.count();if(!count)count=config.datafetch||this.count();this.data.url=this.data.url||url;if(this.callEvent("onDataRequest",[start,count,callback,url])&&this.data.url)this.data.feed.call(this,start,count,callback)},_maybe_loading_already:function(count,from){var last=this._feed_last;if(this._load_count&&last.url){if(last.from<=from&&last.count+last.from>=count+from)return true}return false},removeMissed_setter:function(value){return this.data._removeMissed=value},_init_dataprocessor:function(){var url=this._settings.save;if(url===true)url=this._settings.save=this._settings.url;var obj={master:this};if(url&&url.url)webix.extend(obj,url);else obj.url=url;webix.dp(obj)},save_setter:function(value){if(value)this.$ready.push(this._init_dataprocessor);return value},scheme_setter:function(value){this.data.scheme(value)},dataFeed_setter:function(value){value=webix.proxy.$parse(value);this.data.attachEvent("onBeforeFilter",webix.bind(function(text,filtervalue){if(typeof text=="function")return true;if(this._settings.dataFeed&&(text||filtervalue)){text=text||"id";if(filtervalue&&typeof filtervalue=="object")filtervalue=filtervalue.id;this.clearAll();var url=this._settings.dataFeed;if(typeof url=="function"){var filter={};filter[text]=filtervalue;url.call(this,filtervalue,filter)}else if(url.$proxy){if(url.load){var filterobj={};filterobj[text]=filtervalue;url.load(this,{success:this._onLoad,error:this._onLoadError},{filter:filterobj})}}else{var urldata="filter["+text+"]="+encodeURIComponent(filtervalue);this.load(url+(url.indexOf("?")<0?"?":"&")+urldata,this._settings.datatype)}return false}},this));return value},_call_onready:function(){if(this._settings.ready&&!this._ready_was_used){var code=webix.toFunctor(this._settings.ready,this.$scope);if(code)webix.delay(code,this,arguments);if(this.callEvent)webix.delay(this.callEvent,this,["onReady",[]]);this._ready_was_used=true}},_call_onclearall:function(soft){for(var i=0;i<this._ajax_queue.length;i++){var xhr=this._ajax_queue[i];try{xhr.aborted=true}catch(e){webix._xhr_aborted.push(xhr)}xhr.abort()}if(!soft){this._load_count=false;this._feed_last={};this._ajax_queue=webix.toArray();this.waitData=webix.promise.defer()}},_call_on_config:function(config){this._parseSeetingColl(config)}},webix.AtomDataLoader);webix._xhr_aborted=webix.toArray();webix.DataMarks={addCss:function(id,css,silent){if(!this.addRowCss&&!silent){if(!this.hasCss(id,css)){var node=this.getItemNode(id);if(node){node.className+=" "+css;silent=true}}}return this.data.addMark(id,css,1,1,silent)},removeCss:function(id,css,silent){if(!this.addRowCss&&!silent){if(this.hasCss(id,css)){var node=this.getItemNode(id);if(node){node.className=node.className.replace(css,"").replace("  "," ");silent=true}}}return this.data.removeMark(id,css,1,silent)},hasCss:function(id,mark){return this.data.getMark(id,mark)},clearCss:function(css,silent){return this.data.clearMark(css,1,silent)}};webix.DataStore=function(){this.name="DataStore";webix.extend(this,webix.EventSystem);this.setDriver("json");this.pull={};this.order=webix.toArray();this._marks={}};webix.DataStore.prototype={setDriver:function(type){webix.assert(webix.DataDriver[type],"incorrect DataDriver");this.driver=webix.DataDriver[type]},_parse:function(data,master){this.callEvent("onParse",[this.driver,data]);if(this._filter_order)this.filter();var info=this.driver.getInfo(data);if(info.key)webix.securityKey=info.key;if(info.config)this.callEvent("onServerConfig",[info.config]);var options=this.driver.getOptions(data);if(options)this.callEvent("onServerOptions",[options]);var recs=this.driver.getRecords(data);this._inner_parse(info,recs);if(this._scheme_group&&this._group_processing&&!this._not_grouped_order)this._group_processing(this._scheme_group);if(this._scheme_sort){this.blockEvent();this.sort(this._scheme_sort);this.unblockEvent()}this.callEvent("onStoreLoad",[this.driver,data]);this.refresh()},_inner_parse:function(info,recs){var from=(info.from||0)*1;var subload=true;var marks=false;if(from===0&&this.order[0]&&this.order[this.order.length-1]){if(this._removeMissed){marks={};for(var i=0;i<this.order.length;i++)marks[this.order[i]]=true}subload=false;from=this.order.length}var j=0;for(var i=0;i<recs.length;i++){var temp=this.driver.getDetails(recs[i]);var id=this.id(temp);if(!this.pull[id]){this.order[j+from]=id;j++}else if(subload&&this.order[j+from])j++;if(this.pull[id]){webix.extend(this.pull[id],temp,true);if(this._scheme_update)this._scheme_update(this.pull[id]);if(marks)delete marks[id]}else{this.pull[id]=temp;if(this._scheme_init)this._scheme_init(temp)}}if(marks){this.blockEvent();for(var delid in marks)this.remove(delid);this.unblockEvent()}if(!this.order[info.size-1])this.order[info.size-1]=webix.undefined},id:function(data){return data.id||(data.id=webix.uid())},changeId:function(old,newid){if(this.pull[old])this.pull[newid]=this.pull[old];this.pull[newid].id=newid;this.order[this.order.find(old)]=newid;if(this._filter_order)this._filter_order[this._filter_order.find(old)]=newid;if(this._marks[old]){this._marks[newid]=this._marks[old];delete this._marks[old]}this.callEvent("onIdChange",[old,newid]);if(this._render_change_id)this._render_change_id(old,newid);delete this.pull[old]},getItem:function(id){return this.pull[id]},updateItem:function(id,update,mode){var data=this.getItem(id);var old=null;var changeTrack=this.hasEvent("onDataUpdate");webix.assert(data,"Ivalid ID for updateItem");webix.assert(!update||!update.id||update.id==id,"Attempt to change ID in updateItem");if(!webix.isUndefined(update)&&data!==update){if(changeTrack)old=webix.copy(data);id=data.id;webix.extend(data,update,true);data.id=id}if(this._scheme_update)this._scheme_update(data);this.callEvent("onStoreUpdated",[id.toString(),data,mode||"update"]);if(changeTrack)this.callEvent("onDataUpdate",[id,data,old])},refresh:function(id){if(this._skip_refresh)return;if(id){if(this.exists(id))this.callEvent("onStoreUpdated",[id,this.pull[id],"paint"])}else this.callEvent("onStoreUpdated",[null,null,null])},silent:function(code,master){this._skip_refresh=true;code.call(master||this);this._skip_refresh=false},getRange:function(from,to){if(from)from=this.getIndexById(from);else from=this.$min||this.startOffset||0;if(to)to=this.getIndexById(to);else{to=this.$max===0?0:Math.min(this.$max?this.$max-1:this.endOffset||Infinity,this.count()-1);if(to<0)to=0}if(from>to){var a=to;to=from;from=a}return this.getIndexRange(from,to)},getIndexRange:function(from,to){to=Math.min(to===0?0:to||Infinity,this.count()-1);var ret=webix.toArray();for(var i=from||0;i<=to;i++)ret.push(this.getItem(this.order[i]));return ret},count:function(){return this.order.length},exists:function(id){return!!this.pull[id]},move:function(sindex,tindex){webix.assert(sindex>=0&&tindex>=0,"DataStore::move","Incorrect indexes");if(sindex==tindex)return;var id=this.getIdByIndex(sindex);var obj=this.getItem(id);if(this._filter_order)this._move_inner(this._filter_order,0,0,this.getIdByIndex(sindex),this.getIdByIndex(tindex));this._move_inner(this.order,sindex,tindex);this.callEvent("onStoreUpdated",[id,obj,"move"])},_move_inner:function(col,sindex,tindex,sid,tid){if(sid||tid){sindex=tindex=-1;for(var i=0;i<col.length;i++){if(col[i]==sid&&sindex<0)sindex=i;if(col[i]==tid&&tindex<0)tindex=i}}var id=col[sindex];col.removeAt(sindex);col.insertAt(id,Math.min(col.length,tindex))},scheme:function(config){this._scheme={};this._scheme_save=config.$save;this._scheme_init=config.$init||config.$change;this._scheme_update=config.$update||config.$change;this._scheme_serialize=config.$serialize;this._scheme_group=config.$group;this._scheme_sort=config.$sort;for(var key in config)if(key.substr(0,1)!="$")this._scheme[key]=config[key]},importData:function(target,silent){var data=target?target.data||target:[];this._filter_order=null;if(typeof data.serialize=="function"){this.order=webix.toArray([].concat(data.order));if(this._make_full_copy){this._make_full_copy=false;this.pull={};for(var key in data.pull)this.pull[key]=webix.copy(data.pull[key])}else this.pull=data.pull;if(data.branch&&this.branch){this.branch=webix.copy(data.branch);this._filter_branch=null}}else{this.order=webix.toArray();this.pull={};var id,obj;if(webix.isArray(target))for(var key=0;key<target.length;key++){obj=id=target[key];if(typeof obj=="object")obj.id=obj.id||webix.uid();else obj={id:id,value:id};this.order.push(obj.id);if(this._scheme_init)this._scheme_init(obj);this.pull[obj.id]=obj}else for(var key in data){this.order.push(key);this.pull[key]={id:key,value:data[key]}}}if(this._extraParser&&!data.branch){this.branch={0:[]};if(!this._datadriver_child)this._set_child_scheme("data");for(var i=0;i<this.order.length;i++){var key=this.order[i];this._extraParser(this.pull[key],0,0,false)}}this.callEvent("onStoreLoad",[]);if(!silent)this.callEvent("onStoreUpdated",[])},sync:function(source,filter,silent){this.unsync();var type=typeof source;if(type=="string")source=webix.$$("source");if(type!="function"&&type!="object"){silent=filter;filter=null}if(webix.debug_bind){this.debug_sync_master=source;webix.log("[sync] "+this.debug_bind_master.name+"@"+this.debug_bind_master._settings.id+" <= "+this.debug_sync_master.name+"@"+this.debug_sync_master._settings.id)}if(source.name!="DataStore"){if(source.data&&(source.data.name==="DataStore"||source.data.name==="TreeStore"))source=source.data;else{this._sync_source=source;return webix.callEvent("onSyncUnknown",[this,source,filter])}}var sync_logic=webix.bind(function(mode,record,data){if(this._skip_next_sync)return;if(filter&&this.branch)this._make_full_copy=true;this.importData(source,true);if(filter)this.silent(filter);if(this._on_sync)this._on_sync();if(this._make_full_copy){}if(webix.debug_bind)webix.log("[sync:request] "+this.debug_sync_master.name+"@"+this.debug_sync_master._settings.id+" <= "+this.debug_bind_master.name+"@"+this.debug_bind_master._settings.id);this.callEvent("onSyncApply",[]);if(!silent)this.refresh();else silent=false},this);this._sync_events=[source.attachEvent("onStoreUpdated",sync_logic),source.attachEvent("onIdChange",webix.bind(function(old,nid){this.changeId(old,nid);this.refresh(nid)},this))];this._sync_source=source;this._back_sync_handler=this.attachEvent("onStoreUpdated",function(id,data,mode){if(mode=="update"||mode=="save"){this._skip_next_sync=1;source.updateItem(id,data);this._skip_next_sync=0}});sync_logic()},unsync:function(){if(this._sync_source){var source=this._sync_source;if(source.name!="DataStore"&&(!source.data||source.data.name!="DataStore")){webix.callEvent("onUnSyncUnknown",[this,source])}else{for(var i=0;i<this._sync_events.length;i++)source.detachEvent(this._sync_events[i]);this.detachEvent(this._back_sync_handler)}this._sync_source=null}},destructor:function(){this.unsync();this.pull=this.order=this._marks=null;this._evs_events=this._evs_handlers={}},add:function(obj,index){if(this._scheme)for(var key in this._scheme)if(webix.isUndefined(obj[key]))obj[key]=this._scheme[key];if(this._scheme_init)this._scheme_init(obj);var id=this.id(obj);var order=arguments[2]||this.order;var data_size=order.length;if(webix.isUndefined(index)||index<0)index=data_size;if(index>data_size){webix.log("Warning","DataStore:add","Index of out of bounds");index=Math.min(order.length,index)}if(this.callEvent("onBeforeAdd",[id,obj,index])===false)return false;webix.assert(!this.exists(id),"Not unique ID");this.pull[id]=obj;order.insertAt(id,index);if(this._filter_order){var original_index=this._filter_order.length;if(this.order.length)original_index=Math.min(index||0,original_index);this._filter_order.insertAt(id,original_index)}this.callEvent("onStoreUpdated",[id,obj,"add"]);this.callEvent("onAfterAdd",[id,index]);return obj.id},remove:function(id){if(webix.isArray(id)){for(var i=0;i<id.length;i++)this.remove(id[i]);return}if(this.callEvent("onBeforeDelete",[id])===false)return false;webix.assert(this.exists(id),"Not existing ID in remove command"+id);var obj=this.getItem(id);this.order.remove(id);if(this._filter_order)this._filter_order.remove(id);delete this.pull[id];if(this._marks[id])delete this._marks[id];this.callEvent("onStoreUpdated",[id,obj,"delete"]);this.callEvent("onAfterDelete",[id])},clearAll:function(soft){this.pull={};this._marks={};this.order=webix.toArray();this._filter_order=null;if(!soft)this.url=null;this.callEvent("onClearAll",[soft]);this.refresh()},getIdByIndex:function(index){webix.assert(index>=0,"DataStore::getIdByIndex Incorrect index");return this.order[index]},getIndexById:function(id){var res=this.order.find(id);if(!this.pull[id])return-1;return res},getNextId:function(id,step){return this.order[this.getIndexById(id)+(step||1)]},getFirstId:function(){return this.order[0]},getLastId:function(){return this.order[this.order.length-1]},getPrevId:function(id,step){return this.order[this.getIndexById(id)-(step||1)]},sort:function(by,dir,as){var sort=by;if(typeof by=="function")sort={as:by,dir:dir};else if(typeof by=="string")sort={by:by.replace(/#/g,""),dir:dir,as:as};var parameters=[sort.by,sort.dir,sort.as,sort];if(!this.callEvent("onBeforeSort",parameters))return;this.order=this._sort_core(sort,this.order);if(this._filter_order&&this._filter_order.length!=this.order.length)this._filter_order=this._sort_core(sort,this._filter_order);this.refresh();this.callEvent("onAfterSort",parameters)},_sort_core:function(sort,order){var sorter=this.sorting.create(sort);if(this.order.length){var pre=order.splice(0,this.$freeze);var neworder=webix.toArray();for(var i=order.length-1;i>=0;i--)neworder[i]=this.pull[order[i]];neworder.sort(sorter);return webix.toArray(pre.concat(neworder.map(function(obj){webix.assert(obj,"Client sorting can't be used with dynamic loading");return this.id(obj)},this)))}return order},_filter_reset:function(preserve){if(this._filter_order&&!preserve){this.order=this._filter_order;delete this._filter_order}},_filter_core:function(filter,value,preserve){var neworder=webix.toArray();var freeze=this.$freeze||0;for(var i=0;i<this.order.length;i++){var id=this.order[i];if(i<freeze||filter(this.getItem(id),value))neworder.push(id)}if(!preserve||!this._filter_order)this._filter_order=this.order;this.order=neworder},find:function(config,first){var result=[];for(var i in this.pull){var data=this.pull[i];var match=true;if(typeof config=="object"){for(var key in config)if(data[key]!=config[key]){match=false;break}}else if(!config(data))match=false;if(match)result.push(data);if(first&&result.length)return result[0]}return result},filter:function(text,value,preserve){if(!text&&!this._filter_order&&!this._filter_branch)return;if(!this.callEvent("onBeforeFilter",[text,value]))return;this._filter_reset(preserve);if(!this.order.length)return;if(text){var filter=text;value=value||"";if(typeof text=="string"){text=text.replace(/#/g,"");if(typeof value=="function")filter=function(obj){return value(obj[text])};else{value=value.toString().toLowerCase();filter=function(obj,value){webix.assert(obj,"Client side filtering can't be used with dynamic loading");return(obj[text]||"").toString().toLowerCase().indexOf(value)!=-1}}}this._filter_core(filter,value,preserve,this._filterMode)}this.refresh();this.callEvent("onAfterFilter",[])},_obj_array:function(){var data=[];for(var i=this.order.length-1;i>=0;i--)data[i]=this.pull[this.order[i]];return data},each:function(method,master,all){var order=this.order;if(all)order=this._filter_order||order;for(var i=0;i<order.length;i++)method.call(master||this,this.getItem(order[i]),i)},_methodPush:function(object,method){return function(){return object[method].apply(object,arguments)}},provideApi:function(target,eventable){this.debug_bind_master=target;if(eventable){this.mapEvent({onbeforesort:target,onaftersort:target,onbeforeadd:target,onafteradd:target,onbeforedelete:target,onafterdelete:target,ondataupdate:target})}var list=["sort","add","remove","exists","getIdByIndex","getIndexById","getItem","updateItem","refresh","count","filter","find","getNextId","getPrevId","clearAll","getFirstId","getLastId","serialize","sync"];for(var i=0;i<list.length;i++)target[list[i]]=this._methodPush(this,list[i])},addMark:function(id,mark,css,value,silent){var obj=this._marks[id]||{};this._marks[id]=obj;if(!obj[mark]){obj[mark]=value||true;if(css){var old_css=obj.$css||"";obj.$css=old_css+" "+mark}if(!silent)this.refresh(id)}return obj[mark]},removeMark:function(id,mark,css,silent){var obj=this._marks[id];if(obj){if(obj[mark])delete obj[mark];if(css){var current_css=obj.$css;if(current_css){obj.$css=current_css.replace(mark,"").replace("  "," ")}}if(!silent)this.refresh(id)}},getMark:function(id,mark){var obj=this._marks[id];return obj?obj[mark]:false},clearMark:function(name,css,silent){for(var id in this._marks){var obj=this._marks[id];if(obj[name]){delete obj[name];if(css&&obj.$css)obj.$css=obj.$css.replace(name,"").replace("  "," ");if(!silent)this.refresh(id)}}},serialize:function(all){var ids=this.order;if(all&&this._filter_order)ids=this._filter_order;var result=[];for(var i=0;i<ids.length;i++){var el=this.pull[ids[i]];if(this._scheme_serialize){el=this._scheme_serialize(el);if(el===false)continue}result.push(el)}return result},sorting:{create:function(config){return this._dir(config.dir,this._by(config.by,config.as))},as:{server:function(){return false},date:function(a,b){a=a-0;b=b-0;return a>b?1:a<b?-1:0},int:function(a,b){a=a*1;b=b*1;return a>b?1:a<b?-1:0},string_strict:function(a,b){a=a.toString();b=b.toString();return a>b?1:a<b?-1:0},string:function(a,b){if(!b)return 1;if(!a)return-1;a=a.toString().toLowerCase();b=b.toString().toLowerCase();return a>b?1:a<b?-1:0},raw:function(a,b){return a>b?1:a<b?-1:0}},_by:function(prop,method){if(!prop)return method;if(typeof method!="function")method=this.as[method||"string"];webix.assert(method,"Invalid sorting method");return function(a,b){return method(a[prop],b[prop])}},_dir:function(prop,method){if(prop=="asc"||!prop)return method;return function(a,b){return method(a,b)*-1}}}};webix.DataCollection=webix.proto({name:"DataCollection",isVisible:function(){if(!this.data.order.length&&!this.data._filter_order&&!this._settings.dataFeed)return false;return true},$init:function(config){this.data.provideApi(this,true);var id=config&&config.id?config.id:webix.uid();this._settings.id=id;webix.ui.views[id]=this;this.data.attachEvent("onStoreLoad",webix.bind(function(){this.callEvent("onBindRequest",[])},this))},refresh:function(){this.callEvent("onBindRequest",[])}},webix.DataMove,webix.CollectionBind,webix.BindSource,webix.ValidateCollection,webix.DataLoader,webix.MapCollection,webix.EventSystem,webix.BaseBind,webix.Destruction,webix.Settings);webix.Scrollable={$init:function(config){if(config&&!config.scroll&&this._one_time_scroll)return this._dataobj=this._dataobj||this._contentobj;(this._dataobj||this._contentobj).appendChild(webix.html.create("DIV",{class:"webix_scroll_cont"},""));this._dataobj=(this._dataobj||this._contentobj).firstChild;if(!webix.env.touch)webix._event(this._viewobj,"scroll",webix.bind(function(e){if(this.callEvent)webix.delay(function(){this.callEvent("onAfterScroll",[])},this)},this))},scroll_setter:function(value){if(!value)return false;var marker=value=="x"?"x":value=="xy"?"xy":value=="a"?"xy":"y";if(webix.Touch&&webix.Touch.$active){this._dataobj.setAttribute("touch_scroll",marker);if(this.attachEvent)this.attachEvent("onAfterRender",webix.bind(this._refresh_scroll,this));this._touch_scroll=true}else{if(webix.env.$customScroll){webix.CustomScroll.enable(this,marker)}else{var node=this._dataobj.parentNode.style;if(value.toString().indexOf("a")!=-1){node.overflowX=node.overflowY="auto"}else{if(marker.indexOf("x")!=-1){this._scroll_x=true;node.overflowX="scroll"}if(marker.indexOf("y")!=-1){this._scroll_y=true;node.overflowY="scroll"}}}}return marker},_onoff_scroll:function(mode){if(!!this._settings.scroll==!!mode)return;if(!webix.env.$customScroll){var style=this._dataobj.parentNode.style;style.overflowX=style.overflowY=mode?"auto":"hidden"}this._scroll_x=this._scroll_y=!!mode;this._settings.scroll=!!mode},getScrollState:function(){if(webix.Touch&&webix.Touch.$active){var temp=webix.Touch._get_matrix(this._dataobj);return{x:-temp.e,y:-temp.f}}else return{x:this._dataobj.parentNode.scrollLeft,y:this._dataobj.parentNode.scrollTop}},scrollTo:function(x,y){if(webix.Touch&&webix.Touch.$active){y=Math.max(0,Math.min(y,this._dataobj.offsetHeight-this._content_height));x=Math.max(0,Math.min(x,this._dataobj.offsetWidth-this._content_width));webix.Touch._set_matrix(this._dataobj,-x,-y,this._settings.scrollSpeed||"100ms")}else{this._dataobj.parentNode.scrollLeft=x;this._dataobj.parentNode.scrollTop=y}},_refresh_scroll:function(){if(this._settings.scroll.toString().indexOf("x")!=-1){var x=this._dataobj.scrollWidth;if(x){this._dataobj.style.width="100%";this._dataobj.style.width=this._dataobj.scrollWidth+"px"}}if(webix.Touch&&webix.Touch.$active&&this._touch_scroll){webix.Touch._clear_artefacts();webix.Touch._scroll_end();var s=this.getScrollState();var dx=this._dataobj.offsetWidth-this.$width-s.x;var dy=this._dataobj.offsetHeight-this.$height-s.y;if(dx<0||dy<0){var x=dx<0?Math.min(-dx-s.x,0):-s.x;var y=dy<0?Math.min(-dy-s.y,0):-s.y;webix.Touch._set_matrix(this._dataobj,x,y,0)}}}};webix.protoUI({defaults:{size:10,page:0,group:5,template:"{common.pages()}",maxWidth:1e5,height:30,borderless:true},name:"pager",on_click:{webix_pager_item:function(e,id){this.select(id)}},$init:function(config){this.data=this._settings;this._dataobj=this._viewobj;this._viewobj.className+=" webix_pager";if(config.master===false||config.master===0)this.$ready.push(this._remove_master)},_remove_master:function(){this.refresh();this.$master={refresh:function(){},select:function(){}}},select:function(id){if(this.$master&&this.$master.name=="pager")return this.$master.select(id);switch(id){case"next":id=this._settings.page+1;break;case"prev":id=this._settings.page-1;break;case"first":id=0;break;case"last":id=this._settings.limit-1;break;default:break}if(id<0)id=0;if(id>=this.data.limit)id=this.data.limit-1;var old=this.data.page;if(this.callEvent("onBeforePageChange",[id,old])){this.data.page=id*1;if(this.refresh()){if(!this._settings.animate||!this._animate(old,id*1,this._settings.animate))this.$master.refresh()}this.callEvent("onAfterPageChange",[id])}},_id:"webix_p_id",template_setter:webix.template,type:{template:function(a,b){return a.template.call(this,a,b)},pages:function(obj){var html="";if(obj.page==-1)return"";obj.$min=obj.page-Math.round((obj.group-1)/2);obj.$max=obj.$min+obj.group*1-1;if(obj.$min<0){obj.$max+=obj.$min*-1;obj.$min=0}if(obj.$max>=obj.limit){obj.$min-=Math.min(obj.$min,obj.$max-obj.limit+1);obj.$max=obj.limit-1}for(var i=obj.$min||0;i<=obj.$max;i++)html+=this.button({id:i,index:i+1,selected:i==obj.page?"_selected":"",label:webix.i18n.aria.page+" "+(i+1)});return html},page:function(obj){return obj.page+1},first:function(){return this.button({id:"first",index:webix.locale.pager.first,selected:"",label:webix.i18n.aria.pages[0]})},last:function(){return this.button({id:"last",index:webix.locale.pager.last,selected:"",label:webix.i18n.aria.pages[3]})},prev:function(){return this.button({id:"prev",index:webix.locale.pager.prev,selected:"",label:webix.i18n.aria.pages[1]})},next:function(){return this.button({id:"next",index:webix.locale.pager.next,selected:"",label:webix.i18n.aria.pages[2]})},button:webix.template("<button type='button' webix_p_id='{obj.id}' class='webix_pager_item{obj.selected}' aria-label='{obj.label}'>{obj.index}</button>")},clone:function(pager){if(!pager.$view){pager.view="pager";pager=webix.ui(pager)}this._clone=pager;pager.$master=this;this._refresh_clone()},refresh:function(){var s=this._settings;if(!s.count)return;s.limit=Math.ceil(s.count/s.size);var newPage=Math.min(s.limit-1,s.page);if(newPage!=s.page)return this.$master.setPage(newPage);s.page=newPage;if(newPage>=0&&newPage!=s.old_page||s.limit!=s.old_limit||s.old_count!=s.count){this.render();this._refresh_clone();s.old_limit=s.limit;s.old_page=s.page;s.old_count=s.count;return true}},apiOnly_setter:function(value){return this.$apiOnly=value},_refresh_clone:function(){if(this._clone){this._clone._settings.count=this._settings.count;this._clone._settings.page=this._settings.page;this._clone.refresh()}},_animate:function(old,id,config){if(old==id)return false;if(this._pgInAnimation){if(this._pgAnimateTimeout){window.clearTimeout(this._pgAnimateTimeout)}return this._pgAnimateTimeout=webix.delay(this._animate,this,[old,id,config],100)}var direction=id>old?"left":"right";if(config.direction=="top"||config.direction=="bottom")direction=id>old?"top":"bottom";if(config.flip)direction="";var top=0;var snode=this.$master._dataobj;var isDataTable=!!this.$master._body;if(isDataTable){snode=this.$master._body;top=snode.offsetTop;webix.html.addCss(this.$master.$view,"webix_animation")}var onode=snode.cloneNode(true);onode.style.width=snode.style.width="100%";this.$master.refresh();webix.html.insertBefore(onode,snode.nextSibling,snode.parentNode);if(isDataTable)onode.childNodes[1].scrollLeft=snode.childNodes[1].scrollLeft;var line;var base=config!==true?config:{};var aniset=webix.extend({direction:direction,callback:webix.bind(function(){aniset.callback=null;webix.animate.breakLine(line);this._pgInAnimation=false;if(this.$master._body)webix.html.removeCss(this.$master.$view,"webix_animation")},this),top:top,keepViews:isDataTable},base);line=webix.animate.formLine(snode,onode,aniset);webix.animate([snode,onode],aniset);this._pgInAnimation=true}},webix.MouseEvents,webix.SingleRender,webix.ui.view,webix.EventSystem);webix.locale.pager={first:" &lt;&lt; ",last:" &gt;&gt; ",next:" &gt; ",prev:" &lt; "};webix.PagingAbility={pager_setter:function(pager){if(typeof pager=="string"){var ui_pager=webix.$$(pager);if(!ui_pager){this.$blockRender=true;webix.delay(function(){var obj=webix.$$(pager);this._settings.pager=this.pager_setter(obj);var s=obj._settings;s.count=this.data._count_pager_total(s.level);obj.refresh();this.$blockRender=false;this.render()},this);return null}pager=ui_pager}function check_pager_sizes(repeat){if(pager.config.autosize&&this.getVisibleCount){var count=this.getVisibleCount();if(isNaN(count)){pager.config.size=1;webix.delay(check_pager_sizes,this,[true])}else if(count!=pager.config.size){pager.config.size=count;pager.refresh();if(repeat===true)this.refresh()}}var s=this._settings.pager;if(s.page==-1)return false;this.data.$min=this._count_pager_index(0,s.page*s.size);this.data.$max=this._count_pager_index(this.data.$min,s.size);this.data.$pagesize=this.data.$max-this.data.$min;return true}this.attachEvent("onBeforeRender",check_pager_sizes);if(!pager.$view){pager.view="pager";pager=webix.ui(pager)}this._pager=pager;pager.$master=this;this.data.attachEvent("onStoreUpdated",function(){var s=pager._settings;s.count=this._count_pager_total(s.level);pager.refresh()});this.data._count_pager_total=this._count_pager_total;return pager._settings},_count_pager_total:function(level){if(level&&level!==0){var count=0;this.each(function(obj){if(obj.$level==level)count++});return count}else return this.count()},_count_pager_index:function(start,count){var s=this._settings.pager;if(s.level&&s.level!==0){var end=start;var max=this.data.order.length;if(count)while(end<max){if(this.data.getItem(this.data.order[end]).$level==s.level){if(count===0)break;else count--}end++}return end}else return start+count},setPage:function(value){if(this._pager)this._pager.select(value)},getPage:function(){return this._pager._settings.page},getPager:function(){return this._pager}};webix.protoUI({name:"tooltip",defaults:{dy:0,dx:20},$init:function(container){if(typeof container=="string"){container={template:container}}this.type=webix.extend({},this.type);this.$view=this._viewobj=this._contentobj=this._dataobj=webix.html.create("DIV",{role:"alert","aria-atomic":"true"});this._contentobj.className="webix_tooltip";webix.html.insertBefore(this._contentobj,document.body.firstChild,document.body);this._hideHandler=webix.attachEvent("onClick",webix.bind(function(e){if(this._visible&&webix.$$(e)!=this)this.hide()},this));this.attachEvent("onDestruct",function(){webix.detachEvent(this._hideHandler)})},adjust:function(){},isVisible:function(){return true},show:function(data,pos){if(this._disabled)return;if(this.data!=data){this.data=webix.extend({},data);this.render(data)}if(this._dataobj.firstChild){var w=Math.max(document.documentElement.clientWidth,window.innerWidth||0);var h=Math.max(document.documentElement.clientHeight,window.innerHeight||0);var positionX=w-pos.x;var positionY=h-pos.y;this._contentobj.style.display="block";if(positionX-this._settings.dx>this._contentobj.offsetWidth)positionX=pos.x;else{positionX=pos.x-this._settings.dx*2-this._contentobj.offsetWidth;if(positionX<=0)positionX=0}if(positionY-this._settings.dy>this._contentobj.offsetHeight)positionY=pos.y;else positionY=pos.y-this._settings.dy-this._contentobj.offsetHeight;this._contentobj.style.left=positionX+this._settings.dx+"px";this._contentobj.style.top=positionY+this._settings.dy+"px"}this._visible=true},hide:function(){this.data=null;this._contentobj.style.display="none";this._visible=false},disable:function(){this._disabled=true},enable:function(){this._disabled=false},type:{template:webix.template("{obj.id}"),templateStart:webix.template.empty,templateEnd:webix.template.empty}},webix.SingleRender,webix.Settings,webix.EventSystem,webix.ui.view);webix.AutoTooltip={tooltip_setter:function(value){if(value){if(typeof value=="function")value={template:value};var col_mode=!value.template;var t=new webix.ui.tooltip(value);this._enable_mouse_move();var showEvent=this.attachEvent("onMouseMove",function(id,e){this._mouseEventX=e.clientX;this._mouseEventY=e.clientY;if(this.getColumnConfig){var config=t.type.column=this.getColumnConfig(id.column);if(col_mode){if(!config.tooltip&&config.tooltip!=webix.undefined)return;var trg=e.target||e.srcElements;if(trg.getAttribute("webix_area")&&config.tooltip){var area=trg.getAttribute("webix_area");t.type.template=function(obj,common){var values=obj[common.column.id];return webix.template(config.tooltip).call(this,obj,common,values[area],area)}}else{if(config.tooltip)t.type.template=config.tooltip=webix.template(config.tooltip);else{var text=this.getText(id.row,id.column);t.type.template=function(){return text}}}}}if(!webix.DragControl.active)t.show(this.getItem(id),webix.html.pos(e))});var hideEvent=webix.event(document.body,"mousemove",webix.bind(function(e){e=e||event;if(this._mouseEventX!=e.clientX||this._mouseEventY!=e.clientY)t.hide()},this));this.attachEvent("onDestruct",function(){if(this.config.tooltip)this.config.tooltip.destructor()});this.attachEvent("onAfterScroll",function(){t.hide()});t.attachEvent("onDestruct",webix.bind(function(){this.detachEvent(showEvent);webix.eventRemove(hideEvent)},this));return t}}};webix.protoUI({name:"proto",$init:function(){this.data.provideApi(this,true);this._dataobj=this._dataobj||this._contentobj;this.data.attachEvent("onStoreUpdated",webix.bind(function(){this.render.apply(this,arguments)},this))},$setSize:function(){if(webix.ui.view.prototype.$setSize.apply(this,arguments))this.render()},_id:"webix_item",on_mouse_move:{},type:{}},webix.PagingAbility,webix.DataMarks,webix.AutoTooltip,webix.ValidateCollection,webix.RenderStack,webix.DataLoader,webix.ui.view,webix.EventSystem,webix.Settings);webix.CodeParser={collapseNames:function(base,prefix,data){data=data||{};prefix=prefix||"";if(!base||typeof base!="object")return null;for(var prop in base){if(base[prop]&&typeof base[prop]=="object"&&!webix.isDate(base[prop])&&!webix.isArray(base[prop])){webix.CodeParser.collapseNames(base[prop],prefix+prop+".",data)}else{data[prefix+prop]=base[prop]}}return data},expandNames:function(base){var data={},i,lastIndex,name,obj,prop;for(prop in base){name=prop.split(".");lastIndex=name.length-1;obj=data;for(i=0;i<lastIndex;i++){if(!obj[name[i]])obj[name[i]]={};obj=obj[name[i]]}obj[name[lastIndex]]=base[prop]}return data}};webix.Values={$init:function(){this.elements={}},focus:function(name){if(name){webix.assert(this.elements[name],"unknown input name: "+name);this._focus(this.elements[name])}else{for(var n in this.elements){if(this._focus(this.elements[n]))return true}}},_focus:function(target){if(target&&target.focus){target.focus();return true}},setValues:function(data,update){if(this._settings.complexData)data=webix.CodeParser.collapseNames(data);this._inner_setValues(data,update)},_inner_setValues:function(data,update){this._is_form_dirty=update;this.blockEvent();if(!update||!this._values)this._values={};if(webix.debug_render)webix.log("Render: "+this.name+"@"+this._settings.id);for(var name in data)if(!this.elements[name])this._values[name]=data[name];for(var name in this.elements){var input=this.elements[name];if(input){if(!webix.isUndefined(data[name]))input.setValue(data[name]);else if(!update&&input._allowsClear)input.setValue("");this._values[name]=input.getValue()}}this.unblockEvent();this.callEvent("onValues",[])},isDirty:function(){if(this._is_form_dirty)return true;if(this.getDirtyValues(1)===1)return true;return false},setDirty:function(flag){this._is_form_dirty=flag;if(!flag)this._values=this._inner_getValues()},getDirtyValues:function(){var result={};if(this._values){for(var name in this.elements){var value=this.elements[name].getValue();if(this._values[name]!=value){result[name]=value;if(arguments[0])return 1}}}return result},getCleanValues:function(){return this._values},getValues:function(filter){var data=this._inner_getValues(filter);if(this._settings.complexData)data=webix.CodeParser.expandNames(data);return data},_inner_getValues:function(filter){var success,elem=null,data=this._values?webix.copy(this._values):{};for(var name in this.elements){elem=this.elements[name];success=true;if(filter){if(typeof filter=="object"){if(filter.hidden===false)success=elem.isVisible();if(success&&filter.disabled===false)success=elem.isEnabled()}else success=filter.call(this,elem)}if(success)data[name]=elem.getValue();else delete data[name]}return data},clear:function(){this._is_form_dirty=false;var data={};for(var name in this.elements)if(this.elements[name]._allowsClear)data[name]=this.elements[name]._settings.defaultValue||"";this._inner_setValues(data)},markInvalid:function(name,state){if(state===false){this._clear_invalid(name)}else{if(typeof state=="string"){var input=this.elements[name];if(input)input._settings.invalidMessage=state}this._mark_invalid(name)}},_mark_invalid:function(id){var input=this.elements[id];if(id&&input){this._clear_invalid(id,true);webix.html.addCss(input._viewobj,"webix_invalid");input._settings.invalid=true;var message=input._settings.invalidMessage;if(typeof message==="string"&&input.setBottomText)input.setBottomText()}},_clear_invalid:function(id,silent){var input=this.elements[id];if(id&&input&&input.$view&&input._settings.invalid){webix.html.removeCss(input._viewobj,"webix_invalid");input._settings.invalid=false;var message=input._settings.invalidMessage;if(typeof message==="string"&&!silent&&input.setBottomText)input.setBottomText()}}};webix.protoUI({name:"toolbar",defaults:{type:"toolbar"},_render_borders:true,_form_classname:"webix_toolbar",_form_vertical:false,$init:function(config){if(!config.borderless)this._contentobj.style.borderWidth="1px";this._contentobj.className+=" "+this._form_classname;this._viewobj.setAttribute("role","toolbar")},_recollect_elements:function(){var form=this;form.elements={};webix.ui.each(this,function(view){if(view._settings.name&&view.getValue&&view.setValue){form.elements[view._settings.name]=view;if(view.mapEvent)view.mapEvent({onbeforetabclick:form,onaftertabclick:form,onitemclick:form,onchange:form})}if(view.setValues)return false});var old=this._values;this.setDirty(false);if(old){var now=this._values;for(var key in form.elements)if(old[key]&&now[key]!=old[key]){now[key]=old[key];this.setDirty(true)}}},_parse_cells_ext_end:function(){this._recollect_elements()},_parse_cells_ext:function(collection){var config=this._settings;if(config.elements&&!collection){this._collection=collection=config.elements;this._vertical_orientation=this._form_vertical;delete config.elements}if(this._settings.elementsConfig)this._rec_apply_settings(this._collection,config.elementsConfig);return collection},_rec_apply_settings:function(col,settings){for(var i=0;i<col.length;i++){var element=col[i];webix.extend(element,settings);var nextsettings=settings;if(element.elementsConfig)nextsettings=webix.extend(webix.extend({},element.elementsConfig),settings);var sub;if(element.body)sub=[element.body];else sub=element.rows||element.cols||element.cells||element.body;if(sub)this._rec_apply_settings(sub,nextsettings)}},$getSize:function(dx,dy){var sizes=webix.ui.layout.prototype.$getSize.call(this,dx,dy);var parent=this.getParentView();var index=this._vertical_orientation?3:1;if(parent&&this._vertical_orientation!=parent._vertical_orientation)sizes[index]+=1e5;webix.debug_size_box(this,sizes,true);return sizes},render:function(){},refresh:function(){this.render()}},webix.Scrollable,webix.AtomDataLoader,webix.Values,webix.ui.layout,webix.ValidateData);webix.protoUI({name:"template",$init:function(config){var subtype=this._template_types[config.type];if(subtype){webix.extend(config,subtype);if(config.borderless){delete config._inner;this._set_inner(config)}}if(this._dataobj==this._viewobj){this._dataobj=webix.html.create("DIV");this._dataobj.className=" webix_template";this._viewobj.appendChild(this._dataobj)}else this._dataobj.className+=" webix_template";this.attachEvent("onAfterRender",this._correct_width_scroll)},setValues:function(obj,update){this.data=update?webix.extend(this.data,obj,true):obj;this.render()},getValues:function(){return this.data},$skin:function(){this._template_types.header.height=this._template_types.section.height=webix.skin.$active.barHeight},_template_types:{header:{css:"webix_header"},section:{css:"webix_section",borderless:true},clean:{css:"webix_clean",borderless:true}},onClick_setter:function(value){this.on_click=webix.extend(this.on_click||{},value,true);if(!this._onClick)webix.extend(this,webix.MouseEvents);return value},defaults:{template:webix.template.empty},_render_me:function(){this._not_render_me=false;this._probably_render_me();this.resize()},_probably_render_me:function(){if(!this._not_render_me){this._not_render_me=true;this.render()}},src_setter:function(value){this._not_render_me=true;if(!this.callEvent("onBeforeLoad",[]))return"";webix.ajax(value,webix.bind(function(text){this._settings.template=webix.template(text);this._render_me();this.callEvent("onAfterLoad",[])},this));return value},_correct_width_scroll:function(){if(this._settings.autoheight){this._last_size=null;this.resize()}if(this._settings.scroll&&this._settings.scroll.indexOf("x")!=-1)this._dataobj.style.width=this._dataobj.scrollWidth+"px"},content_setter:function(config){if(config){this._not_render_me=true;this.render=function(){};this._dataobj.appendChild(webix.toNode(config))}},refresh:function(){this.render()},setHTML:function(html){this._settings.template=function(){return html};this.refresh()},setContent:function(content){this._dataobj.innerHTML="";this.content_setter(content)},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)){this._probably_render_me();if(this._settings.autoheight){var top=this.getTopParentView();clearTimeout(top._template_resize_timer);top._template_resize_timer=webix.delay(this.resize,this)}return true}},$getSize:function(x,y){if(this._settings.autoheight&&!this._settings.type)this._settings.height=this._get_auto_height();return webix.ui.view.prototype.$getSize.call(this,x,y)},_get_auto_height:function(){var size;this._probably_render_me();var padding=webix.skin.$active.layoutPadding.space;this._dataobj.style.height="auto";size=this._dataobj.scrollHeight;this._dataobj.style.height="";return size},_one_time_scroll:true},webix.Scrollable,webix.AtomDataLoader,webix.AtomRender,webix.EventSystem,webix.ui.view);webix.protoUI({name:"iframe",$init:function(config){this._dataobj=this._contentobj;this._contentobj.innerHTML="<iframe style='width:100%; height:100%' frameborder='0' onload='var t = $$(this.parentNode.getAttribute(\"view_id\")); if (t) t.callEvent(\"onAfterLoad\",[]);' src='about:blank'></iframe>"},load:function(value){this.src_setter(value)},src_setter:function(value){if(!this.callEvent("onBeforeLoad",[]))return"";this.getIframe().src=value;return value},getIframe:function(){return this._contentobj.getElementsByTagName("iframe")[0]},getWindow:function(){return this.getIframe().contentWindow}},webix.ui.view,webix.EventSystem);webix.OverlayBox={showOverlay:function(message){if(!this._overlay){this._overlay=webix.html.create("DIV",{class:"webix_overlay"},message||"");webix.html.insertBefore(this._overlay,this._viewobj.firstChild,this._viewobj);this._viewobj.style.position="relative"}else this._overlay.innerHTML=message},hideOverlay:function(){if(this._overlay){webix.html.remove(this._overlay);this._overlay=null}}};webix.protoUI({name:"scrollview",defaults:{scroll:"y",scrollSpeed:"0ms"},$init:function(){this._viewobj.className+=" webix_scrollview"},body_setter:function(config){config.borderless=true;this._body_cell=webix.ui._view(config);this._body_cell._parent_cell=this;this._dataobj.appendChild(this._body_cell._viewobj)},getChildViews:function(){return[this._body_cell]},getBody:function(){return this._body_cell},resizeChildren:function(){this._desired_size=this._body_cell.$getSize(0,0);this._resizeChildren();webix.callEvent("onResize",[])},_resizeChildren:function(){var scroll_size=this._native_scroll||webix.ui.scrollSize;var cx=Math.max(this._content_width,this._desired_size[0]);var cy=Math.max(this._content_height,this._desired_size[2]);this._body_cell.$setSize(cx,cy);this._dataobj.style.width=this._body_cell._content_width+"px";this._dataobj.style.height=this._body_cell._content_height+"px";if(webix.env.touch){var state=this.getScrollState();var top=this._body_cell._content_height-this._content_height;if(top<state.y)this.scrollTo(null,top)}if(webix._responsive_exception){webix._responsive_exception=false;this._desired_size=this._body_cell.$getSize(0,0);this._resizeChildren()}},$getSize:function(dx,dy){var desired_size=this._desired_size=this._body_cell.$getSize(0,0);var self_sizes=webix.ui.view.prototype.$getSize.call(this,dx,dy);var scroll_size=this._native_scroll||webix.ui.scrollSize;if(this._settings.scroll=="x"){self_sizes[2]=Math.max(self_sizes[2],desired_size[2])+scroll_size;self_sizes[3]=Math.min(self_sizes[3],desired_size[3])+scroll_size}else if(this._settings.scroll=="y"){self_sizes[0]=Math.max(self_sizes[0],desired_size[0])+scroll_size;self_sizes[1]=Math.min(self_sizes[1],desired_size[1])+scroll_size}return self_sizes},$setSize:function(x,y){var temp=webix.ui.scrollSize;webix.ui.scrollSize=this._native_scroll||temp;if(webix.ui.view.prototype.$setSize.call(this,x,y))this._resizeChildren();webix.ui.scrollSize=temp},scroll_setter:function(value){var custom=webix.env.$customScroll;if(typeof value=="string"&&value.indexOf("native-")===0){this._native_scroll=17;value=value.replace("native-");webix.env.$customScroll=false}value=webix.Scrollable.scroll_setter.call(this,value);webix.env.$customScroll=custom;return value},_replace:function(new_view){this._body_cell.destructor();this._body_cell=new_view;this._body_cell._parent_cell=this;this._bodyobj.appendChild(this._body_cell._viewobj);this.resize()},showView:function(id){var topPos=webix.$$(id).$view.offsetTop-webix.$$(id).$view.parentNode.offsetTop;this.scrollTo(0,topPos)}},webix.Scrollable,webix.EventSystem,webix.ui.view);webix.TreeRenderStack={$init:function(){webix.assert(this.render,"TreeRenderStack :: Object must use RenderStack first")},_toHTMLItem:function(obj){var mark=this.data._marks[obj.id];this.callEvent("onItemRender",[obj]);return this.type.templateStart(obj,this.type,mark)+(obj.$template?this.type["template"+obj.$template](obj,this.type,mark):this.type.template(obj,this.type,mark))+this.type.templateEnd()},_toHTMLItemObject:function(obj){this._html.innerHTML=this._toHTMLItem(obj);return this._html.firstChild},_toHTML:function(obj){webix.assert(!obj.$template||this.type["template"+obj.$template],"RenderStack :: Unknown template: "+obj.$template);var html="<div role='presentation' class='webix_tree_branch_"+obj.$level+"'>"+this._toHTMLItem(obj);if(obj.open)html+=this._toHTMLLevel(obj.id);html+="</div>";return html},_toHTMLLevel:function(id){var html="";var leaves=this.data.branch[id];if(leaves){html+="<div role='presentation' class='webix_tree_leaves'>";var last=leaves.length-1;for(var i=0;i<=last;i++){var obj=this.getItem(leaves[i]);this.type._tree_branch_render_state[obj.$level]=i==last;html+=this._toHTML(obj)}html+="</div>"}return html},render:function(id,data,type){webix.TreeRenderStack._obj=this;if(!this.isVisible(this._settings.id)||this.$blockRender)return;if(webix.debug_render)webix.log("Render: "+this.name+"@"+this._settings.id);if(id){var cont;var item=this.getItem(id);if(type!="add"){cont=this.getItemNode(id);if(!cont)return}switch(type){case"branch":var branch=cont.parentNode;var node=this._toHTMLObject(item);webix.html.insertBefore(node,branch);webix.html.remove(branch);this._htmlmap=null;break;case"paint":case"update":var node=this._htmlmap[id]=this._toHTMLItemObject(item);webix.html.insertBefore(node,cont);webix.html.remove(cont);break;case"delete":webix.html.remove(cont.parentNode);break;case"add":var parent;if(item.$parent==0){parent=this._dataobj.firstChild}else if(this.getItem(item.$parent).open){parent=this.getItemNode(item.$parent);if(parent){if(!parent.nextSibling){var leafs=webix.html.create("DIV",{class:"webix_tree_leaves"},"");parent.parentNode.appendChild(leafs)}parent=parent.nextSibling}}if(parent){var next=this.data.getNextSiblingId(id);next=this.getItemNode(next);if(next)next=next.parentNode;var node=this._toHTMLObject(item);this._htmlmap[id]=node.firstChild;webix.html.insertBefore(node,next,parent)}break;default:return false}this.callEvent("onPartialRender",[id,data,type])}else if(this.callEvent("onBeforeRender",[this.data])){this.type._tree_branch_render_state=[];this._dataobj.innerHTML=this._toHTMLLevel(0);this._htmlmap=null;this.callEvent("onAfterRender",[])}this.type._tree_branch_render_state=0;webix.TreeRenderStack._obj=null;return true},getItemNode:function(search_id){if(this._htmlmap)return this._htmlmap[search_id];this._htmlmap={};var t=this._dataobj.getElementsByTagName("DIV");for(var i=0;i<t.length;i++){var id=t[i].getAttribute(this._id);if(id)this._htmlmap[id]=t[i]}return this.getItemNode(search_id)},_branch_render_supported:1};webix.SelectionModel={$init:function(){this._selected=webix.toArray();webix.assert(this.data,"SelectionModel :: Component doesn't have DataStore");this.data.attachEvent("onStoreUpdated",webix.bind(this._data_updated,this));this.data.attachEvent("onStoreLoad",webix.bind(this._data_loaded,this));this.data.attachEvent("onAfterFilter",webix.bind(this._data_filtered,this));this.data.attachEvent("onSyncApply",webix.bind(this._select_check,this));this.data.attachEvent("onIdChange",webix.bind(this._id_changed,this));this.$ready.push(this._set_noselect)},_set_noselect:function(){if(this._settings.select=="multiselect"||this._settings.multiselect)webix._event(this.$view,"mousedown",function(e){var shiftKey=(e||event).shiftKey;if(shiftKey){webix._noselect_element=this;webix.html.addCss(this,"webix_noselect",1)}})},_id_changed:function(oldid,newid){for(var i=this._selected.length-1;i>=0;i--)if(this._selected[i]==oldid)this._selected[i]=newid},_data_filtered:function(){for(var i=this._selected.length-1;i>=0;i--){if(this.data.getIndexById(this._selected[i])<0){var id=this._selected[i];this.removeCss(id,"webix_selected",true);this._selected.splice(i,1);this.callEvent("onSelectChange",[id])}}},_data_updated:function(id,obj,type){if(type=="delete"){if(this.loadBranch){this._select_check()}else this._selected.remove(id)}else if(!id&&!this.data.count()&&!this.data._filter_order){this._selected=webix.toArray()}},_data_loaded:function(){if(this._settings.select)this.data.each(function(obj){if(obj&&obj.$selected)this.select(obj.id)},this)},_select_check:function(){for(var i=this._selected.length-1;i>=0;i--)if(!this.exists(this._selected[i]))this._selected.splice(i,1)},_select_mark:function(id,state,refresh,need_unselect){var name=state?"onBeforeSelect":"onBeforeUnSelect";if(!this.callEvent(name,[id,state]))return false;if(need_unselect){this._silent_selection=true;this.unselectAll();this._silent_selection=false}if(state)this.addCss(id,"webix_selected",true);else this.removeCss(id,"webix_selected",true);if(refresh)refresh.push(id);else{if(state)this._selected.push(id);else this._selected.remove(id);this._refresh_selection(id)}var name=state?"onAfterSelect":"onAfterUnSelect";this.callEvent(name,[id]);return true},select:function(id,preserve){var ctrlKey=arguments[2];var shiftKey=arguments[3];if(!id)return this.selectAll();if(webix.isArray(id)){for(var i=0;i<id.length;i++)this.select(id[i],i?1:preserve,ctrlKey,shiftKey);return}webix.assert(this.data.exists(id),"Incorrect id in select command: "+id);if(shiftKey&&this._selected.length)return this.selectAll(this._selected[this._selected.length-1],id);var need_unselect=false;if(!ctrlKey&&!preserve&&(this._selected.length!=1||this._selected[0]!=id))need_unselect=true;if(!need_unselect&&this.isSelected(id)){if(ctrlKey)this.unselect(id);return}this._select_mark(id,true,null,need_unselect)},unselect:function(id){if(!id)return this.unselectAll();if(!this.isSelected(id))return;this._select_mark(id,false)},selectAll:function(from,to){var range;var refresh=[];if(from||to)range=this.data.getRange(from||null,to||null);else range=this.data.getRange();range.each(function(obj){if(!this.data.getMark(obj.id,"webix_selected")){this._selected.push(obj.id);this._select_mark(obj.id,true,refresh)}},this);this._refresh_selection(refresh)},unselectAll:function(){var refresh=[];this._selected.each(function(id){this._select_mark(id,false,refresh)},this);this._selected=webix.toArray();this._refresh_selection(refresh)},isSelected:function(id){return this._selected.find(id)!=-1},getSelectedId:function(as_array){switch(this._selected.length){case 0:return as_array?[]:"";case 1:return as_array?[this._selected[0]]:this._selected[0];default:return[].concat(this._selected)}},getSelectedItem:function(as_array){var sel=this.getSelectedId(true);if(sel.length>1||as_array){for(var i=sel.length-1;i>=0;i--)sel[i]=this.getItem(sel[i]);return sel}else if(sel.length)return this.getItem(sel[0])},_is_mass_selection:function(obj){return obj.length>100||obj.length>this.data.count/2},_refresh_selection:function(refresh){if(typeof refresh!="object")refresh=[refresh];if(!refresh.length)return;if(this._is_mass_selection(refresh))this.data.refresh();else for(var i=0;i<refresh.length;i++)this.render(refresh[i],this.data.getItem(refresh[i]),"update");if(!this._silent_selection)this.callEvent("onSelectChange",[refresh])}};webix.ready(function(){webix.event(document.body,"mouseup",function(e){if(webix._noselect_element){webix.html.removeCss(webix._noselect_element,"webix_noselect");webix._noselect_element=null}})});webix.TreeDataMove={$init:function(){webix.assert(this.data,"DataMove :: Component doesn't have DataStore")},copy:function(sid,tindex,tobj,details){details=details||{};details.copy=true;return this.move(sid,tindex,tobj,details)},_next_move_index:function(nid,next,source){if(next&&nid){var new_index=this.getBranchIndex(nid);return new_index+(source==this&&source.getBranchIndex(next)<new_index?0:1)}},_check_branch_child:function(parent,child){var t=this.data.branch[parent];if(t&&t.length){for(var i=0;i<t.length;i++){if(t[i]==child)return true;if(this._check_branch_child(t[i],child))return true}}return false},move:function(sid,tindex,tobj,details){details=details||{};tindex=tindex||0;var new_id=details.newId||sid;var target_parent=details.parent||0;tobj=tobj||this;webix.assert(tobj.data,"moving attempt to component without datastore");if(!tobj.data)return;if(webix.isArray(sid)){for(var i=0;i<sid.length;i++){var nid=this.move(sid[i],tindex,tobj,details);tindex=tobj._next_move_index(nid,sid[i+1],this)}return}if(this!=tobj||details.copy){new_id=tobj.data.add(tobj._externalData(this.getItem(sid),new_id),tindex,target_parent||0);if(this.data.branch[sid]&&tobj.getBranchIndex){var temp=this.data._scheme_serialize;this.data._scheme_serialize=function(obj){var copy=webix.copy(obj);delete copy.$parent;delete copy.$level;delete copy.$child;if(tobj.data.pull[copy.id])copy.id=webix.uid();return copy};var copy_data={data:this.serialize(sid,true),parent:new_id};this.data._scheme_serialize=temp;tobj.parse(copy_data)}if(!details.copy)this.data.remove(sid)}else{if(sid==target_parent||this._check_branch_child(sid,target_parent))return;var source=this.getItem(sid);var tbranch=this.data.branch[target_parent];if(!tbranch)tbranch=this.data.branch[target_parent]=[];var sbranch=this.data.branch[source.$parent];var sindex=webix.PowerArray.find.call(sbranch,sid);if(tindex<0)tindex=Math.max(tbranch.length-1,0);if(sbranch===tbranch&&tindex===sindex)return;webix.PowerArray.removeAt.call(sbranch,sindex);webix.PowerArray.insertAt.call(tbranch,sid,Math.min(tbranch.length,tindex));if(!sbranch.length)delete this.data.branch[source.$parent];if(source.$parent&&source.$parent!="0")this.getItem(source.$parent).$count--;if(target_parent&&target_parent!="0"){var target=tobj.getItem(target_parent);target.$count++;this._set_level_rec(source,target.$level+1)}else this._set_level_rec(source,1);source.$parent=target_parent;tobj.data.callEvent("onDataMove",[sid,tindex,target_parent,tbranch[tindex+1]])}this.refresh();return new_id},_set_level_rec:function(item,value){item.$level=value;var branch=this.data.branch[item.id];if(branch)for(var i=0;i<branch.length;i++)this._set_level_rec(this.getItem(branch[i]),value+1)},_drag_pause:function(id){if(id&&!id.header)this.open(id)},$dropAllow:function(context){if(context.from!=context.to)return true;for(var i=0;i<context.source.length;i++)if(context.source==context.target||this._check_branch_child(context.source,context.target))return false;return true},_externalData:function(data,id){var new_data=webix.DataMove._externalData.call(this,data,id);delete new_data.open;return new_data}};webix.TreeDataLoader={$init:function(){this.data.attachEvent("onStoreUpdated",webix.bind(this._sync_hierarchy,this),null,true);this._feed_common=this._feed_commonA},_feed_commonA:function(id,count,callback,url){var details=count===0?{parent:encodeURIComponent(id)}:null;webix.DataLoader.prototype._feed_common.call(this,id,count,callback,url,details)},loadBranch:function(id,callback,url){id=id||0;this.data.url=url||this.data.url;if(this.callEvent("onDataRequest",[id,callback,this.data.url])&&this.data.url)this.data.feed.call(this,id,0,callback,url)},_sync_hierarchy:function(id,data,mode){if(!mode||mode=="add"||mode=="delete"||mode=="branch"){this.data._sync_to_order(this)}}};webix.TreeStore={name:"TreeStore",$init:function(){this._filterMode={showSubItems:true};this.branch={0:[]};this.attachEvent("onParse",function(driver,data){this._set_child_scheme(driver.child);var parent=driver.getInfo(data).parent});this.attachEvent("onClearAll",webix.bind(function(){this._filter_branch=null},this))},filterMode_setter:function(mode){return webix.extend(this._filterMode,mode,true)},_filter_reset:function(preserve){if(this._filter_branch&&!preserve){this.branch=this._filter_branch;this.order=webix.toArray(webix.copy(this.branch[0]));for(var key in this.branch)if(key!="0")this.getItem(key).$count=this.branch[key].length;delete this._filter_branch}},_filter_core:function(filter,value,preserve,filterMode){if(!preserve||!this._filter_branch){this._filter_branch=this.branch;this.branch=webix.clone(this.branch)}this.branch[0]=this._filter_branch_rec(filter,value,this.branch[0],1,filterMode||{})},_filter_branch_rec:function(filter,value,branch,level,config){var neworder=[];var allow=config.level&&config.level!=level;for(var i=0;i<branch.length;i++){var id=branch[i];var item=this.getItem(id);var child_run=false;var sub=this.branch[id];if(allow){child_run=true}else if(filter(this.getItem(id),value)){neworder.push(id);if(config.openParents!==false){var parentId=this.getParentId(id);while(parentId&&parentId!="0"){this.getItem(parentId).open=1;parentId=this.getParentId(parentId)}}if(config.level||config.showSubItems)continue}else{child_run=true}if(allow||!config.level){if(sub){var newsub=this.branch[id]=this._filter_branch_rec(filter,value,sub,level+1,config);item.$count=newsub.length;if(child_run&&newsub.length)neworder.push(id)}}}return neworder},count:function(){if(this.order.length)return this.order.length;var count=0;this.eachOpen(function(){count++});return count},changeId:function(old,newid){if(this.branch[old]){var branch=this.branch[newid]=this.branch[old];for(var i=0;i<branch.length;i++)this.getItem(branch[i]).$parent=newid;delete this.branch[old]}var parent=this.getItem(old).$parent;if(this.branch[parent]){var index=webix.PowerArray.find.call(this.branch[parent],old);this.branch[parent][index]=newid}return webix.DataStore.prototype.changeId.call(this,old,newid)},clearAll:function(soft){this.branch={0:[]};webix.DataStore.prototype.clearAll.call(this,soft)},getPrevSiblingId:function(id){var order=this.branch[this.getItem(id).$parent];var pos=webix.PowerArray.find.call(order,id)-1;if(pos>=0)return order[pos];return null},getNextSiblingId:function(id){var order=this.branch[this.getItem(id).$parent];var pos=webix.PowerArray.find.call(order,id)+1;if(pos<order.length)return order[pos];return null},getParentId:function(id){return this.getItem(id).$parent},getFirstChildId:function(id){var order=this.branch[id];if(order&&order.length)return order[0];return null},isBranch:function(parent){return!!this.branch[parent]},getBranchIndex:function(child){var t=this.branch[this.pull[child].$parent];return webix.PowerArray.find.call(t,child)},_set_child_scheme:function(parse_name){if(typeof parse_name=="string")this._datadriver_child=function(obj){var t=obj[parse_name];if(t)delete obj[parse_name];return t};else this._datadriver_child=parse_name},_inner_parse:function(info,recs){var parent=info.parent||0;for(var i=0;i<recs.length;i++){var temp=this.driver.getDetails(recs[i]);var id=this.id(temp);var update=!!this.pull[id];if(update){temp=webix.extend(this.pull[id],temp,true);if(this._scheme_update)this._scheme_update(temp)}else{if(this._scheme_init)this._scheme_init(temp);this.pull[id]=temp}this._extraParser(temp,parent,0,update,info.from?info.from*1+i:0)}var pItem=this.pull[parent]||{};var pBranch=this.branch[parent]||[];pItem.$count=pBranch.length;delete pItem.webix_kids;if(info.size&&info.size!=pBranch.length)pBranch[info.size]=null},_extraParser:function(obj,parent,level,update,from){obj.$count=0;obj.$parent=parent!="0"?parent:0;obj.$level=level||(parent!="0"?this.pull[parent].$level+1:1);var parent_branch=this.branch[obj.$parent];if(!parent_branch)parent_branch=this.branch[obj.$parent]=[];if(this._filter_branch)this._filter_branch[obj.$parent]=parent_branch;if(!update){var pos=from||parent_branch.length;parent_branch[pos]=obj.id}var child=this._datadriver_child(obj);if(obj.webix_kids){return obj.$count=-1}if(!child)return obj.$count=0;if(!webix.isArray(child))child=[child];for(var i=0;i<child.length;i++){var item=webix.DataDriver.json.getDetails(child[i]);var itemid=this.id(item);update=!!this.pull[itemid];if(update){item=webix.extend(this.pull[itemid],item,true);if(this._scheme_update)this._scheme_update(item)}else{if(this._scheme_init)this._scheme_init(item);this.pull[itemid]=item}this._extraParser(item,obj.id,obj.$level+1,update)}var branch=this.branch[obj.id];if(branch)obj.$count=branch.length},_sync_to_order:function(master){this.order=webix.toArray();this._sync_each_child(0,master)},_sync_each_child:function(start,master){var branch=this.branch[start];for(var i=0;i<branch.length;i++){var id=branch[i];this.order.push(id);var item=this.pull[id];if(item){if(item.open){if(item.$count==-1)master.loadBranch(id);else if(item.$count)this._sync_each_child(id,master)}}}},provideApi:function(target,eventable){var list=["getPrevSiblingId","getNextSiblingId","getParentId","getFirstChildId","isBranch","getBranchIndex","filterMode_setter"];for(var i=0;i<list.length;i++)target[list[i]]=this._methodPush(this,list[i]);if(!target.getIndexById)webix.DataStore.prototype.provideApi.call(this,target,eventable)},getTopRange:function(){return webix.toArray([].concat(this.branch[0])).map(function(id){return this.getItem(id)},this)},eachChild:function(id,functor,master,all){var branch=this.branch;if(all&&this._filter_branch)branch=this._filter_branch;var stack=branch[id];if(stack)for(var i=0;i<stack.length;i++)functor.call(master||this,this.getItem(stack[i]))},each:function(method,master,all,id){this.eachChild(id||0,function(item){var branch=this.branch;method.call(master||this,item);if(all&&this._filter_branch)branch=this._filter_branch;if(item&&branch[item.id])this.each(method,master,all,item.id)},this,all)},eachOpen:function(method,master,id){this.eachChild(id||0,function(item){method.call(master||this,item);if(this.branch[item.id]&&item.open)this.eachOpen(method,master,item.id)})},eachSubItem:function(id,functor){var top=this.branch[id||0];if(top)for(var i=0;i<top.length;i++){var key=top[i];if(this.branch[key]){functor.call(this,this.getItem(key),true);this.eachSubItem(key,functor)}else functor.call(this,this.getItem(key),false)}},eachLeaf:function(id,functor){var top=this.branch[id||0];if(top)for(var i=0;i<top.length;i++){var key=top[i];if(this.branch[key]){this.eachLeaf(key,functor)}else functor.call(this,this.getItem(key),false)}},_sort_core:function(sort,order){var sorter=this.sorting.create(sort);for(var key in this.branch){var bset=this.branch[key];var data=[];for(var i=0;i<bset.length;i++)data.push(this.pull[bset[i]]);data.sort(sorter);for(var i=0;i<bset.length;i++)data[i]=data[i].id;this.branch[key]=data}return order},add:function(obj,index,pid){var refresh_parent=false;var parent=this.getItem(pid||0);if(parent){if(!this.branch[parent.id])refresh_parent=true;parent.$count++;if(!parent.$count)parent.$count=1}this.branch[pid||0]=this.order=webix.toArray(this.branch[pid||0]);obj.$count=0;obj.$level=parent?parent.$level+1:1;obj.$parent=parent?parent.id:0;if(this._filter_branch){var origin=this._filter_branch[pid||0];if(!origin)origin=this._filter_branch[pid]=this.order;if(this.order!==origin){var original_index=origin.length;if(!index&&this.branch[pid||0].length)original_index=0;origin=webix.toArray(origin);origin.insertAt(obj.id,original_index)}}var result=webix.DataStore.prototype.add.call(this,obj,index);if(refresh_parent)this.refresh(pid);return result},_rec_remove:function(id,inner){var obj=this.pull[id];if(this.branch[obj.id]&&this.branch[obj.id].length>0){var branch=this.branch[id];for(var i=0;i<branch.length;i++)this._rec_remove(branch[i],true)}delete this.branch[id];if(this._filter_branch)delete this._filter_branch[id];delete this.pull[id];if(this._marks[id])delete this._marks[id]},_filter_removed:function(pull,parentId,id){var branch=pull[parentId];if(branch.length==1&&branch[0]==id&&parentId){delete pull[parentId]}else webix.toArray(branch).remove(id)},remove:function(id){if(webix.isArray(id)){for(var i=0;i<id.length;i++)this.remove(id[i]);return}webix.assert(this.exists(id),"Not existing ID in remove command"+id);var obj=this.pull[id];var parentId=obj.$parent||0;if(this.callEvent("onBeforeDelete",[id])===false)return false;this._rec_remove(id);this.callEvent("onAfterDelete",[id]);var parent=this.pull[parentId];this._filter_removed(this.branch,parentId,id);if(this._filter_branch)this._filter_removed(this._filter_branch,parentId,id);var refresh_parent=0;if(parent){parent.$count--;if(parent.$count<=0){parent.$count=0;parent.open=0;refresh_parent=1}}this.callEvent("onStoreUpdated",[id,obj,"delete"]);if(refresh_parent)this.refresh(parent.id)},getBranch:function(id){var out=[];var items=(this._filter_branch||this.branch)[id];if(items)for(var i=0;i<items.length;i++)out[i]=this.pull[items[i]];return out},serialize:function(id,all){var coll=this.branch;if(all&&this._filter_branch)coll=this._filter_branch;var ids=this.branch[id||0];var result=[];for(var i=0;i<ids.length;i++){var obj=this.pull[ids[i]];var rel;if(this._scheme_serialize){rel=this._scheme_serialize(obj);if(rel===false)continue}else rel=webix.copy(obj);if(this.branch[obj.id])rel.data=this.serialize(obj.id,all);result.push(rel)}return result}};webix.TreeType={space:function(obj,common){var html="";for(var i=1;i<obj.$level;i++)html+="<div class='webix_tree_none'></div>";return html},icon:function(obj,common){if(obj.$count){if(obj.open)return"<div class='webix_tree_open'></div>";else return"<div class='webix_tree_close'></div>"}else return"<div class='webix_tree_none'></div>"},checkbox:function(obj,common){if(obj.nocheckbox)return"";return"<input type='checkbox' class='webix_tree_checkbox' "+(obj.checked?"checked":"")+(obj.disabled?" disabled":"")+">"},folder:function(obj,common){if(obj.icon)return"<div class='webix_tree_file webix_tree_"+obj.icon+"'></div>";if(obj.$count){if(obj.open)return"<div class='webix_tree_folder_open'></div>";else return"<div class='webix_tree_folder'></div>"}return"<div class='webix_tree_file'></div>"}};webix.TreeAPI={open:function(id,show){if(!id)return;var item=this.getItem(id);if(!item.$count||item.open)return;if(this.callEvent("onBeforeOpen",[id])){item.open=true;this.data.callEvent("onStoreUpdated",[id,0,"branch"]);this.callEvent("onAfterOpen",[id])}if(show&&id!="0")this.open(this.getParentId(id),show)},close:function(id){if(!id)return;var item=this.getItem(id);if(!item.open)return;if(this.callEvent("onBeforeClose",[id])){item.open=false;this.data.callEvent("onStoreUpdated",[id,0,"branch"]);this.callEvent("onAfterClose",[id])}},openAll:function(id){this.data.eachSubItem(id||0,function(obj,branch){if(branch)obj.open=true});this.data.refresh()},closeAll:function(id){this.data.eachSubItem(id||0,function(obj,branch){if(branch)obj.open=false});this.data.refresh()},_tree_check_uncheck:function(id,mode,e){if(this._settings.threeState)return this._tree_check_uncheck_3(id,mode!==null?mode:"");var value,item=this.getItem(id),trg=e?e.target||e.srcElement:null;if(trg&&trg.type=="checkbox")value=trg.checked?true:false;else value=mode!==null?mode:!item.checked;item.checked=value;this.callEvent("onItemCheck",[id,item.checked,e])},isBranchOpen:function(search_id){if(search_id=="0")return true;var item=this.getItem(search_id);if(item.open)return this.isBranchOpen(item.$parent);return false},getOpenItems:function(){var open=[];for(var id in this.data.branch){if(this.exists(id)&&this.getItem(id).open)open.push(id)}return open},getState:function(){return{open:this.getOpenItems(),select:this.getSelectedId(true)}},_repeat_set_state:function(tree,open){var event=this.data.attachEvent("onStoreLoad",function(){tree.setState.call(tree,open);tree.data.detachEvent(event);tree=null})},setState:function(state){var repeat=false;var dyn=false;if(state.open){this.closeAll();var open=state.open;for(var i=0;i<open.length;i++){var item=this.getItem(open[i]);if(item&&item.$count){item.open=true;if(item.$count==-1){this._repeat_set_state(this,state);this.refresh();return 0}}}this.refresh()}if(state.select&&this.select){var select=state.select;this.unselect();for(var i=0;i<select.length;i++)if(this.exists(select[i]))this.select(select[i],true)}return 1}};webix.TreeClick={webix_tree_open:function(e,id){this.close(id);return false},webix_tree_close:function(e,id){this.open(id);return false},webix_tree_checkbox:function(e,id){this._tree_check_uncheck(id,null,e);return false}};webix.TreeCollection=webix.proto({name:"TreeCollection",$init:function(){webix.extend(this.data,webix.TreeStore,true);this.data.provideApi(this,true);webix.extend(this,webix.TreeDataMove,true)}},webix.TreeDataLoader,webix.DataCollection);webix.AutoScroll={_auto_scroll:function(pos,id){var yscroll=1;var xscroll=0;var scroll=this._settings.dragscroll;if(typeof scroll=="string"){xscroll=scroll.indexOf("x")!=-1;yscroll=scroll.indexOf("y")!=-1}var data=this._body||this.$view;var box=webix.html.offset(data);var top=box.y;var bottom=top+data.offsetHeight;var left=box.x;var right=left+data.offsetWidth;var scroll=this.getScrollState();var reset=false;var sense=Math.max(this.type&&!isNaN(parseFloat(this.type.height))?this.type.height+5:0,40);if(yscroll){var config=this._settings;if(config.topSplit){var topSplitPos=this._cellPosition(this.getIdByIndex(config.topSplit-1),this.columnId(0));top+=topSplitPos.top+topSplitPos.height}if(pos.y<top+sense){this._auto_scrollTo(scroll.x,scroll.y-sense*2,pos);reset=true}else if(pos.y>bottom-sense){this._auto_scrollTo(scroll.x,scroll.y+sense*2,pos);reset=true}}if(xscroll){if(pos.x<left+sense){this._auto_scrollTo(scroll.x-sense*2,scroll.y,pos);reset=true}else if(pos.x>right-sense){this._auto_scrollTo(scroll.x+sense*2,scroll.y,pos);reset=true}}if(reset)this._auto_scroll_delay=webix.delay(this._auto_scroll,this,[pos],100)},_auto_scrollTo:function(x,y,pos){if(this.callEvent("onBeforeAutoScroll",[pos]))this.scrollTo(x,y)}};webix.DragOrder={_do_not_drag_selection:true,$drag:function(s,e){var html=webix.DragItem.$drag.call(this,s,e);if(html){var context=webix.DragControl.getContext();if(this.getBranchIndex)this._drag_order_stored_left=this._drag_order_complex?this.getItem(context.start).$level*16:0;if(!context.fragile)this.addCss(context.start,"webix_transparent")}return html},_getDragItemPos:function(pos,e){return webix.DragItem._getDragItemPos(pos,e)},$dragPos:function(pos,e,node){var box=webix.html.offset(this.$view);var left=box.x+(this._drag_order_complex?1+this._drag_order_stored_left:1);var top=pos.y;var config=this._settings;var xdrag=config.layout=="x";if(xdrag){top=box.y+(this._drag_order_complex?+box.height-webix.ui.scrollSize-1:1);left=pos.x}node.style.display="none";var html=document.elementFromPoint(left,top);if(html!=this._last_sort_dnd_node){var view=webix.$$(html);if(view&&view==this){var id=this.locate(html,true);if(!id&&webix.DragControl._saved_event)id=this.locate(webix.DragControl._saved_event,true);var start_id=webix.DragControl.getContext().start;this._auto_scroll_force=true;if(id){if(id!=this._last_sort_dnd_node){if(id!=start_id){var details,index;if(this.getBranchIndex){details={parent:this.getParentId(id)};index=this.getBranchIndex(id)}else{details={};index=this.getIndexById(id)}if(this.callEvent("onBeforeDropOrder",[start_id,index,e,details])){this.move(start_id,index,this,details);this._last_sort_dnd_node=id}}webix.DragControl._last=this._contentobj}}else{id="$webix-last";if(this._last_sort_dnd_node!=id){if(!this.callEvent("onBeforeDropOrder",[start_id,-1,e,{parent:0}]))return;this._last_sort_dnd_node=id}}}}node.style.display="block";if(xdrag){pos.y=box.y;pos.x=pos.x-18;if(pos.x<box.x)pos.x=box.x;else{var max=box.x+this.$view.offsetWidth-60;if(pos.x>max)pos.x=max}}else{box.y+=this._header_height;pos.x=this._drag_order_stored_left||box.x;pos.y=pos.y-18;if(pos.y<box.y)pos.y=box.y;else{var max=box.y+this.$view.offsetHeight-60;if(pos.y>max)pos.y=max}}if(this._auto_scroll_delay)this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay);this._auto_scroll_delay=webix.delay(this._auto_scroll,this,[webix.html.pos(e),this.locate(e)||null],250);webix.DragControl._skip=true},$dragIn:function(){return false},$drop:function(s,t,e){if(this._auto_scroll_delay){this._auto_scroll_force=null;this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay)}var context=webix.DragControl.getContext();var id=context.start;this.removeCss(id,"webix_transparent");var index=this.getIndexById(id);this.callEvent("onAfterDropOrder",[id,index,e]);if(context.fragile)this.refresh()}};webix.DragItem={_initHandlers:function(obj,source,target){if(!source)webix.DragControl.addDrop(obj._contentobj,obj,true);if(!target)webix.DragControl.addDrag(obj._contentobj,obj);this.attachEvent("onDragOut",function(a,b){this.$dragMark(a,b)});this.attachEvent("onBeforeAutoScroll",function(){var context=webix.DragControl.getContext();return!!(webix.DragControl._active&&context&&(context.to===this||this._auto_scroll_force))})},drag_setter:function(value){if(value){webix.extend(this,webix.AutoScroll,true);if(value=="order")webix.extend(this,webix.DragOrder,true);if(value=="inner")this._inner_drag_only=true;this._initHandlers(this,value=="source",value=="target");delete this.drag_setter}return value},$dragIn:function(s,t,e){var id=this.locate(e)||null;var context=webix.DragControl._drag_context;if((this._inner_drag_only||context.from._inner_drag_only)&&context.from!==this)return false;var to=webix.DragControl.getMaster(t);var html=this.getItemNode(id,e)||this._dataobj;if(html==webix.DragControl._landing)return html;context.target=id;context.to=to;if(this._auto_scroll_delay)this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay);this._auto_scroll_delay=webix.delay(function(pos,id){this._drag_pause(id);this._auto_scroll(pos,id)},this,[webix.html.pos(e),id],250);if(!this.$dropAllow(context,e)||!this.callEvent("onBeforeDragIn",[context,e])){context.to=context.target=null;if(this._auto_scroll_delay)this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay);return null}this.$dragMark(context,e);return html},$dropAllow:function(){return true},_drag_pause:function(id){},_target_to_id:function(target){return target&&typeof target==="object"?target.toString():target},$dragOut:function(s,t,n,e){var id=(this._viewobj.contains(n)?this.locate(e):null)||null;var context=webix.DragControl._drag_context;if((context.target||"").toString()==(id||"").toString())return null;if(this._auto_scroll_delay){this._auto_scroll_force=null;this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay)}context.target=context.to=null;this.callEvent("onDragOut",[context,e]);return null},$drop:function(s,t,e){if(this._auto_scroll_delay)this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay);var context=webix.DragControl._drag_context;context.to=this;var target=this._target_to_id(context.target);if(this.getBranchIndex){if(target){context.parent=this.getParentId(target);context.index=this.getBranchIndex(target)}}else context.index=target?this.getIndexById(target):this.count();this.$dragMark({},e);if(context.from&&context.from!=context.to&&context.from.callEvent){context.from.callEvent("onBeforeDropOut",[context,e])}if(!this.callEvent("onBeforeDrop",[context,e]))return;this._context_to_move(context,e);this.callEvent("onAfterDrop",[context,e])},_context_to_move:function(context,e){webix.assert(context.from,"Unsopported d-n-d combination");if(context.from){var details={parent:context.parent,mode:context.pos};context.from.move(context.source,context.index,context.to,details)}},_getDragItemPos:function(pos,e){if(this.getItemNode){var id=this.locate(e,true);var node=id?this.getItemNode(id):null;return node?webix.html.offset(node):node}},$drag:function(s,e){var id=this.locate(e,true);if(id){var list=[id];if(this.getSelectedId&&!this._do_not_drag_selection){var selection=this.getSelectedId(true,true);if(selection&&selection.length>1&&webix.PowerArray.find.call(selection,id)!=-1){var hash={};var list=[];for(var i=0;i<selection.length;i++)hash[selection[i]]=true;for(var i=0;i<this.data.order.length;i++){var hash_id=this.data.order[i];if(hash[hash_id])list.push(hash_id)}}}var context=webix.DragControl._drag_context={source:list,start:id};context.fragile=this.addRowCss&&webix.env.touch&&(webix.env.isWebKit||webix.env.isFF);context.from=this;if(this.callEvent("onBeforeDrag",[context,e])){if(webix.Touch)webix.Touch._start_context=null;return context.html||this.$dragHTML(this.getItem(id),e)}}return null},$dragHTML:function(obj,e){return this._toHTML(obj)},$dragMark:function(context,ev){var target=null;if(context.target)target=this._target_to_id(context.target);if(this._marked&&this._marked!=target){if(!context.fragile)this.removeCss(this._marked,"webix_drag_over");this._marked=null}if(!this._marked&&target){this._marked=target;if(!context.fragile)this.addCss(target,"webix_drag_over");return target}if(context.to){return true}else return false}};webix.Group={$init:function(){webix.extend(this.data,webix.GroupStore);this.data.attachEvent("onClearAll",webix.bind(function(){this.data._not_grouped_order=this.data._not_grouped_pull=null;this._group_level_count=0},this))},group:function(config){this.data.ungroup(true);this.data.group(config)},ungroup:function(skipRender){this.data.ungroup(skipRender)}};webix.GroupMethods={sum:function(property,data){data=data||this;var summ=0;for(var i=0;i<data.length;i++)summ+=property(data[i])*1;return summ},min:function(property,data){data=data||this;var min=Infinity;for(var i=0;i<data.length;i++)if(property(data[i])*1<min)min=property(data[i])*1;return min*1},max:function(property,data){data=data||this;var max=-Infinity;for(var i=0;i<data.length;i++)if(property(data[i])*1>max)max=property(data[i])*1;return max*1},count:function(property,data){var count=0;for(var i=0;i<data.length;i++){var some=property(data[i]);if(some!==null&&typeof some!=="undefined")count++}return count},any:function(property,data){return property(data[0])},string:function(property,data){return property.$name}};webix.GroupStore={$init:function(){this.attachEvent("onClearAll",this._reset_groups)},_reset_groups:function(){this._not_grouped_order=this._not_grouped_pull=null;this._group_level_count=0},ungroup:function(skipRender){if(this.getBranchIndex)return this._ungroup_tree.apply(this,arguments);if(this._not_grouped_order){this.order=this._not_grouped_order;this.pull=this._not_grouped_pull;this._not_grouped_pull=this._not_grouped_order=null;if(!skipRender)this.callEvent("onStoreUpdated",[])}},_group_processing:function(scheme){this.blockEvent();this.group(scheme);this.unblockEvent()},_group_prop_accessor:function(val){if(typeof val=="function")return val;var acc=function(obj){return obj[val]};acc.$name=val;return acc},group:function(stats){if(this.getBranchIndex)return this._group_tree.apply(this,arguments);var key=this._group_prop_accessor(stats.by);if(!stats.map[key])stats.map[key]=[key,this._any];var groups={};var labels=[];this.each(function(data){var current=key(data);if(!groups[current]){labels.push({id:current,$group:true,$row:stats.row});groups[current]=webix.toArray()}groups[current].push(data)});for(var prop in stats.map){var functor=stats.map[prop][1]||"any";var property=this._group_prop_accessor(stats.map[prop][0]);if(typeof functor!="function"){webix.assert(webix.GroupMethods[functor],"unknown grouping rule: "+functor);functor=webix.GroupMethods[functor]}for(var i=0;i<labels.length;i++){labels[i][prop]=functor.call(this,property,groups[labels[i].id])}}this._not_grouped_order=this.order;this._not_grouped_pull=this.pull;this.order=webix.toArray();this.pull={};for(var i=0;i<labels.length;i++){var id=this.id(labels[i]);this.pull[id]=labels[i];this.order.push(id);if(this._scheme_init)this._scheme_init(labels[i])}this.callEvent("onStoreUpdated",[])},_group_tree:function(input,parent){this._group_level_count=(this._group_level_count||0)+1;var stats;if(typeof input=="string"){stats={by:this._group_prop_accessor(input),map:{}};stats.map[input]=[input]}else if(typeof input=="function"){stats={by:input,map:{}}}else stats=input;var level;if(parent)level=this.getItem(parent).$level;else{parent=0;level=0}var order=this.branch[parent];var key=this._group_prop_accessor(stats.by);var topbranch=[];var labels=[];for(var i=0;i<order.length;i++){var data=this.getItem(order[i]);var current=key(data);var current_id=level+"$"+current;var ancestor=this.branch[current_id];if(!ancestor){var newitem=this.pull[current_id]={id:current_id,value:current,$group:true,$row:stats.row};if(this._scheme_init)this._scheme_init(newitem);labels.push(newitem);ancestor=this.branch[current_id]=[];ancestor._formath=[];topbranch.push(current_id)}ancestor.push(data.id);ancestor._formath.push(data)}this.branch[parent]=topbranch;for(var prop in stats.map){var functor=stats.map[prop][1]||"any";var property=this._group_prop_accessor(stats.map[prop][0]);if(typeof functor!="function"){webix.assert(webix.GroupMethods[functor],"unknown grouping rule: "+functor);functor=webix.GroupMethods[functor]}for(var i=0;i<labels.length;i++)labels[i][prop]=functor.call(this,property,this.branch[labels[i].id]._formath)}for(var i=0;i<labels.length;i++){var group=labels[i];if(this.hasEvent("onGroupCreated"))this.callEvent("onGroupCreated",[group.id,group.value,this.branch[group.id]._formath]);if(stats.footer){var id="footer$"+group.id;var footer=this.pull[id]={id:id,$footer:true,value:group.value,$level:level,$count:0,$parent:group.id,$row:stats.footer.row};for(var prop in stats.footer){var functor=stats.footer[prop][1]||"any";var property=this._group_prop_accessor(stats.footer[prop][0]);if(typeof functor!="function"){webix.assert(webix.GroupMethods[functor],"unknown grouping rule: "+functor);functor=webix.GroupMethods[functor]}footer[prop]=functor.call(this,property,this.branch[labels[i].id]._formath)}this.branch[group.id].push(footer.id);this.callEvent("onGroupFooter",[footer.id,footer.value,this.branch[group.id]._formath])}delete this.branch[group.id]._formath}this._fix_group_levels(topbranch,parent,level+1);this.callEvent("onStoreUpdated",[])},_ungroup_tree:function(skipRender,parent,force){if(!force&&!this._group_level_count)return;this._group_level_count=Math.max(0,this._group_level_count-1);parent=parent||0;var order=[];var toporder=this.branch[parent];for(var i=0;i<toporder.length;i++){var id=toporder[i];var branch=this.branch[id];if(branch)order=order.concat(branch);delete this.pull[id];delete this.branch[id]}this.branch[parent]=order;for(var i=order.length-1;i>=0;i--){if(this.pull[order[i]].$footer)order.splice(i,1)}this._fix_group_levels(order,0,1);if(!skipRender)this.callEvent("onStoreUpdated",[])},_fix_group_levels:function(branch,parent,level){if(parent)this.getItem(parent).$count=branch.length;for(var i=0;i<branch.length;i++){var item=this.pull[branch[i]];item.$level=level;item.$parent=parent;var next=this.branch[item.id];if(next)this._fix_group_levels(next,item.id,level+1)}}};webix.clipbuffer={_area:null,_blur_id:null,_ctrl:0,init:function(){if(this._area!==null)return this._area;webix.destructors.push({obj:this});this._area=document.createElement("textarea");this._area.className="webix_clipbuffer";this._area.setAttribute("webixignore",1);this._area.setAttribute("spellcheck","false");this._area.setAttribute("autocapitalize","off");this._area.setAttribute("autocorrect","off");this._area.setAttribute("autocomplete","off");document.body.appendChild(this._area);webix.event(document.body,"keydown",webix.bind(function(e){var key=e.keyCode;var ctrl=!!(e.ctrlKey||e.metaKey);if(key===86&&ctrl)webix.delay(this._paste,this,[e],100)},this));return this._area},destructor:function(){this._area=null},set:function(text){this.init();this._area.value=text;this.focus()},focus:function(){if(!this._isSelectRange()){this.init();this._area.focus();this._area.select()}},_isSelectRange:function(){var text="";if(typeof window.getSelection!="undefined"){text=window.getSelection().toString()}else if(typeof document.selection!="undefined"&&document.selection.type=="Text"){text=document.selection.createRange().text}return!!text},_paste:function(e){var trg=e.target||e.srcElement;if(trg===this._area){var text=this._area.value;var last_active=webix.UIManager.getFocus();if(last_active&&(!last_active.getEditor||!last_active.getEditor())){last_active.callEvent("onPaste",[text]);this._area.select()}}}};webix.CopyPaste={clipboard_setter:function(value){if(value===true||value===1)value="modify";this.attachEvent("onAfterSelect",function(id){if(!this.getEditor||!this.getEditor()){var item=this.getItem(id);var text=this.type.templateCopy(item);webix.clipbuffer.set(text,this);webix.clipbuffer.focus();webix.UIManager.setFocus(this)}});this.attachEvent("onPaste",function(text){if(!webix.isUndefined(this._paste[this._settings.clipboard]))this._paste[this._settings.clipboard].call(this,text)});this.attachEvent("onFocus",function(){webix.clipbuffer.focus()});this.attachEvent("onItemClick",function(id){if(!this._selected||this._selected.find(id)!==-1){webix.clipbuffer.focus();webix.UIManager.setFocus(this)}});return value},_paste:{insert:function(text){this.add({value:text})},modify:function(text){var sel=this.getSelectedId(true);for(var i=0;i<sel.length;i++){this.getItem(sel[i]).value=text;this.refresh(sel[i])}},custom:function(text){}},templateCopy_setter:function(value){this.type.templateCopy=webix.template(value)},type:{templateCopy:function(item){return this.template(item)}}};webix.KeysNavigation={$init:function(){if(this.getSelectedId){this.attachEvent("onAfterRender",this._set_focusable_item);this.attachEvent("onAfterSelect",webix.once(function(){if(this.count()>1){var node=this._dataobj.querySelector("["+this._id+"]");if(node)node.setAttribute("tabindex","-1")}}))}},_set_focusable_item:function(){var sel=this.getSelectedId(true);if(!sel.length||!this.getItemNode(sel[0])){var node=this._dataobj.querySelector("["+this._id+"]");if(node)node.setAttribute("tabindex","0")}},_navigation_helper:function(mode){return function(view,e){var tag=e.srcElement||e.target;if(!tag.getAttribute("webixignore")){var name=tag.tagName;if(name=="INPUT"||name=="TEXTAREA"||name=="SELECT")return true}if(view&&view.moveSelection&&view.config.navigation&&!view._in_edit_mode){webix.html.preventEvent(e);return view.moveSelection(mode,e.shiftKey)}return true}},moveSelection:function(mode,shift,focus){var config=this._settings;if(config.disabled)return;var selected=this.getSelectedId(true);var x_layout=this.count&&(config.layout=="x"||config.xCount>1);if((mode=="right"||mode=="left")&&this._parent_menu){var parent=webix.$$(this._parent_menu);parent._hide_sub_menu(true);if(parent.config.layout==="x")parent.moveSelection(mode);else webix.UIManager.setFocus(parent);return}if(!selected.length&&this.count()){if(mode=="down"||mode=="right"&&x_layout)mode="top";else if(mode=="up"||mode=="left"&&x_layout)mode="bottom";else return;selected=[this.getFirstId()]}if(selected.length==1){selected=selected[0];var prev=selected;if(mode=="left"&&this.close)return this.close(selected);if(mode=="right"&&this.open)return this.open(selected);else if(mode=="top"){selected=this.getFirstId()}else if(mode=="bottom"){selected=this.getLastId()}else if(mode=="up"||mode=="left"||mode=="pgup"){var index=this.getIndexById(selected);var step=mode=="pgup"?10:1;selected=this.getIdByIndex(Math.max(0,index-step))}else if(mode=="down"||mode=="right"||mode=="pgdown"){var index=this.getIndexById(selected);var step=mode=="pgdown"?10:1;selected=this.getIdByIndex(Math.min(this.count()-1,index+step))}else{webix.assert(false,"Not supported selection moving mode");return}if(this._skip_item)selected=this._skip_item(selected,prev,mode);this.showItem(selected);this.select(selected);if(this.getSubMenu&&this.getSubMenu(selected))this._mouse_move_activation(selected,this.getItemNode(selected));if(!this.config.clipboard&&focus!==false){var node=this.getItemNode(selected);if(node)node.focus()}}return false},navigation_setter:function(value){if(value&&!webix.UIManager._global_nav_grid_hotkeys){webix.UIManager._global_nav_grid_hotkeys=true;webix.UIManager.addHotKey("up",this._navigation_helper("up"));webix.UIManager.addHotKey("down",this._navigation_helper("down"));webix.UIManager.addHotKey("shift+up",this._navigation_helper("up"));webix.UIManager.addHotKey("shift+down",this._navigation_helper("down"));webix.UIManager.addHotKey("shift+right",this._navigation_helper("right"));webix.UIManager.addHotKey("shift+left",this._navigation_helper("left"));webix.UIManager.addHotKey("pageup",this._navigation_helper("pgup"));webix.UIManager.addHotKey("pagedown",this._navigation_helper("pgdown"));webix.UIManager.addHotKey("home",this._navigation_helper("top"));webix.UIManager.addHotKey("end",this._navigation_helper("bottom"));webix.UIManager.addHotKey("right",this._navigation_helper("right"));webix.UIManager.addHotKey("left",this._navigation_helper("left"))}return value}};webix.protoUI({name:"tree",defaults:{scroll:"a",navigation:true},$init:function(){this._viewobj.className+=" webix_tree";webix.extend(this.data,webix.TreeStore,true);webix.extend(this.on_click,webix.TreeClick);this.attachEvent("onAfterRender",this._refresh_scroll);this.attachEvent("onPartialRender",this._refresh_scroll);this.data.provideApi(this,true);this._viewobj.setAttribute("role","tree")},_id:"webix_tm_id",on_context:{},on_dblclick:{webix_tree_checkbox:function(){if(this.on_click.webix_tree_checkbox)return this.on_click.webix_tree_checkbox.apply(this,arguments)}},$fixEditor:function(editor){var item=this.getItemNode(editor.id).querySelector("span");if(item){if(item.innerHTML==="")item.innerHTML="&nbsp;";var padding=10;var pos=item.offsetLeft;editor.node.style.width=this.$view.scrollWidth-pos-padding+"px";editor.node.style.marginLeft=pos+"px";editor.node.style.left="0px"}},on_click:{webix_tree_item:function(e,id,node){if(this._settings.activeTitle){var item=this.getItem(id);if(item.open)this.close(id);else this.open(id)}if(this._settings.select){if(this._settings.select=="multiselect"||this._settings.multiselect){if(this._settings.multiselect=="level"){var select=this.getSelectedId(true)[0];if(select&&this.getParentId(id)!=this.getParentId(select))return}this.select(id,false,e.ctrlKey||e.metaKey||this._settings.multiselect=="touch",e.shiftKey)}else this.select(id)}}},_paste:{insert:function(text){var parent=this.getSelectedId()||"0";this.add({value:text},null,parent)},modify:function(text){var sel=this.getSelectedId(true);for(var i=0;i<sel.length;i++){this.getItem(sel[i]).value=text;this.refresh(sel[i])}},custom:function(text){}},_drag_order_complex:true,$dragHTML:function(obj){return"<div class='borderless'>"+this.type.template(obj,this.type)+"</div>"},type:webix.extend({template:function(obj,common){var template=common["template"+obj.level]||common.templateCommon;return template.apply(this,arguments)},classname:function(obj,common,marks){var css="webix_tree_item";if(obj.$css){if(typeof obj.$css=="object")obj.$css=webix.html.createCss(obj.$css);css+=" "+obj.$css}if(marks&&marks.$css)css+=" "+marks.$css;return css},aria:function(obj,common,marks){return'role="treeitem"'+(marks&&marks.webix_selected?' aria-selected="true" tabindex="0"':' tabindex="-1"')+(obj.$count?'aria-expanded="'+(obj.open?"true":"false")+'"':"")+'aria-level="'+obj.$level+'"'},templateCommon:webix.template("{common.icon()} {common.folder()} <span>#value#</span>"),templateStart:webix.template('<div webix_tm_id="#id#" class="{common.classname()}" {common.aria()}>'),templateEnd:webix.template("</div>"),templateCopy:webix.template("#value#")},webix.TreeType)},webix.AutoTooltip,webix.Group,webix.TreeAPI,webix.DragItem,webix.TreeDataMove,webix.SelectionModel,webix.KeysNavigation,webix.MouseEvents,webix.Scrollable,webix.TreeDataLoader,webix.ui.proto,webix.TreeRenderStack,webix.CopyPaste,webix.EventSystem);webix.TreeStateCheckbox={_init_render_tree_state:function(){if(this._branch_render_supported){var old_render=this.render;this.render=function(id,data,mode){var updated=old_render.apply(this,arguments);if(this._settings.threeState&&updated&&data!="checkbox")this._setThirdState.apply(this,arguments)};this._init_render_tree_state=function(){}}},threeState_setter:function(value){if(value)this._init_render_tree_state();return value},_setThirdState:function(id){var i,leaves,parents,checkedParents,tree;parents=[];tree=this;if(id&&!tree.data.pull[id]){id=0}if(!id||tree.data.pull[id].$count){leaves=this._getAllLeaves(id);leaves.sort(function(a,b){return tree.data.pull[b].$level-tree.data.pull[a].$level});for(i=0;i<leaves.length;i++){if(!i||tree.data.pull[leaves[i]].$parent!=tree.data.pull[leaves[i-1]].$parent)parents=parents.concat(tree._setParentThirdState(leaves[i]))}}else{parents=parents.concat(tree._setParentThirdState(id))}checkedParents={};for(i=0;i<parents.length;i++){if(!checkedParents[parents[i]]){checkedParents[parents[i]]=1;this._setCheckboxIndeterminate(parents[i])}}tree=null},_setCheckboxIndeterminate:function(id){var chElem,elem;elem=this.getItemNode(id);if(elem){this.render(id,"checkbox","update");if(this.getItem(id).indeterminate){elem=this.getItemNode(id);chElem=elem.getElementsByTagName("input")[0];if(chElem)chElem.indeterminate=this.getItem(id).indeterminate}}},_setParentThirdState:function(itemId){var checked,checkedCount,indeterminate,parentId,result,tree,unsureCount,needrender;parentId=this.getParentId(itemId);tree=this;result=[];while(parentId&&parentId!="0"){unsureCount=0;checkedCount=0;this.data.eachChild(parentId,function(obj){if(obj.indeterminate){unsureCount++}else if(obj.checked){checkedCount++}});checked=indeterminate=needrender=false;var item=this.getItem(parentId);if(checkedCount==item.$count){checked=true}else if(checkedCount>0||unsureCount>0){indeterminate=true}if(indeterminate||indeterminate!=item.indeterminate)needrender=true;item.indeterminate=indeterminate;if(checked||item.checked!=checked)needrender=true;item.checked=checked;if(needrender){result.push(parentId);parentId=this.getParentId(parentId)}else parentId=0}return result},getChecked:function(){var result=[];var tree=this;this.data.eachSubItem(0,function(obj){if(tree.isChecked(obj.id))result.push(obj.id)});return result},_tree_check_uncheck_3:function(id,mode){var item=this.getItem(id);if(item){if(mode==="")mode=!item.checked;if(item.checked!=mode||item.indeterminate){item.checked=mode;this._correctThreeState(id);var parents=this._setParentThirdState(id);if(this._branch_render_supported&&parents.length<5){for(var i=0;i<parents.length;i++)this._setCheckboxIndeterminate(parents[i])}else this.refresh();this.callEvent("onItemCheck",[id,mode])}}},checkItem:function(id){this._tree_check_uncheck(id,true);this.updateItem(id)},uncheckItem:function(id){this._tree_check_uncheck(id,false);this.updateItem(id)},_checkUncheckAll:function(id,mode,all){var method=mode?"checkItem":"uncheckItem";if(!id)id=0;else this[method](id);if(this._settings.threeState){if(!id)this.data.eachChild(0,function(item){this[method](item.id)},this,all)}else this.data.each(function(item){this[method](item.id)},this,all,id)},checkAll:function(id,all){this._checkUncheckAll(id,true,all)},uncheckAll:function(id,all){this._checkUncheckAll(id,false,all)},_correctThreeState:function(id){var i,leaves,state;var item=this.getItem(id);item.indeterminate=false;state=item.checked;this.data.eachSubItem(id,function(child){child.indeterminate=false;child.checked=state});if(this._branch_render_supported&&this.isBranchOpen(item.$parent)){this.render(id,0,"branch")}},isChecked:function(id){return this.getItem(id).checked},_getAllLeaves:function(parentId){var result=[];this.data.eachSubItem(parentId,function(obj,branch){if(!branch)result.push(obj.id)});return result}};if(webix.ui.tree)webix.extend(webix.ui.tree,webix.TreeStateCheckbox,true);webix.type(webix.ui.tree,{name:"lineTree",css:"webixLineTree",icon:function(obj,common){var html="";var open="";for(var i=1;i<=obj.$level;i++){if(i==obj.$level)var open=obj.$count?obj.open?"webix_tree_open ":"webix_tree_close ":"webix_tree_none ";var icon=this._icon_src(obj,common,i);if(icon)html+="<div class='"+open+"webix_tree_img webix_tree_"+icon+"'></div>"}return html},_icon_src:function(obj,common,level){var lines=common._tree_branch_render_state;var tree=webix.TreeRenderStack._obj;if(lines===0&&tree){var lines_level=obj.$level;var branch_id=obj.id;lines=[];while(lines_level){var parent_id=tree.getParentId(branch_id);var pbranch=tree.data.branch[parent_id];if(pbranch[pbranch.length-1]==branch_id)lines[lines_level]=true;branch_id=parent_id;lines_level--}common._tree_branch_render_state=lines}if(!lines)return 0;if(level==obj.$level){var mode=3;if(!obj.$parent){if(obj.$index===0)mode=4}if(lines[obj.$level])mode=2;if(obj.$count){if(obj.open)return"minus"+mode;else return"plus"+mode}else return"line"+mode}else{if(!lines[level])return"line1";return"blank"}}});webix.NavigationButtons={$init:function(){this.$ready.push(function(){this.attachEvent("onKeyPress",this._onKeyPress)})},_moveActive:function(code,e){if(code===37||code===39){webix.html.preventEvent(e);this._showNavItem(code===37?-1:1);var node=this._navPanel.querySelector("[tabindex='0']");if(node)node.focus()}},_renderPanel:function(){webix.html.remove(this._navPanel);this._navPanel=webix.html.create("DIV",{class:"webix_nav_panel "+"webix_nav_panel_"+this._settings.navigation.type,role:"tablist"},"");this._viewobj.appendChild(this._navPanel);this._renderNavItems();this._renderNavButtons();this._setLinkEventHandler()},_setLinkEventHandler:function(){var h=[];if(this._navPanel)h[0]=webix.event(this._navPanel,"click",webix.bind(function(e){var elem=e.srcElement||e.target;var found=false;while(elem!=this._navPanel&&!found){var bindId=elem.getAttribute(this._linkAttr);if(bindId){found=true;this._showPanelBind(bindId)}elem=elem.parentNode}},this));if(this._prevNavButton)h[1]=webix.event(this._prevNavButton,"click",webix.bind(function(e){this._showNavItem(-1)},this));if(this._nextNavButton)h[1]=webix.event(this._nextNavButton,"click",webix.bind(function(e){this._showNavItem(1)},this));this.attachEvent("onDestruct",function(){for(var i=0;i<h.length;i++){this.detachEvent(h[i])}h=null})},_showNavItem:function(inc){if(this._cells){var index=this._active_cell+inc;if(index>=this._cells.length||index<0){index=index<0?this._cells.length-1:0}this.setActiveIndex(index)}},_showPanelBind:function(id){if(this._cells)webix.$$(id).show()},_renderNavItems:function(){var item,config;config=this._settings.navigation;if(config.items){this._linkAttr=config.linkAttr||"bind_id";if(!this._navPanel)this._renderPanel();else this._clearPanel();var data=this._cells?this._cells:this.data.order;if(data.length>1){for(var i=0;i<data.length;i++){item=webix.html.create("DIV",{class:"webix_nav_item webix_nav_"+(i==this._active_cell?"active":"inactive"),role:"tab",tabindex:i==this._active_cell?"0":"-1"},"<div></div>");var id=this._cells?this._cells[i]._settings.id:data[i];if(id)item.setAttribute(this._linkAttr,id);this._navPanel.appendChild(item)}}}},_clearPanel:function(){if(this._navPanel){var coll=this._navPanel.childNodes;for(var i=coll.length-1;i>=0;i--)webix.html.remove(coll[i])}},_renderNavButtons:function(){var item,config;config=this._settings.navigation;if(config.buttons){if(this._prevNavButton)webix.html.remove(this._prevNavButton);if(this._prevNavButton)webix.html.remove(this._nextNavButton);this._prevNavButton=webix.html.create("DIV",{class:"webix_nav_button_"+config.type+" webix_nav_button_prev ",role:"button",tabindex:"0","aria-label":webix.i18n.aria.prevTab},'<div class="webix_nav_button_inner"></div>');this._viewobj.appendChild(this._prevNavButton);this._nextNavButton=webix.html.create("DIV",{class:"webix_nav_button_"+config.type+" webix_nav_button_next ",role:"button",tabindex:"0","aria-label":webix.i18n.aria.nextTab},'<div class="webix_nav_button_inner"></div>');this._viewobj.appendChild(this._nextNavButton)}}};(function(){webix.env.printPPI=96;webix.env.printMargin=.75*webix.env.printPPI;var ppi=webix.env.printPPI;var margin=webix.env.printMargin;var papers={a4:"A4",a3:"A3",letter:"letter"};var fits={page:true,data:true};var modes={portrait:true,landscape:true};var sizes={A3:{width:11.7,height:16.5},A4:{width:8.27,height:11.7},letter:{width:8.5,height:11}};webix.print=function(id,options){var view=webix.$$(id);if(view&&view.$printView)view=view.$printView();webix.assert(view,"non-existing view for printing");if(!view)return;if(view.callEvent)view.callEvent("onBeforePrint",[options]);options=_checkOptions(options);_beforePrint(options);if(!view.$customPrint||view.$customPrint(options)===true)_print(view,options);_afterPrint(options)};function _checkOptions(options){options=options||{};options.paper=papers[(options.paper||"").toLowerCase()]||"A4";options.mode=modes[options.mode]?options.mode:"portrait";options.fit=fits[options.fit]?options.fit:"page";options.scroll=options.scroll||false;options.size=sizes[options.paper];options.margin=options.margin||options.margin===0?options.margin:{};margin=isNaN(options.margin*1)?margin:options.margin;options.margin={top:options.margin.top||options.margin.top===0?options.margin.top:margin,bottom:options.margin.bottom||options.margin.bottom===0?options.margin.bottom:margin,right:options.margin.right||options.margin.right===0?options.margin.right:margin,left:options.margin.left||options.margin.left===0?options.margin.left:margin};return options}function _beforePrint(options){webix.html.addCss(document.body,"webix_print");if(options.docHeader)_getHeaderFooter("Header",options);if(options.docFooter)_getHeaderFooter("Footer",options);var cssString="@media print { "+"@page{ size:"+options.paper+" "+options.mode+";"+"margin-top:"+options.margin.top+"px;margin-bottom:"+options.margin.bottom+"px;margin-right:"+options.margin.right+"px;margin-left:"+options.margin.left+"px;}"+"}";webix.html.addStyle(cssString,"print")}function _afterPrint(options){webix.html.removeCss(document.body,"webix_print");webix.html.removeStyle("print");if(options.docHeader)webix.html.remove(options.docHeader);if(options.docFooter)webix.html.remove(options.docFooter)}function _print(view,options){var doc=view.$view.cloneNode(true);var canvases=view.$view.getElementsByTagName("canvas");if(canvases.length)for(var i=canvases.length-1;i>=0;i--){var destCtx=doc.getElementsByTagName("canvas")[i].getContext("2d");destCtx.drawImage(canvases[i],0,0)}webix.html.insertBefore(doc,options.docFooter,document.body);webix.html.addCss(doc,"webix_ui_print");if(!options.scroll&&(view._dataobj&&view.data&&view.data.pull||view.getBody))webix.html.addCss(doc,"webix_print_noscroll");window.print();webix.html.remove(doc)}function _getHeaderFooter(group,options){var header=webix.html.create("div",{class:"webix_view webix_print_"+group.toLowerCase(),style:"height:0px;visibility:hidden;"},options["doc"+group]);if(group==="Header")webix.html.insertBefore(header,document.body.firstChild);else document.body.appendChild(header);options["doc"+group]=header}})();webix.CustomPrint={$customPrint:function(options,htmlOnly){if(this._prePrint(options,htmlOnly))return true;var tableData=this._getTableArray(options);var table=this._getTableHTML(tableData,options);if(htmlOnly)return table;var doc=webix.html.create("div",{class:"webix_ui_print"});doc.appendChild(table);webix.html.insertBefore(doc,options.docFooter,document.body);window.print();webix.html.remove(doc)},_prePrint:function(options,htmlOnly){if(!htmlOnly&&(this.config.layout=="y"||options.scroll||this.config.prerender||this.config.autoheight))return true;if(this.config.layout=="x")webix.extend(options||{},{xCount:this.count(),nobreaks:true},true)},_getPageWidth:function(options){if(options.fit=="page")return Infinity;var size=options.size;var width=size[options.mode=="portrait"?"width":"height"];return Math.min(width*webix.env.printPPI-2*webix.env.printMargin)},_getTableArray:function(options,base,start){var maxWidth=this._getPageWidth(options);var xCount=options.xCount||this._getVisibleRange()._dx;var tableArray=[];var colrow=[];var width=0;var newTableStart,rownum,colnum;start=start||0;base=base||[];for(var i=0;i<this.data.order.length;){var obj=this.data.pull[this.data.order[i]];rownum=parseInt(i/xCount);colnum=i-rownum*xCount;if(obj&&colnum>=start){width+=this.type.width;if(width>maxWidth&&colnum>start){newTableStart=colrow.length+start;tableArray.push(colrow);i=i+(xCount-colrow.length);colrow=[];width=0;continue}var cellValue=this.type.template(obj,this.type);var className=this._itemClassName;var style={display:"table-cell",height:this.type.height+"px",width:this.type.width+"px"};colrow.push({txt:cellValue,className:className+" "+(obj.$css||""),style:style});if((i+1)%xCount===0){tableArray.push(colrow);colrow=[];width=0}}i++}base.push(tableArray);if(newTableStart)this._getTableArray(options,base,newTableStart);return base},_getTableHTML:function(tableData,options){var container=webix.html.create("div");tableData.forEach(webix.bind(function(table,i){var tableHTML=webix.html.create("table",{class:"webix_table_print "+this.$view.className,style:"border-collapse:collapse"});table.forEach(function(row){var tr=webix.html.create("tr");row.forEach(function(column){var td=webix.html.create("td");if(column.txt)td.innerHTML=column.txt;if(column.className)td.className=column.className;if(column.style){var keys=Object.keys(column.style);keys.forEach(function(key){if(column.style[key])td.style[key]=column.style[key]})}if(column.span){if(column.span.colspan>1)td.colSpan=column.span.colspan;if(column.span.rowspan>1)td.rowSpan=column.span.rowspan}tr.appendChild(td)});tableHTML.appendChild(tr)});container.appendChild(tableHTML);if(!options.nobreaks&&i+1<tableData.length){var br=webix.html.create("DIV",{class:"webix_print_pagebreak"});container.appendChild(br)}},this));return container}};webix.protoUI({name:"list",_listClassName:"webix_list",_itemClassName:"webix_list_item",$init:function(config){webix.html.addCss(this._viewobj,this._listClassName+((config.layout||this.defaults.layout)=="x"?"-x":""));this.data.provideApi(this,true);this._auto_resize=webix.bind(this._auto_resize,this);this.data.attachEvent("onStoreUpdated",this._auto_resize);this.data.attachEvent("onSyncApply",this._auto_resize);this.attachEvent("onAfterRender",this._correct_width_scroll);this._viewobj.setAttribute("role","listbox")},$dragHTML:function(obj,e){if(this._settings.layout=="y"&&this.type.width=="auto"){this.type.width=this._content_width;var node=this._toHTML(obj);this.type.width="auto";return node}return this._toHTML(obj)},defaults:{select:false,scroll:true,layout:"y",navigation:true},_id:"webix_l_id",on_click:{webix_list_item:function(e,id){if(this._settings.select){this._no_animation=true;if(this._settings.select=="multiselect"||this._settings.multiselect)this.select(id,false,e.ctrlKey||e.metaKey||this._settings.multiselect=="touch",e.shiftKey);else this.select(id);this._no_animation=false}}},on_dblclick:{},getVisibleCount:function(){return Math.floor(this._content_height/this._one_height())},_auto_resize:function(){if(this._settings.autoheight||this._settings.autowidth)this.resize()},_auto_height_calc:function(count){var value=this.data.$pagesize||this.count();this._onoff_scroll(count&&count<value);if(this._settings.autoheight&&value<(count||Infinity))count=value;var height=this._one_height()*count+(this.type.margin||0);if(this.getUnits)height+=this.getUnits().length*this.type.headerHeight;return Math.max(height,this._settings.minHeight||0)},_one_height:function(){return this.type.height+(this.type.margin||0)},_auto_width_calc:function(count){var value=this.data.$pagesize||this.count();this._onoff_scroll(count&&count<value);if(this._settings.autowidth&&value<(count||Infinity))count=value;return this.type.width*count},_correct_width_scroll:function(){if(this._settings.layout=="x")this._dataobj.style.width=this.type.width!="auto"?this.type.width*this.count()+"px":"auto"},$getSize:function(dx,dy){if(this._settings.layout=="y"){if(this.type.width!="auto")this._settings.width=this.type.width+(this._scroll_y?webix.ui.scrollSize:0);if(this._settings.yCount||this._settings.autoheight)this._settings.height=this._auto_height_calc(this._settings.yCount)||1}else{if(this.type.height!="auto")this._settings.height=this._one_height()+(this._scroll_x?webix.ui.scrollSize:0);if(this._settings.xCount||this._settings.autowidth)this._settings.width=this._auto_width_calc(this._settings.xCount)||1}return webix.ui.view.prototype.$getSize.call(this,dx,dy)},$setSize:function(){webix.ui.view.prototype.$setSize.apply(this,arguments)},type:{css:"",widthSize:function(obj,common){return common.width+(common.width>-1?"px":"")},heightSize:function(obj,common){return common.height+(common.height>-1?"px":"")},classname:function(obj,common,marks){var css="webix_list_item";if(obj.$css){if(typeof obj.$css=="object")obj.$css=webix.html.createCss(obj.$css);css+=" "+obj.$css}if(marks&&marks.$css)css+=" "+marks.$css;return css},aria:function(obj,common,marks){return'role="option"'+(marks&&marks.webix_selected?' aria-selected="true" tabindex="0"':' tabindex="-1"')+(obj.$count&&obj.$template?'aria-expanded="true"':"")},template:function(obj){return(obj.icon?"<span class='webix_icon fa-"+obj.icon+"'></span> ":"")+obj.value+(obj.badge?"<div class='webix_badge'>"+obj.badge+"</div>":"")},width:"auto",templateStart:webix.template('<div webix_l_id="#id#" class="{common.classname()}" style="width:{common.widthSize()}; height:{common.heightSize()}; overflow:hidden;" {common.aria()}>'),templateEnd:webix.template("</div>")},$skin:function(){this.type.height=webix.skin.$active.listItemHeight}},webix.CustomPrint,webix.KeysNavigation,webix.DataMove,webix.DragItem,webix.MouseEvents,webix.SelectionModel,webix.Scrollable,webix.ui.proto,webix.CopyPaste);webix.protoUI({name:"grouplist",defaults:{animate:{}},_listClassName:"webix_grouplist",$init:function(){webix.extend(this.data,webix.TreeStore,true);this.data.count=function(){return this.order.length};this.data.provideApi(this,true);this.data.attachEvent("onClearAll",webix.bind(this._onClear,this));this._onClear()},_onClear:function(){this._nested_cursor=[];this._nested_chain=[]},$setSize:function(){if(webix.ui.view.prototype.$setSize.apply(this,arguments)){this._dataobj.style.width=this._content_width}},on_click:{webix_list_item:function(e,id){if(this._in_animation){return false}for(var i=0;i<this._nested_chain.length;i++){if(this._nested_chain[i]==id){for(var j=i;j<this._nested_chain.length;j++){this.data.getItem(this._nested_chain[j]).$template=""}if(!i){this._nested_cursor=this.data.branch[0];this._nested_chain=[]}else{this._nested_cursor=this.data.branch[this._nested_chain[i-1]];this._nested_chain.splice(i)}this._is_level_down=false;return this.render()}}var obj=this.getItem(id);if(obj.$count){this._is_level_down=true;this._nested_chain.push(id);obj.$template="Back";this._nested_cursor=this.data.branch[obj.id];return this.render()}else{if(this._settings.select){this._no_animation=true;if(this._settings.select=="multiselect"||this._settings.multiselect)this.select(id,false,this._settings.multiselect=="touch"||e.ctrlKey||e.metaKey,e.shiftKey);else this.select(id);this._no_animation=false}}}},getOpenState:function(){return{parents:this._nested_chain,branch:this._nested_cursor}},render:function(id,data,type,after){var i,lastChain;this._nested_chain=webix.copy(this._nested_chain);this._nested_cursor=webix.copy(this._nested_cursor);if(this._nested_chain.length){for(i=0;i<this._nested_chain.length;i++){if(!this.data.branch[this._nested_chain[i]]){this._nested_chain.splice(i,1);i--}}}lastChain=this._nested_chain.length?this._nested_chain[this._nested_chain.length-1]:0;this._nested_cursor=webix.copy(this.data.branch[lastChain]);if(!this._nested_cursor.length&&this._nested_chain.length){this._nested_cursor=[lastChain];this._nested_chain.pop()}if(this._in_animation){return webix.delay(this.render,this,arguments,100)}for(i=0;i<this._nested_cursor.length;i++)this.data.getItem(this._nested_cursor[i]).$template="";if(!this._nested_cursor.length)this._nested_cursor=this.data.branch[0];this.data.order=webix.toArray([].concat(this._nested_chain).concat(this._nested_cursor));if(this.callEvent("onBeforeRender",[this.data])){if(this._no_animation||!this._dataobj.innerHTML||!(webix.animate.isSupported()&&this._settings.animate)||this._prev_nested_chain_length==this._nested_chain.length){webix.RenderStack.render.apply(this,arguments)}else{if(this.callEvent("onBeforeRender",[this.data])){if(!this._back_scroll_states)this._back_scroll_states=[];var next_div=this._dataobj.cloneNode(false);next_div.innerHTML=this.data.getRange().map(this._toHTML,this).join("");var aniset=webix.extend({},this._settings.animate);aniset.direction=this._is_level_down?"left":"right";var animArr=[webix.clone(aniset),webix.clone(aniset)];if(this._is_level_down){this._back_scroll_states.push(this.getScrollState());if(webix.Touch&&webix.Touch.$active){animArr[0].y=0;animArr[1].y=-this.getScrollState().y}}else{var getScrollState=this._back_scroll_states.pop();if(webix.Touch&&webix.Touch.$active){animArr[0].y=-getScrollState.y;animArr[1].y=-this.getScrollState().y}}var line=webix.animate.formLine(next_div,this._dataobj,aniset);if(webix.Touch&&webix.Touch.$active)webix.Touch._set_matrix(next_div,0,this._is_level_down?0:animArr[0].y,"0ms");aniset.master=this;aniset.callback=function(){this._dataobj=next_div;if(!this._is_level_down){if(webix.Touch&&webix.Touch.$active){webix.delay(function(){webix.Touch._set_matrix(next_div,0,animArr[0].y,"0ms")},this)}else if(getScrollState)this.scrollTo(0,getScrollState.y)}else if(!(webix.Touch&&webix.Touch.$active)){this.scrollTo(0,0)}webix.animate.breakLine(line);aniset.master=aniset.callback=null;this._htmlmap=null;this._in_animation=false;this.callEvent("onAfterRender",[])};this._in_animation=true;webix.animate(line,animArr)}}this._prev_nested_chain_length=this._nested_chain.length}},templateBack_setter:function(config){this.type.templateBack=webix.template(config)},templateItem_setter:function(config){this.type.templateItem=webix.template(config)},templateGroup_setter:function(config){this.type.templateGroup=webix.template(config)},type:{template:function(obj,common){if(obj.$count)return common.templateGroup(obj,common);return common.templateItem(obj,common)},css:"group",classname:function(obj,common,marks){return"webix_list_item webix_"+(obj.$count?"group":"item")+(obj.$template?"_back":"")+(marks&&marks.webix_selected?" webix_selected ":"")+(obj.$css?obj.$css:"")},templateStart:webix.template('<div webix_l_id="#id#" class="{common.classname()}" style="width:{common.widthSize()}; height:{common.heightSize()};  overflow:hidden;" {common.aria()}>'),templateBack:webix.template("#value#"),templateItem:webix.template("#value#"),templateGroup:webix.template("#value#"),templateEnd:function(obj,common){var html="";if(obj.$count)html+="<div class='webix_arrow_icon'></div>";html+="</div>";return html}},showItem:function(id){var obj,parent;if(id){obj=this.getItem(id);parent=obj.$parent;if(obj.$count)parent=obj.id}this._nested_cursor=this.data.branch[parent||0];this._nested_chain=[];while(parent){this.getItem(parent).$template="Back";this._nested_chain.unshift(parent);parent=this.getItem(parent).$parent}this._no_animation=true;this.render();this._no_animation=false;webix.RenderStack.showItem.call(this,id)}},webix.Group,webix.ui.list);webix.type(webix.ui.grouplist,{});webix.protoUI({name:"unitlist",_id:"webix_item_id",uniteBy_setter:webix.template,render:function(id,data,type,after){var config=this._settings;if(!this.isVisible(config.id))return;if(webix.debug_render)webix.log("Render: "+this.name+"@"+config.id);if(!config.uniteBy){if(webix.debug_render){webix.log("uniteBy is undefined")}return false}if(id){var cont=this.getItemNode(id);if(cont&&type=="update"&&this._settings.uniteBy.call(this,data)==this.getItem(id).$unitValue){var t=this._htmlmap[id]=this._toHTMLObject(data);webix.html.insertBefore(t,cont);webix.html.remove(cont);return}}if(this.callEvent("onBeforeRender",[this.data])){this.units=null;this._setUnits();if(this.units){this._dataobj.innerHTML=this._getUnitRange().map(this._toHTML,this).join("");this._htmlmap=null}this.callEvent("onAfterRender",[])}},getUnits:function(){var result=[];if(this.units){for(var b in this.units){result.push(b)}}return result},getUnitList:function(id){return this.units?this.units[id]:null},_toHTML:function(obj){var mark=this.data._marks[obj.id];webix.assert(!obj.$template||this.type["template"+obj.$template],"RenderStack :: Unknown template: "+obj.$template);this.callEvent("onItemRender",[obj]);if(obj.$unit){return this.type.templateStartHeader(obj,this.type)+this.type.templateHeader.call(this,obj.$unit)+this.type.templateEnd(obj,this.type)}return this.type.templateStart(obj,this.type,mark)+(obj.$template?this.type["template"+obj.$template]:this.type.template)(obj,this.type)+this.type.templateEnd(obj,this.type)},_getUnitRange:function(){var data,i,u,unit;data=[];var min=this.data.$min||0;var max=this.data.$max||Infinity;var count=0;for(u in this.units){data.push({$unit:u});unit=this.units[u];for(i=0;i<unit.length;i++){if(count==min)data=[{$unit:u}];data.push(this.getItem(unit[i]));if(count==max)return webix.toArray(data);count++}}return webix.toArray(data)},_setUnits:function(){var list=this;this.units={};this.data.each(function(obj){var result=list._settings.uniteBy.call(this,obj);obj.$unitValue=result;if(!list.units[result])list.units[result]=[];list.units[result].push(obj.id)})},type:{headerHeight:20,templateHeader:function(value){return"<span class='webix_unit_header_inner'>"+value+"</span>"},templateStart:function(obj,type,marks){if(obj.$unit)return type.templateStartHeader.apply(this,arguments);var className="webix_list_item webix_list_"+type.css+"_item"+(marks&&marks.webix_selected?" webix_selected":"")+(obj.$css?obj.$css:"");var style="width:"+type.widthSize(obj,type,marks)+"; height:"+type.heightSize(obj,type,marks)+"; overflow:hidden;"+(type.layout&&type.layout=="x"?"float:left;":"");return'<div webix_item_id="'+obj.id+'" class="'+className+'" style="'+style+'" '+type.aria(obj,type,marks)+">"},templateStartHeader:function(obj,type,marks){var className="webix_unit_header webix_unit_"+type.css+"_header"+(obj.$selected?"_selected":"");var style="width:"+type.widthSize(obj,type,marks)+"; height:"+type.headerHeight+"px; overflow:hidden;";return'<div webix_unit_id="'+obj.$unit+'" class="'+className+'" style="'+style+'">'}},$skin:function(){this.type.headerHeight=webix.skin.$active.unitHeaderHeight||20}},webix.ui.list);webix.EditAbility={defaults:{editaction:"click"},$init:function(config){this._editors={};this._in_edit_mode=0;this._edit_open_time=0;this._contentobj.style.position="relative";if(config)config.onDblClick=config.onDblClick||{};this.attachEvent("onAfterRender",this._refocus_inline_editor);if(this._settings.editable)this._init_edit_events_once();webix.extend(this,webix.Undo)},_refocus_try:function(newnode){try{if(typeof newnode.selectionStart=="number"){newnode.selectionStart=newnode.selectionEnd=newnode.value.length}else if(typeof newnode.createTextRange!="undefined"){var range=newnode.createTextRange();range.collapse(false);range.select()}}catch(e){}},_refocus_inline_editor:function(){var editor=this.getEditor();if(editor&&editor.$inline&&!editor.getPopup){var newnode=this._locateInput(editor);if(newnode&&newnode!=editor.node){var text=editor.node.value;editor.node=newnode;newnode.value=text;newnode.focus();this._refocus_try(newnode)}else this.editStop()}},editable_setter:function(value){if(value)this._init_edit_events_once();return value},_init_edit_events_once:function(){webix.attachEvent("onEditEnd",webix.bind(function(){if(this._in_edit_mode)this.editStop()},this));webix.attachEvent("onClick",webix.bind(function(e){if(this._in_edit_mode&&new Date-this._edit_open_time>200){if(!this._last_editor||this._last_editor.popupType||!e||(!this._last_editor.node||!this._last_editor.node.contains(e.target||e.srcElement)))this.editStop()}},this));if(this.data.attachEvent)this.data.attachEvent("onIdChange",webix.bind(function(oldid,newid){this._changeEditorId(oldid,newid)},this));this.attachEvent("onItemClick",function(id){if(this._settings.editable&&this._settings.editaction=="click")this.edit(id)});this.attachEvent("onItemDblClick",function(id){if(this._settings.editable&&this._settings.editaction=="dblclick")this.edit(id)});this._reset_active_editor=webix.bind(function(){this._edit_open_time=new Date},this);this._init_edit_events_once=function(){};if(this._component_specific_edit_init)this._component_specific_edit_init()},_handle_live_edits:function(){webix.delay(function(){var editor=this.getEditor();if(editor&&editor.config.liveEdit){var state={value:editor.getValue(),old:editor.value};if(state.value==state.old)return;editor.value=state.value;this._set_new_value(editor,state.value,false);this.callEvent("onLiveEdit",[state,editor])}},this)},_show_editor_form:function(id){var form=this._settings.form;if(typeof form!="string")this._settings.form=form=webix.ui(form).config.id;var form=webix.$$(form);var realform=form.setValues?form:form.getChildViews()[0];realform.setValues(this.getItem(id.row||id));form.config.master=this.config.id;form.show(this.getItemNode(id));var first=realform.getChildViews()[0];if(first.focus)first.focus()},edit:function(id,preserve,show){if(!this.callEvent("onBeforeEditStart",[id]))return;if(this._settings.form)return this._show_editor_form(id);var editor=this._get_editor_type(id);if(editor){if(this.getEditor(id))return;if(!preserve)this.editStop();webix.assert(webix.editors[editor],"Invalid editor type: "+editor);var type=webix.extend({},webix.editors[editor]);var node=this._init_editor(id,type,show);if(type.config.liveEdit)this._live_edits_handler=this.attachEvent("onKeyPress",this._handle_live_edits);var area=type.getPopup?type.getPopup(node)._viewobj:node;if(area)webix._event(area,"click",this._reset_active_editor);if(node)webix._event(node,"change",this._on_editor_change,{bind:{view:this,id:id}});if(show!==false)type.focus();if(this.$fixEditor)this.$fixEditor(type);this._edit_open_time=webix.edit_open_time=new Date;webix.UIManager.setFocus(this,true);this.callEvent("onAfterEditStart",[id]);return type}return null},getEditor:function(id){if(!id)return this._last_editor;return this._editors[id]},_changeEditorId:function(oldid,newid){var editor=this._editors[oldid];if(editor){this._editors[newid]=editor;editor.id=newid;delete this._editors[oldid]}},_on_editor_change:function(e){if(this.view.hasEvent("onEditorChange"))this.view.callEvent("onEditorChange",[this.id,this.view.getEditorValue(this.id)])},_get_edit_config:function(id){return this._settings},_init_editor:function(id,type,show){var config=type.config=this._get_edit_config(id);var node=type.render();if(type.$inline)node=this._locateInput(id);type.node=node;var item=this.getItem(id);var value=item[this._settings.editValue||"value"];if(webix.isUndefined(value))value="";type.setValue(value,item);type.value=value;this._addEditor(id,type);if(show!==false)this.showItem(id);if(!type.$inline)this._sizeToCell(id,node,true);if(type.afterRender)type.afterRender();return node},_locate_cell:function(id){return this.getItemNode(id)},_locateInput:function(id){var cell=this._locate_cell(id);if(cell)cell=cell.getElementsByTagName("input")[0]||cell;return cell},_get_editor_type:function(id){return this._settings.editor},_addEditor:function(id,type){type.id=id;this._editors[id]=this._last_editor=type;this._in_edit_mode++},_removeEditor:function(editor){if(this._last_editor==editor)this._last_editor=0;if(editor.destroy)editor.destroy();delete editor.popup;delete editor.node;delete this._editors[editor.id];this._in_edit_mode--},focusEditor:function(id){var editor=this.getEditor.apply(this,arguments);if(editor&&editor.focus)editor.focus()},editCancel:function(){this.editStop(null,null,true)},_applyChanges:function(el){if(el){var ed=this.getEditor();if(ed&&ed.getPopup&&ed.getPopup()==el.getTopParentView())return}this.editStop()},editStop:function(id){if(this._edit_stop)return;this._edit_stop=1;var cancel=arguments[2];var result=1;if(!id){this._for_each_editor(function(editor){result=result*this._editStop(editor,cancel)})}else result=this._editStop(this._editors[id],cancel);this._edit_stop=0;return result},_cellPosition:function(id){var html=this.getItemNode(id);return{left:html.offsetLeft,top:html.offsetTop,height:html.offsetHeight,width:html.offsetWidth,parent:this._contentobj}},_sizeToCell:function(id,node,inline){if(!node.style)return;var pos=this._cellPosition(id);node.style.top=pos.top+"px";node.style.left=pos.left+"px";node.style.width=pos.width-1+"px";node.style.height=pos.height-1+"px";node.top=pos.top;if(inline)pos.parent.appendChild(node)},_for_each_editor:function(handler){for(var editor in this._editors)handler.call(this,this._editors[editor])},_editStop:function(editor,ignore){if(!editor)return;var state={value:editor.getValue(),old:editor.value};if(this.callEvent("onBeforeEditStop",[state,editor,ignore])){if(!ignore){var old=state.old;if(typeof state.value=="string")old+="";if(old!=state.value||editor.config.liveEdit){var item=this._set_new_value(editor,state.value,true);this.updateItem(editor.row||editor.id,item)}}if(editor.$inline)editor.node=null;else webix.html.remove(editor.node);var popup=editor.config.suggest;if(popup&&typeof popup=="string")webix.$$(popup).hide();this._removeEditor(editor);if(this._live_edits_handler)this.detachEvent(this._live_edits_handler);this.callEvent("onAfterEditStop",[state,editor,ignore]);return 1}return 0},validateEditor:function(id){var result=true;if(this._settings.rules){var editor=this.getEditor(id);var key=editor.column||this._settings.editValue||"value";var rule=this._settings.rules[key];var all=this._settings.rules.$all;if(rule||all){var obj=this.data.getItem(editor.row||editor.id);var value=editor.getValue();var input=editor.getInputNode();if(rule)result=rule.call(this,value,obj,key);if(all)result=all.call(this,value,obj,key)&&result;if(result)webix.html.removeCss(input,"webix_invalid");else webix.html.addCss(input,"webix_invalid");webix.callEvent("onLiveValidation",[editor,result,obj,value])}}return result},getEditorValue:function(id){var editor;if(arguments.length===0)editor=this._last_editor;else editor=this.getEditor(id);if(editor)return editor.getValue()},getEditState:function(){return this._last_editor||false},editNext:function(next,from){next=next!==false;if(this._in_edit_mode==1||from){var editor_next=this._find_cell_next(this._last_editor||from,function(id){if(this._get_editor_type(id))return true;return false},next);if(this.editStop()){if(editor_next){this.edit(editor_next);this._after_edit_next(editor_next)}return false}}},_after_edit_next:function(){},_find_cell_next:function(start,check,direction){var row=this.getIndexById(start.id);var order=this.data.order;if(direction){for(var i=row+1;i<order.length;i++){if(check.call(this,order[i]))return order[i]}}else{for(var i=row-1;i>=0;i--){if(check.call(this,order[i]))return order[i]}}return null},_set_new_value:function(editor,new_value,copy){var item=copy?{}:this.getItem(editor.id);item[this._settings.editValue||"value"]=new_value;return item}};(function(){function init_suggest(editor,input){var suggest=editor.config.suggest;if(suggest){var box=editor.config.suggest=create_suggest(suggest);var boxobj=webix.$$(box);if(boxobj&&input)boxobj.linkInput(input)}}function create_suggest(config){if(typeof config=="string")return config;if(config.linkInput)return config._settings.id;if(typeof config=="object"){if(webix.isArray(config))config={data:config};config.view=config.view||"suggest"}else if(config===true)config={view:"suggest"};var obj=webix.ui(config);return obj.config.id}function getLabel(config){var text=config.header&&config.header[0]?config.header[0].text:config.editValue||config.label;return(text||"").toString().replace(/<[^>]*>/g,"")}webix.editors={text:{focus:function(){this.getInputNode(this.node).focus();this.getInputNode(this.node).select()},getValue:function(){return this.getInputNode(this.node).value},setValue:function(value){var input=this.getInputNode(this.node);input.value=value;init_suggest(this,input)},getInputNode:function(){return this.node.firstChild},render:function(){return webix.html.create("div",{class:"webix_dt_editor"},"<input type='text' aria-label='"+getLabel(this.config)+"'>")}},"inline-checkbox":{render:function(){return{}},getValue:function(){return this.node.checked},setValue:function(){},focus:function(){this.node.focus()},getInputNode:function(){},$inline:true},"inline-text":{render:function(){return{}},getValue:function(){return this.node.value},setValue:function(){},focus:function(){try{this.node.select();this.node.focus()}catch(e){}},getInputNode:function(){},$inline:true},checkbox:{focus:function(){this.getInputNode().focus()},getValue:function(){return this.getInputNode().checked},setValue:function(value){this.getInputNode().checked=!!value},getInputNode:function(){return this.node.firstChild.firstChild},render:function(){return webix.html.create("div",{class:"webix_dt_editor"},"<div><input type='checkbox' aria-label='"+getLabel(this.config)+"'></div>")}},select:{focus:function(){this.getInputNode().focus()},getValue:function(){return this.getInputNode().value},setValue:function(value){this.getInputNode().value=value},getInputNode:function(){return this.node.firstChild},render:function(){var html="";var options=this.config.options||this.config.collection;webix.assert(options,"options not defined for select editor");if(options.data&&options.data.each)options.data.each(function(obj){html+="<option value='"+obj.id+"'>"+obj.value+"</option>"});else{if(webix.isArray(options)){for(var i=0;i<options.length;i++){var rec=options[i];var isplain=webix.isUndefined(rec.id);var id=isplain?rec:rec.id;var label=isplain?rec:rec.value;html+="<option value='"+id+"'>"+label+"</option>"}}else for(var key in options){html+="<option value='"+key+"'>"+options[key]+"</option>"}}return webix.html.create("div",{class:"webix_dt_editor"},"<select aria-label='"+getLabel(this.config)+"'>"+html+"</select>")}},popup:{focus:function(){this.getInputNode().focus()},destroy:function(){this.getPopup().hide()},getValue:function(){return this.getInputNode().getValue()||""},setValue:function(value){this.getPopup().show(this.node);this.getInputNode().setValue(value)},getInputNode:function(){return this.getPopup().getChildViews()[0]},getPopup:function(){if(!this.config.popup)this.config.popup=this.createPopup();return webix.$$(this.config.popup)},createPopup:function(){var popup=this.config.popup||this.config.suggest;if(popup){var pobj;if(typeof popup=="object"&&!popup.name){popup.view=popup.view||"suggest";pobj=webix.ui(popup)}else pobj=webix.$$(popup);if(pobj.linkInput)pobj.linkInput(document.body);else if(this.linkInput)this.linkInput(document.body);return pobj}var type=webix.editors.$popup[this.popupType];if(typeof type!="string"){type=webix.editors.$popup[this.popupType]=webix.ui(type);this.popupInit(type);if(!type.linkInput)this.linkInput(document.body)}return type._settings.id},linkInput:function(node){webix._event(webix.toNode(node),"keydown",webix.bind(function(e){var code=e.which||e.keyCode,list=this.getInputNode();if(!list.isVisible())return;if(code===40){if(list.moveSelection)list.moveSelection("down");webix.UIManager.setFocus(list)}else if(code===13&&(e.target.nodeName!=="TEXTAREA"||!e.shiftKey))webix.callEvent("onEditEnd",[])},this))},popupInit:function(popup){},popupType:"text",render:function(){return{}},$inline:true}};webix.editors.color=webix.extend({focus:function(){},popupType:"color",popupInit:function(popup){popup.getChildViews()[0].attachEvent("onSelect",function(value){webix.callEvent("onEditEnd",[value])})}},webix.editors.popup);webix.editors.date=webix.extend({focus:function(){},popupType:"date",setValue:function(value){this._is_string=this.config.stringResult||value&&typeof value=="string";webix.editors.popup.setValue.call(this,value)},getValue:function(){return this.getInputNode().getValue(this._is_string?webix.i18n.parseFormatStr:"")||""},popupInit:function(popup){popup.getChildViews()[0].attachEvent("onDateSelect",function(value){webix.callEvent("onEditEnd",[value])})}},webix.editors.popup);webix.editors.combo=webix.extend({_create_suggest:function(config){if(this.config.popup){return this.config.popup.config.id}else if(config){return create_suggest(config)}else return this._shared_suggest(config)},_shared_suggest:function(){var e=webix.editors.combo;return e._suggest=e._suggest||this._create_suggest(true)},render:function(){var node=webix.html.create("div",{class:"webix_dt_editor"},"<input type='text' role='combobox' aria-label='"+getLabel(this.config)+"'>");var suggest=this.config.suggest=this._create_suggest(this.config.suggest);if(suggest){webix.$$(suggest).linkInput(node.firstChild,true);webix._event(node.firstChild,"click",webix.bind(this.showPopup,this))}return node},getPopup:function(){return webix.$$(this.config.suggest)},showPopup:function(){var popup=this.getPopup();var list=popup.getList();var input=this.getInputNode();var value=this.getValue();popup.show(input);input.setAttribute("aria-expanded","true");if(value){webix.assert(list.exists(value),"Option with ID "+value+" doesn't exist");if(list.exists(value)){list.select(value);list.showItem(value)}}else{list.unselect();list.showItem(list.getFirstId())}popup._last_input_target=input},afterRender:function(){this.showPopup()},setValue:function(value){this._initial_value=value;if(this.config.suggest){var sobj=webix.$$(this.config.suggest);var data=this.config.collection||this.config.options;if(data)sobj.getList().data.importData(data);this._initial_text=this.getInputNode(this.node).value=sobj.getItemText(value)}},getValue:function(){var value=this.getInputNode().value;if(this.config.suggest){if(value==this._initial_text)return this._initial_value;return webix.$$(this.config.suggest).getSuggestion()}else return value}},webix.editors.text);webix.editors.richselect=webix.extend({focus:function(){},getValue:function(){return this.getPopup().getValue()},setValue:function(value){var suggest=this.config.collection||this.config.options;var list=this.getInputNode();if(suggest)this.getPopup().getList().data.importData(suggest);this.getPopup().show(this.node);this.getPopup().setValue(value)},getInputNode:function(){return this.getPopup().getList()},popupInit:function(popup){popup.linkInput(document.body)},popupType:"richselect"},webix.editors.popup);webix.editors.password=webix.extend({render:function(){return webix.html.create("div",{class:"webix_dt_editor"},"<input type='password' aria-label='"+getLabel(this.config)+"'>")}},webix.editors.text);webix.editors.$popup={text:{view:"popup",width:250,height:150,body:{view:"textarea"}},color:{view:"popup",body:{view:"colorboard"}},date:{view:"popup",width:250,height:250,padding:0,body:{view:"calendar",icons:true,borderless:true}},richselect:{view:"suggest",body:{view:"list",select:true}}}})();webix.VirtualRenderStack={$init:function(){webix.assert(this.render,"VirtualRenderStack :: Object must use RenderStack first");this._htmlmap={};webix._event(this._viewobj,"scroll",webix.bind(this._render_visible_rows,this));if(webix.env.touch){this.attachEvent("onAfterScroll",webix.bind(this._render_visible_rows,this))}this._unrendered_area=[]},getItemNode:function(search_id){return this._htmlmap[search_id]},showItem:function(id){var range=this._getVisibleRange();var ind=this.data.getIndexById(id);var dy=Math.floor(ind/range._dx)*range._y;var state=this.getScrollState();if(dy<state.y||dy+this._settings.height>=state.y+this._content_height)this.scrollTo(0,dy)},render:function(id,data,type){if(!this.isVisible(this._settings.id)||this.$blockRender)return;if(webix.debug_render)webix.log("Render: "+this.name+"@"+this._settings.id);if(id){var cont=this.getItemNode(id);switch(type){case"update":if(!cont)return;var t=this._htmlmap[id]=this._toHTMLObject(data);webix.html.insertBefore(t,cont);webix.html.remove(cont);break;default:this._render_delayed();break}}else{if(this.callEvent("onBeforeRender",[this.data])){this._htmlmap={};this._render_visible_rows(null,true);this._wait_for_render=false;this.callEvent("onAfterRender",[])}}},_render_delayed:function(){if(this._wait_for_render)return;this._wait_for_render=true;window.setTimeout(webix.bind(function(){this.render()},this),1)},_create_placeholder:function(height){if(webix.env.maxHTMLElementSize)height=Math.min(webix.env.maxHTMLElementSize,height);var node=document.createElement("DIV");node.style.cssText="height:"+height+"px; width:100%; overflow:hidden;";return node},_render_visible_rows:function(e,reset){this._unrendered_area=[];var viewport=this._getVisibleRange();if(!this._dataobj.firstChild||reset){this._dataobj.innerHTML="";this._dataobj.appendChild(this._create_placeholder(viewport._max));this._htmlrows=[this._dataobj.firstChild]}var t=viewport._from;while(t<=viewport._height){while(this._htmlrows[t]&&this._htmlrows[t]._filled&&t<=viewport._height){t++}if(t>viewport._height)break;var holder=t;while(!this._htmlrows[holder])holder--;var holder_row=this._htmlrows[holder];var base=t*viewport._dx+(this.data.$min||0);if(base>(this.data.$max||Infinity))break;var nextpoint=Math.min(base+viewport._dx-1,this.data.$max?this.data.$max-1:Infinity);var node=this._create_placeholder(viewport._y);var range=this.data.getIndexRange(base,nextpoint);if(!range.length)break;var loading={$template:"Loading"};for(var i=0;i<range.length;i++){if(!range[i])this._unrendered_area.push(base+i);range[i]=this._toHTML(range[i]||loading)}node.innerHTML=range.join("");for(var i=0;i<range.length;i++)this._htmlmap[this.data.getIdByIndex(base+i)]=node.childNodes[i];var h=parseFloat(holder_row.style.height,10);var delta=(t-holder)*viewport._y;var delta2=h-delta-viewport._y;webix.html.insertBefore(node,delta?holder_row.nextSibling:holder_row,this._dataobj);this._htmlrows[t]=node;node._filled=true;if(delta<=0&&delta2>0){holder_row.style.height=delta2+"px";this._htmlrows[t+1]=holder_row}else{if(delta<0)webix.html.remove(holder_row);else holder_row.style.height=delta+"px";if(delta2>0){var new_space=this._htmlrows[t+1]=this._create_placeholder(delta2);webix.html.insertBefore(new_space,node.nextSibling,this._dataobj)}}t++}if(this._unrendered_area.length){var from=this._unrendered_area[0];var to=this._unrendered_area.pop()+1;if(to>from){var count=to-from;if(this._maybe_loading_already(count,from))return;count=Math.max(count,this._settings.datafetch||this._settings.loadahead||0);this.loadNext(count,from)}}},_getVisibleRange:function(){var state=this.getScrollState();var top=state.y;var width=this._content_width;var height=this._content_height;var t=this.type;var dx=Math.floor(width/t.width)||1;var min=Math.floor(top/t.height);var dy=Math.ceil((height+top)/t.height)-1;var count=this.data.$max?this.data.$max-this.data.$min:this.data.count();var max=Math.ceil(count/dx)*t.height;return{_from:min,_height:dy,_top:top,_max:max,_y:t.height,_dx:dx}},_cellPosition:function(id){var html=this.getItemNode(id);if(!html){this.showItem(id);this._render_visible_rows();html=this.getItemNode(id)}return{left:html.offsetLeft,top:html.offsetTop,height:html.offsetHeight,width:html.offsetWidth,parent:this._contentobj}}};webix.protoUI({name:"dataview",$init:function(config){if(config.sizeToContent)this.$ready.unshift(this._after_init_call);var prerender=config.prerender||this.defaults.prerender;if(prerender===false||prerender!==true&&config.height!=="auto"&&!config.autoheight)webix.extend(this,webix.VirtualRenderStack,true);if(config.autoheight)config.scroll=false;this._contentobj.className+=" webix_dataview";this._viewobj.setAttribute("role","listbox")},_after_init_call:function(){var test=webix.html.create("DIV",0,this.type.template({}));test.style.position="absolute";document.body.appendChild(test);this.type.width=test.offsetWidth;this.type.height=test.offsetHeight;webix.html.remove(test)},defaults:{scroll:true,datafetch:50,navigation:true},_id:"webix_f_id",_itemClassName:"webix_dataview_item",on_click:{webix_dataview_item:function(e,id){if(this._settings.select){if(this._settings.select=="multiselect"||this._settings.multiselect)this.select(id,false,this._settings.multiselect=="touch"||e.ctrlKey||e.metaKey,e.shiftKey);else this.select(id)}}},on_dblclick:{},on_mouse_move:{},type:{template:webix.template("#value#"),templateLoading:webix.template("Loading..."),width:160,height:50,classname:function(obj,common,marks){var css="webix_dataview_item ";if(common.css)css+=common.css+" ";if(obj.$css){if(typeof obj.$css=="object")obj.$css=webix.html.createCss(obj.$css);css+=obj.$css+" "}if(marks&&marks.$css)css+=marks.$css+" ";return css},aria:function(obj,common,marks){return'role="option"'+(marks&&marks.webix_selected?' aria-selected="true" tabindex="0"':' tabindex="-1"')},templateStart:webix.template('<div webix_f_id="#id#" class="{common.classname()}" {common.aria()} style="width:{common.width}px; height:{common.height}px; float:left; overflow:hidden;">'),templateEnd:webix.template("</div>")},_calck_autoheight:function(width){return this._settings.height=this.type.height*Math.ceil(this.data.count()/Math.floor(width/this.type.width))},autoheight_setter:function(mode){if(mode){this.data.attachEvent("onStoreLoad",webix.bind(this.resize,this));this._contentobj.style.overflowY="hidden"}return mode},$getSize:function(dx,dy){if(this._settings.xCount>0&&this.type.width!="auto"&&!this._autowidth)this._settings.width=this.type.width*this._settings.xCount+(this._scroll_y?webix.ui.scrollSize:0);if(this._settings.yCount&&this.type.height!="auto")this._settings.height=this.type.height*this._settings.yCount;var width=this._settings.width||this._content_width;if(this._settings.autoheight&&width){this._calck_autoheight(width);this.scroll_setter(false)}return webix.ui.view.prototype.$getSize.call(this,dx,dy)},_recalk_counts:function(){var render=false;if(this._settings.yCount&&this.type.height=="auto"){this.type.height=Math.floor(this._content_height/this._settings.yCount);render=true}if(this._settings.xCount&&(this.type.width=="auto"||this._autowidth)){this._autowidth=true;this.type.width=Math.floor(this._content_width/this._settings.xCount);render=true}else this._autowidth=false;return render},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)){if(this._settings.autoheight&&this._calck_autoheight()!=this._content_height)return webix.delay(this.resize,this);if(this._recalk_counts()||this._render_visible_rows)this.render()}}},webix.DataMove,webix.DragItem,webix.MouseEvents,webix.KeysNavigation,webix.SelectionModel,webix.Scrollable,webix.CustomPrint,webix.ui.proto);webix.DataDriver.htmltable={toObject:function(data){data=webix.toNode(data);webix.assert(data,"table is not found");webix.assert(data.tagName.toLowerCase()==="table","Incorrect table object");var tr=data.rows;webix.html.remove(data);return tr},getRecords:function(data){var new_data=[];var i=data[0]&&data[0]._webix_skip?1:0;for(;i<data.length;i++)new_data.push(data[i]);return new_data},getDetails:function(data){var td=data.getElementsByTagName("td");data={};for(var i=0;i<td.length;i++){data["data"+i]=td[i].innerHTML}return data},getInfo:function(data){return{size:0,from:0}},getOptions:function(){},getConfig:function(data){var columns=[];var td=data[0].getElementsByTagName("th");if(td.length)data[0]._webix_skip=true;for(var i=0;i<td.length;i++){var col={id:"data"+i,header:this._de_json(td[i].innerHTML)};var attrs=this._get_attrs(td[i]);col=webix.extend(col,attrs);columns.push(col)}return columns},_de_json:function(str){var pos=str.indexOf("json://");if(pos!=-1)str=JSON.parse(str.substr(pos+7));return str},_get_attrs:function(el){var attr=el.attributes;var hash={};for(var i=0;i<attr.length;i++){hash[attr[i].nodeName]=this._de_json(attr[i].nodeValue)}hash.width=parseInt(hash.width,10);return hash}};webix.protoUI({name:"vscroll",defaults:{scroll:"x",scrollStep:40,scrollPos:0,scrollSize:18,scrollVisible:1,zoom:1},$init:function(config){var dir=config.scroll||"x";var node=this._viewobj=webix.toNode(config.container);node.className+=" webix_vscroll_"+dir;node.innerHTML="<div class='webix_vscroll_body'></div>";webix._event(node,"scroll",this._onscroll,{bind:this});this._last_set_size=0;this._last_scroll_pos=0},reset:function(){this._last_scroll_pos=this.config.scrollPos=0;this._viewobj[this.config.scroll=="x"?"scrollLeft":"scrollTop"]=0},_check_quantum:function(value){if(value>15e5){this._settings.zoom=Math.floor(value/15e5)+1;this._zoom_limit=value-this._last_set_size;value=Math.floor(value/this._settings.zoom)+this._last_set_size}else{this._settings.zoom=1;this._zoom_limit=Infinity}return value},scrollWidth_setter:function(value){value=this._check_quantum(value);this._viewobj.firstChild.style.width=value+"px";return value},scrollHeight_setter:function(value){value=this._check_quantum(value);this._viewobj.firstChild.style.height=value+"px";return value},sizeTo:function(value,top,bottom){value=value-(top||0)-(bottom||0);var width=this._settings.scrollSize;if(webix.env.isIE&&width)width+=1;if(!width&&this._settings.scrollVisible&&!webix.env.$customScroll){this._viewobj.style.pointerEvents="none";width=14}if(!width){this._viewobj.style.display="none"}else{this._viewobj.style.display="block";if(top)this._viewobj.style.marginTop=top+"px";this._viewobj.style[this._settings.scroll=="x"?"width":"height"]=Math.max(0,value)+"px";this._viewobj.style[this._settings.scroll=="x"?"height":"width"]=width+"px"}this._last_set_size=value},getScroll:function(){return this._settings.scrollPos*this._settings.zoom},getSize:function(){return(this._settings.scrollWidth||this._settings.scrollHeight)*this._settings.zoom},scrollTo:function(value){if(value<0)value=0;var config=this._settings;value=Math.min(((config.scrollWidth||config.scrollHeight)-this._last_set_size)*config.zoom,value);if(value<0)value=0;var svalue=value/config.zoom;if(this._last_scroll_pos!=svalue){this._viewobj[config.scroll=="x"?"scrollLeft":"scrollTop"]=svalue;this._onscroll_inner(svalue);return true}},_onscroll:function(){var x=this._viewobj[this._settings.scroll=="x"?"scrollLeft":"scrollTop"];if(x!=this._last_scroll_pos)this._onscroll_inner(x)},_onscroll_inner:function(value){this._last_scroll_pos=value;this._settings.scrollPos=Math.min(this._zoom_limit,value*this._settings.zoom)||0;this.callEvent("onScroll",[this._settings.scrollPos])},activeArea:function(area,x_mode){this._x_scroll_mode=x_mode;webix._event(area,webix.env.isIE8?"mousewheel":"wheel",this._on_wheel,{bind:this});this._add_touch_events(area)},_add_touch_events:function(area){if(!webix.env.touch&&window.navigator.pointerEnabled){webix.html.addCss(area,"webix_scroll_touch_ie",true);webix._event(area,"pointerdown",function(e){if(e.pointerType=="touch"||e.pointerType=="pen"){this._start_context=webix.Touch._get_context_m(e);this._start_scroll_pos=this._settings.scrollPos}},{bind:this});webix.event(document.body,"pointermove",function(e){var scroll;if(this._start_context){this._current_context=webix.Touch._get_context_m(e);if(this._settings.scroll=="x"){scroll=this._current_context.x-this._start_context.x}else if(this._settings.scroll=="y"){scroll=this._current_context.y-this._start_context.y}if(scroll&&Math.abs(scroll)>5){this.scrollTo(this._start_scroll_pos-scroll)}}},{bind:this});webix.event(window,"pointerup",function(e){if(this._start_context){this._start_context=this._current_context=null}},{bind:this})}},_on_wheel:function(e){var dir=0;var step=e.deltaMode===0?30:1;if(webix.env.isIE8)dir=e.detail=-e.wheelDelta/30;if(e.deltaX&&Math.abs(e.deltaX)>Math.abs(e.deltaY)){if(this._x_scroll_mode&&this._settings.scrollVisible)dir=e.deltaX/step}else{if(!this._x_scroll_mode&&this._settings.scrollVisible){if(webix.isUndefined(e.deltaY))dir=e.detail;else dir=e.deltaY/step}}if(webix.env.isSafari)this._scroll_trg=e.target||e.srcElement;if(dir)if(this.scrollTo(this._settings.scrollPos+dir*this._settings.scrollStep))return webix.html.preventEvent(e)}},webix.EventSystem,webix.Settings);webix.Number={format:function(value,config){if(value===""||typeof value==="undefined")return value;config=config||webix.i18n;value=parseFloat(value);var sign=value<0?"-":"";value=Math.abs(value);var str=value.toFixed(config.decimalSize).toString();str=str.split(".");var int_value="";if(config.groupSize){var step=config.groupSize;var i=str[0].length;do{i-=step;var chunk=i>0?str[0].substr(i,step):str[0].substr(0,step+i);int_value=chunk+(int_value?config.groupDelimiter+int_value:"")}while(i>0)}else int_value=str[0];if(config.decimalSize)return sign+int_value+config.decimalDelimiter+str[1];else return sign+int_value},numToStr:function(config){return function(value){return webix.Number.format(value,config)}}};webix.Date={startOnMonday:false,toFixed:function(num){if(num<10)return"0"+num;return num},weekStart:function(date){date=this.copy(date);var shift=date.getDay();if(this.startOnMonday){if(shift===0)shift=6;else shift--}return this.datePart(this.add(date,-1*shift,"day"))},monthStart:function(date){date=this.copy(date);date.setDate(1);return this.datePart(date)},yearStart:function(date){date=this.copy(date);date.setMonth(0);return this.monthStart(date)},dayStart:function(date){return this.datePart(date,true)},dateToStr:function(format,utc){if(typeof format=="function")return format;if(webix.env.strict){return function(date){var str="";var lastPos=0;format.replace(/%[a-zA-Z]/g,function(s,pos){str+=format.slice(lastPos,pos);var fn=function(date){if(s=="%d")return webix.Date.toFixed(date.getDate());if(s=="%m")return webix.Date.toFixed(date.getMonth()+1);if(s=="%j")return date.getDate();if(s=="%n")return date.getMonth()+1;if(s=="%y")return webix.Date.toFixed(date.getFullYear()%100);if(s=="%Y")return date.getFullYear();if(s=="%D")return webix.i18n.calendar.dayShort[date.getDay()];if(s=="%l")return webix.i18n.calendar.dayFull[date.getDay()];if(s=="%M")return webix.i18n.calendar.monthShort[date.getMonth()];if(s=="%F")return webix.i18n.calendar.monthFull[date.getMonth()];if(s=="%h")return webix.Date.toFixed((date.getHours()+11)%12+1);if(s=="%g")return(date.getHours()+11)%12+1;if(s=="%G")return date.getHours();if(s=="%H")return webix.Date.toFixed(date.getHours());if(s=="%i")return webix.Date.toFixed(date.getMinutes());if(s=="%a")return date.getHours()>11?webix.i18n.pm[0]:webix.i18n.am[0];if(s=="%A")return date.getHours()>11?webix.i18n.pm[1]:webix.i18n.am[1];if(s=="%s")return webix.Date.toFixed(date.getSeconds());if(s=="%S")return webix.Date.toFixed(date.getMilliseconds());if(s=="%W")return webix.Date.toFixed(webix.Date.getISOWeek(date));if(s=="%c"){var str=date.getFullYear();str+="-"+webix.Date.toFixed(date.getMonth()+1);str+="-"+webix.Date.toFixed(date.getDate());str+="T";str+=webix.Date.toFixed(date.getHours());str+=":"+webix.Date.toFixed(date.getMinutes());str+=":"+webix.Date.toFixed(date.getSeconds());return str}return s};str+=fn(date);lastPos=pos+2});str+=format.slice(lastPos,format.length);return str}}format=format.replace(/%[a-zA-Z]/g,function(a){switch(a){case"%d":return'"+webix.Date.toFixed(date.getDate())+"';case"%m":return'"+webix.Date.toFixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+webix.Date.toFixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+webix.i18n.calendar.dayShort[date.getDay()]+"';case"%l":return'"+webix.i18n.calendar.dayFull[date.getDay()]+"';case"%M":return'"+webix.i18n.calendar.monthShort[date.getMonth()]+"';case"%F":return'"+webix.i18n.calendar.monthFull[date.getMonth()]+"';case"%h":return'"+webix.Date.toFixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+webix.Date.toFixed(date.getHours())+"';case"%i":return'"+webix.Date.toFixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?webix.i18n.pm[0]:webix.i18n.am[0])+"';case"%A":return'"+(date.getHours()>11?webix.i18n.pm[1]:webix.i18n.am[1])+"';case"%s":return'"+webix.Date.toFixed(date.getSeconds())+"';case"%S":return'"+webix.Date.toFixed(date.getMilliseconds())+"';case"%W":return'"+webix.Date.toFixed(webix.Date.getISOWeek(date))+"';case"%c":var str='"+date.getFullYear()+"';str+='-"+webix.Date.toFixed((date.getMonth()+1))+"';str+='-"+webix.Date.toFixed(date.getDate())+"';str+="T";str+='"+webix.Date.toFixed(date.getHours())+"';str+=':"+webix.Date.toFixed(date.getMinutes())+"';str+=':"+webix.Date.toFixed(date.getSeconds())+"';if(utc===true)str+="Z";return str;default:return a}});if(utc===true)format=format.replace(/date\.get/g,"date.getUTC");return new Function("date","if (!date) return ''; if (!date.getMonth) date=webix.i18n.parseFormatDate(date);  return \""+format+'";')},strToDate:function(format,utc){if(typeof format=="function")return format;var mask=format.match(/%[a-zA-Z]/g);var splt="var temp=date.split(/[^0-9a-zA-Z]+/g);";var i,t,s;if(!webix.i18n.calendar.monthShort_hash){s=webix.i18n.calendar.monthShort;t=webix.i18n.calendar.monthShort_hash={};for(i=0;i<s.length;i++)t[s[i]]=i;s=webix.i18n.calendar.monthFull;t=webix.i18n.calendar.monthFull_hash={};for(i=0;i<s.length;i++)t[s[i]]=i}if(webix.env.strict){return function(date){if(!date)return"";if(typeof date=="object")return date;var temp=date.split(/[^0-9a-zA-Z]+/g);var set=[0,0,1,0,0,0,0];for(i=0;i<mask.length;i++){var a=mask[i];if(a=="%y")set[0]=temp[i]*1+(temp[i]>30?1900:2e3);else if(a=="%Y"){set[0]=(temp[i]||0)*1;if(set[0]<30)set[0]+=2e3}else if(a=="%n"||a=="%m")set[1]=(temp[i]||1)-1;else if(a=="%M")set[1]=webix.i18n.calendar.monthShort_hash[temp[i]]||0;else if(a=="%F")set[1]=webix.i18n.calendar.monthFull_hash[temp[i]]||0;else if(a=="%j"||a=="%d")set[2]=temp[i]||1;else if(a=="%g"||a=="%G"||a=="%h"||a=="%H")set[3]=temp[i]||0;else if(a=="%a")set[3]=set[3]%12+((temp[i]||"")==webix.i18n.am[0]?0:12);else if(a=="%A")set[3]=set[3]%12+((temp[i]||"")==webix.i18n.am[1]?0:12);else if(a=="%i")set[4]=temp[i]||0;else if(a=="%s")set[5]=temp[i]||0;else if(a=="%S")set[6]=temp[i]||0;else if(a=="%c"){var reg=/(\d+)-(\d+)-(\d+)T(\d+):(\d+):(\d+)(\+.*|)/g;var res=reg.exec(date);set[0]=(res[1]||0)*1;if(set[0]<30)set[0]+=2e3;set[1]=(res[2]||1)-1;set[2]=res[3]||1;set[3]=res[4]||0;set[4]=res[5]||0;set[5]=res[6]||0}}if(utc)return new Date(Date.UTC(set[0],set[1],set[2],set[3],set[4],set[5],set[6]));return new Date(set[0],set[1],set[2],set[3],set[4],set[5],set[6])}}for(i=0;i<mask.length;i++){switch(mask[i]){case"%j":case"%d":splt+="set[2]=temp["+i+"]||1;";break;case"%n":case"%m":splt+="set[1]=(temp["+i+"]||1)-1;";break;case"%y":splt+="set[0]=temp["+i+"]*1+(temp["+i+"]>30?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":splt+="set[3]=temp["+i+"]||0;";break;case"%i":splt+="set[4]=temp["+i+"]||0;";break;case"%Y":splt+="set[0]=(temp["+i+"]||0)*1; if (set[0]<30) set[0]+=2000;";break;case"%a":splt+="set[3]=set[3]%12+(temp["+i+"]==webix.i18n.am[0]?0:12);";break;case"%A":splt+="set[3]=set[3]%12+(temp["+i+"]==webix.i18n.am[1]?0:12);";break;case"%s":splt+="set[5]=temp["+i+"]||0;";break;case"%S":splt+="set[6]=temp["+i+"]||0;";break;case"%M":splt+="set[1]=webix.i18n.calendar.monthShort_hash[temp["+i+"]]||0;";break;case"%F":splt+="set[1]=webix.i18n.calendar.monthFull_hash[temp["+i+"]]||0;";break;case"%c":splt+="var res = date.split('T');";splt+="if(res[0]){ var d = res[0].split('-');";splt+="set[0]= (d[0]||0)*1; if (set[0]<30) set[0]+=2000;";splt+="set[1]= (d[1]||1)-1;";splt+="set[2]= d[2]||1;}";splt+="if(res[1]){ var t = res[1].split(':');";splt+="set[3]= t[0]||0;";splt+="set[4]= t[1]||0;";splt+="set[5]= parseInt(t[2])||0;}";break;default:break}}var code="set[0],set[1],set[2],set[3],set[4],set[5], set[6]";if(utc)code=" Date.UTC("+code+")";return new Function("date","if (!date) return ''; if (typeof date == 'object') return date; var set=[0,0,1,0,0,0,0]; "+splt+" return new Date("+code+");")},getISOWeek:function(ndate){if(!ndate)return false;var nday=ndate.getDay();if(nday===0){nday=7}var first_thursday=new Date(ndate.valueOf());first_thursday.setDate(ndate.getDate()+(4-nday));var year_number=first_thursday.getFullYear();var ordinal_date=Math.floor((first_thursday.getTime()-new Date(year_number,0,1).getTime())/864e5);var weekNumber=1+Math.floor(ordinal_date/7);return weekNumber},getUTCISOWeek:function(ndate){return this.getISOWeek(ndate)},_correctDate:function(d,d0,inc,checkFunc){if(!inc)return;var incorrect=checkFunc(d,d0);if(incorrect){var i=inc>0?1:-1;while(incorrect){d.setHours(d.getHours()+i);incorrect=checkFunc(d,d0);i+=inc>0?1:-1}}},add:function(date,inc,mode,copy){if(copy)date=this.copy(date);var d=webix.Date.copy(date);switch(mode){case"day":date.setDate(date.getDate()+inc);this._correctDate(date,d,inc,function(d,d0){return webix.Date.datePart(d0,true).valueOf()==webix.Date.datePart(d,true).valueOf()});break;case"week":date.setDate(date.getDate()+7*inc);this._correctDate(date,d,7*inc,function(d,d0){return webix.Date.datePart(d0,true).valueOf()==webix.Date.datePart(d,true).valueOf()});break;case"month":date.setMonth(date.getMonth()+inc);this._correctDate(date,d,inc,function(d,d0){return d0.getMonth()==d.getMonth()&&d0.getYear()==d.getYear()});break;case"year":date.setYear(date.getFullYear()+inc);this._correctDate(date,d,inc,function(d,d0){return d0.getFullYear()==d.getFullYear()});break;case"hour":date.setHours(date.getHours()+inc);this._correctDate(date,d,inc,function(d,d0){return d0.getHours()==d.getHours()&&webix.Date.datePart(d0,true)==webix.Date.datePart(d,true)});break;case"minute":date.setMinutes(date.getMinutes()+inc);break;default:webix.Date.add[mode](date,inc,mode);break}return date},datePart:function(date,copy){if(copy)date=this.copy(date);var d=this.copy(date);d.setHours(0);if(d.getDate()!=date.getDate()){date.setHours(1)}else{date.setHours(0)}date.setMinutes(0);date.setSeconds(0);date.setMilliseconds(0);return date},timePart:function(date,copy){if(copy)date=this.copy(date);return(date.valueOf()/1e3-date.getTimezoneOffset()*60)%86400},copy:function(date){return new Date(date.valueOf())},equal:function(a,b){if(!a||!b)return false;return a.valueOf()===b.valueOf()},isHoliday:function(day){day=day.getDay();if(day===0||day==6)return"webix_cal_event"}};webix.i18n={_dateMethods:["fullDateFormat","timeFormat","dateFormat","longDateFormat","parseFormat","parseTimeFormat"],parseFormat:"%Y-%m-%d %H:%i",parseTimeFormat:"%H:%i",numberFormat:webix.Number.format,priceFormat:function(value){return webix.i18n._price_format(webix.i18n.numberFormat(value,webix.i18n._price_settings))},setLocale:function(locale){var extend=function(base,source){for(var method in source){if(typeof source[method]=="object"&&!webix.isArray(source[method])){if(!base[method]){base[method]={}}extend(base[method],source[method])}else base[method]=source[method]}};if(typeof locale=="string")locale=this.locales[locale];if(locale){extend(this,locale)}var helpers=webix.i18n._dateMethods;for(var i=0;i<helpers.length;i++){var key=helpers[i];var utc=webix.i18n[key+"UTC"];webix.i18n[key+"Str"]=webix.Date.dateToStr(webix.i18n[key],utc);webix.i18n[key+"Date"]=webix.Date.strToDate(webix.i18n[key],utc)}this._price_format=webix.template(this.price);this._price_settings=this.priceSettings||this;this.intFormat=webix.Number.numToStr({groupSize:this.groupSize,groupDelimiter:this.groupDelimiter,decimalSize:0})}};webix.i18n.locales={};webix.i18n.locales["en-US"]={groupDelimiter:",",groupSize:3,decimalDelimiter:".",decimalSize:2,dateFormat:"%m/%d/%Y",timeFormat:"%h:%i %A",longDateFormat:"%d %F %Y",fullDateFormat:"%m/%d/%Y %h:%i %A",am:["am","AM"],pm:["pm","PM"],price:"${obj}",priceSettings:{groupDelimiter:",",groupSize:3,decimalDelimiter:".",decimalSize:2},fileSize:["b","Kb","Mb","Gb","Tb","Pb","Eb"],calendar:{monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today"},controls:{select:"Select",invalidMessage:"Invalid input value"},dataExport:{page:"Page",of:"of"},PDFviewer:{of:"of",automaticZoom:"Automatic Zoom",actualSize:"Actual Size",pageFit:"Page Fit",pageWidth:"Page Width",pageHeight:"Page Height"},aria:{calendar:"Calendar",increaseValue:"Increase value",decreaseValue:"Decrease value",navMonth:["Previous month","Next month"],navYear:["Previous year","Next year"],navDecade:["Previous decade","Next decade"],dateFormat:"%d %F %Y",monthFormat:"%F %Y",yearFormat:"%Y",hourFormat:"Hours: %h %A",minuteFormat:"Minutes: %i",removeItem:"Remove item",pages:["First page","Previous page","Next page","Last page"],page:"Page",headermenu:"Header menu",openGroup:"Open column group",closeGroup:"Close column group",closeTab:"Close tab",showTabs:"Show more tabs",resetTreeMap:"Reset tree map",navTreeMap:"Level up",nextTab:"Next tab",prevTab:"Previous tab",multitextSection:"Add section",multitextextraSection:"Remove section",showChart:"Show chart",hideChart:"Hide chart",resizeChart:"Resize chart"},richtext:{underline:"Underline",bold:"Bold",italic:"Italic"}};webix.i18n.setLocale("en-US");webix.protoUI({name:"datatable",defaults:{leftSplit:0,rightSplit:0,topSplit:0,columnWidth:100,minColumnWidth:20,minColumnHeight:26,prerender:false,autoheight:false,autowidth:false,header:true,fixedRowHeight:true,scrollAlignY:true,scrollX:true,scrollY:true,datafetch:50,navigation:true},$skin:function(){var height=webix.skin.$active.rowHeight;var defaults=this.defaults;defaults.rowHeight=height;defaults.headerRowHeight=webix.skin.$active.barHeight},on_click:{webix_richfilter:function(){return false},webix_table_checkbox:function(e,id){id=this.locate(e);var item=this.getItem(id.row);var col=this.getColumnConfig(id.column);var trg=e.target||e.srcElement;var check=trg.type=="checkbox"?trg.checked:item[id.column]!=col.checkValue;var value=check?col.checkValue:col.uncheckValue;var update={};update[id.column]=value;this.updateItem(id.row,update,this._settings.checkboxRefresh?"update":"save");this.callEvent("onCheck",[id.row,id.column,value]);return false},webix_table_radio:function(e){var id=this.locate(e);var item=this.getItem(id.row);var col=this.getColumnConfig(id.column);var checked=0;this.eachRow(function(rowid){var item=this.data.pull[rowid];if(item&&item[id.column]==col.checkValue)item[id.column]=col.uncheckValue});item[id.column]=col.checkValue;this.callEvent("onCheck",[id.row,id.column,true]);this.refresh();return false}},on_dblclick:{webix_table_checkbox:function(){return this.on_click.webix_table_checkbox.apply(this,arguments)}},on_context:{},$init:function(config){this.on_click=webix.extend({},this.on_click);var html="<div class='webix_ss_header'><div class='webix_hs_left'></div><div class='webix_hs_center'></div><div class='webix_hs_right'></div></div><div class='webix_ss_body'><div class='webix_ss_left'><div class='webix_ss_center_scroll'></div></div>";html+="<div class='webix_ss_center'><div class='webix_ss_center_scroll' role='rowgroup'></div></div>";html+="<div class='webix_ss_right'><div class='webix_ss_center_scroll'></div></div></div>";html+="<div class='webix_ss_hscroll' role='scrollbar' aria-orientation='horizontal'></div><div class='webix_ss_footer'><div class='webix_hs_left'></div><div class='webix_hs_center'></div><div class='webix_hs_right'></div></div><div class='webix_ss_vscroll_header'></div><div class='webix_ss_vscroll' role='scrollbar' aria-orientation='vertical'></div><div class='webix_ss_vscroll_footer'></div>";this._contentobj.innerHTML=html;this._top_id=this._contentobj.id=this.name+webix.uid();this._contentobj.className+=" webix_dtable";this._dataobj=this._contentobj;this._header=this._contentobj.firstChild;this._body=this._header.nextSibling;this._footer=this._body.nextSibling.nextSibling;this._viewobj.setAttribute("role","grid");if(!config.editable)this._viewobj.setAttribute("aria-readonly","true");this.data.provideApi(this,true);this.data.attachEvent("onParse",webix.bind(this._call_onparse,this));this.$ready.push(this._first_render);this._columns=[];this._headers=[];this._footers=[];this._rows_cache=[];this._active_headers={};this._filter_elements={};this._header_height=this._footer_height=0;this._destroy_with_me=[];this.data.attachEvent("onServerConfig",webix.bind(this._config_table_from_file,this));this.data.attachEvent("onServerOptions",webix.bind(this._config_options_from_file,this));this.attachEvent("onViewShow",function(){this._restore_scroll_state();this._refresh_any_header_content()});this.data.attachEvent("onClearAll",function(soft){if(!soft){this._scrollLeft=this._scrollTop=0;if(this._x_scroll)this._x_scroll.reset();if(this._y_scroll)this._y_scroll.reset()}});this.attachEvent("onDestruct",this._clean_config_struct);this.attachEvent("onKeyPress",this._onKeyPress);this.attachEvent("onScrollY",this._adjust_rows);webix.callEvent("onDataTable",[this,config])},_render_initial:function(){this._scrollSizeX=this._scrollSizeY=webix.ui.scrollSize;webix.html.addStyle("#"+this._top_id+" .webix_cell { height:"+this._settings.rowHeight+"px; line-height:"+(this._settings.rowLineHeight||this._settings.rowHeight)+"px;"+(this._settings.fixedRowHeight?"":"white-space:normal;")+" }");webix.html.addStyle("#"+this._top_id+" .webix_hcell { height:"+this._settings.headerRowHeight+"px; line-height:"+this._settings.headerRowHeight+"px;}");this._render_initial=function(){}},_first_render:function(){this.data.attachEvent("onStoreLoad",webix.bind(this._refresh_any_header_content,this));this.data.attachEvent("onSyncApply",webix.bind(this._refresh_any_header_content,this));this.data.attachEvent("onStoreUpdated",webix.bind(function(){return this.render.apply(this,arguments)},this));this.data.attachEvent("onStoreUpdated",webix.bind(this._refresh_tracking_header_content,this));this.render()},refresh:function(){this.render()},render:function(id,data,mode){if(mode=="save")return;if(mode=="move"){var context=webix.DragControl.getContext();if(context&&context.fragile)return}if(!this._columns.length){var cols=this._settings.columns;if(!cols||!cols.length){if(this._settings.autoConfig&&this.data.order.length){this._dtable_fully_ready=0;this._autoDetectConfig()}else return}this._define_structure()}if(!this.isVisible(this._settings.id)||this.$blockRender)return this._render_initial();if(id&&data!=-1&&(mode=="paint"||mode=="update")){if(this._render_timer)clearTimeout(this._render_timer);if(!this._render_timer||this._render_timer_id==id){this._render_timer_id=id;this._render_timer=webix.delay(function(){this.render(id,-1,mode)},this)}else{this._render_timer_id=null;this._render_timer=webix.delay(function(){this.render()},this)}return}else if(this._render_timer){clearTimeout(this._render_timer);this._render_timer=0}if(this.callEvent("onBeforeRender",[this.data])){this._render_initial();if(!this._dtable_fully_ready)this._apply_headers();if(this._content_width){if(this["_settings"].experimental&&(mode=="paint"||mode=="update")&&id)this._repaint_single_row(id);else this._check_rendered_cols(true,true)}if(!id||mode!="update"){this._dtable_height=this._get_total_height();this._set_split_sizes_y()}this._viewobj.setAttribute("aria-colcount",Math.max(this._hidden_column_order.length,this._columns.length));this._viewobj.setAttribute("aria-rowcount",this.data.count());this.callEvent("onAfterRender",[this.data]);return true}},getColumnConfig:function(id){return this._columns_pull[id]||this._hidden_column_hash[id]},_config_options_from_file:function(colls){for(var key in colls){var column=this.getColumnConfig(key);webix.assert(column,"Orphan collection: "+key);var temp=new webix.DataCollection({data:colls[key]});this._destroy_with_me.push(temp);this._bind_collection(temp,column)}},_config_table_from_file:function(config){if(config.columns&&this._dtable_fully_ready)this.refreshColumns(null,true)},_define_structure:function(){if(this._settings.columns){this._columns=this._settings.columns;this._columns_pull={};for(var i=0;i<this._columns.length;i++){var col=this._columns[i];this._columns_pull[col.id]=col;var format=col.cssFormat;if(format)col.cssFormat=webix.toFunctor(format,this.$scope);col.width=col.width||this._settings.columnWidth;if(typeof col.format=="string")col.format=webix.i18n[col.format]||window[col.format];if(webix.isUndefined(col.checkValue))col.checkValue=1;if(webix.isUndefined(col.uncheckValue))col.uncheckValue=0;if(col.css&&typeof col.css=="object")col.css=webix.html.createCss(col.css);var template=col.template;if(template){if(typeof template=="string")template=template.replace(/#\$value#/g,"#"+col.id+"#");col.template=webix.template(template)}}this._normalize_headers("header",this._headers);this._normalize_headers("footer",this._footers);this.callEvent("onStructureLoad",[])}},_define_structure_and_render:function(){this._apply_headers()},_clean_config_struct:function(){for(var i=0;i<this._columns.length;i++){delete this._columns[i].attached;delete this._columns[i].node}},_apply_headers:function(){this._rightSplit=this._columns.length-this._settings.rightSplit;this._dtable_width=0;for(var i=0;i<this._columns.length;i++){if(!this._columns[i].node){var temp=webix.html.create("DIV");temp.style.width=this._columns[i].width+"px";this._columns[i].node=temp}if(i>=this._settings.leftSplit&&i<this._rightSplit)this._dtable_width+=this._columns[i].width}var marks=[];if(this._settings.rightSplit){var nr=this._columns.length-this._settings.rightSplit;marks[nr]=" webix_first";marks[nr-1]=" webix_last"}if(this._settings.leftSplit){var nl=this._settings.leftSplit;marks[nl]=" webix_first";marks[nl-1]=" webix_last"}marks[0]=(marks[0]||"")+" webix_first";var last_index=this._columns.length-1;marks[last_index]=(marks[last_index]||"")+" webix_last";for(var i=0;i<this._columns.length;i++){var node=this._columns[i].node;node.setAttribute("column",i);node.className="webix_column "+(this._columns[i].css||"")+(marks[i]||"")}this._create_scrolls();this._set_columns_positions();this._set_split_sizes_x();this._render_header_and_footer();this._dtable_fully_ready=true},_set_columns_positions:function(){var left=0;for(var i=0;i<this._columns.length;i++){var column=this._columns[i];if(i==this._settings.leftSplit||i==this._rightSplit)left=0;if(column.node){column.node.style.left=left+"px";if(this._settings.leftSplit||this._settings.rightSplit){webix.html.remove(column.node);column.attached=false}}left+=column.width}},_render_header_and_footer:function(){if(!this._header_fix_width)this._header_fix_width=0;this._header_height=this._footer_height=0;if(this._settings.header){this._refreshHeaderContent(this._header,0,1);this._normalize_headers("header",this._headers);this._header_height=this._headers._summ;this._render_header_section(this._header,"header",this._headers)}if(this._settings.footer){this._refreshHeaderContent(this._footer,0,1);this._normalize_headers("footer",this._footers);this._footer_height=this._footers._summ;this._render_header_section(this._footer,"footer",this._footers)}this.refreshHeaderContent(false,false);this._size_header_footer_fix();if(this._last_sorted)this.markSorting(this._last_sorted,this._last_order)},_getHeaderHeight:function(header,column,ind){var width=0;var colspan=header.colspan||1;var css="webix_hcell "+(header.css||"");if(header.rotate)css+=" webix_measure_rotate";else for(var i=0;i<colspan;i++)width+=this._columns[ind+i]?this._columns[ind+i].width:this.config.columnWidth;var size=webix.html.getTextSize([header.text],css,width);return(header.rotate?size.width:size.height)+1},_normalize_headers:function(collection,heights){var rows=0;for(var i=0;i<this._columns.length;i++){var data=this._columns[i][collection];if(!data||typeof data!="object"||!data.length){if(webix.isUndefined(data)){if(collection=="header")data=this._columns[i].id;else data=""}data=[data]}for(var j=0;j<data.length;j++){if(typeof data[j]!="object")data[j]={text:data[j]};if(data[j]&&data[j].height)heights[j]=data[j].height;if(data[j]&&data[j].autoheight)heights[j]=this._getHeaderHeight(data[j],this._columns[i],i)}rows=Math.max(rows,data.length);this._columns[i][collection]=data}heights._summ=rows;for(var i=rows-1;i>=0;i--){heights[i]=heights[i]||this._settings.headerRowHeight;heights._summ+=heights[i]*1}for(var i=0;i<this._columns.length;i++){var col=this._columns[i][collection];for(var j=0;j<col.length;j++){if(col[j]&&col[j].rowspan)for(var z=1;z<col[j].rowspan;z++)col[j+z]=null;if(col[j]&&col[j].colspan)for(var z=1;z<col[j].colspan;z++)this._columns[i+z][collection][j]=null}}for(var i=0;i<this._columns.length;i++){var data=this._columns[i][collection];if(data.length<rows){var end=data.length-1;data[end].rowspan=rows-data.length+1;for(var j=end+1;j<rows;j++)data[j]=null}}return rows},_find_header_content:function(sec,id){var alltd=sec.getElementsByTagName("TD");for(var i=0;i<alltd.length;i++)if(alltd[i].getAttribute("active_id")==id)return alltd[i]},getHeaderContent:function(id){var obj=this._find_header_content(this._header,id);if(!obj)obj=this._find_header_content(this._footer,id);if(obj){var config=this._active_headers[id];var type=webix.ui.datafilter[config.content];if(type.getHelper)return type.getHelper(obj,config);return{type:type,getValue:function(){return type.getValue(obj)},setValue:function(value){return type.setValue(obj,value)}}}},_summ_next:function(heights,start,i){var summ=i?-1:0;i+=start;for(start;start<i;start++)summ+=heights[start]+1;return summ},_render_subheader:function(start,end,width,name,heights){if(start==end)return"";var html="<table role='presentation' style='width:"+width+"px' cellspacing='0' cellpadding='0'>";for(var i=start;i<end;i++){html+="<tr>";for(var i=start;i<end;i++)html+="<th  style='width:"+this._columns[i].width+"px'></th>";html+="</tr>"}var count=this._columns[0][name].length;var block_evs=[];for(var j=0;j<count;j++){html+="<tr section='"+name+"' role='row'>";for(var i=start;i<end;i++){var header=this._columns[i][name][j];if(header===null)continue;if(header.content){header.contentId=header.contentId||webix.uid();header.columnId=this._columns[i].id;header.format=this._columns[i].format;webix.assert(webix.ui.datafilter,"Filtering extension was not included");webix.assert(webix.ui.datafilter[header.content],"Unknown content type: "+header.content);header.text=webix.ui.datafilter[header.content].render(this,header);this._active_headers[header.contentId]=header;this._has_active_headers=true}html+="<td  role='presentation' column='"+(header.colspan?header.colspan-1+i:i)+"'";var hcss="";if(i==start)hcss+="webix_first";var column_pos=i+(header.colspan?header.colspan-1:0);if(column_pos>=end-1)hcss+=" webix_last";if(hcss)html+=' class="'+hcss+'"';var cell_height=heights[j];var sheight="";if(header.contentId)html+=" active_id='"+header.contentId+"'";if(header.colspan)html+=" colspan='"+header.colspan+"'";if(header.rowspan){html+=" rowspan='"+header.rowspan+"'";cell_height=this._summ_next(this._headers,j,header.rowspan)}if(cell_height!=this._settings.headerRowHeight)sheight=" style='line-height:"+cell_height+"px; height:"+cell_height+"px;'";var css="webix_hcell";var header_css=header.css;if(header_css){if(typeof header_css=="object")header.css=header_css=webix.html.createCss(header_css);css+=" "+header_css}if(this._columns[i].$selected)css+=" webix_sel_hcell";html+="><div role='columnheader' class='"+css+"'"+sheight+">";var text=header.text===""?"&nbsp;":header.text;if(header.rotate)text="<div class='webix_rotate' style='width:"+(cell_height-10)+"px; transform-origin:center "+(cell_height-15)/2+"px;-webkit-transform-origin:center "+(cell_height-15)/2+"px;'>"+text+"</div>";html+=text+"</div></td>"}html+="</tr>"}html+="</tr></table>";return html},showItemByIndex:function(row_ind,column_ind){var pager=this._settings.pager;if(pager){var target=Math.floor(row_ind/pager.size);if(target!=pager.page)webix.$$(pager.id).select(target)}if(row_ind!=-1){var state=this._get_y_range();if(row_ind<state[0]+1||row_ind>=state[1]-1){var summ=this._getHeightByIndexSumm(pager?this.data.$min:0,row_ind);if(row_ind<state[0]+1){summ=Math.max(0,summ-1)-this._top_split_height}else{summ+=this._getHeightByIndex(row_ind)-this._dtable_offset_height;if(row_ind>0)summ+=this._getHeightByIndex(row_ind-1)-1}this._y_scroll.scrollTo(summ)}}if(column_ind!=-1){if(column_ind<this._settings.leftSplit)return;if(column_ind>=this._rightSplit)return;var state=this._get_x_range();if(column_ind<state[0]+1||column_ind>=state[1]-1){var summ=0;for(var i=this._settings.leftSplit;i<column_ind;i++)summ+=this._columns[i].width;if(column_ind<state[0]+1){}else{summ+=this._columns[column_ind].width-this._center_width}this._x_scroll.scrollTo(summ)}}},showCell:function(row,column){if(!column||!row){var t=this.getSelectedId(true);if(t.length==1){column=column||t[0].column;row=row||t[0].row}}column=column?this.getColumnIndex(column):-1;row=row?this.getIndexById(row):-1;this.showItemByIndex(row,column)},scrollTo:function(x,y){if(!this._x_scroll)return;if(this._scrollTo_touch)return this._scrollTo_touch(x,y);if(x!==null)this._x_scroll.scrollTo(x);if(y!==null)this._y_scroll.scrollTo(y)},getScrollState:function(){if(this._getScrollState_touch)return this._getScrollState_touch();var diff=this._render_scroll_shift?0:this._render_scroll_diff||0;return{x:this._scrollLeft||0,y:this._scrollTop+diff}},showItem:function(id){this.showItemByIndex(this.getIndexById(id),-1)},_render_header_section:function(sec,name,heights){sec.childNodes[0].innerHTML=this._render_subheader(0,this._settings.leftSplit,this._left_width,name,heights);sec.childNodes[1].innerHTML=this._render_subheader(this._settings.leftSplit,this._rightSplit,this._dtable_width,name,heights);sec.childNodes[1].onscroll=webix.bind(this._scroll_with_header,this);sec.childNodes[2].innerHTML=this._render_subheader(this._rightSplit,this._columns.length,this._right_width,name,heights)},_scroll_with_header:function(){var active=this.getScrollState().x;var header=this._header.childNodes[1].scrollLeft;if(header!=active)this.scrollTo(header,null)},_refresh_tracking_header_content:function(){this.refreshHeaderContent(true,true)},_refresh_any_header_content:function(){this.refreshHeaderContent(false,true)},refreshHeaderContent:function(trackedOnly,preserve,id){if(this._settings.header){if(preserve)this._refreshHeaderContent(this._header,trackedOnly,1,id);this._refreshHeaderContent(this._header,trackedOnly,0,id)}if(this._settings.footer){if(preserve)this._refreshHeaderContent(this._footer,trackedOnly,1,id);this._refreshHeaderContent(this._footer,trackedOnly,0,id)}},refreshFilter:function(id){if(id&&!this._active_headers[id])return;this.refreshHeaderContent(false,true,id)},_refreshHeaderContent:function(sec,cellTrackOnly,getOnly,byId){if(this._has_active_headers&&sec){var alltd=sec.getElementsByTagName("TD");for(var i=0;i<alltd.length;i++){if(alltd[i].getAttribute("active_id")){var obj=this._active_headers[alltd[i].getAttribute("active_id")];if(byId&&byId!=obj.columnId)continue;var content=webix.ui.datafilter[obj.content];if(getOnly){if(content.getValue)obj.value=content.getValue(alltd[i])}else if(!cellTrackOnly||content.trackCells){content.refresh(this,alltd[i],obj)}}}}},headerContent:[],_set_size_scroll_area:function(obj,height,hdx){if(this._scrollSizeY){obj.style.height=Math.max(height,1)-1+"px";obj.style.width=(this._rightSplit?0:hdx)+this._scrollSizeY-1+"px";if(webix.env.isWebKit)var w=obj.offsetWidth}else obj.style.display="none"},_size_header_footer_fix:function(){if(this._settings.header)this._set_size_scroll_area(this._header_scroll,this._header_height,this._header_fix_width);if(this._settings.footer)this._set_size_scroll_area(this._footer_scroll,this._footer_height,this._header_fix_width)},_update_scroll:function(x,y){var hasX=!(this._settings.autowidth||this._settings.scrollX===false);this._scrollSizeX=hasX?webix.ui.scrollSize:0;var hasY=!(this._settings.autoheight||this._settings.scrollY===false);this._scrollSizeY=hasY?webix.ui.scrollSize:0;if(webix.env.touch)hasX=hasY=false;if(this._x_scroll){this._x_scroll._settings.scrollSize=this._scrollSizeX;this._x_scroll._settings.scrollVisible=hasX}if(this._y_scroll){this._y_scroll._settings.scrollSize=this._scrollSizeY;this._y_scroll._settings.scrollVisible=hasY}},_create_scrolls:function(){this._scrollTop=0;this._scrollLeft=0;var scrx,scry;scrx=scry=1;if(this._settings.autoheight||this._settings.scrollY===false)scry=this._scrollSizeY=0;if(this._settings.autowidth||this._settings.scrollX===false)scrx=this._scrollSizeX=0;if(webix.env.touch)scrx=scry=0;if(!this._x_scroll){this._x_scroll=new webix.ui.vscroll({container:this._footer.previousSibling,scrollWidth:this._dtable_width,scrollSize:this._scrollSizeX,scrollVisible:scrx});if(scrx&&!this._scrollSizeX&&!webix.env.$customScroll)this._x_scroll._viewobj.style.position="absolute";this._x_scroll.attachEvent("onScroll",webix.bind(this._onscroll_x,this))}if(!this._y_scroll){this._header_scroll=this._footer.nextSibling;var vscroll_view=this._header_scroll.nextSibling;this._footer_scroll=vscroll_view.nextSibling;this._y_scroll=new webix.ui.vscroll({container:vscroll_view,scrollHeight:100,scroll:"y",scrollSize:this._scrollSizeY,scrollVisible:scry});this._y_scroll.activeArea(this._body);this._x_scroll.activeArea(this._body,true);this._y_scroll.attachEvent("onScroll",webix.bind(this._onscroll_y,this))}if(this._content_width)this.callEvent("onResize",[this._content_width,this._content_height]);if(webix.env.$customScroll)webix.CustomScroll.enable(this);this._create_scrolls=function(){}},columnId:function(index){return this._columns[index].id},getColumnIndex:function(id){for(var i=0;i<this._columns.length;i++)if(this._columns[i].id==id)return i;return-1},_getNodeBox:function(rid,cid){var xs=0,xe=0,ye=0,ys=0;var i;var zone=0;for(i=0;i<this._columns.length;i++){if(this._rightSplit==i||this._settings.leftSplit==i){xs=0;zone++}if(this._columns[i].id==cid)break;xs+=this._columns[i].width}xe+=this._columns[i].width;for(i=0;i<this.data.order.length;i++){if(this.data.order[i]==rid)break;ys+=this._getHeightByIndex(i)}ye+=this._getHeightByIndex(i);return[xs,xe,ys-this._scrollTop,ye,this._body.childNodes[zone]]},_id_to_string:function(){return this.row},locate:function(node,idOnly){if(this._settings.subview&&this!=webix.$$(node))return null;node=node.target||node.srcElement||node;while(node&&node.getAttribute){if(node===this.$view)break;var cs=webix.html._getClassName(node).toString();var pos=null;if(cs.indexOf("webix_cell")!=-1){pos=this._locate(node);if(pos)pos.row=this.data.order[pos.rind]}if(cs.indexOf("webix_hcell")!=-1){pos=this._locate(node);if(pos)pos.header=true}if(pos){if(idOnly)return pos.header?null:pos.row;pos.column=this._columns[pos.cind].id;pos.toString=this._id_to_string;return pos}node=node.parentNode}return null},_locate:function(node){var cdiv=node.parentNode;if(!cdiv)return null;var column=(node.getAttribute("column")||cdiv.getAttribute("column"))*1;var row=node.getAttribute("row")||0;if(!row)for(var i=0;i<cdiv.childNodes.length;i++)if(cdiv.childNodes[i]==node){if(i>=this._settings.topSplit)row=i+this._columns[column]._yr0-this._settings.topSplit;else row=i}return{rind:row,cind:column}},_correctScrollSize:function(){var center=-this._center_width;for(var i=0;i<this._columns.length;i++)center+=this._columns[i].width;this._scrollLeft=Math.min(this._scrollLeft,Math.max(0,center))},_updateColsSizeSettings:function(silent){if(!this._dtable_fully_ready)return;this._correctScrollSize();this._set_columns_positions();this._set_split_sizes_x();this._render_header_and_footer();if(!silent)this._check_rendered_cols(false,false)},setColumnWidth:function(col,width,skip_update){return this._setColumnWidth(this.getColumnIndex(col),width,skip_update)},_setColumnWidth:function(col,width,skip_update,by_user){if(isNaN(width)||col<0)return;var column=this._columns[col];if(column.minWidth&&width<column.minWidth)width=column.minWidth;else if(width<this._settings.minColumnWidth)width=this._settings.minColumnWidth;var old=column.width;if(old!=width){if(col>=this._settings.leftSplit&&col<this._rightSplit)this._dtable_width+=width-old;column.width=width;if(column.node)column.node.style.width=width+"px";else return false;if(!skip_update)this._updateColsSizeSettings();this.callEvent("onColumnResize",[column.id,width,old,!!by_user]);return true}return false},_getRowHeight:function(row){return(row.$height||this._settings.rowHeight)+(row.$subopen?row.$subHeight:0)},_getHeightByIndex:function(index){var id=this.data.order[index];if(!id)return this._settings.rowHeight;return this._getRowHeight(this.data.pull[id])},_getHeightByIndexSumm:function(index1,index2){if(this._settings.fixedRowHeight)return(index2-index1)*this._settings.rowHeight;else{var summ=0;for(;index1<index2;index1++)summ+=this._getHeightByIndex(index1);return summ}},_cellPosition:function(row,column){var top;if(arguments.length==1){column=row.column;row=row.row}var item=this.getItem(row);var config=this.getColumnConfig(column);var left=0;var parent=0;for(var index=0;index<this._columns.length;index++){if(index==this._settings.leftSplit||index==this._rightSplit)left=0;var leftcolumn=this._columns[index];if(leftcolumn.id==column){var split_column=index<this._settings.leftSplit?0:index>=this._rightSplit?2:1;parent=this._body.childNodes[split_column].firstChild;break}left+=leftcolumn.width}if(this.getIndexById(row)<this._settings.topSplit)top=this._getHeightByIndexSumm(0,this.getIndexById(row));else top=this._getHeightByIndexSumm((this._render_scroll_top||0)-this._settings.topSplit,this.getIndexById(row))+(this._render_scroll_shift||0);return{parent:parent,top:top,left:left,width:config.width,height:item.$height||this._settings.rowHeight}},_get_total_height:function(){var pager=this._settings.pager;var start=0;var max=this.data.order.length;if(pager){start=pager.size*pager.page;max=Math.min(max,start+pager.size);if(pager.level){start=this.data.$min;max=this.data.$max}}return this._getHeightByIndexSumm(start,max)},setRowHeight:function(rowId,height){if(isNaN(height))return;if(height<this._settings.minColumnHeight)height=this._settings.minColumnHeight;var item=this.getItem(rowId);var old_height=item.$height||this._settings.rowHeight;if(old_height!=height){item.$height=height;this.config.fixedRowHeight=false;this.render();this.callEvent("onRowResize",[rowId,height,old_height])}},_onscroll_y:function(value){var scrollChange=this._scrollTop!==value;this._scrollTop=value;if(!this._settings.prerender){this._check_rendered_cols()}else{var conts=this._body.childNodes;for(var i=0;i<conts.length;i++){conts[i].scrollTop=value}}if(webix.env.$customScroll)webix.CustomScroll._update_scroll(this._body);if(scrollChange){this.callEvent("onScrollY",[]);this.callEvent("onAfterScroll",[])}},_onscroll_x:function(value){var scrollChange=this._scrollLeft!==value;this._body.childNodes[1].scrollLeft=this._scrollLeft=value;if(this._settings.header)this._header.childNodes[1].scrollLeft=value;if(this._settings.footer)this._footer.childNodes[1].scrollLeft=value;if(this._settings.prerender===false)this._check_rendered_cols(this._minimize_dom_changes?false:true);if(webix.env.$customScroll)webix.CustomScroll._update_scroll(this._body);if(scrollChange){this.callEvent("onScrollX",[]);this.callEvent("onAfterScroll",[])}},_get_x_range:function(full){if(full)return[0,this._columns.length];var t=this._scrollLeft;var xind=this._settings.leftSplit;while(t>0&&this._columns.length-1>xind){t-=this._columns[xind].width;xind++}var xend=xind;if(t)xind--;t+=this._center_width;while(t>0&&xend<this._rightSplit){t-=this._columns[xend].width;xend++}return[xind,xend]},getVisibleCount:function(){return Math.floor(this._dtable_offset_height/this.config.rowHeight)},_get_y_range:function(full){var t=this._scrollTop;var start=0;var end=this.count();var pager=this._settings.pager;if(pager){var start=pager.page*pager.size;var end=Math.min(end,start+pager.size);if(pager.level){start=this.data.$min;end=this.data.$max}}if(this._settings.autoheight)return[start,end,0];if(full)return[start,end,0];var xind=start;var rowHeight=this._settings.fixedRowHeight?this._settings.rowHeight:0;if(rowHeight){var dep=Math.ceil(t/rowHeight);t-=dep*rowHeight;xind+=dep}else while(t>0){t-=this._getHeightByIndex(xind);xind++}var topSplit=this._settings.topSplit;if(topSplit)xind+=topSplit;var xdef=xind>0&&t?-(this._getHeightByIndex(xind-1)+t):0;var xend=xind;if(t)xind--;t+=(this._dtable_offset_height||this._content_height)-(this._top_split_height||0);if(rowHeight){var dep=Math.ceil(t/rowHeight);t-=dep*rowHeight;xend+=dep}else{while(t>0&&xend<end){t-=this._getHeightByIndex(xend);xend++}}if(xend>end)xend=end;return[xind,xend,xdef]},_repaint_single_row:function(id){var item=this.getItem(id);var rowindex=this.getIndexById(id);var state=this._get_y_range();var freeze=this.config.topSplit;var freezeCss="";if(rowindex>=freeze){if(rowindex<state[0]||rowindex>=state[1])return;rowindex-=state[0]-freeze}else{freezeCss=rowindex==freeze-1?" webix_topcell webix_last_topcell":" webix_topcell"}var x_range=this._get_x_range();for(var i=0;i<this._columns.length;i++){var column=this._columns[i];if(i<this._rightSplit&&i>=this._settings.leftSplit&&(i<x_range[0]||i>x_range[1]))column._yr0=-999;if(column.attached&&column.node){var node=column.node.childNodes[rowindex];var value=this._getValue(item,this._columns[i],0);node.innerHTML=value;node.className=this._getCss(this._columns[i],value,item,id)+freezeCss}}},_check_rendered_cols:function(x_scroll,force){if(!this._columns.length)return;if(force)this._clearColumnCache();if(webix.debug_render)webix.log("Render: "+this.name+"@"+this._settings.id);var xr=this._get_x_range(this._settings.prerender);var yr=this._get_y_range(this._settings.prerender===true);if(x_scroll){for(var i=this._settings.leftSplit;i<xr[0];i++)this._hideColumn(i,force);for(var i=xr[1];i<this._rightSplit;i++)this._hideColumn(i,force)}this._render_full_rows=[];var rendered=0;for(var i=0;i<this._settings.leftSplit;i++)rendered+=this._renderColumn(i,yr,force);for(var i=xr[0];i<xr[1];i++)rendered+=this._renderColumn(i,yr,force,i==xr[0]);for(var i=this._rightSplit;i<this._columns.length;i++)rendered+=this._renderColumn(i,yr,force);this._check_and_render_full_rows(yr[0],yr[1],force);this._check_load_next(yr)},_delete_full_rows:function(start,end){this._rows_cache_start=start;this._rows_cache_end=end;webix.html.remove(this._rows_cache);this._rows_cache=[]},_adjust_rows:function(){if(this._settings.prerender&&this._rows_body){var state=this.getScrollState();this._rows_body.style.top="-"+(state.y||0)+"px"}},_check_and_render_full_rows:function(start,end,force){if(this._rows_body)this._rows_body.style.top=this._render_scroll_shift+"px";if(!force&&start==this._rows_cache_start&&end==this._rows_cache_end)return;this._delete_full_rows(start,end);if(this._render_full_row_some)this._render_full_row_some=false;else return;for(var i=0;i<this._render_full_rows.length;i++){var info=this._render_full_rows[i];var item=this.getItem(info.id);var value;if(typeof item.$row=="function"){value=item.$row.call(this,item,this.type)}else{value=this._getValue(item,this.getColumnConfig(item.$row),i)}var row=this._rows_cache[i]=webix.html.create("DIV",null,value);row.className="webix_cell "+(item.$sub?"webix_dtable_sub"+(this._settings.subview?"view":"row"):"webix_dtable_colrow");row.setAttribute("column",0);row.setAttribute("row",info.index);var height=item.$height||this._settings.rowHeight;if(item.$subopen)row.style.height=item.$subHeight+"px";else row.style.height=height+"px";row.style.paddingRight=webix.ui.scrollSize+"px";row.style.top=info.top+(item.$subopen?height-1:-1)+"px";if(!this._rows_body){this._rows_body=webix.html.create("DIV");this._rows_body.style.position="relative";this._rows_body.style.top=this._render_scroll_shift+"px";this._body.appendChild(this._rows_body)}this._rows_body.appendChild(row);this.attachEvent("onSyncScroll",function(x,y,t){webix.Touch._set_matrix(this._rows_body,0,y,t)});if(this._settings.subview)this.callEvent("onSubViewRender",[item,row])}},_check_load_next:function(yr){var paging=this._settings.pager;var fetch=this._settings.datafetch;var direction=!this._last_valid_render_pos||yr[0]>=this._last_valid_render_pos;this._last_valid_render_pos=yr[0];if(this._data_request_flag){if(paging&&(!fetch||fetch>=paging.size))if(this._check_rows([0,paging.size*paging.page],Math.max(fetch,paging.size),true))return this._data_request_flag=null;this._run_load_next(this._data_request_flag,direction);this._data_request_flag=null}else{if(this._settings.loadahead)var check=this._check_rows(yr,this._settings.loadahead,direction)}},_check_rows:function(view,count,dir){var start=view[1];var end=start+count;if(!dir){start=view[0]-count;end=view[0]}if(start<0)start=0;end=Math.min(end,this.data.order.length-1);var result=false;for(var i=start;i<end;i++)if(!this.data.order[i]){if(!result)result={start:i,count:end-start};else{result.last=i;result.count=i-start}}if(result){this._run_load_next(result,dir);return true}},_run_load_next:function(conf,direction){var count=Math.max(conf.count,this._settings.datafetch||this._settings.loadahead||0);var start=direction?conf.start:conf.last-count+1;if(this._maybe_loading_already(conf.count,conf.start))return;this.loadNext(count,start)},_preserveScrollTarget:function(columnNode){if(webix.env.isSafari){var i,node,newNode,scroll,dir=[this._x_scroll,this._y_scroll];for(i=0;i<2;i++){scroll=dir[i];if(scroll&&scroll._scroll_trg&&scroll._scroll_trg.parentNode==columnNode){node=scroll._scroll_trg}}if(node){if(this._scrollWheelTrg)webix.html.remove(this._scrollWheelTrg);this._scrollWheelTrg=node;newNode=node.cloneNode(true);node.parentNode.insertBefore(newNode,node);this._scrollWheelTrg.style.display="none";this._body.appendChild(this._scrollWheelTrg)}}},_hideColumn:function(index){var col=this._columns[index];this._preserveScrollTarget(col.node);webix.html.remove(col.node);col.attached=false},_clearColumnCache:function(){for(var i=0;i<this._columns.length;i++)this._columns[i]._yr0=-1;if(this._rows_cache.length){webix.html.remove(this._rows_cache);this._rows_cache=[]}},getText:function(row_id,column_id){return this._getValue(this.getItem(row_id),this.getColumnConfig(column_id),0)},getCss:function(row_id,column_id){var item=this.getItem(row_id);return this._getCss(this.getColumnConfig(column_id),item[column_id],item,row_id)},_getCss:function(config,value,item,id){var css="webix_cell";if(config.cssFormat){var per_css=config.cssFormat(value,item,id,config.id);if(per_css){if(typeof per_css=="object")css+=" "+webix.html.createCss(per_css);else css+=" "+per_css}}var row_css=item.$css;if(row_css){if(typeof row_css=="object")item.$css=row_css=webix.html.createCss(row_css);css+=" "+row_css}var mark=this.data._marks[id];if(mark){if(mark.$css)css+=" "+mark.$css;if(mark.$cellCss){var mark_marker=mark.$cellCss[config.id];if(mark_marker)css+=" "+mark_marker}}if(item.$cellCss){var css_marker=item.$cellCss[config.id];if(css_marker){if(typeof css_marker=="object")css_marker=webix.html.createCss(css_marker);css+=" "+css_marker}}var selected=this.data.getMark(item.id,"webix_selected");if(selected&&(selected.$row||selected[config.id])||config.$selected)css+=this._select_css;return css},_getValue:function(item,config,i){if(!item)return"";var value;value=item[config.id];if(value===webix.undefined||value===null)value="";else if(config.format)value=config.format(value);if(config.template)value=config.template(item,this.type,value,config,i);return value},type:{checkbox:function(obj,common,value,config){var checked=value==config.checkValue?'checked="true"':"";return"<input class='webix_table_checkbox' type='checkbox' "+checked+">"},radio:function(obj,common,value,config){var checked=value==config.checkValue?'checked="true"':"";return"<input class='webix_table_radio' type='radio' "+checked+">"},editIcon:function(){return"<span class='webix_icon fa-pencil'></span>"},trashIcon:function(){return"<span class='webix_icon fa-trash'></span>"}},type_setter:function(value){if(!this.types||!this.types[value])webix.type(this,value);else{this.type=webix.clone(this.types[value]);if(this.type.css)this._contentobj.className+=" "+this.type.css}if(this.type.on_click)webix.extend(this.on_click,this.type.on_click);return value},_renderColumn:function(index,yr,force,single){var col=this._columns[index];if(!col.attached){var split_column=index<this._settings.leftSplit?0:index>=this._rightSplit?2:1;this._body.childNodes[split_column].firstChild.appendChild(col.node);col.attached=true;col.split=split_column}this._render_scroll_top=yr[0];this._render_scroll_shift=0;this._render_scroll_diff=yr[2];if(this._settings.scrollAlignY){if(yr[1]==this.data.order.length||this.data.$pagesize&&yr[1]%this.data.$pagesize===0){col.node.style.top=(this._render_scroll_shift=yr[2])+"px"}else if(col._yr2)col.node.style.top="0px"}else{this._render_scroll_shift=yr[2];col.node.style.top=yr[2]+"px"}if(!force&&(col._yr0==yr[0]&&col._yr1==yr[1])&&(!this._settings.topSplit||col._render_scroll_shift==this._render_scroll_shift))return 0;var html="";var config=this._settings.columns[index];var state={row:this._settings.rowHeight,total:0,single:single};for(var i=0;i<this._settings.topSplit;i++)html+=this._render_single_cell(i,config,yr,state,-this._render_scroll_shift);for(var i=Math.max(yr[0],this._settings.topSplit);i<yr[1];i++)html+=this._render_single_cell(i,config,yr,state,-1);this._preserveScrollTarget(col.node);col.node.innerHTML=html;col._yr0=yr[0];col._yr1=yr[1];col._yr2=yr[2];col._render_scroll_shift=this._render_scroll_shift;return 1},_render_single_cell:function(i,config,yr,state,top){var id=this.data.order[i];var item=this.data.getItem(id);var html="";var value;if(item){var aria=" role='gridcell' aria-rowindex='"+(i+1)+"' aria-colindex='"+(this.getColumnIndex(config.id)+1)+"'"+(item.$count||item.$sub?" aria-expanded='"+(item.open||item.$subopen?"true":"false")+"'":"")+(item.$level?" aria-level='"+item.$level+"'":"");if(state.single&&item.$row){this._render_full_row_some=true;this._render_full_rows.push({top:state.total,id:item.id,index:i});if(!item.$sub){state.total+=state.row;return"<div"+aria+" class='webix_cell'></div>"}}var value=this._getValue(item,config,i);var css=this._getCss(config,value,item,id);if(css.indexOf("select")!==-1)aria+=" aria-selected='true' tabindex='0'";var margin=item.$subopen?"margin-bottom:"+item.$subHeight+"px;":"";if(top>=0){if(top>0)margin+="top:"+top+"px;'";css="webix_topcell "+css;if(i==this._settings.topSplit-1)css="webix_last_topcell "+css}if(item.$height){html="<div"+aria+" class='"+css+"' style='height:"+item.$height+"px;"+margin+"'>"+value+"</div>";state.total+=item.$height-state.row}else{html="<div"+aria+" class='"+css+"'"+(margin?" style='"+margin+"'":"")+">"+value+"</div>"}if(margin)state.total+=item.$subHeight}else{html="<div role='gridcell' class='webix_cell'></div>";if(!this._data_request_flag)this._data_request_flag={start:i,count:yr[1]-i};else this._data_request_flag.last=i}state.total+=state.row;return html},_set_split_sizes_y:function(){if(!this._columns.length||isNaN(this._content_height*1))return;webix.debug_size_box(this,["y-sizing"],true);var wanted_height=this._dtable_height+(this._scrollSizeX?this._scrollSizeX:0);if((this._settings.autoheight||this._settings.yCount)&&this.resize())return;this._y_scroll.sizeTo(this._content_height,this._header_height,this._footer_height);this._y_scroll.define("scrollHeight",wanted_height);this._top_split_height=this._settings.topSplit*this._settings.rowHeight;this._dtable_offset_height=Math.max(0,this._content_height-this._scrollSizeX-this._header_height-this._footer_height);for(var i=0;i<3;i++){this._body.childNodes[i].style.height=this._dtable_offset_height+"px";if(this._settings.prerender)this._body.childNodes[i].firstChild.style.height=this._dtable_height+"px";else this._body.childNodes[i].firstChild.style.height=this._dtable_offset_height+"px"}this._header.style.height=this._header_height+"px"},_set_split_sizes_x:function(){if(!this._columns.length)return;if(webix.debug_size)webix.log("  - "+this.name+"@"+this._settings.id+" X sizing");var index=0;this._left_width=0;this._right_width=0;this._center_width=0;while(index<this._settings.leftSplit){this._left_width+=this._columns[index].width;index++}index=this._columns.length-1;while(index>=this._rightSplit){this._right_width+=this._columns[index].width;index--}if(!this._content_width)return;if(this._settings.autowidth&&this.resize())return;this._center_width=this._content_width-this._right_width-this._left_width-this._scrollSizeY;this._body.childNodes[1].firstChild.style.width=this._dtable_width+"px";this._body.childNodes[0].style.width=this._left_width+"px";this._body.childNodes[1].style.width=this._center_width+"px";this._body.childNodes[2].style.width=this._right_width+"px";this._header.childNodes[0].style.width=this._left_width+"px";this._header.childNodes[1].style.width=this._center_width+"px";this._header.childNodes[2].style.width=this._right_width+"px";this._footer.childNodes[0].style.width=this._left_width+"px";this._footer.childNodes[1].style.width=this._center_width+"px";this._footer.childNodes[2].style.width=this._right_width+"px";var delta=this._center_width-this._dtable_width;if(delta<0)delta=0;if(delta!=this._header_fix_width){this._header_fix_width=delta;this._size_header_footer_fix()}if(webix.env.isWebKit){var w=this._body.childNodes[0].offsetWidth;w=this._body.childNodes[1].offsetWidth;w=this._body.childNodes[1].firstChild.offsetWidth;w=this._body.childNodes[2].offsetWidth}this._x_scroll.sizeTo(this._content_width-this._scrollSizeY);this._x_scroll.define("scrollWidth",this._dtable_width+this._left_width+this._right_width)},$getSize:function(dx,dy){if((this._settings.autoheight||this._settings.yCount)&&this._settings.columns){var desired=(this._settings.yCount||0)*this._settings.rowHeight;if(!desired)desired=this.isVisible()?this._dtable_height:this.count()*this._settings.rowHeight;this._settings.height=Math.max(desired+(this._scrollSizeX?this._scrollSizeX:0)-1,this._settings.minHeight||0)+this._header_height+this._footer_height}if(this._settings.autowidth&&this._settings.columns)this._settings.width=Math.max(this._dtable_width+this._left_width+this._right_width+this._scrollSizeY,this._settings.minWidth||0);var minwidth=this._left_width+this._right_width+this._scrollSizeY;var sizes=webix.ui.view.prototype.$getSize.call(this,dx,dy);sizes[0]=Math.max(sizes[0]||minwidth);return sizes},_restore_scroll_state:function(){if(this._x_scroll&&!webix.env.touch){var state=this.getScrollState();this._x_scroll._last_scroll_pos=this._y_scroll._last_scroll_pos=-1;this.scrollTo(state.x,state.y)}},$setSize:function(x,y){var oldw=this._content_width;var oldh=this._content_height;if(webix.ui.view.prototype.$setSize.apply(this,arguments)){if(this._dtable_fully_ready){this.callEvent("onResize",[this._content_width,this._content_height,oldw,oldh]);this._set_split_sizes_x();this._set_split_sizes_y()}this.render()}},_on_header_click:function(column){var col=this.getColumnConfig(column);if(!col.sort)return;var order="asc";if(col.id==this._last_sorted)order=this._last_order=="asc"?"desc":"asc";this._sort(col.id,order,col.sort)},markSorting:function(column,order){if(!this._sort_sign)this._sort_sign=webix.html.create("DIV");var parent=this._sort_sign.parentNode;if(parent){parent.removeAttribute("aria-sort");parent.removeAttribute("tabindex")}webix.html.remove(this._sort_sign);if(order){var cell=this._get_header_cell(this.getColumnIndex(column));if(cell){this._sort_sign.className="webix_ss_sort_"+order;cell.style.position="relative";cell.appendChild(this._sort_sign);cell.setAttribute("aria-sort",order+"ending");cell.setAttribute("tabindex","0")}this._last_sorted=column;this._last_order=order}else{this._last_sorted=this._last_order=null}},scroll_setter:function(mode){if(typeof mode=="string"){this._settings.scrollX=mode.indexOf("x")!=-1;this._settings.scrollY=mode.indexOf("y")!=-1;return mode}else return this._settings.scrollX=this._settings.scrollY=mode},_get_header_cell:function(column){var cells=this._header.getElementsByTagName("TD");var maybe=null;for(var i=0;i<cells.length;i++)if(cells[i].getAttribute("column")==column&&!cells[i].getAttribute("active_id")){maybe=cells[i].firstChild;if((cells[i].colSpan||0)<2)return maybe}return maybe},_sort:function(col_id,direction,type){direction=direction||"asc";this.markSorting(col_id,direction);if(type=="server"){this.callEvent("onBeforeSort",[col_id,direction,type]);this.loadNext(0,0,{before:function(){this.clearAll(true)},success:function(){this.callEvent("onAfterSort",[col_id,direction,type])}},0,1)}else{if(type=="text"){this.data.each(function(obj){obj.$text=this.getText(obj.id,col_id)},this);type="string";col_id="$text"}if(typeof type=="function")this.data.sort(type,direction);else this.data.sort(col_id,direction,type||"string")}},_mouseEventCall:function(css_call,e,id,trg){var functor,i,res;if(css_call.length){for(i=0;i<css_call.length;i++){functor=webix.toFunctor(css_call[i],this.$scope);res=functor.call(this,e,id,trg);if(res===false)return false}}},_mouseEvent:function(e,hash,name,pair){e=e||event;var trg=e.target||e.srcElement;if(this._settings.subview&&this!=webix.$$(trg))return;var css="",css_call=[],found=false,id=null,res,trg=e.target||e.srcElement;while(trg&&trg.parentNode&&trg!=this._viewobj.parentNode){var trgCss=webix.html._getClassName(trg);if(css=trgCss){css=css.toString().split(" ");for(var i=css.length-1;i>=0;i--)if(hash[css[i]])css_call.push(hash[css[i]])}if(trg.parentNode.getAttribute&&!id){var column=trg.parentNode.getAttribute("column")||trg.getAttribute("column");if(column){var isBody=trg.parentNode.tagName=="DIV";if(!this._columns[column])return;found=true;if(isBody){var index=trg.parentNode.getAttribute("row")||trg.getAttribute("row");if(!index){index=webix.html.index(trg);if(index>=this._settings.topSplit)index+=this._columns[column]._yr0-this._settings.topSplit}this._item_clicked=id={row:this.data.order[index],column:this._columns[column].id};id.toString=this._id_to_string}else this._item_clicked=id={column:this._columns[column].id};res=this._mouseEventCall(css_call,e,id,trg);if(res===false)return;if(isBody){if(this.callEvent("on"+name,[id,e,trg])&&pair){this.callEvent("on"+pair,[id,e,trg])}}else if(name=="ItemClick"){var isHeader=trg.parentNode.parentNode.getAttribute("section")=="header";if(isHeader&&this.callEvent("onHeaderClick",[id,e,trg]))this._on_header_click(id.column)}css_call=[]}}trg=trg.parentNode}this._mouseEventCall(css_call,e,id,this.$view);return found},showOverlay:function(message){if(!this._datatable_overlay){var t=webix.html.create("DIV",{class:"webix_overlay"},"");this._body.appendChild(t);this._datatable_overlay=t}this._datatable_overlay.innerHTML=message},hideOverlay:function(){if(this._datatable_overlay){webix.html.remove(this._datatable_overlay);this._datatable_overlay=null}},mapCells:function(startrow,startcol,numrows,numcols,callback,getOnly){if(startrow===null&&this.data.order.length>0)startrow=this.data.order[0];if(startcol===null)startcol=this.columnId(0);if(numrows===null)numrows=this.data.order.length;if(numcols===null)numcols=this._settings.columns.length;if(!this.exists(startrow))return;startrow=this.getIndexById(startrow);startcol=this.getColumnIndex(startcol);if(startcol===null)return;for(var i=0;i<numrows&&startrow+i<this.data.order.length;i++){var row_ind=startrow+i;var row_id=this.data.order[row_ind];var item=this.getItem(row_id);for(var j=0;j<numcols&&startcol+j<this._settings.columns.length;j++){var col_ind=startcol+j;var col_id=this.columnId(col_ind);var result=callback(item[col_id],row_id,col_id,i,j);if(!getOnly)item[col_id]=result}}},_call_onparse:function(driver,data){if(!this._settings.columns&&driver.getConfig)this.define("columns",driver.getConfig(data))},_autoDetectConfig:function(){var test=this.getItem(this.getFirstId());var res=this._settings.columns=[];for(var key in test)if(key!="id")res.push({id:key,header:key[0].toUpperCase()+key.substr(1),sort:"string",editor:"text"});if(res.length)res[0].fillspace=true;if(typeof this._settings.select=="undefined")this.define("select","row")}},webix.AutoTooltip,webix.Group,webix.DataMarks,webix.DataLoader,webix.MouseEvents,webix.MapCollection,webix.ui.view,webix.EventSystem,webix.Settings);webix.ui.datafilter={textWaitDelay:500,summColumn:{getValue:function(node){return node.firstChild.innerHTML},setValue:function(){},refresh:function(master,node,value){var result=0;master.mapCells(null,value.columnId,null,1,function(value){value=value*1;if(!isNaN(value))result+=value},true);if(value.format)result=value.format(result);if(value.template)result=value.template({value:result});node.firstChild.innerHTML=result},trackCells:true,render:function(master,config){if(config.template)config.template=webix.template(config.template);return""}},masterCheckbox:{getValue:function(){},setValue:function(){},getHelper:function(node,config){return{check:function(){config.checked=false;node.onclick()},uncheck:function(){config.checked=true;node.onclick()},isChecked:function(){return config.checked}}},refresh:function(master,node,config){node.onclick=function(){this.getElementsByTagName("input")[0].checked=config.checked=!config.checked;var column=master.getColumnConfig(config.columnId);var checked=config.checked?column.checkValue:column.uncheckValue;master.data.each(function(obj){if(obj){obj[config.columnId]=checked;master.callEvent("onCheck",[obj.id,config.columnId,checked]);this.callEvent("onStoreUpdated",[obj.id,obj,"save"])}});master.refresh()}},render:function(master,config){return"<input type='checkbox' "+(config.checked?"checked='1'":"")+">"}},textFilter:{getInputNode:function(node){return node.firstChild?node.firstChild.firstChild:{value:null}},getValue:function(node){return this.getInputNode(node).value},setValue:function(node,value){this.getInputNode(node).value=value},refresh:function(master,node,value){node.component=master._settings.id;master.registerFilter(node,value,this);node._comp_id=master._settings.id;if(value.value&&this.getValue(node)!=value.value)this.setValue(node,value.value);node.onclick=webix.html.preventEvent;webix._event(node,"keydown",this._on_key_down)},render:function(master,config){if(this.init)this.init(config);config.css="webix_ss_filter";return"<input "+(config.placeholder?'placeholder="'+config.placeholder+'" ':"")+"type='text'>"},_on_key_down:function(e,node,value){var id=this._comp_id;if((e.which||e.keyCode)==9)return;if(this._filter_timer)window.clearTimeout(this._filter_timer);this._filter_timer=window.setTimeout(function(){var ui=webix.$$(id);if(ui)ui.filterByAll()},webix.ui.datafilter.textWaitDelay)}},selectFilter:{getInputNode:function(node){return node.firstChild?node.firstChild.firstChild:{value:null}},getValue:function(node){return this.getInputNode(node).value},setValue:function(node,value){this.getInputNode(node).value=value},refresh:function(master,node,value){value.compare=value.compare||function(a,b){return a==b};node.component=master._settings.id;master.registerFilter(node,value,this);var data;var options=value.options;if(options){if(typeof options=="string"){data=value.options=[];webix.ajax(options).then(webix.bind(function(data){value.options=data.json();this.refresh(master,node,value)},this))}else data=options}else{data=master.collectValues(value.columnId);data.unshift({id:"",value:""})}var optview=webix.$$(options);if(optview&&optview.data&&optview.data.getRange){data=optview.data.getRange()}var select=document.createElement("select");for(var i=0;i<data.length;i++){var option=document.createElement("option");option.value=data[i].id;option.text=data[i].value;select.add(option)}node.firstChild.innerHTML="";node.firstChild.appendChild(select);if(value.value)this.setValue(node,value.value);node.onclick=webix.html.preventEvent;select._comp_id=master._settings.id;webix._event(select,"change",this._on_change)},render:function(master,config){if(this.init)this.init(config);config.css="webix_ss_filter";return""},_on_change:function(e,node,value){webix.$$(this._comp_id).filterByAll()}}};webix.ui.datafilter.serverFilter=webix.extend({$server:true,_on_key_down:function(e,node,value){var config,name,id=this._comp_id,code=e.which||e.keyCode;node=e.target||e.srcElement;if(code==9||code>=33&&code<=40)return;if(this._filter_timer)window.clearTimeout(this._filter_timer);this._filter_timer=window.setTimeout(function(){webix.$$(id).filterByAll()},webix.ui.datafilter.textWaitDelay)}},webix.ui.datafilter.textFilter);webix.ui.datafilter.serverSelectFilter=webix.extend({$server:true,_on_change:function(e,node,value){var id=this._comp_id;webix.$$(id).filterByAll()}},webix.ui.datafilter.selectFilter);webix.ui.datafilter.numberFilter=webix.extend({init:function(config){config.prepare=function(value,filter){var equality=value.indexOf("=")!=-1?1:0;var intvalue=this.format(value);if(intvalue==="")return"";if(value.indexOf(">")!=-1)config.compare=this._greater;else if(value.indexOf("<")!=-1){config.compare=this._lesser;equality*=-1}else{config.compare=this._equal;equality=0}return intvalue-equality}},format:function(value){return value.replace(/[^\-\.0-9]/g,"")},_greater:function(a,b){return a*1>b},_lesser:function(a,b){return a!==""&&a*1<b},_equal:function(a,b){return a*1==b}},webix.ui.datafilter.textFilter);webix.ui.datafilter.dateFilter=webix.extend({format:function(value){if(value==="")return"";var date=new Date;if(value.indexOf("today")!=-1){date=webix.Date.dayStart(date)}else if(value.indexOf("now")==-1){var parts=value.match(/[0-9]+/g);if(!parts||!parts.length)return"";if(parts.length<3){parts.reverse();date=new Date(parts[0],(parts[1]||1)-1,1)}else date=webix.i18n.dateFormatDate(value.replace(/^[>< =]+/,""))}return date.valueOf()}},webix.ui.datafilter.numberFilter);webix.extend(webix.ui.datatable,{filterByAll:function(){var server=false;this.data.silent(function(){this.filter();var first=false;for(var key in this._filter_elements){webix.assert(key,"empty column id for column with filtering");if(!this.isColumnVisible(key))continue;var record=this._filter_elements[key];var originvalue=record[2].getValue(record[0]);var inputvalue=originvalue;if(record[1].prepare)inputvalue=record[1].prepare.call(record[2],inputvalue,record[1],this);record[1].value=originvalue;var compare=record[1].compare;if(!this.callEvent("onBeforeFilter",[key,inputvalue,record[1]]))continue;if(record[2].$server||server){server=true}else{if(inputvalue==="")continue;if(compare){compare=this._multi_compare(key,compare);this.filter(webix.bind(function(obj,value){if(!obj)return false;return compare(obj[key],value,obj)},this),inputvalue,first)}else this.filter(key,inputvalue,first);first=true}}if(server)this._runServerFilter()},this);if(!server){this.refresh();this.callEvent("onAfterFilter",[])}},_multi_compare:function(key,compare){var column=this.getColumnConfig(key);var separator=column?column.optionslist:null;if(!separator)return compare;if(typeof separator!="string")separator=",";return function(itemValue,inputValue,obj){if(!itemValue)return true;var ids=itemValue.split(separator);for(var i=0;i<ids.length;i++){if(compare(ids[i],inputValue,obj))return true}}},filterMode_setter:function(mode){return webix.extend(this.data._filterMode,mode,true)},getFilter:function(columnId){var filter=this._filter_elements[columnId];webix.assert(filter,"Filter doesn't exists for column in question");if(filter&&filter[2].getInputNode)return filter[2].getInputNode(filter[0]);return null},registerFilter:function(node,config,obj){this._filter_elements[config.columnId]=[node,config,obj]},collectValues:function(id){var values=[];var checks={"":true};var obj=this.getColumnConfig(id);var options=obj.options||obj.collection;if(options){if(typeof options=="object"&&!options.loadNext){if(webix.isArray(options))for(var i=0;i<options.length;i++)values.push({id:options[i],value:options[i]});else for(var key in options)values.push({id:key,value:options[key]});return values}else{if(typeof options==="string")options=webix.$$(options);if(options.getBody)options=options.getBody();this._collectValues.call(options,"id","value",values,checks)}}else this._collectValues(obj.id,obj.id,values,checks);var obj={values:values};this.callEvent("onCollectValues",[id,obj]);return obj.values},_collectValues:function(id,value,values,checks){this.data.each(function(obj){var test=obj?obj[id]:"";if(test!==webix.undefined&&!checks[test]){checks[test]=true;values.push({id:obj[id],value:obj[value]})}},this,true);if(values.length){var type=typeof values[0].value==="string"?"string":"raw";values.sort(this.data.sorting.create({as:type,by:"value",dir:"asc"}))}},_runServerFilter:function(name){this.loadNext(0,0,{before:function(){if(this.editStop)this.editStop();this.clearAll(true)},success:function(){this.callEvent("onAfterFilter",[])}},0,1)}});webix.extend(webix.ui.datatable,{hover_setter:function(value){if(value&&!this._hover_initialized){this._enable_mouse_move();this.config.experimental=true;this.attachEvent("onMouseMoving",function(e){var row=this.locate(arguments[0]);row=row?row.row:null;if(this._last_hover!=row){if(this._last_hover)this.removeRowCss(this._last_hover,this._settings.hover);this._delayed_hover_set();this._last_hover=row}});this.attachEvent("onMouseOut",function(){if(this._last_hover){this.removeRowCss(this._last_hover,this._settings.hover);this._last_hover=null}});this._hover_initialized=1}return value},_delayed_hover_set:function(){webix.delay(function(){if(this._last_hover)this.addRowCss(this._last_hover,this._settings.hover)},this,[],5)},select_setter:function(value){if(!this.select&&value){webix.extend(this,this._selections._commonselect,true);if(value===true)value="row";else if(value=="multiselect"){value="row";this._settings.multiselect=true}webix.assert(this._selections[value],"Unknown selection mode: "+value);webix.extend(this,this._selections[value],true)}return value},getSelectedId:function(mode){return mode?[]:""},getSelectedItem:function(mode){return webix.SelectionModel.getSelectedItem.call(this,mode)},_selections:{_commonselect:{_select_css:" webix_cell_select",$init:function(){this._reinit_selection();this.on_click.webix_cell=webix.bind(this._click_before_select,this);this._data_cleared=this._data_filtered=function(){this.unselect()};this.data.attachEvent("onStoreUpdated",webix.bind(this._data_updated,this));this.data.attachEvent("onSyncApply",webix.bind(this._data_synced,this));this.data.attachEvent("onClearAll",webix.bind(this._data_cleared,this));this.data.attachEvent("onAfterFilter",webix.bind(this._data_filtered,this));this.data.attachEvent("onIdChange",webix.bind(this._id_changed,this));this.$ready.push(webix.SelectionModel._set_noselect)},_id_changed:function(oldid,newid){for(var i=0;i<this._selected_rows.length;i++)if(this._selected_rows[i]==oldid)this._selected_rows[i]=newid;for(var i=0;i<this._selected_areas.length;i++){var item=this._selected_areas[i];if(item.row==oldid){oldid=this._select_key(item);item.row=newid;newid=this._select_key(item);item.id=newid;delete this._selected_pull[oldid];this._selected_pull[newid]=true}}},_data_updated:function(id,obj,type){if(type=="delete")this.unselect(id)},_data_synced:function(){for(var i=this._selected_areas.length-1;i>=0;i--){if(!this.exists(this._selected_areas[i].row))this._selected_areas.splice(i,1)}},_reinit_selection:function(){this._selected_areas=[];this._selected_pull={};this._selected_rows=[]},isSelected:function(id,column){var key;if(!webix.isUndefined(column))key=this._select_key({row:id,column:column});else key=typeof id==="object"?this._select_key(id):id;return this._selected_pull[key]},getSelectedId:function(asArray,plain){var result;if(this._selected_areas.length>1||asArray){result=[].concat(this._selected_areas);if(plain)for(var i=0;i<result.length;i++)result[i]=result[i].id}else{result=this._selected_areas[0];if(plain&&result)return result.id}return result},_id_to_string:function(){return this.row},_select:function(data,preserve){var key=this._select_key(data);if(key===null)return;if(preserve===-1)return this._unselect(data);data.id=key;data.toString=this._id_to_string;if(!this.callEvent("onBeforeSelect",[data,preserve]))return false;if(this._selected_pull[key]&&(preserve||this._selected_areas.length==1))return;if(!preserve)this._clear_selection();this._selected_areas.push(data);this._selected_pull[key]=true;this.callEvent("onAfterSelect",[data,preserve]);this._finalize_select(this._post_select(data));return true},_clear_selection:function(){if(!this._selected_areas.length)return false;for(var i=0;i<this._selected_areas.length;i++){if(!this.callEvent("onBeforeUnSelect",[this._selected_areas[i]]))return false}for(var i=0;i<this._selected_rows.length;i++)this.data.removeMark(this._selected_rows[i],"webix_selected");var cols=this._settings.columns;if(cols)for(var i=0;i<cols.length;i++){cols[i].$selected=null}var data=this._selected_areas;this._reinit_selection();for(var i=0;i<data.length;i++){this.callEvent("onAfterUnSelect",[data[i]])}return true},unselectAll:function(){this.clearSelection()},selectAll:function(){this.selectRange()},clearSelection:function(){if(this._clear_selection()){this.callEvent("onSelectChange",[]);this.render()}},_unselect:function(data){var key=this._select_key(data);if(!key&&this._selected_areas.length){this.clearSelection();this.callEvent("onSelectChange",[])}if(!this._selected_pull[key])return;if(!this.callEvent("onBeforeUnSelect",[data]))return false;for(var i=0;i<this._selected_areas.length;i++){if(this._selected_areas[i].id==key){this._selected_areas.splice(i,1);break}}delete this._selected_pull[key];this.callEvent("onAfterUnSelect",[data]);this._finalize_select(0,this._post_unselect(data))},_add_item_select:function(id){var item=this.getItem(id);return this.data.addMark(item.id,"webix_selected",0,{$count:0},true)},_finalize_select:function(id){if(id)this._selected_rows.push(id);if(!this._silent_selection){this.render();this.callEvent("onSelectChange",[])}},_click_before_select:function(e,id){var preserve=e.ctrlKey||e.metaKey||this._settings.multiselect=="touch";var range=e.shiftKey;if(!this._settings.multiselect&&this._settings.select!="multiselect")preserve=range=false;if(range&&this._selected_areas.length){var last=this._selected_areas[this._selected_areas.length-1];this._selectRange(id,last)}else{if(preserve&&this._selected_pull[this._select_key(id)])this._unselect(id);else this._select({row:id.row,column:id.column},preserve)}},_mapSelection:function(callback,column,row){var cols=this._settings.columns;if(column){var temp=[];for(var i=0;i<cols.length;i++)if(cols[i].$selected)temp.push(cols[i]);cols=temp}var rows=this.data.order;var row_ind=0;for(var i=0;i<rows.length;i++){var item=this.getItem(rows[i]);if(!item)continue;var selection=this.data.getMark(item.id,"webix_selected");if(selection||column){var col_ind=0;for(var j=0;j<cols.length;j++){var id=cols[j].id;if(row||column||selection[id]){if(callback)item[id]=callback(item[id],rows[i],id,row_ind,col_ind);else return{row:rows[i],column:id};col_ind++}}row_ind++}}}},row:{_select_css:" webix_row_select",_select_key:function(data){return data.row},select:function(row_id,preserve){if(row_id)row_id=row_id.toString();webix.assert(this.data.exists(row_id),"Incorrect id in select command: "+row_id);this._select({row:row_id},preserve)},_post_select:function(data){this._add_item_select(data.row).$row=true;return data.row},unselect:function(row_id){this._unselect({row:row_id})},_post_unselect:function(data){this.data.removeMark(data.row,"webix_selected",0,1);return data.row},mapSelection:function(callback){return this._mapSelection(callback,false,true)},_selectRange:function(a,b){return this.selectRange(a.row,b.row)},selectRange:function(row_id,end_row_id,preserve){if(webix.isUndefined(preserve))preserve=true;var row_start_ind=row_id?this.getIndexById(row_id):0;var row_end_ind=end_row_id?this.getIndexById(end_row_id):this.data.order.length-1;if(row_start_ind>row_end_ind){var temp=row_start_ind;row_start_ind=row_end_ind;row_end_ind=temp}this._silent_selection=true;for(var i=row_start_ind;i<=row_end_ind;i++){var id=this.getIdByIndex(i);if(!id){if(row_id)this.select(row_id);break}this.select(id,preserve)}this._silent_selection=false;this._finalize_select()}},cell:{_select_key:function(data){if(!data.column)return null;return data.row+"_"+data.column},select:function(row_id,column_id,preserve){webix.assert(this.data.exists(row_id),"Incorrect id in select command: "+row_id);this._select({row:row_id,column:column_id},preserve)},_post_select:function(data){var sel=this._add_item_select(data.row);sel.$count++;sel[data.column]=true;return data.row},unselect:function(row_id,column_id){this._unselect({row:row_id,column:column_id})},_post_unselect:function(data){var sel=this._add_item_select(data.row);sel.$count--;sel[data.column]=false;if(sel.$count<=0)this.data.removeMark(data.row,"webix_selected");return data.row},mapSelection:function(callback){return this._mapSelection(callback,false,false)},_selectRange:function(a,b){return this.selectRange(a.row,a.column,b.row,b.column)},selectRange:function(row_id,column_id,end_row_id,end_column_id,preserve){if(webix.isUndefined(preserve))preserve=true;var row_start_ind=row_id?this.getIndexById(row_id):0;var row_end_ind=end_row_id?this.getIndexById(end_row_id):this.data.order.length-1;var col_start_ind=column_id?this.getColumnIndex(column_id):0;var col_end_ind=end_column_id?this.getColumnIndex(end_column_id):this._columns.length-1;if(row_start_ind>row_end_ind){var temp=row_start_ind;row_start_ind=row_end_ind;row_end_ind=temp}if(col_start_ind>col_end_ind){var temp=col_start_ind;col_start_ind=col_end_ind;col_end_ind=temp}this._silent_selection=true;for(var i=row_start_ind;i<=row_end_ind;i++)for(var j=col_start_ind;j<=col_end_ind;j++)this.select(this.getIdByIndex(i),this.columnId(j),preserve);this._silent_selection=false;this._finalize_select()}},column:{_select_css:" webix_column_select",_select_key:function(data){return data.column},_id_to_string:function(){return this.column},select:function(column_id,preserve){this._select({column:column_id},preserve)},_post_select:function(data){this._settings.columns[this.getColumnIndex(data.column)].$selected=true;if(!this._silent_selection)this._render_header_and_footer()},unselect:function(column_id){this._unselect({column:column_id})},_post_unselect:function(data){this._settings.columns[this.getColumnIndex(data.column)].$selected=null;this._render_header_and_footer()},mapSelection:function(callback){return this._mapSelection(callback,true,false)},_selectRange:function(a,b){return this.selectRange(a.column,b.column)},selectRange:function(column_id,end_column_id,preserve){if(webix.isUndefined(preserve))preserve=true;var column_start_ind=column_id?this.getColumnIndex(column_id):0;var column_end_ind=end_column_id?this.getColumnIndex(end_column_id):this._columns.length-1;if(column_start_ind>column_end_ind){var temp=column_start_ind;column_start_ind=column_end_ind;column_end_ind=temp}this._silent_selection=true;for(var i=column_start_ind;i<=column_end_ind;i++)this.select(this.columnId(i),preserve);this._silent_selection=false;this._render_header_and_footer();this._finalize_select()},_data_synced:function(){}},area:{_select_key:function(data){return data.row+"_"+data.column},getSelectedId:function(asArray){var area=this.getSelectArea();var result=[];if(area){if(asArray&&(area.start.row!=area.end.row||area.start.column!=area.end.column)){var row_start_ind=this.getIndexById(area.start.row);var row_end_ind=this.getIndexById(area.end.row);if(row_start_ind==-1||row_end_ind==-1)return result;var col_start_ind=this.getColumnIndex(area.start.column);var col_end_ind=this.getColumnIndex(area.end.column);for(var i=row_start_ind;i<=row_end_ind;i++)for(var j=col_start_ind;j<=col_end_ind;j++)result.push({row:this.getIdByIndex(i),column:this.columnId(j)})}else{result.push(area.end)}}return asArray?result:result[0]},unselect:function(row_id){this._unselect()},_unselect:function(){this.removeSelectArea();this.callEvent("onSelectChange",[])},mapSelection:function(callback){var select=this.getSelectArea();if(select){var sind=this.getColumnIndex(select.start.column);var eind=this.getColumnIndex(select.end.column);var srow=this.getIndexById(select.start.row);var erow=this.getIndexById(select.end.row);for(var i=srow;i<=erow;i++){var rid=this.data.order[i];var item=this.getItem(rid);for(var j=sind;j<=eind;j++){var cid=this._columns[j].id;if(callback)item[cid]=callback(item[cid]||"",rid,cid,i-srow,j-sind);else return{row:rid,column:cid}}}}},select:function(row_id,column_id,preserve){webix.assert(this.data.exists(row_id),"Incorrect id in select command: "+row_id);this._select({row:row_id,column:column_id},preserve)},_selectRange:function(id,last){this._extendAreaRange(id,last)},_select:function(cell,preserve){this.addSelectArea(cell,cell,false);return true},_data_synced:function(){if(this._selected_areas.length)this.refreshSelectArea()}}}});webix.extend(webix.ui.datatable,{blockselect_setter:function(value){if(value&&this._block_sel_flag){webix._event(this._viewobj,webix.env.mouse.move,this._bs_move,{bind:this});webix._event(this._viewobj,webix.env.mouse.down,this._bs_down,{bind:this});webix.event(document.body,webix.env.mouse.up,this._bs_up,{bind:this});this._block_sel_flag=this._bs_ready=this._bs_progress=false;this.attachEvent("onAfterScroll",function(){this._update_block_selection()});webix.extend(this,webix.AutoScroll,true);this.attachEvent("onBeforeAutoScroll",function(){return this._bs_progress})}return value},_block_sel_flag:true,_childOf:function(e,tag){var src=e.target||e.srcElement;while(src){if(src.getAttribute&&src.getAttribute("webixignore"))return false;if(src==tag)return true;src=src.parentNode}return false},_bs_down:function(e){if(this._settings.subview&&this!=webix.$$(e.target||e.srcElement))return;if(this._childOf(e,this._body)){if(e.target&&e.target.tagName=="INPUT"||this._rs_process)return;webix.html.addCss(document.body,"webix_noselect");this._bs_position=webix.html.offset(this._body);var pos=webix.html.pos(e);this._bs_ready=[pos.x-this._bs_position.x,pos.y-this._bs_position.y]}},_bs_up:function(e){if(this._block_panel){this._bs_select("select",true,e);this._block_panel=webix.html.remove(this._block_panel)}webix.html.removeCss(document.body,"webix_noselect");this._bs_ready=this._bs_progress=false;if(this._auto_scroll_delay)this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay)},_update_block_selection:function(){if(this._bs_progress)this._bs_select(false,false)},_bs_select:function(mode,theend,e){var start=null;if(!this._bs_ready[2])this._bs_ready[2]=this._locate_cell_xy.apply(this,this._bs_ready);start=this._bs_ready[2];var end=this._locate_cell_xy.apply(this,this._bs_progress);if(!this.callEvent("onBeforeBlockSelect",[start,end,theend,e]))return;if((!this._bs_do_select||this._bs_do_select(start,end,theend,e)!==false)&&(start.row&&end.row)){if(mode==="select"){this._clear_selection();this._selectRange(start,end)}else{var startx,starty,endx,endy;if(mode==="box"){startx=Math.min(this._bs_ready[0],this._bs_progress[0]);endx=Math.max(this._bs_ready[0],this._bs_progress[0]);starty=Math.min(this._bs_ready[1],this._bs_progress[1]);endy=Math.max(this._bs_ready[1],this._bs_progress[1])}else{var startn=this._cellPosition(start.row,start.column);var endn=this._cellPosition(end.row,end.column);var scroll=this.getScrollState();var startWidth=startn.width;var endWidth=endn.width;if(this._right_width&&this._bs_ready[0]>this._left_width+this._center_width){startn.left+=this._left_width+this._center_width}else if(this._left_width){if(this._bs_ready[0]>this._left_width){if(startn.left<scroll.x){startWidth-=scroll.x-startn.left;startn.left=this._left_width}else startn.left+=this._left_width-scroll.x}}else startn.left-=scroll.x;if(this._right_width&&this._bs_progress[0]>this._left_width+this._center_width){endn.left+=this._left_width+this._center_width}else if(this._left_width){if(this._bs_progress[0]>this._left_width){if(endn.left<scroll.x){endWidth-=scroll.x-endn.left;endn.left=this._left_width}else endn.left+=this._left_width-scroll.x}}else endn.left-=scroll.x;if(this._settings.prerender){startn.top-=this._scrollTop;endn.top-=this._scrollTop}startx=Math.min(startn.left,endn.left);endx=Math.max(startn.left+startWidth,endn.left+endWidth);starty=Math.min(startn.top,endn.top);endy=Math.max(startn.top+startn.height,endn.top+endn.height);if(this._settings.topSplit)starty+=this._getTopSplitOffset(start);if(this._auto_scroll_delay)this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay);if(e)this._auto_scroll_delay=webix.delay(this._auto_scroll,this,[webix.html.pos(e)],250)}var style=this._block_panel.style;style.left=startx+"px";style.top=starty+"px";style.width=endx-startx+"px";style.height=endy-starty+"px"}}if(theend)this.callEvent("onAfterBlockSelect",[start,end])},_bs_start:function(e){this._block_panel=webix.html.create("div",{class:"webix_block_selection"},"");this._body.appendChild(this._block_panel)},_bs_move:function(e){if(this._bs_ready!==false){var pos=webix.html.pos(e);var progress=[pos.x-this._bs_position.x,pos.y-this._bs_position.y];if(Math.abs(this._bs_ready[0]-progress[0])<5&&Math.abs(this._bs_ready[1]-progress[1])<5)return;if(this._bs_progress===false)this._bs_start(e);this._bs_progress=progress;this._bs_select(this.config.blockselect,false,e)}},_locate_cell_xy:function(x,y){var inTopSplit=false,row=null,column=null;if(this._right_width&&x>this._left_width+this._center_width)x+=this._x_scroll.getSize()-this._center_width-this._left_width-this._right_width;else if(!this._left_width||x>this._left_width)x+=this._x_scroll.getScroll();if(this._settings.topSplit&&this._render_scroll_top>this._settings.topSplit){var splitPos=this._cellPosition(this.getIdByIndex(this._settings.topSplit-1),this.columnId(0));if(splitPos.top+splitPos.height>y){inTopSplit=true}}if(!inTopSplit)y+=this.getScrollState().y;if(x<0)x=0;if(y<0)y=0;var cols=this._settings.columns;var rows=this.data.order;var summ=0;for(var i=0;i<cols.length;i++){summ+=cols[i].width;if(summ>=x){column=cols[i].id;break}}if(!column)column=cols[cols.length-1].id;summ=0;var start=this.data.$min||0;if(this._settings.fixedRowHeight){row=rows[start+Math.floor(y/this._settings.rowHeight)]}else for(var i=start;i<rows.length;i++){summ+=this._getHeightByIndex(i);if(summ>=y){row=rows[i];break}}if(!row)row=rows[rows.length-1];return{row:row,column:column}},_getTopSplitOffset:function(cell,area){var y=0,startIndex=this.getIndexById(cell.row);if(startIndex>=this._settings.topSplit){var startPos=this._cellPosition(this.getIdByIndex(startIndex),cell.column);var splitPos=this._cellPosition(this.getIdByIndex(this._settings.topSplit-1),cell.column);if(splitPos.top+splitPos.height-startPos.top>0){y=splitPos.top+splitPos.height-(startPos.top>0||!area?startPos.top:0)}}return y}});webix.protoUI({name:"resizearea",defaults:{dir:"x"},$init:function(config){var dir=config.dir||"x";var node=webix.toNode(config.container);var size=dir=="x"?"width":"height";var margin=config.margin?config.margin+"px":0;this._key_property=dir=="x"?"left":"top";this._viewobj=webix.html.create("DIV",{class:"webix_resize_area webix_dir_"+dir});webix._event(this._viewobj,webix.env.mouse.down,webix.html.stopEvent);if(margin){if(dir=="x")margin=margin+" 0 "+margin;else margin="0 "+margin+" 0 "+margin}this._dragobj=webix.html.create("DIV",{class:"webix_resize_handle_"+dir,style:margin?"padding:"+margin:""},"<div class='webix_handle_content'></div>");this._originobj=webix.html.create("DIV",{class:"webix_resize_origin_"+dir});if(config[size]){this._originobj.style[size]=config[size]+(config.border?1:0)+"px";this._dragobj.style[size]=config[size]+"px"}if(config.cursor)this._dragobj.style.cursor=this._originobj.style.cursor=this._viewobj.style.cursor=config.cursor;this._moveev=webix.event(node,webix.env.mouse.move,this._onmove,{bind:this});this._upev=webix.event(document.body,webix.env.mouse.up,this._onup,{bind:this});this._dragobj.style[this._key_property]=this._originobj.style[this._key_property]=config.start+"px";node.appendChild(this._viewobj);node.appendChild(this._dragobj);node.appendChild(this._originobj)},_onup:function(){this.callEvent("onResizeEnd",[this._last_result]);webix.eventRemove(this._moveev);webix.eventRemove(this._upev);webix.html.remove(this._viewobj);webix.html.remove(this._dragobj);webix.html.remove(this._originobj);this._viewobj=this._dragobj=this._originobj=null},_onmove:function(e){var pos=webix.html.pos(e);this._last_result=(this._settings.dir=="x"?pos.x:pos.y)+this._settings.start-this._settings.eventPos;this._dragobj.style[this._key_property]=this._last_result+"px";this.callEvent("onResize",[this._last_result])}},webix.EventSystem,webix.Settings);webix.extend(webix.ui.datatable,{resizeRow_setter:function(value){this._settings.scrollAlignY=false;this._settings.fixedRowHeight=false;return this.resizeColumn_setter(value)},resizeColumn_setter:function(value){if(value&&this._rs_init_flag){webix._event(this._viewobj,"mousemove",this._rs_move,{bind:this});webix._event(this._viewobj,"mousedown",this._rs_down,{bind:this});webix._event(this._viewobj,"mouseup",this._rs_up,{bind:this});this._rs_init_flag=false}return value},_rs_init_flag:true,_rs_down:function(e){if(this._settings.subview&&this!=webix.$$(e.target||e.srcElement))return;if(!this._rs_ready)return;this._rs_process=[webix.html.pos(e),this._rs_ready[2]];webix.html.addCss(document.body,"webix_noselect");webix.html.denySelect()},_rs_up:function(){this._rs_process=false;webix.html.removeCss(document.body,"webix_noselect");webix.html.allowSelect()},_rs_start:function(e){e=e||event;if(this._rs_progress)return;var dir=this._rs_ready[0];var node=this._rs_process[1];var obj=this._locate(node);if(!obj)return;var eventPos=this._rs_process[0];var start;if(dir=="x"){start=webix.html.offset(node).x+this._rs_ready[1]-webix.html.offset(this._body).x;eventPos=eventPos.x;if(!this._rs_ready[1])obj.cind-=node.parentNode.colSpan||1}else{start=webix.html.offset(node).y+this._rs_ready[1]-webix.html.offset(this._body).y+this._header_height;eventPos=eventPos.y;if(!this._rs_ready[1])obj.rind--}if(obj.cind>=0&&obj.rind>=0){this._rs_progress=[dir,obj,start];var resize=new webix.ui.resizearea({container:this._viewobj,dir:dir,eventPos:eventPos,start:start,cursor:(dir=="x"?"col":"row")+"-resize"});resize.attachEvent("onResizeEnd",webix.bind(this._rs_end,this))}this._rs_down=this._rs_ready=false},_rs_end:function(result){if(this._rs_progress){var dir=this._rs_progress[0];var obj=this._rs_progress[1];var newsize=result-this._rs_progress[2];if(dir=="x"){if(this._settings.rightSplit&&obj.cind+1>=this._rightSplit&&obj.cind!==this._columns.length-1){obj.cind++;newsize*=-1}var column=this._columns[obj.cind];var oldwidth=column.width;delete column.fillspace;delete column.adjust;this._setColumnWidth(obj.cind,oldwidth+newsize,true,true);this._updateColsSizeSettings()}else{var rid=this.getIdByIndex(obj.rind);var oldheight=this._getRowHeight(this.getItem(rid));this.setRowHeight(rid,oldheight+newsize)}this._rs_up()}this._rs_progress=null},_rs_move:function(e){var cell=null,config=this._settings;if(this._rs_ready&&this._rs_process)return this._rs_start(e);e=e||event;var node=e.target||e.srcElement;var mode=false;if(node.tagName=="TD"||node.tagName=="TABLE")return;var element_class=node.className||"";var in_body=typeof element_class==="string"&&element_class.indexOf("webix_cell")!=-1;if(in_body&&config.drag)return;var in_header=typeof element_class==="string"&&element_class.indexOf("webix_hcell")!=-1;this._rs_ready=false;if(in_body||in_header){var dx=node.offsetWidth;var dy=node.offsetHeight;var pos=webix.html.posRelative(e);var resizeRow=config.resizeRow;if(typeof resizeRow=="object"&&resizeRow.headerOnly){cell=this._locate(node);if(cell.cind>0)resizeRow=false}if(in_body&&resizeRow){resizeRow=typeof resizeRow=="object"&&resizeRow.size?resizeRow.size:3;if(pos.y<resizeRow){if(!cell)cell=this._locate(node);if(cell.rind){this._rs_ready=["y",0,node];mode="row-resize"}}else if(dy-pos.y<resizeRow+1){this._rs_ready=["y",dy,node];mode="row-resize"}}var resizeColumn=config.resizeColumn;if(typeof resizeColumn=="object"&&resizeColumn.headerOnly&&in_body)resizeColumn=false;if(resizeColumn){resizeColumn=typeof resizeColumn=="object"&&resizeColumn.size?resizeColumn.size:3;if(pos.x<resizeColumn){this._rs_ready=["x",0,node];mode="col-resize"}else if(dx-pos.x<resizeColumn+1){this._rs_ready=["x",dx,node];mode="col-resize"}}}if(this._cursor_timer)window.clearTimeout(this._cursor_timer);this._cursor_timer=webix.delay(this._mark_resize_ready,this,[mode],mode?100:0)},_mark_resize_ready:function(mode){if(this._last_cursor_mode!=mode){this._last_cursor_mode=mode;this._viewobj.style.cursor=mode||"default"}}});webix.extend(webix.ui.datatable,webix.PagingAbility);webix.csv={escape:true,delimiter:{rows:"\n",cols:"\t"},parse:function(text,sep){sep=sep||this.delimiter;if(!this.escape)return this._split_clip_data(text,sep);var lines=text.replace(/\n$/,"").split(sep.rows);var i=0;while(i<lines.length-1){if(this._substr_count(lines[i],'"')%2===1){lines[i]+=sep.rows+lines[i+1];delete lines[i+1];i++}i++}var csv=[];for(i=0;i<lines.length;i++){if(typeof lines[i]!=="undefined"){var line=lines[i].split(sep.cols);for(var j=0;j<line.length;j++){if(line[j].indexOf('"')===0)line[j]=line[j].substr(1,line[j].length-2);line[j]=line[j].replace('""','"')}csv.push(line)}}return csv},_split_clip_data:function(text,sep){var lines=text.split(sep.rows);for(var i=0;i<lines.length;i++){lines[i]=lines[i].split(sep.cols)}return lines},_substr_count:function(string,substring){var arr=string.split(substring);return arr.length-1},stringify:function(data,sep){sep=sep||this.delimiter;if(!this.escape){for(var i=0;i<data.length;i++)data[i]=data[i].join(sep.cols);return data.join(sep.rows)}var reg=/\n|\"|;|,/;for(var i=0;i<data.length;i++){for(var j=0;j<data[i].length;j++){if(reg.test(data[i][j])){data[i][j]=data[i][j].replace(/"/g,'""');data[i][j]='"'+data[i][j]+'"'}}data[i]=data[i].join(sep.cols)}data=data.join(sep.rows);return data}};webix.TablePaste={clipboard_setter:function(value){if(value===true||value===1)this._settings.clipboard="block";webix.clipbuffer.init();this.attachEvent("onSelectChange",this._sel_to_clip);this.attachEvent("onItemClick",function(id,e,node){if(document.activeElement&&this.$view.contains(document.activeElement)){webix.clipbuffer.focus();webix.UIManager.setFocus(this)}});this.attachEvent("onPaste",this._clip_to_sel);return value},templateCopy_setter:webix.template,_sel_to_clip:function(){if(!this.getEditor||!this.getEditor()){var data=this._get_sel_text();webix.clipbuffer.set(data);webix.UIManager.setFocus(this)}},_get_sel_text:function(){var data=[];var filter=this._settings.templateCopy;this.mapSelection(function(value,row,col,row_ind,col_ind){if(!data[row_ind])data[row_ind]=[];var newvalue=filter?filter(value,row,col):value;data[row_ind].push(newvalue);return value});return webix.csv.stringify(data,this._settings.delimiter)},_clip_to_sel:function(text){if(!webix.isUndefined(this._paste[this._settings.clipboard])){var data=webix.csv.parse(text,this._settings.delimiter);this._paste[this._settings.clipboard].call(this,data)}},_paste:{block:function(data){var leftTop=this.mapSelection(null);if(!leftTop)return;this.mapCells(leftTop.row,leftTop.column,data.length,null,function(value,row,col,row_ind,col_ind){if(data[row_ind]&&data[row_ind].length>col_ind){return data[row_ind][col_ind]}return value});this.render()},selection:function(data){this.mapSelection(function(value,row,col,row_ind,col_ind){if(data[row_ind]&&data[row_ind].length>col_ind)return data[row_ind][col_ind];return value});this.render()},repeat:function(data){this.mapSelection(function(value,row,col,row_ind,col_ind){row=data[row_ind%data.length];value=row[col_ind%row.length];return value});this.render()},custom:function(text){}}};webix.extend(webix.ui.datatable,webix.TablePaste);if(!webix.storage)webix.storage={};webix.storage.local={put:function(name,data){if(name&&window.JSON&&window.localStorage){window.localStorage.setItem(name,webix.stringify(data))}},get:function(name){if(name&&window.JSON&&window.localStorage){var json=window.localStorage.getItem(name);if(!json)return null;return webix.DataDriver.json.toObject(json)}else return null},remove:function(name){if(name&&window.JSON&&window.localStorage){window.localStorage.removeItem(name)}},clear:function(){window.localStorage.clear()}};webix.storage.session={put:function(name,data){if(name&&window.JSON&&window.sessionStorage){window.sessionStorage.setItem(name,webix.stringify(data))}},get:function(name){if(name&&window.JSON&&window.sessionStorage){var json=window.sessionStorage.getItem(name);if(!json)return null;return webix.DataDriver.json.toObject(json)}else return null},remove:function(name){if(name&&window.JSON&&window.sessionStorage){window.sessionStorage.removeItem(name)}},clear:function(){window.sessionStorage.clear()}};webix.storage.cookie={put:function(name,data,domain,expires){if(name&&window.JSON){document.cookie=name+"="+escape(webix.stringify(data))+(expires&&expires instanceof Date?";expires="+expires.toUTCString():"")+(domain?";domain="+domain:"")+(webix.env.https?";secure":"")}},getRaw:function(check_name){var a_all_cookies=document.cookie.split(";");var a_temp_cookie="";var cookie_name="";var cookie_value="";var b_cookie_found=false;for(var i=0;i<a_all_cookies.length;i++){a_temp_cookie=a_all_cookies[i].split("=");cookie_name=a_temp_cookie[0].replace(/^\s+|\s+$/g,"");if(cookie_name==check_name){b_cookie_found=true;if(a_temp_cookie.length>1){cookie_value=unescape(a_temp_cookie[1].replace(/^\s+|\s+$/g,""))}return cookie_value}a_temp_cookie=null;cookie_name=""}if(!b_cookie_found){return null}return null},get:function(name){if(name&&window.JSON){var json=this.getRaw(name);if(!json)return null;return webix.DataDriver.json.toObject(unescape(json))}else return null},remove:function(name,domain){if(name&&this.getRaw(name))document.cookie=name+"="+(domain?";domain="+domain:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"},clear:function(domain){var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++)document.cookie=/^[^=]+/.exec(cookies[i])[0]+"="+(domain?";domain="+domain:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}};webix.DataState={getState:function(){var cols_n=this.config.columns.length;var columns=this.config.columns;var settings={ids:[],size:[],select:this.getSelectedId(true),scroll:this.getScrollState()};for(var i=0;i<cols_n;i++){var col=columns[i];settings.ids.push(col.id);settings.size.push(col.fillspace||col.adjust?-1:col.width)}settings.order=[].concat(this._hidden_column_order.length?this._hidden_column_order:settings.ids);if(this._last_sorted){settings.sort={id:this._last_sorted,dir:this._last_order}}if(this._filter_elements&&this._dtable_fully_ready){var filter={};var any_filter=0;for(var key in this._filter_elements){if(this._hidden_column_hash[key])continue;var f=this._filter_elements[key];f[1].value=filter[key]=f[2].getValue(f[0]);any_filter=1}if(any_filter)settings.filter=filter}settings.hidden=[];for(var key in this._hidden_column_hash)settings.hidden.push(key);return settings},setState:function(obj){var columns=this.config.columns;if(!obj)return;this._last_sorted=null;this.blockEvent();if(obj.hidden){var hihash={};for(var i=0;i<obj.hidden.length;i++){hihash[obj.hidden[i]]=true;if(!this._hidden_column_order.length)this.hideColumn(obj.hidden[i])}if(this._hidden_column_order.length){for(var i=0;i<this._hidden_column_order.length;i++){var hikey=this._hidden_column_order[i];if(!!hihash[hikey]==!this._hidden_column_hash[hikey])this.hideColumn(hikey,!!hihash[hikey])}}}if(obj.ids){var reorder=false;var cols=this.config.columns;for(var i=0;i<cols.length;i++)if(cols[i].id!=obj.ids[i])reorder=true;if(reorder){for(var i=0;i<obj.ids.length;i++)cols[i]=this.getColumnConfig(obj.ids[i])||cols[i];this.refreshColumns()}}if(obj.size){var cols_n=Math.min(obj.size.length,columns.length);for(var i=0;i<cols_n;i++){var col=columns[i];if(col&&obj.size[i]>0&&col.width!=obj.size[i]){delete col.fillspace;delete col.adjust;this._setColumnWidth(i,obj.size[i],true)}}}this.unblockEvent();var silent=!(this._settings.leftSplit||this._settings.rightSplit);this._updateColsSizeSettings(silent);this.callEvent("onStructureUpdate",[]);if(obj.sort){var column=columns[this.getColumnIndex(obj.sort.id)];if(column)this._sort(obj.sort.id,obj.sort.dir,column.sort)}if(obj.filter){var temp=this.filterByAll;this.filterByAll=function(){};for(var key in obj.filter){var value=obj.filter[key];if(!value)continue;if(!this._filter_elements[key])continue;var f=this._filter_elements[key];f[2].setValue(f[0],value);var contentid=f[1].contentId;if(contentid)this._active_headers[contentid].value=value}for(var key in this._filter_elements){if(!obj.filter[key]){var f=this._filter_elements[key];f[2].setValue(f[0],"")}}this.filterByAll=temp;this.filterByAll()}if(obj.select&&this.select){var select=obj.select;this.unselect();for(var i=0;i<select.length;i++)if(!select[i].row||this.exists(select[i].row))this._select(select[i],true)}if(obj.scroll)this.scrollTo(obj.scroll.x,obj.scroll.y)}};webix.extend(webix.ui.datatable,webix.DataState);(function(){var t=webix.Touch={config:{longTouchDelay:1e3,scrollDelay:150,gravity:500,deltaStep:30,speed:"0ms",finish:1500,ellastic:true},limit:function(value){t._limited=value!==false},disable:function(){t._disabled=true},enable:function(){t._disabled=false},$init:function(){t.$init=function(){};webix.event(document.body,mouse.down,t._touchstart);webix.event(document.body,mouse.move,t._touchmove);webix.event(document.body,mouse.up,t._touchend);webix.event(document.body,"dragstart",function(e){return webix.html.preventEvent(e)});webix.event(document.body,"touchstart",function(e){if(t._disabled||t._limited)return;if(webix.env.isSafari){var tag=e.srcElement.tagName.toLowerCase();if(tag=="input"||tag=="textarea"||tag=="select"||tag=="label")return true;t._fire_fast_event=true;return webix.html.preventEvent(e)}});t._clear_artefacts();t._scroll=[null,null];t.$active=true},_clear_artefacts:function(){t._start_context=t._current_context=t._prev_context=t._scroll_context=null;t._scroll_mode=t._scroll_node=t._scroll_stat=this._long_touched=null;t._delta={_x_moment:0,_y_moment:0,_time:0};if(t._css_button_remove){webix.html.removeCss(t._css_button_remove,"webix_touch");t._css_button_remove=null}window.clearTimeout(t._long_touch_timer);t._was_not_moved=true;t._axis_x=true;t._axis_y=true;if(!t._active_transion)t._scroll_end()},_touchend:function(e){if(t._start_context){if(!t._scroll_mode){if(!this._long_touched){if(t._axis_y&&!t._axis_x){t._translate_event("onSwipeX")}else if(t._axis_x&&!t._axis_y){t._translate_event("onSwipeY")}else{if(webix.env.isSafari&&t._fire_fast_event){t._fire_fast_event=false;var target=t._start_context.target;webix.delay(function(){var click_event=document.createEvent("MouseEvents");click_event.initEvent("click",true,true);target.dispatchEvent(click_event)})}}}}else{var temp=t._get_matrix(t._scroll_node);var x=temp.e;var y=temp.f;var finish=t.config.finish;var delta=t._get_delta(e,true);var view=webix.$$(t._scroll_node);var gravity=view&&view.$scroll?view.$scroll.gravity:t.config.gravity;if(delta._time){var nx=x+gravity*delta._x_moment/delta._time;var ny=y+gravity*delta._y_moment/delta._time;var cnx=t._scroll[0]?t._correct_minmax(nx,false,false,t._scroll_stat.dx,t._scroll_stat.px):x;var cny=t._scroll[1]?t._correct_minmax(ny,false,false,t._scroll_stat.dy,t._scroll_stat.py):y;var size=Math.max(Math.abs(cnx-x),Math.abs(cny-y));if(size<150)finish=finish*size/150;if(cnx!=x||cny!=y)finish=Math.round(finish*Math.max((cnx-x)/(nx-x),(cny-y)/(ny-y)));var result={e:cnx,f:cny};var view=webix.$$(t._scroll_node);if(view&&view.adjustScroll)view.adjustScroll(result);finish=Math.max(100,finish);if(x!=result.e||y!=result.f){t._set_matrix(t._scroll_node,result.e,result.f,finish+"ms");if(t._scroll_master)t._scroll_master._sync_scroll(result.e,result.f,finish+"ms");t._set_scroll(result.e,result.f,finish+"ms")}else{t._scroll_end()}}else t._scroll_end()}t._translate_event("onTouchEnd");t._clear_artefacts()}},_touchmove:function(e){if(!t._scroll_context||!t._start_context)return;var delta=t._get_delta(e);t._translate_event("onTouchMove");if(t._scroll_mode){t._set_scroll_pos(delta)}else{t._axis_x=t._axis_check(delta._x,"x",t._axis_x);t._axis_y=t._axis_check(delta._y,"y",t._axis_y);if(t._scroll_mode){var view=t._get_event_view("onBeforeScroll",true);if(view){var data={};view.callEvent("onBeforeScroll",[data]);if(data.update){t.config.speed=data.speed;t.config.scale=data.scale}}t._init_scroller(delta)}}return webix.html.preventEvent(e)},_set_scroll_pos:function(){if(!t._scroll_node)return;var temp=t._get_matrix(t._scroll_node);var be=temp.e,bf=temp.f;var prev=t._prev_context||t._start_context;var view=webix.$$(t._scroll_node);var ellastic=view&&view.$scroll?view.$scroll.ellastic:t.config.ellastic;if(t._scroll[0])temp.e=t._correct_minmax(temp.e-prev.x+t._current_context.x,ellastic,temp.e,t._scroll_stat.dx,t._scroll_stat.px);if(t._scroll[1])temp.f=t._correct_minmax(temp.f-prev.y+t._current_context.y,ellastic,temp.f,t._scroll_stat.dy,t._scroll_stat.py);t._set_matrix(t._scroll_node,temp.e,temp.f,"0ms");if(t._scroll_master)t._scroll_master._sync_scroll(temp.e,temp.f,"0ms");t._set_scroll(temp.e,temp.f,"0ms")},_set_scroll:function(dx,dy,speed){var edx=t._scroll_stat.px/t._scroll_stat.dx*-dx;var edy=t._scroll_stat.py/t._scroll_stat.dy*-dy;if(t._scroll[0])t._set_matrix(t._scroll[0],edx,0,speed);if(t._scroll[1])t._set_matrix(t._scroll[1],0,edy,speed)},scrollTo:function(node,x,y,speed){t._set_matrix(node,x,y,speed)},_set_matrix:function(node,xv,yv,speed){if(!t._in_anim_frame&&window.setAnimationFrame){window.setAnimationFrame(function(){t._in_anim_frame=true;return t._set_matrix(node,xv,yv,speed)})}t._in_anim_frame=null;t._active_transion=true;if(node){var trans=t.config.translate||webix.env.translate;node.style[webix.env.transform]=trans+"("+Math.round(xv)+"px, "+Math.round(yv)+"px"+(trans=="translate3d"?", 0":"")+")";node.style[webix.env.transitionDuration]=speed}},_get_matrix:function(node){var matrix=window.getComputedStyle(node)[webix.env.transform];var tmatrix;if(matrix=="none")tmatrix={e:0,f:0};else{if(window.WebKitCSSMatrix)tmatrix=new WebKitCSSMatrix(matrix);else if(window.MSCSSMatrix)tmatrix=new MSCSSMatrix(matrix);else{var _tmatrix=matrix.replace(/(matrix\()(.*)(\))/gi,"$2");_tmatrix=_tmatrix.replace(/\s/gi,"");_tmatrix=_tmatrix.split(",");var tmatrix={};var tkey=["a","b","c","d","e","f"];for(var i=0;i<tkey.length;i++){tmatrix[tkey[i]]=parseInt(_tmatrix[i],10)}}}if(t._scroll_master)t._scroll_master._sync_pos(tmatrix);return tmatrix},_correct_minmax:function(value,allow,current,dx,px){if(value===current)return value;var delta=Math.abs(value-current);var sign=delta/(value-current);if(value>0)return allow?current+sign*Math.sqrt(delta):0;var max=dx-px;if(max+value<0)return allow?current-Math.sqrt(-(value-current)):-max;return value},_init_scroll_node:function(node){if(!node.scroll_enabled){node.scroll_enabled=true;node.parentNode.style.position="relative";var prefix=webix.env.cssPrefix;node.style.cssText+=prefix+"transition: "+prefix+"transform; "+prefix+"user-select:none; "+prefix+"transform-style:flat;";node.addEventListener(webix.env.transitionEnd,t._scroll_end,false)}},_init_scroller:function(delta){if(t._scroll_mode.indexOf("x")!=-1)t._scroll[0]=t._create_scroll("x",t._scroll_stat.dx,t._scroll_stat.px,"width");if(t._scroll_mode.indexOf("y")!=-1)t._scroll[1]=t._create_scroll("y",t._scroll_stat.dy,t._scroll_stat.py,"height");t._init_scroll_node(t._scroll_node);window.setTimeout(t._set_scroll_pos,1)},_create_scroll:function(mode,dy,py,dim){if(dy-py<2){var matrix=t._get_matrix(t._scroll_node);var e=mode=="y"?matrix.e:0;var f=mode=="y"?0:matrix.f;if(!t._scroll_master)t._set_matrix(t._scroll_node,e,f,"0ms");t._scroll_mode=t._scroll_mode.replace(mode,"");return""}var scroll=webix.html.create("DIV",{class:"webix_scroll_"+mode},"");scroll.style[dim]=Math.max(py*py/dy-7,10)+"px";if(t._scroll_stat.left)if(mode==="x")scroll.style.left=t._scroll_stat.left+"px";else scroll.style.right=-t._scroll_stat.left+"px";if(t._scroll_stat.hidden)scroll.style.visibility="hidden";t._scroll_node.parentNode.appendChild(scroll);return scroll},_axis_check:function(value,mode,old){if(value>t.config.deltaStep){if(t._was_not_moved){t._long_move(mode);t._locate(mode);if((t._scroll_mode||"").indexOf(mode)==-1)t._scroll_mode=""}return false}return old},_scroll_end:function(){var result,state,view;view=webix.$$(t._scroll_node||this);if(view){if(t._scroll_node)result=t._get_matrix(t._scroll_node);else if(view.getScrollState){state=view.getScrollState();result={e:state.x,f:state.y}}webix.callEvent("onAfterScroll",[result]);if(view.callEvent)view.callEvent("onAfterScroll",[result])}if(!t._scroll_mode){webix.html.remove(t._scroll);t._scroll=[null,null]}t._active_transion=false},_long_move:function(mode){window.clearTimeout(t._long_touch_timer);t._was_not_moved=false},_stop_old_scroll:function(e){if(t._scroll[0]||t._scroll[1]){t._stop_scroll(e,t._scroll[0]?"x":"y")}else return true},_touchstart:function(e){var target=e.target||event.srcElement;if(t._disabled||target.tagName&&target.tagName.toLowerCase()=="textarea"&&target.offsetHeight<target.scrollHeight)return;t._long_touched=null;t._scroll_context=t._start_context=mouse.context(e);var element=webix.$$(e);if(t._limited&&!t._is_scroll()&&!(element&&element.$touchCapture)){t._scroll_context=null}t._translate_event("onTouchStart");if(t._stop_old_scroll(e))t._long_touch_timer=window.setTimeout(t._long_touch,t.config.longTouchDelay);if(element&&element.touchable&&(!target.className||target.className.indexOf("webix_view")!==0)){t._css_button_remove=element.getNode(e);webix.html.addCss(t._css_button_remove,"webix_touch")}},_long_touch:function(e){if(t._start_context){t._translate_event("onLongTouch");webix.callEvent("onClick",[t._start_context]);t._long_touched=true}},_stop_scroll:function(e,stop_mode){t._locate(stop_mode);var scroll=t._scroll[0]||t._scroll[1];if(scroll){var view=t._get_event_view("onBeforeScroll",true);if(view)view.callEvent("onBeforeScroll",[t._start_context,t._current_context])}if(scroll&&(!t._scroll_node||scroll.parentNode!=t._scroll_node.parentNode)){t._clear_artefacts();t._scroll_end();t._start_context=mouse.context(e)}t._touchmove(e)},_get_delta:function(e,ch){t._prev_context=t._current_context;t._current_context=mouse.context(e);t._delta._x=Math.abs(t._start_context.x-t._current_context.x);t._delta._y=Math.abs(t._start_context.y-t._current_context.y);if(t._prev_context){if(t._current_context.time-t._prev_context.time<t.config.scrollDelay){t._delta._x_moment=t._delta._x_moment/1.3+t._current_context.x-t._prev_context.x;t._delta._y_moment=t._delta._y_moment/1.3+t._current_context.y-t._prev_context.y}else{t._delta._y_moment=t._delta._x_moment=0}t._delta._time=t._delta._time/1.3+(t._current_context.time-t._prev_context.time)}return t._delta},_get_sizes:function(node){t._scroll_stat={dx:node.offsetWidth,dy:node.offsetHeight,px:node.parentNode.offsetWidth,py:node.parentNode.offsetHeight}},_is_scroll:function(locate_mode){var node=t._start_context.target;if(!webix.env.touch&&!webix.env.transition&&!webix.env.transform)return null;while(node&&node.tagName!="BODY"){if(node.getAttribute){var mode=node.getAttribute("touch_scroll");if(mode&&(!locate_mode||mode.indexOf(locate_mode)!=-1))return[node,mode]}node=node.parentNode}return null},_locate:function(locate_mode){var state=this._is_scroll(locate_mode);if(state){t._scroll_mode=state[1];t._scroll_node=state[0];t._get_sizes(state[0])}return state},_translate_event:function(name){webix.callEvent(name,[t._start_context,t._current_context]);var view=t._get_event_view(name);if(view)view.callEvent(name,[t._start_context,t._current_context])},_get_event_view:function(name,active){var view=webix.$$(active?t._scroll_node:t._start_context);if(!view)return null;while(view){if(view.hasEvent&&view.hasEvent(name))return view;view=view.getParentView()}return null},_get_context:function(e){if(!e.touches[0]){var temp=t._current_context;temp.time=new Date;return temp}return{target:e.target,x:e.touches[0].pageX,y:e.touches[0].pageY,time:new Date}},_get_context_m:function(e){return{target:e.target||e.srcElement,x:e.pageX,y:e.pageY,time:new Date}}};function touchInit(){if(webix.env.touch){t.$init();if(document.body.className.indexOf("webix_full_screen")==-1)t.limit(true);if(window.MSCSSMatrix)webix.html.addStyle(".webix_view{ -ms-touch-action: none; }")}else{var id=webix.event(document.body,"touchstart",function(ev){if(ev.touches.length&&ev.touches[0].radiusX>4){webix.env.touch=true;setMouse(mouse);touchInit();for(var key in webix.ui.views){var view=webix.ui.views[key];if(view&&view.$touch)view.$touch()}}webix.eventRemove(id)},{capture:true})}}function setMouse(mouse){mouse.down="touchstart";mouse.move="touchmove";mouse.up="touchend";mouse.context=t._get_context}webix.ready(touchInit);var mouse=webix.env.mouse={down:"mousedown",up:"mouseup",move:"mousemove",context:t._get_context_m};if(window.navigator.pointerEnabled){mouse.down="pointerdown";mouse.move="pointermove";mouse.up="pointerup"}else if(window.navigator.msPointerEnabled){mouse.down="MSPointerDown";mouse.move="MSPointerMove";mouse.up="MSPointerUp"}else if(webix.env.touch)setMouse(mouse)})();webix.attachEvent("onDataTable",function(table,config){if(webix.env.touch){webix.Touch.$init();config.scrollSize=0;if(webix.Touch._disabled)webix.Touch.limit();table.$ready.push(table.$touch)}});webix.extend(webix.ui.datatable,{$touch:function(){var config=this._settings;config.scrollAlignY=false;webix.extend(this,config.prerender===true?this._touchNative:this._touch);var scrollMode="";if(!config.autowidth&&config.scrollX!==false)scrollMode+="x";if(!config.autoheight&&config.scrollY!==false)scrollMode+="y";this._body.setAttribute("touch_scroll",scrollMode);webix.Touch._init_scroll_node(this._body.childNodes[1].firstChild);webix.Touch._set_matrix(this._body.childNodes[1].firstChild,0,0,"0ms");this._sync_scroll(0,0,"0ms")},_touchNative:{_scrollTo_touch:function(x,y){webix.Touch._set_matrix(this._body.childNodes[1].firstChild,0,0,"0ms");this._sync_scroll(x,y,"0ms")},_getScrollState_touch:function(){var temp=webix.Touch._get_matrix(this._body.childNodes[1].firstChild);return{x:-temp.e,y:-temp.f}},$init:function(){this.attachEvent("onBeforeScroll",function(){webix.Touch._scroll_node=this._body.childNodes[1].firstChild;webix.Touch._get_sizes(webix.Touch._scroll_node);webix.Touch._scroll_master=this});this.attachEvent("onTouchEnd",function(){webix.Touch._scroll_master=null})},_sync_scroll:function(x,y,t){if(this._settings.leftSplit)webix.Touch._set_matrix(this._body.childNodes[0].firstChild,0,y,t);if(this._settings.rightSplit)webix.Touch._set_matrix(this._body.childNodes[2].firstChild,0,y,t);if(this._settings.header)webix.Touch._set_matrix(this._header.childNodes[1].firstChild,x,0,t);if(this._settings.footer)webix.Touch._set_matrix(this._footer.childNodes[1].firstChild,x,0,t);this.callEvent("onSyncScroll",[x,y,t])},_sync_pos:function(){}},_touch:{_scrollTo_touch:function(x,y){webix.delay(function(){this.callEvent("onAfterScroll",[{e:-x,f:-y}])},this)},$scroll:{gravity:0,elastic:false},$init:function(){this.attachEvent("onAfterColumnHide",function(){this._scrollTo_touch(0,0)});this.attachEvent("onBeforeScroll",function(){var t=webix.Touch;t._scroll_node=this._body.childNodes[1].firstChild;t._get_sizes(t._scroll_node);t._scroll_stat.left=this._scrollLeft;t._scroll_stat.hidden=this._x_scroll._settings.scrollVisible||this._y_scroll._settings.scrollVisible;t._scroll_stat.dy=this._dtable_height;t._scroll_master=this});this.attachEvent("onAfterScroll",function(result){if(!result)return;var isScrollX=this._scrollLeft!=-result.e;var isScrollY=this._scrollTop!=-result.f;webix.Touch._scroll_master=null;webix.Touch._fix_f=null;this._scrollTop=0;this._scrollLeft=0;var temp=webix.Touch.config.translate;webix.Touch.config.translate="translate";this._sync_scroll(this._x_scroll?0:result.e,0,"0ms");webix.Touch.config.translate=temp;this._scrollLeft=-result.e;this._scrollTop=-result.f;this._correctScrollSize();this.render();if(isScrollX){if(this._x_scroll)this._x_scroll.scrollTo(this._scrollLeft);this.callEvent("onScrollX",[])}if(isScrollY){if(this._y_scroll)this._y_scroll.scrollTo(this._scrollTop);this.callEvent("onScrollY",[])}return false})},_sync_scroll:function(x,y,t){y+=this._scrollTop;x+=this._scrollLeft;webix.Touch._set_matrix(this._body.childNodes[1].firstChild,x,y,t);if(this._settings.leftSplit)webix.Touch._set_matrix(this._body.childNodes[0].firstChild,0,y,t);if(this._settings.rightSplit)webix.Touch._set_matrix(this._body.childNodes[2].firstChild,0,y,t);if(this._settings.header)webix.Touch._set_matrix(this._header.childNodes[1].firstChild,x,0,t);if(this._settings.footer)webix.Touch._set_matrix(this._footer.childNodes[1].firstChild,x,0,t);this.callEvent("onSyncScroll",[x,y,t])},_sync_pos:function(matrix){matrix.f-=this._scrollTop;matrix.e-=this._scrollLeft}}});webix.extend(webix.ui.datatable,{$init:function(){this.data.attachEvent("onStoreUpdated",webix.bind(function(id){if(!id)this._adjustColumns()},this));this.attachEvent("onStructureLoad",this._adjustColumns);this.attachEvent("onStructureUpdate",this._resizeColumns);this.attachEvent("onColumnResize",function(a,b,c,user){if(user)this._resizeColumns()});this.attachEvent("onResize",this._resizeColumns)},_adjustColumns:function(){var resize=false;var cols=this._columns;for(var i=0;i<cols.length;i++)if(cols[i].adjust&&(cols[i].adjust=="header"||this.count()))resize=this._adjustColumn(i,cols[i].adjust,true)||resize;if(resize){this._updateColsSizeSettings(true);this._resizeColumns()}},_resizeColumns:function(){var cols=this._settings.columns;var fill=[];var summ=0;if(cols&&!this._settings.autowidth)for(var i=0;i<cols.length;i++){var colfil=cols[i].fillspace;if(colfil){fill[i]=colfil;summ+=colfil*1||1}}if(summ)this._fillColumnSize(fill,summ)},_fillColumnSize:function(fill,summ){var cols=this._settings.columns;if(!cols)return;var width=this._content_width-this._scrollSizeY;var resize=false;if(width>0){for(var i=0;i<cols.length;i++)if(!fill[i])width-=cols[i].width||this.config.columnWidth;for(var i=0;i<fill.length;i++)if(fill[i]){var request=Math.min(width,Math.round(width*fill[i]/summ));resize=this._setColumnWidth(i,request,true)||resize;width=width-cols[i].width;summ=summ-fill[i]}if(resize)this._updateColsSizeSettings(true)}},_getColumnConfigSize:function(ind,headers){var config=this._settings.columns[ind];var max=config.minColumnWidth||10;if(headers!="header"){var order=[].concat(this.data.order);for(var i=0;i<order.length;i++)order[i]=order[i]?this._getValue(this.getItem(order[i]),config,0):"";max=Math.max(max,webix.html.getTextSize(order,"webix_table_cell webix_cell").width)}if(headers!="data"){for(var i=0;i<config.header.length;i++){var header=config.header[i];if(header){var width=0;if(header.rotate)for(var h=0;h<(header.rowspan||1);h++)width+=this._headers[h];var css="webix_table_cell webix_cell "+(header.css||"")+(header.rotate?"webix_measure_rotate":"");var size=webix.html.getTextSize([header.text],css,width);max=Math.max(max,header.rotate?size.height:size.width)}}}return max+1+(webix.env.isIE?webix.skin.$active.layoutPadding.space:0)},_adjustColumn:function(ind,headers,ignore){if(ind>=0){var width=this._getColumnConfigSize(ind,headers);return this._setColumnWidth(ind,width,ignore)}},adjustColumn:function(id,headers){this._adjustColumn(this.getColumnIndex(id),headers)},adjustRowHeight:function(id,silent){if(id){var config=this.getColumnConfig(id);var container;var d=webix.html.create("DIV",{class:"webix_table_cell webix_measure_size webix_cell"},"");d.style.cssText="width:"+config.width+"px; height:1px; visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;";this.$view.appendChild(d);if(d.offsetHeight<1){container=this.$view.cloneNode(true);document.body.appendChild(container);container.appendChild(d)}this.data.each(function(obj){if(obj){d.innerHTML=this._getValue(obj,config,0);obj.$height=Math.max(d.scrollHeight,this._settings.rowHeight)}},this);d=webix.html.remove(d);if(container)webix.html.remove(container)}else{var heightsArr=new Array(this.data.count()+1).join("0").split("");var cols=this.config.columns;for(var i=0;i<cols.length;i++){this.adjustRowHeight(cols[i].id,true);this.data.each(function(obj,index){if(obj.$height>heightsArr[index]){heightsArr[index]=obj.$height}obj.$height=heightsArr[index]})}}if(!silent)this.refresh()}});webix.extend(webix.ui.datatable,{math_setter:function(value){if(value)this._math_init();return value},_math_pref:"$",_math_init:function(){if(webix.env.strict)return;this.data.attachEvent("onStoreUpdated",webix.bind(this._parse_row_math,this));this.data.attachEvent("onStoreLoad",webix.bind(this._parse_math,this));this.attachEvent("onStructureLoad",this._parse_math)},_parse_row_math:function(id,obj,action){if(!id||(action=="delete"||action=="paint"))return;if(action=="add")this._exprs_by_columns(obj);for(var i=0;i<this._columns.length;i++)this._parse_cell_math(id,this._columns[i].id,action!=="add");this._math_recalc={}},_parse_cell_math:function(row,col,_inner_call){var item=this.getItem(row);var value;if(_inner_call===true)value=item[this._math_pref+col]||item[col];else{value=item[col];this._math_recalc={}}if(typeof value==="undefined"||value===null)return;if(value.length>0&&value.substr(0,1)==="="){if(!item[this._math_pref+col]||_inner_call!==true)item[this._math_pref+col]=item[col];item[col]=this._calculate(value,row,col)}else{if(typeof item[this._math_pref+col]!=="undefined")delete item[this._math_pref+col];this._remove_old_triggers(row,col)}if(typeof item.depends!=="undefined"&&typeof item.depends[col]!=="undefined"){for(var i in item.depends[col]){var name=item.depends[col][i][0]+"__"+item.depends[col][i][1];if(typeof this._math_recalc[name]==="undefined"){this._math_recalc[name]=true;this._parse_cell_math(item.depends[col][i][0],item.depends[col][i][1],true)}}}},_set_original_value:function(row,col){var item=this.getItem(row);if(typeof item[this._math_pref+col]!=="undefined")item[col]=item[this._math_pref+col]},_parse_math:function(){if(!this._columns||!this.count())return;this._exprs_by_columns();for(var j=0;j<this._columns.length;j++){var col=this.columnId(j);this.data.each(function(obj){this._parse_cell_math(obj.id,col)},this)}this._math_recalc={}},_exprs_by_columns:function(row){for(var i=0;i<this._columns.length;i++){if(this._columns[i].math){var col=this.columnId(i);var math="="+this._columns[i].math;math=math.replace(/\$r/g,"#$r#");math=math.replace(/\$c/g,"#$c#");if(row)row[col]=this._parse_relative_expr(math,row.id,col);else this.data.each(function(obj){obj[col]=this._parse_relative_expr(math,obj.id,col)},this)}}},_parse_relative_expr:function(expr,row,col){return webix.template(expr)({$r:row,$c:col})},_get_calc_value:function(row,col){var item;if(this.exists(row))item=this.getItem(row);else return"#out_of_range";var value=item[this._math_pref+col]||item[col]||0;value=value.toString();if(value.substring(0,1)!=="=")return value;else{if(typeof item[this._math_pref+col]==="undefined")item[this._math_pref+col]=item[col];item[col]=this._calculate(value,row,col,true);return item[col]}},_calculate:function(value,row,col,_inner_call){if(_inner_call===true){if(this._in_math_trace(row,col))return"#selfreference"}else this._start_math_trace();this._to_math_trace(row,col);var item=this.getItem(row);value=value.substring(1);var operations=this._get_operations(value);var triggers=this._get_refs(value);if(operations){value=this._replace_refs(value,triggers);value=this._parse_args(value,operations)}else{value=this._replace_refs(value,triggers,true)}var exc=this._math_exception(value);if(exc!==false)return exc;this._from_math_trace(row,col);this._remove_old_triggers(row,col);for(var i=0;i<triggers.length;i++){this._add_trigger([row,col],triggers[i])}var exc=this._math_exception(value);if(exc!==false)return exc;if(!value)return value;value=this._compute(value);var exc=this._math_exception(value);if(exc!==false)return exc;return value},_get_operations:function(value){var splitter=/(\+|\-|\*|\/)/g;var operations=value.replace(/\[[^)]*?\]/g,"").match(splitter);return operations},_get_refs:function(value){var reg=/\[([^\]]+),([^\]]+)\]/g;var cells=value.match(reg);if(cells===null)cells=[];for(var i=0;i<cells.length;i++){var cell=cells[i];var tmp=cell;cell=cell.substr(1,cell.length-2);cell=cell.split(",");cell[0]=this._trim(cell[0]);cell[1]=this._trim(cell[1]);if(cell[0].substr(0,1)===":")cell[0]=this.getIdByIndex(cell[0].substr(1));if(cell[1].substr(0,1)===":")cell[1]=this.columnId(cell[1].substr(1));cell[2]=tmp;cells[i]=cell}return cells},_replace_refs:function(value,cells,clean){var dell="(",delr=")";if(clean)dell=delr="";for(var i=0;i<cells.length;i++){var cell=cells[i];var cell_value=this._get_calc_value(cell[0],cell[1]);if(isNaN(cell_value))cell_value='"'+cell_value+'"';value=value.replace(cell[2],dell+cell_value+delr)}return value},_parse_args:function(value,operations){var args=[];for(var i=0;i<operations.length;i++){var op=operations[i];var temp=this._split_by(value,op);args.push(temp[0]);value=temp[1]}args.push(value);for(var i=0;i<args.length;i++){var arg=this._trim(args[i]);args[i]=arg}var expr="";for(var i=0;i<args.length-1;i++){expr+=args[i]+operations[i]}expr+=args[args.length-1];return expr},_compute:function(expr){try{webix.temp_value="";expr="webix.temp_value = "+expr;eval(expr)}catch(ex){webix.assert(false,"Math error in datatable<br>"+expr);webix.temp_value=""}var result=webix.temp_value;webix.temp_value=null;return result.toString()},_split_by:function(value,splitter){var pos=value.indexOf(splitter);var before=value.substr(0,pos);var after=value.substr(pos+1);return[before,after]},_trim:function(value){value=value.replace(/^ */g,"");value=value.replace(/ *$/g,"");return value},_start_math_trace:function(){this._math_trace=[]},_to_math_trace:function(row,col){this._math_trace[row+"__"+col]=true},_from_math_trace:function(row,col){if(typeof this._math_trace[row+"__"+col]!=="undefined")delete this._math_trace[row+"__"+col]},_in_math_trace:function(row,col){if(typeof this._math_trace[row+"__"+col]!=="undefined")return true;else return false},_add_trigger:function(depends,from){var item=this.getItem(from[0]);if(typeof item.depends==="undefined")item.depends={};if(typeof item.depends[from[1]]==="undefined")item.depends[from[1]]={};item.depends[from[1]][depends[0]+"__"+depends[1]]=depends;item=this.getItem(depends[0]);if(typeof item.triggers==="undefined")item.triggers={};if(typeof item.triggers[depends[1]]==="undefined")item.triggers[depends[1]]={};item.triggers[depends[1]][from[0]+"__"+from[1]]=from},_remove_old_triggers:function(row,col){if(!this.exists(row,col))return;var item=this.getItem(row,col);if(typeof item.triggers==="undefined")return;for(var i in item.triggers[col]){var depend=item.triggers[col][i];delete this.getItem(depend[0]).depends[depend[1]][row+"__"+col]}},_math_exception:function(value){var reg=/#\w+/;var match=value.match(reg);if(match!==null&&match.length>0)return match[0];return false}});webix.extend(webix.ui.datatable,{_get_editor_type:function(id){return this.getColumnConfig(id.column).editor},getEditor:function(row,column){if(!row)return this._last_editor;if(arguments.length==1){column=row.column;row=row.row}return(this._editors[row]||{})[column]},_for_each_editor:function(handler){for(var row in this._editors){var row_editors=this._editors[row];for(var column in row_editors)if(column!="$count")handler.call(this,row_editors[column])}},_init_editor:function(id,type,show){var row=id.row;var column=id.column;var col_settings=type.config=this.getColumnConfig(column);if(show!==false)this.showCell(row,column);var node=type.render();if(type.$inline)node=this._locateInput(id);type.node=node;var item=this.getItem(row);var format=col_settings.editFormat;var value;if(this._settings.editMath)value=item["$"+column];value=value||item[column];if(webix.isUndefined(value))value="";type.setValue(format?format(value):value,item);type.value=item[column];this._addEditor(id,type);if(!type.$inline)this._sizeToCell(id,node,true);if(type.afterRender)type.afterRender();if(this._settings.liveValidation){webix._event(type.node,"keyup",this._bind_live_validation(id,this));this.validateEditor(id)}return node},_bind_live_validation:function(id,that){return function(){that.validateEditor(id)}},_set_new_value:function(editor,new_value,copy){var parser=this.getColumnConfig(editor.column).editParse;var item=copy?{}:this.getItem(editor.row);item[editor.column]=parser?parser(new_value):new_value;if(this._settings.editMath)item["$"+editor.column]=null;return item},_addEditor:function(id,type,node){var row_editors=this._editors[id.row]=this._editors[id.row]||{};row_editors.$count=(row_editors.$count||0)+1;type.row=id.row;type.column=id.column;this._last_editor=row_editors[id.column]=type;this._in_edit_mode++;this._last_editor_scroll=this.getScrollState()},_removeEditor:function(editor){if(this._last_editor==editor)this._last_editor=0;if(editor.destroy)editor.destroy();var row=this._editors[editor.row];delete row[editor.column];row.$count--;if(!row.$count)delete this._editors[editor.row];this._in_edit_mode--},_changeEditorId:function(oldid,newid){var editor=this._editors[oldid];if(editor){this._editors[newid]=editor;delete this._editors[oldid];for(var key in editor)editor[key].row=newid}},_locate_cell:function(id){var area,i,index,j,node,span,config=this.getColumnConfig(id.column),cell=0;if(config&&config.node&&config.attached){index=this.getIndexById(id.row);if(this._spans_pull){span=this.getSpan(id.row,id.column);if(span){for(i=0;i<3;i++){area=this._spans_areas[i];for(j=0;!cell&&j<area.childNodes.length;j++){node=area.childNodes[j];if(node.getAttribute("row")==index&&node.getAttribute("column")==this.getColumnIndex(id.column))cell=node}}}}if(!cell&&index>=config._yr0-this._settings.topSplit&&index<config._yr1)cell=config.node.childNodes[index-config._yr0+this._settings.topSplit]}return cell},editCell:function(row,column,preserve,show){column=column||this._settings.columns[0].id;return webix.EditAbility.edit.call(this,{row:row,column:column},preserve,show)},editRow:function(id,focus){if(id&&id.row)id=id.row;var next=false;this.eachColumn(function(column){this.edit({row:id,column:column},next,!next);next=true})},editColumn:function(id,focus){if(id&&id.column)id=id.column;var next=false;this.eachRow(function(row){this.edit({row:row,column:id},next,!next);next=true})},eachRow:function(handler,all){var order=this.data.order;if(all)order=this.data._filter_order||order;for(var i=0;i<order.length;i++)handler.call(this,order[i])},eachColumn:function(handler,all){for(var i in this._columns_pull){var column=this._columns_pull[i];handler.call(this,column.id,column)}if(all){for(var i in this._hidden_column_hash){var column=this._hidden_column_hash[i];handler.call(this,column.id,column)}}},_after_edit_next:function(editor_next){if(this.getSelectedId){var sel=this.getSelectedId(true);if(sel.length==1){this._select(editor_next);return false}}},_custom_tab_handler:function(tab,e){if(this._settings.editable&&!this._in_edit_mode){if(e.target&&e.target.tagName=="INPUT")return true;var selection=this.getSelectedId(true);if(selection.length==1){this.editNext(tab,selection[0]);return false}}return true},_find_cell_next:function(start,check,direction){var row=this.getIndexById(start.row);var column=this.getColumnIndex(start.column);var order=this.data.order;var cols=this._columns;if(direction){for(var i=row;i<order.length;i++){for(var j=column+1;j<cols.length;j++){var id={row:order[i],column:cols[j].id};if(check.call(this,id)&&(!this._checkCellMerge||!this._checkCellMerge(start,id))){return id}}column=-1}}else{for(var i=row;i>=0;i--){for(var j=column-1;j>=0;j--){var id={row:order[i],column:cols[j].id};if(check.call(this,id))return id}column=cols.length}}return null},_correct_after_focus_y:function(){if(this._in_edit_mode){if(this._ignore_after_focus_scroll)this._ignore_after_focus_scroll=false;else{this._y_scroll.scrollTo(this.getScrollState().y+this._body.childNodes[1].firstChild.scrollTop);this._body.childNodes[1].firstChild.scrollTop=0;this._ignore_after_focus_scroll=true}}},_correct_after_focus_x:function(){if(this._in_edit_mode){this._x_scroll.scrollTo(this._body.childNodes[1].scrollLeft)}},_component_specific_edit_init:function(){this.attachEvent("onScrollY",this._update_editor_y_pos);this.attachEvent("onScrollX",this._update_editor_y_pos);this.attachEvent("onScrollY",this._refocus_inline_editor);this.attachEvent("onColumnResize",function(){this.editStop()});this.attachEvent("onAfterFilter",function(){this.editStop()});this.attachEvent("onRowResize",function(){this.editStop()});this.attachEvent("onAfterScroll",function(){if(this._settings.topSplit)this.editStop()});this._body.childNodes[1].firstChild.onscroll=webix.bind(this._correct_after_focus_y,this);this._body.childNodes[1].onscroll=webix.bind(this._correct_after_focus_x,this)},_update_editor_y_pos:function(){if(this._in_edit_mode){var old=this._last_editor_scroll;this._last_editor_scroll=this.getScrollState();var diff=this._last_editor_scroll.y-old.y;this._for_each_editor(function(editor){if(editor.getPopup){var node=this.getItemNode(editor);if(node)editor.getPopup().show(node);else editor.getPopup().show({x:-1e4,y:-1e4})}else if(!editor.$inline){editor.node.top-=diff;editor.node.style.top=editor.node.top+"px"}})}}});webix.extend(webix.ui.datatable,webix.EditAbility);webix.extend(webix.ui.datatable,{$init:function(){this._clear_hidden_state();this.attachEvent("onStructureLoad",this._hideInitialColumns)},_clear_hidden_state:function(){this._hidden_column_hash={};this._hidden_column_order=webix.toArray();this._hidden_split=[0,0]},_hideInitialColumns:function(){var cols=this._columns;for(var i=0;i<cols.length;i++){if(cols[i].header)this._getInitialSpans(cols,cols[i].header);if(cols[i].footer)this._getInitialSpans(cols,cols[i].footer)}for(var i=cols.length-1;i>=0;i--){if(cols[i].hidden)this.hideColumn(cols[i].id,true,true);else if(cols[i].batch&&this.config.visibleBatch&&cols[i].batch!=this.config.visibleBatch){this.hideColumn(cols[i].id,true,true)}}},_getInitialSpans:function(cols,elements){for(var h=0;h<elements.length;h++){var line=elements[h];if(line&&line.colspan)line.$colspan=line.colspan}},moveColumn:function(id,index){var start_index=this.getColumnIndex(id);if(start_index==index)return;var columns=this._settings.columns;var start=columns.splice(start_index,1);var pos=index-(index>start_index?1:0);webix.PowerArray.insertAt.call(columns,start[0],pos);this._refresh_columns()},_init_horder:function(){var horder=this._hidden_column_order;var cols=this._settings.columns;if(!horder.length){for(var i=0;i<cols.length;i++)horder[i]=cols[i].id;this._hidden_split=[this._settings.leftSplit,this._rightSplit]}},isColumnVisible:function(id){return!this._hidden_column_hash[id]},hideColumn:function(id,mode,silent){var cols=this._settings.columns;var horder=this._hidden_column_order;var hhash=this._hidden_column_hash;var column;var span=1;if(mode!==false){var index=this.getColumnIndex(id);webix.assert(index!=-1,"hideColumn: invalid ID or already hidden");if(index===-1||!this.callEvent("onBeforeColumnHide",[id]))return;if(index==-1)return;this._init_horder();var header=cols[index].header[0];if(header)header.$groupSpan=span=header.colspan||1;if(index<this._settings.leftSplit)this._settings.leftSplit-=span;if(index>=this._rightSplit)this._settings.rightSplit-=span;else this._rightSplit-=span;for(var i=index+span-1;i>=index;i--){this._hideColumn(index);column=cols.splice(index,1)[0];hhash[column.id]=column;column._yr0=-1;delete this._columns_pull[column.id]}this.callEvent("onAfterColumnHide",[id])}else{column=hhash[id];webix.assert(column,"showColumn: invalid ID or already visible");if(!column||!this.callEvent("onBeforeColumnShow",[id]))return;var prev=null;var i=0;var hindex=0;for(;i<horder.length;i++){if(horder[i]==id){hindex=i;break}if(!hhash[horder[i]])prev=horder[i]}var index=prev?this.getColumnIndex(prev)+1:0;var header=column.header[0];if(header){header.colspan=header.$groupSpan||header.colspan;delete header.$groupSpan;span=header.colspan||1}for(var i=hindex+span-1;i>=hindex;i--){var column=hhash[horder[i]];if(column){webix.PowerArray.insertAt.call(cols,column,index);delete column.hidden;delete hhash[column.id];this._columns_pull[column.id]=column}else span--}if(hindex<this._hidden_split[0])this._settings.leftSplit+=span;if(hindex>=this._hidden_split[1])this._settings.rightSplit+=span;else this._rightSplit+=span;this.callEvent("onAfterColumnShow",[id])}if(column.header)this._fixColspansHidden(column,mode!==false?0:1,"header");if(column.footer)this._fixColspansHidden(column,mode!==false?0:1,"footer");if(!silent)this._refresh_columns()},_fixColspansHidden:function(config,mod,elName){for(var i=config[elName].length-1;i>=0;i--){var ind=this._hidden_column_order;var spanSource,isHidden=false,spanSize=0;for(var j=0;j<ind.length;j++){var config=this.getColumnConfig(ind[j]);var el=config[elName][i];if(!this.isColumnVisible(ind[j])){if(el&&el.$colspan&&spanSize<=0){spanSize=el.colspan=el.$colspan;isHidden=spanSource=el}if(spanSource&&spanSize>0){spanSource.colspan--}}else{if(isHidden&&spanSize>0&&spanSource&&spanSource.colspan>0){el=config[elName][i]=spanSource;spanSource=el}else if(el&&el.$colspan&&spanSize<=0){spanSize=el.colspan=el.$colspan;spanSource=el}isHidden=null}spanSize--}}},refreshColumns:function(columns,reset){if(columns&&columns!=this.config.columns||reset){this._clear_hidden_state();this._filter_elements={};if(columns)this._rightSplit=columns.length-(this.config.rightSplit||0)}this._columns_pull={};for(var i=0;i<this._columns.length;i++){var col=this._columns[i];this._columns_pull[col.id]=col;col.attached=col.node=null}for(var i=0;i<3;i++){this._header.childNodes[i].innerHTML="";this._body.childNodes[i].firstChild.innerHTML=""}this._columns=this.config.columns=columns||this.config.columns;this._rightSplit=this._columns.length-this._settings.rightSplit;this._dtable_fully_ready=0;this._define_structure();this.callEvent("onStructureUpdate");this._update_scroll();this.render()},_refresh_columns:function(){this._dtable_fully_ready=0;this.callEvent("onStructureUpdate");this._apply_headers();this.render()},showColumn:function(id){return this.hideColumn(id,false)},showColumnBatch:function(batch,mode){var preserve=typeof mode!="undefined";mode=mode!==false;this.eachColumn(function(id,col){if(col.batch){var hidden=this._hidden_column_hash[col.id];if(!mode)hidden=!hidden;if(col.batch==batch&&hidden)this.hideColumn(col.id,!mode,true);else if(!preserve&&col.batch!=batch&&!hidden)this.hideColumn(col.id,mode,true)}},true);this._refresh_columns()}});webix.extend(webix.ui.datatable,{$init:function(){this.attachEvent("onAfterScroll",this._set_focusable_item)},_set_focusable_item:function(){var sel=this._getVisibleSelection();if(!sel){var node=this._dataobj.querySelector(".webix_cell");if(node)node.setAttribute("tabindex","0")}},_getVisibleSelection:function(){var sel=this.getSelectedId(true);for(var i=0;i<sel.length;i++){if(this.isColumnVisible(sel[i].column))return this.getItemNode(sel[i])}return null},moveSelection:function(mode,shift,focus){if(this._settings.disabled)return;var t=this.getSelectedId(true);var index=t.length-1;var preserve=this._settings.multiselect||this._settings.areaselect?shift:false;if(t.length>1&&this._settings.select!=="cell"){t=t.sort(webix.bind(function(a,b){if(this.getIndexById(a.row)>this.getIndexById(b.row)||this.getColumnIndex(a.column)>this.getColumnIndex(b.column))return 1;else return-1},this));if(mode=="up"||mode=="left"||mode=="top"||mode=="pgup")index=0}if(index<0&&this.count()){if(mode=="down"||mode=="right")mode="top";else if(mode=="up"||mode=="left")mode="bottom";else return;index=0;t=[{row:1,column:1}]}if(index>=0){var row=t[index].row;var column=t[index].column;if(mode=="top"||mode=="bottom"){if(row){if(mode=="top")row=this.data.getFirstId();else if(mode=="bottom")row=this.data.getLastId()}if(column){index=0;if(mode=="bottom")index=this.config.columns.length-1;column=this.columnId(index)}}else if(mode=="up"||mode=="down"||mode=="pgup"||mode=="pgdown"){if(row){var index=this.getIndexById(row);var step=mode=="pgup"||mode=="pgdown"?Math.round(this._dtable_offset_height/this._settings.rowHeight):1;if(mode=="up"||mode=="pgup")index-=step;else if(mode=="down"||mode=="pgdown")index+=step;if(index<0)index=0;if(index>=this.data.order.length)index=this.data.order.length-1;row=this.getIdByIndex(index);if(!row&&this._settings.pager)this.showItemByIndex(index)}}else if(mode=="right"||mode=="left"){if(column&&this.config.select!="row"){var index=this.getColumnIndex(column);if(mode=="right")index++;else if(mode=="left")index--;if(index<0)index=0;if(index>=this.config.columns.length)index=this.config.columns.length-1;column=this.columnId(index)}else if((this.open||this._subViewStorage)&&mode=="right"){return this.open?this.open(row):this.openSub(row)}else if((this.close||this._subViewStorage)&&mode=="left"){return this.close?this.close(row):this.closeSub(row)}}else{webix.assert(false,"Not supported selection moving mode");return}if(row){this.showCell(row,column);if(!this.select){webix.extend(this,this._selections._commonselect,true);this._settings.select=this.open||this._subViewStorage?"row":"cell";webix.extend(this,this._selections[this._settings.select],true)}var cell={row:row,column:column};if(preserve&&this._settings.select=="area"){var last=this._selected_areas[this._selected_areas.length-1];this._extendAreaRange(cell,last,mode)}else this._select(cell,preserve);if(!this._settings.clipboard&&focus!==false){var node=this.getItemNode(cell);if(node)node.focus()}}}return false}});webix.extend(webix.ui.datatable,webix.KeysNavigation);webix.extend(webix.ui.datatable,webix.DataMove);webix.extend(webix.ui.datatable,{drag_setter:function(value){this.attachEvent("onBeforeDrag",function(context){return this._checkDragTopSplit(context.source)});this.attachEvent("onBeforeDragIn",function(context){return this._checkDragTopSplit(context.target)});this.attachEvent("onBeforeDropOrder",function(startId,index){return index<0||index>=this._settings.topSplit});return webix.DragItem.drag_setter.call(this,value)},_checkDragTopSplit:function(ids){var i,index,frozen=false;if(this._settings.topSplit&&ids){if(!webix.isArray(ids))ids=[ids];for(i=0;!frozen&&i<ids.length;i++){index=this.getIndexById(ids[i]);frozen=index<this._settings.topSplit}}return!frozen},$dragHTML:function(item,e){var width=this._content_width-this._scrollSizeY;var html="<div class='webix_dd_drag' style='width:"+(width-2)+"px;'>";var cols=this._settings.columns;for(var i=0;i<cols.length;i++){var value=this._getValue(item,cols[i]);html+="<div style='width:"+cols[i].width+"px;'>"+value+"</div>"}return html+"</div>"},getHeaderNode:function(column_id,row_index){if(this.isColumnVisible(column_id)){var ind=this.getColumnIndex(column_id);var hind=this._settings.leftSplit>ind?0:this._rightSplit<=ind?2:1;row_index=row_index||0;var rows=this._header.childNodes[hind].getElementsByTagName("TR");if(rows.length){var nodes=rows[row_index+1].childNodes;for(var i=0;i<nodes.length;i++)if(nodes[i].getAttribute("column")==ind)return nodes[i].firstChild}}return null},getItemNode:function(id,e){if(id&&!id.header){var row=id.row||id;var rowindex=this.getIndexById(row);var state=this._get_y_range();var minRow=state[0]-this._settings.topSplit;if(rowindex<minRow&&rowindex>state[1])return;var x_range=this._get_x_range();var colindex=this._settings.leftSplit?0:x_range[0];if(id.column){colindex=this.getColumnIndex(id.column);if(colindex<this._rightSplit&&colindex>=this._settings.leftSplit&&(colindex<x_range[0]||colindex>x_range[1]))return}var column=this._settings.columns[colindex];if(column.attached&&column.node){var nodeIndex=rowindex<this._settings.topSplit?rowindex:rowindex-minRow;return column.node.childNodes[nodeIndex]}}},dragColumn_setter:function(value){var control;if(value=="order"){control={$drag:webix.bind(function(s,e){var id=this.locate(e);if(this._rs_process||!id||!this.callEvent("onBeforeColumnDrag",[id.column,e]))return false;webix.DragControl._drag_context={from:control,start:id,custom:"column_dnd"};var column=this.getColumnConfig(id.column);this._relative_column_drag=webix.html.posRelative(e);this._limit_column_drag=column.width;return"<div class='webix_dd_drag_column' style='width:"+column.width+"px'>"+(column.header[0].text||"&nbsp;")+"</div>"},this),$dragPos:webix.bind(function(pos,e,node){var context=webix.DragControl.getContext();var box=webix.html.offset(this.$view);node.style.display="none";var html=document.elementFromPoint(pos.x,box.y+1);var id=html?this.locate(html):null;var start=webix.DragControl.getContext().start.column;if(id&&id.column!=start&&(!this._column_dnd_temp_block||id.column!=this._last_sort_dnd_node)){if(context.custom=="column_dnd"&&webix.$$(html)==this){if(!this.callEvent("onBeforeColumnDropOrder",[start,id.column,e]))return;var start_index=this.getColumnIndex(start);var end_index=this.getColumnIndex(id.column);if(e.touches){this._dragTarget=e.target;this._dragTarget.style.display="none";this.$view.parentNode.appendChild(this._dragTarget)}this.moveColumn(start,end_index+(start_index<end_index?1:0));this._last_sort_dnd_node=id.column;this._column_dnd_temp_block=true}}if(id&&id.column==start){this._column_dnd_temp_block=false}node.style.display="block";pos.x=pos.x-this._relative_column_drag.x;pos.y=box.y;if(pos.x<box.x)pos.x=box.x;else{var max=box.x+this.$view.offsetWidth-this._scrollSizeY-this._limit_column_drag;if(pos.x>max)pos.x=max}webix.DragControl._skip=true},this),$dragDestroy:webix.bind(function(a,node){webix.html.remove(node);if(this._dragTarget)webix.html.remove(this._dragTarget);var id=webix.DragControl.getContext().start;this.callEvent("onAfterColumnDropOrder",[id.column,this._last_sort_dnd_node,a])},this),$drop:function(){}}}else if(value){control={_inner_drag_only:true,$drag:webix.bind(function(s,e){var id=this.locate(e);if(this._rs_process||!id||!this.callEvent("onBeforeColumnDrag",[id.column,e]))return false;webix.DragControl._drag_context={from:control,start:id,custom:"column_dnd"};var header=this.getColumnConfig(id.column).header;var text="&nbsp;";for(var i=0;i<header.length;i++)if(header[i]){text=header[i].text;break}return"<div class='webix_dd_drag_column'>"+text+"</div>"},this),$drop:webix.bind(function(s,t,e){var target=e;if(e.touches&&this._drag_column_last)target=this._drag_column_last;var id=this.locate(target);if(!id)return false;var start=webix.DragControl.getContext().start.column;if(start!=id.column){if(!this.callEvent("onBeforeColumnDrop",[start,id.column,e]))return;var start_index=this.getColumnIndex(start);var end_index=this.getColumnIndex(id.column);this.moveColumn(start,end_index+(start_index<end_index?1:0));this.callEvent("onAfterColumnDrop",[start,id.column,e])}},this),$dragIn:webix.bind(function(s,t,e){var context=webix.DragControl.getContext();if(context.custom!="column_dnd"||context.from!=control)return false;var target=e.target||e.srcElement;while((target.className||"").indexOf("webix_hcell")==-1){target=target.parentNode;if(!target)return}if(target!=this._drag_column_last){if(this._drag_column_last)webix.html.removeCss(this._drag_column_last,"webix_dd_over_column");webix.html.addCss(target,"webix_dd_over_column")}return this._drag_column_last=target},this),$dragDestroy:webix.bind(function(a,h){if(this._drag_column_last)webix.html.removeCss(this._drag_column_last,"webix_dd_over_column");webix.html.remove(h)},this)}}if(value){webix.DragControl.addDrag(this._header,control);webix.DragControl.addDrop(this._header,control,true)}}});webix.extend(webix.ui.datatable,webix.DragItem);webix.extend(webix.ui.datatable,{clearValidation:function(){for(var i in this.data._marks)this._clear_invalid_css(i);this.data.clearMark("webix_invalid",true)},_mark_invalid:function(id,details){this._clear_invalid_css(id);for(var key in details)this.addCellCss(id,key,"webix_invalid_cell");this.addCss(id,"webix_invalid")},_clear_invalid:function(id){this._clear_invalid_css(id);this.removeCss(id,"webix_invalid")},_clear_invalid_css:function(id){var item=this.getItem(id);var mark=this.data.getMark(id,"$cellCss");if(mark){for(var key in mark)mark[key]=mark[key].replace("webix_invalid_cell","").replace("  "," ")}},addRowCss:function(id,css,silent){this.addCss(id,css,silent)},removeRowCss:function(id,css,silent){this.removeCss(id,css,silent)},addCellCss:function(id,name,css,silent){var mark=this.data.getMark(id,"$cellCss");var newmark=mark||{};var style=newmark[name]||"";newmark[name]=style.replace(css,"").replace("  "," ")+" "+css;if(!mark)this.data.addMark(id,"$cellCss",false,newmark,true);if(!silent)this.refresh(id)},removeCellCss:function(id,name,css,silent){var mark=this.data.getMark(id,"$cellCss");if(mark){var style=mark[name]||"";if(style)mark[name]=style.replace(css,"").replace("  "," ");if(!silent)this.refresh(id)}}});webix.extend(webix.ui.datatable,webix.ValidateCollection);(function(){function getData(data){var values=[];for(var i=data.length-1;i>=0;i--){var value=data[i];values[i]=typeof value==="object"?value.value:value}return values}var SLines=webix.Sparklines=function(){};SLines.types={};SLines.getTemplate=function(customConfig){var config=customConfig||{};if(typeof customConfig=="string")config={type:customConfig};webix.extend(config,{type:"line"});var slConstructor=this.types[config.type];webix.assert(slConstructor,"Unknown sparkline type");return webix.bind(this._template,new slConstructor(config))};SLines._template=function(item,common,data,column){if(column)return this.draw(getData(data),column.width,33);else return this.draw(item.data||item,common.width,common.height)}})();webix.attachEvent("onDataTable",function(table){table.type.sparklines=webix.Sparklines.getTemplate()});(function(){function setOpacity(color,opacity){color=webix.color.toRgb(color);color.push(opacity);return"rgba("+color.join(",")+")"}function joinAttributes(attrs){var result=" ";if(attrs)for(var a in attrs)result+=a+'="'+attrs[a]+'" ';return result}var SVG={};SVG.draw=function(content,width,height,css){var attrs={xmlns:"http://www.w3.org/2000/svg",version:"1.1",height:"100%",width:"100%",viewBox:"0 0 "+width+" "+height,class:css||""};return"<svg "+joinAttributes(attrs)+">"+content+"</svg>"};SVG.styleMap={lineColor:"stroke",color:"fill"};SVG.group=function(path){return"<g>"+path+"</g>"};SVG._handlers={M:function(p){return" M "+p.x+" "+p.y},L:function(p){return" L "+p.x+" "+p.y},C:function(cp0,cp1,p){return" C "+cp0.x+" "+cp0.y+" "+cp1.x+" "+cp1.y+" "+p.x+" "+p.y},A:function(p,radius,angle0,angle1){var x=p.x+Math.cos(angle1)*radius;var y=p.y+Math.sin(angle1)*radius;var bigCircle=angle1-angle0>=Math.PI;return" A "+radius+" "+radius+" 0 "+(bigCircle?1:0)+" 1 "+x+" "+y}};SVG.definePath=function(points,close){var path="";for(var i=0;i<points.length;i++){webix.assert(points[i][0]&&typeof points[i][0]=="string","Path type must be a string");var type=points[i][0].toUpperCase();webix.assert(this._handlers[type],"Incorrect path type");path+=this._handlers[type].apply(this,points[i].slice(1))}if(close)path+=" Z";return path};SVG._linePoints=function(points){var result=[];for(var i=0;i<points.length;i++){result.push([i?"L":"M",points[i]])}return result};SVG.setOpacity=function(color,opacity){color=webix.color.toRgb(color);color.push(opacity);return"rgba("+color.join(",")+")"};SVG._curvePoints=function(points){var result=[];for(var i=0;i<points.length;i++){var p=points[i];if(!i){result.push(["M",p[0]])}result.push(["C",p[1],p[2],p[3]])}return result};SVG.getPath=function(path,css,attrs){attrs=joinAttributes(attrs);return'<path class="'+css+'" vector-effect="non-scaling-stroke" d="'+path+'" '+attrs+"/>"};SVG.getSector=function(p,radius,angle0,angle1,css,attrs){attrs=joinAttributes(attrs);var x0=p.x+Math.cos(angle0)*radius;var y0=p.y+Math.sin(angle0)*radius;var lines=[["M",p],["L",{x:x0,y:y0}],["A",p,radius,angle0,angle1],["L",p]];return'<path class="'+css+'" vector-effect="non-scaling-stroke" d="'+SVG.definePath(lines,true)+'" '+attrs+"/>"};SVG.getCurve=function(points,css,attrs){attrs=joinAttributes(attrs);var path=this.definePath(this._curvePoints(points));return'<path fill="none" class="'+css+'" vector-effect="non-scaling-stroke" d="'+path+'" '+attrs+"/>"};SVG.getLine=function(p0,p1,css,attrs){return this.getPath(this.definePath(this._linePoints([p0,p1]),true),css,attrs)};SVG.getCircle=function(p,radius,css,attrs){attrs=joinAttributes(attrs);return'<circle class="'+css+'" cx="'+p.x+'" cy="'+p.y+'" r="'+radius+'" '+attrs+"/>"};SVG.getRect=function(x,y,width,height,css,attrs){attrs=joinAttributes(attrs);return'<rect class="'+css+'" rx="0" ry="0" x="'+x+'" y="'+y+'" width="'+width+'" height="'+height+'" '+attrs+"/>"};webix._SVG=SVG})();(function(){var defaults={paddingX:3,paddingY:4,radius:1,minHeight:4,eventRadius:8};function Area(config){this.config=webix.extend(webix.copy(defaults),config||{},true)}Area.prototype.draw=function(data,width,height){var eventRadius,graph,path,points,styles,config=this.config,Line=webix.Sparklines.types.line.prototype,renderer=webix._SVG;points=this.getPoints(data,width,height);path=renderer.definePath(Line._getLinePoints(points),true);if(config.color)styles=this._applyColor(renderer,config.color);graph=renderer.group(renderer.getPath(path,"webix_sparklines_area"+(styles?" "+styles.area:"")));points.splice(points.length-3,3);path=renderer.definePath(Line._getLinePoints(points));graph+=renderer.group(renderer.getPath(path,"webix_sparklines_line"+(styles?" "+styles.line:"")));graph+=Line._drawItems(renderer,points,config.radius,"webix_sparklines_item"+(styles?" "+styles.item:""));eventRadius=Math.min(data.length?(width-2*(config.paddingX||0))/data.length:0,config.eventRadius);graph+=Line._drawEventItems(renderer,points,eventRadius);return renderer.draw(graph,width,height,"webix_sparklines_area_chart"+(config.css?" "+config.css:""))};Area.prototype._applyColor=function(renderer,color){var config={area:{},line:{},item:{}},map=renderer.styleMap;if(color){config.area[map.color]=renderer.setOpacity(color,.2);config.line[map.lineColor]=color;config.item[map.color]=color;for(var name in config)config[name]=webix.html.createCss(config[name])}return config};Area.prototype.getPoints=function(data,width,height){var Line=webix.Sparklines.types.line.prototype;var points=Line.getPoints.call(this,data,width,height);var x=this.config.paddingX||0;var y=this.config.paddingY||0;points.push({x:width-x,y:height-y},{x:x,y:height-y},{x:x,y:points[0].y});return points};webix.Sparklines.types["area"]=Area})();(function(){var defaults={paddingX:3,paddingY:4,width:20,margin:4,minHeight:4,eventRadius:8,origin:0,itemCss:function(value){return value<(this.config.origin||0)?" webix_sparklines_bar_negative":""}};function Bar(config){this.config=webix.extend(webix.copy(defaults),config||{},true)}Bar.prototype.draw=function(data,width,height){var i,css,p,y,padding,config=this.config,graph="",items=[],points=this.getPoints(data,width,height),renderer=webix._SVG;for(i=0;i<points.length;i++){css=typeof config.itemCss=="function"?config.itemCss.call(this,data[i]):config.itemCss||"";if(config.negativeColor&&data[i]<config.origin)css+=" "+this._applyColor(renderer,config.negativeColor);else if(config.color)css+=" "+this._applyColor(renderer,config.color);p=points[i];items.push(renderer.getRect(p.x,p.y,p.width,p.height,"webix_sparklines_bar "+css))}graph+=renderer.group(items.join(""));y=parseInt(this._getOrigin(data,width,height),10)+.5;padding=config.paddingX||0;graph+=renderer.group(renderer.getLine({x:padding,y:y},{x:width-padding,y:y},"webix_sparklines_origin"));var evPoints=this._getEventPoints(data,width,height);var evItems=[];for(i=0;i<evPoints.length;i++){p=evPoints[i];evItems.push(renderer.getRect(p.x,p.y,p.width,p.height,"webix_sparklines_event_area ",{webix_area:i}))}graph+=renderer.group(evItems.join(""));return renderer.draw(graph,width,height,"webix_sparklines_bar_chart"+(config.css?" "+config.css:""))};Bar.prototype._applyColor=function(renderer,color){var config={},map=renderer.styleMap;if(color)config[map.color]=color;return webix.html.createCss(config)};Bar.prototype._getOrigin=function(data,width,height){var config=this.config;var y=config.paddingY||0;height=(height||100)-y*2;var pos=y+height;if(config.origin!==false){var minValue=Math.min.apply(null,data);var maxValue=Math.max.apply(null,data);var origin=config.origin||-1e-6;if(origin>=maxValue){pos=y}else if(origin>minValue){var unitY=height/(maxValue-minValue);pos-=unitY*(origin-minValue)}}return pos};Bar.prototype._getEventPoints=function(data,width,height){var result=[];var x=this.config.paddingX||0;var y=this.config.paddingY||0;width=(width||100)-x*2;height=(height||100)-y*2;if(data.length){var unitX=width/data.length;for(var i=0;i<data.length;i++)result.push({x:Math.ceil(unitX*i)+x,y:y,height:height,width:unitX})}return result};Bar.prototype.getPoints=function(data,width,height){var config=this.config;var minValue=Math.min.apply(null,data);if(config.origin<minValue)minValue=config.origin;var maxValue=Math.max.apply(null,data);var result=[];var x=config.paddingX;var y=config.paddingY;var margin=config.margin;var barWidth=config.width||20;var originY=this._getOrigin(data,width,height);width=(width||100)-x*2;height=(height||100)-y*2;if(data.length){var unitX=width/data.length;var yNum=config.scale||maxValue-minValue;barWidth=Math.min(unitX-margin,barWidth);margin=unitX-barWidth;var minHeight=0;var origin=minValue;if(config.origin!==false&&config.origin>minValue)origin=config.origin||0;else minHeight=config.minHeight;var unitY=(height-minHeight)/(yNum?yNum:1);for(var i=0;i<data.length;i++){var h=Math.ceil(unitY*(data[i]-origin));result.push({x:Math.ceil(unitX*i)+x+margin/2,y:originY-(data[i]>=origin?h:0)-minHeight,height:Math.abs(h)+minHeight,width:barWidth})}}return result};webix.Sparklines.types["bar"]=Bar})();(function(){var defaults={paddingX:6,paddingY:6,radius:2,minHeight:4,eventRadius:8};function Line(config){this.config=webix.extend(webix.copy(defaults),config||{},true)}Line.prototype.draw=function(data,width,height){var points=this.getPoints(data,width,height);var config=this.config;var renderer=webix._SVG;var styles=config.color?this._applyColor(renderer,config.color):null;var path=renderer.definePath(this._getLinePoints(points));var graph=renderer.group(renderer.getPath(path,"webix_sparklines_line"+(styles?" "+styles.line:"")));graph+=this._drawItems(renderer,points,config.radius,"webix_sparklines_item"+(styles?" "+styles.item:""));var eventRadius=Math.min(data.length?(width-2*(config.paddingX||0))/data.length:0,config.eventRadius);graph+=this._drawEventItems(renderer,points,eventRadius);return renderer.draw(graph,width,height,"webix_sparklines_line_chart"+(config.css?" "+config.css:""))};Line.prototype._applyColor=function(renderer,color){var config={line:{},item:{}},map=renderer.styleMap;if(color){config.line[map.lineColor]=color;config.item[map.color]=color;for(var name in config)config[name]=webix.html.createCss(config[name])}return config};Line.prototype._drawItems=function(renderer,points,radius,css,attrs){var items=[];for(var i=0;i<points.length;i++){items.push(renderer.getCircle(points[i],radius,css,attrs))}return renderer.group(items.join(""))};Line.prototype._drawEventItems=function(renderer,points,radius){var items=[];for(var i=0;i<points.length;i++){items.push(renderer.getCircle(points[i],radius,"webix_sparklines_event_area",{webix_area:i}))}return renderer.group(items.join(""))};Line.prototype._getLinePoints=function(points){var i,type,result=[];for(i=0;i<points.length;i++){type=i?"L":"M";result.push([type,points[i]])}return result};Line.prototype.getPoints=function(data,width,height){var config=this.config;var minValue=Math.min.apply(null,data);if(typeof config.origin!=="undefined")minValue=Math.min(config.origin,minValue);var maxValue=Math.max.apply(null,data);var result=[];var x=config.paddingX||0;var y=config.paddingY||0;width=(width||100)-x*2;var minHeight=config.minHeight||0;height=(height||100)-y*2;if(data.length){if(data.length==1)result.push({x:width/2+x,y:height/2+x});else{var unitX=width/(data.length-1);var yNum=config.scale||maxValue-minValue;var unitY=(height-minHeight)/(yNum?yNum:1);if(!yNum)height/=2;for(var i=0;i<data.length;i++){result.push({x:Math.ceil(unitX*i)+x,y:height-Math.ceil(unitY*(data[i]-minValue))+y-minHeight})}}}return result};webix.Sparklines.types["line"]=Line})();(function(){var defaults={paddingY:2};function Pie(config){this.config=webix.extend(defaults,config||{},true)}Pie.prototype._defColorsCursor=0;Pie.prototype._defColors=["#f55b50","#ff6d3f","#ffa521","#ffc927","#ffee54","#d3e153","#9acb61","#63b967","#21a497","#21c5da","#3ea4f5","#5868bf","#7b53c0","#a943ba","#ec3b77","#9eb0b8"];Pie.prototype._getColor=function(i,data){var count=data.length;var colorsCount=this._defColors.length;if(colorsCount>count){if(i){if(i<colorsCount-count)i=this._defColorsCursor+2;else i=this._defColorsCursor+1}this._defColorsCursor=i}else i=i%colorsCount;return this._defColors[i]};Pie.prototype.draw=function(data,width,height){var attrs,graph,i,sectors,config=this.config,color=config.color||this._getColor,points=this.getAngles(data),renderer=webix._SVG,y=config.paddingY||0,r=height/2-y,x0=width/2,y0=height/2;if(typeof color!="function")color=function(){return color};sectors="";for(i=0;i<points.length;i++){attrs={};attrs[renderer.styleMap["color"]]=color.call(this,i,data,this._context);sectors+=renderer.getSector({x:x0,y:y0},r,points[i][0],points[i][1],"webix_sparklines_sector",attrs)}graph=renderer.group(sectors);sectors="";for(i=0;i<points.length;i++){sectors+=renderer.getSector({x:x0,y:y0},r,points[i][0],points[i][1],"webix_sparklines_event_area",{webix_area:i})}graph+=renderer.group(sectors);return renderer.draw(graph,width,height,"webix_sparklines_pie_chart"+(config.css?" "+config.css:""))};Pie.prototype.getAngles=function(data){var a0=-Math.PI/2,a1,i,result=[];var ratios=this._getRatios(data);for(i=0;i<data.length;i++){a1=-Math.PI/2+ratios[i]-1e-4;result.push([a0,a1]);a0=a1}return result};Pie.prototype._getTotalValue=function(data){var t=0;for(var i=0;i<data.length;i++)t+=data[i]*1;return t};Pie.prototype._getRatios=function(data){var i,value,ratios=[],prevSum=0,totalValue=this._getTotalValue(data);for(i=0;i<data.length;i++){value=data[i]*1;ratios[i]=Math.PI*2*(totalValue?(value+prevSum)/totalValue:1/data.length);prevSum+=value}return ratios};webix.Sparklines.types["pie"]=Pie})();(function(){var defaults={paddingX:3,paddingY:6,radius:2,minHeight:4,eventRadius:8};function Spline(config){this.config=webix.extend(webix.copy(defaults),config||{},true)}Spline.prototype.draw=function(data,width,height){var config=this.config,graph="",Line=webix.Sparklines.types.line.prototype,points=this.getPoints(data,width,height),renderer=webix._SVG,styles=config.color?this._applyColor(renderer,config.color):null;graph+=renderer.group(renderer.getCurve(points,"webix_sparklines_line"+(styles?" "+styles.line:"")));var linePoints=Line.getPoints.call(this,data,width,height);graph+=Line._drawItems(renderer,linePoints,config.radius,"webix_sparklines_item"+(styles?" "+styles.item:""));var eventRadius=Math.min(data.length?(width-2*(config.paddingX||0))/data.length:0,config.eventRadius);graph+=Line._drawEventItems(renderer,linePoints,eventRadius);return renderer.draw(graph,width,height,"webix_sparklines_line_chart"+(config.css?" "+config.css:""))};Spline.prototype._applyColor=function(renderer,color){var config={line:{},item:{}},map=renderer.styleMap;if(color){config.line[map.lineColor]=color;config.item[map.color]=color;for(var name in config)config[name]=webix.html.createCss(config[name])}return config};Spline.prototype.getPoints=function(data,width,height){var i,points,px,py,result=[],x=[],y=[],Line=webix.Sparklines.types.line.prototype;points=Line.getPoints.call(this,data,width,height);for(i=0;i<points.length;i++){x.push(points[i].x);y.push(points[i].y)}px=this._getControlPoints(x);py=this._getControlPoints(y);for(i=0;i<points.length-1;i++){result.push([points[i],{x:px[0][i],y:py[0][i]},{x:px[1][i],y:py[1][i]},points[i+1]])}return result};Spline.prototype._getControlPoints=function(points){var a=[],b=[],c=[],r=[],p1=[],p2=[],i,m,n=points.length-1;a[0]=0;b[0]=2;c[0]=1;r[0]=points[0]+2*points[1];for(i=1;i<n-1;i++){a[i]=1;b[i]=4;c[i]=1;r[i]=4*points[i]+2*points[i+1]}a[n-1]=2;b[n-1]=7;c[n-1]=0;r[n-1]=8*points[n-1]+points[n];for(i=1;i<n;i++){m=a[i]/b[i-1];b[i]=b[i]-m*c[i-1];r[i]=r[i]-m*r[i-1]}p1[n-1]=r[n-1]/b[n-1];for(i=n-2;i>=0;--i)p1[i]=(r[i]-c[i]*p1[i+1])/b[i];for(i=0;i<n-1;i++)p2[i]=2*points[i+1]-p1[i+1];p2[n-1]=.5*(points[n]+p1[n-1]);return[p1,p2]};webix.Sparklines.types["spline"]=Spline;var defaultsArea={paddingX:3,paddingY:6,radius:1,minHeight:4,eventRadius:8};function SplineArea(config){this.config=webix.extend(webix.copy(defaultsArea),config||{},true)}SplineArea.prototype=webix.copy(Spline.prototype);SplineArea.prototype.draw=function(data,width,height){var config=this.config,Line=webix.Sparklines.types.line.prototype,renderer=webix._SVG,styles=config.color?this._applyColor(renderer,config.color):null;var points=this.getPoints(data,width,height);var linePoints=points.splice(points.length-3,3);var linePath=renderer._linePoints(linePoints);linePath[0][0]="L";var areaPoints=renderer._curvePoints(points).concat(linePath);var graph=renderer.group(renderer.getPath(renderer.definePath(areaPoints),"webix_sparklines_area"+(styles?" "+styles.area:""),true));graph+=renderer.group(renderer.getPath(renderer.definePath(renderer._curvePoints(points)),"webix_sparklines_line"+(styles?" "+styles.line:"")));var itemPoints=Line.getPoints.call(this,data,width,height);graph+=Line._drawItems(renderer,itemPoints,config.radius,"webix_sparklines_item"+(styles?" "+styles.item:""));var eventRadius=Math.min(data.length?(width-2*(config.paddingX||0))/data.length:0,config.eventRadius);graph+=Line._drawEventItems(renderer,itemPoints,eventRadius);return renderer.draw(graph,width,height,"webix_sparklines_splinearea_chart"+(config.css?" "+config.css:""))};SplineArea.prototype._applyColor=function(renderer,color){var config={area:{},line:{},item:{}},map=renderer.styleMap;if(color){config.area[map.color]=renderer.setOpacity(color,.2);config.line[map.lineColor]=color;config.item[map.color]=color;for(var name in config)config[name]=webix.html.createCss(config[name])}return config};SplineArea.prototype.getPoints=function(data,width,height){var points=Spline.prototype.getPoints.call(this,data,width,height);var x=this.config.paddingX||0;var y=this.config.paddingY||0;points.push({x:width-x,y:height-y},{x:x,y:height-y},{x:x,y:points[0][0].y});return points};webix.Sparklines.types["splineArea"]=SplineArea})();webix.extend(webix.ui.datatable,{_prePrint:function(options,htmlOnly){if(options.scroll&&!htmlOnly)return true;options.header=webix.isUndefined(options.header)?this.config.header?true:false:options.header;options.footer=webix.isUndefined(options.footer)?this.config.footer?true:false:options.footer;options.xCorrection=options.xCorrection||0},_findIndex:function(arr,func){var result=-1;for(var i=0;result<0&&i<arr.length;i++){if(func(arr[i]))result=i}return result},_getTableHeader:function(base,columns,group){var spans={},start=0;base.forEach(webix.bind(function(tableArray,tid){var row=tableArray[0],headerArray=[],length=row.length;row.forEach(webix.bind(function(cell,cid){var column=columns[cid+start];for(var h=0;h<column[group].length;h++){var header=column[group][h];if(!header&&!(spans[tid]&&spans[tid][h]))continue;header=webix.copy(header||{text:""});if(spans[tid]&&spans[tid][h]&&cid===0){header.colspan=spans[tid][h];spans[tid][h]=0}if(header.colspan){var colspan=Math.min(header.colspan,length-cid);spans[tid+1]=spans[tid+1]||{};spans[tid+1][h]=header.colspan-colspan;header.colspan=colspan}if(header.rowspan&&length===1){header.height=(header.height||this.config.headerRowHeight)*header.rowspan;header.rowspan=null}var hcell={txt:header.rotate?this.getHeaderNode(column.id,h).innerHTML:header.text||(header.contentId?this.getHeaderContent(header.contentId).getValue():""),className:"webix_hcell "+"webix_"+group+"_cell "+(header.css||""),style:{height:(header.height||this.config.headerRowHeight)+"px",width:header.colspan?"auto":column.width+"px"},span:header.colspan||header.rowspan?{colspan:header.colspan||1,rowspan:header.rowspan||1}:null};headerArray[h]=headerArray[h]||[];headerArray[h][cid]=hcell}},this));if(group=="header")base[tid]=headerArray.concat(tableArray);else base[tid]=tableArray.concat(headerArray);start+=length},this));return base},_getTableArray:function(options,base,start){var columns=this.config.columns;var sel=this.getSelectedId(true);var maxWidth=this._getPageWidth(options);var rightRestriction=0;var bottomRestriction=0;var tableArray=[];var newTableStart=0;start=start||0+options.xCorrection;base=base||[];this.eachRow(webix.bind(function(row){var width=0;var rowItem=this.getItem(row);var rowIndex=this.getIndexById(row);var colrow=[];var datarow=false;for(var c=start;c<columns.length;c++){var column=columns[c].id;var colIndex=this.getColumnIndex(column)-start;if(columns[c]){width+=columns[c].width;if(width>maxWidth&&c>start){newTableStart=c;break}if(options.data!=="selection"||options.data=="selection"&&this._findIndex(sel,function(obj){return obj.column==column&&obj.row==row})!==-1){var span=this.getSpan(row,column);if(span&&this.getColumnIndex(column)===start){var spanStart=this.getColumnIndex(span[1]);if(spanStart<start){span[2]=span[2]-(start-spanStart);span[4]=span[4]?span[4]:rowItem[span[1]]?this.getText(row,span[1]):null;span[1]=column}}if(!span||span&&span[0]==row&&span[1]==column){var cellValue=span&&span[4]?span[4]:this._columns_pull[column]?this.getText(row,column):"";var className=this.getCss(row,column)+" "+(columns[c].css||"")+(span?" webix_dtable_span "+(span[5]||""):"");var style={height:span&&span[3]>1?"auto":(rowItem.$height||this.config.rowHeight)+"px",width:span&&span[2]>1?"auto":columns[c].width+"px"};colrow.push({txt:cellValue,className:className,style:style,span:span?{colspan:span[2],spanStart:this.getColumnIndex(span[1]),rowspan:span[3]}:null});if(cellValue){rightRestriction=Math.max(colIndex+1,rightRestriction);bottomRestriction=Math.max(rowIndex+1,bottomRestriction)}datarow=datarow||!!cellValue}else if(span){colrow.push({$inspan:true});rightRestriction=Math.max(colIndex+1,rightRestriction);bottomRestriction=Math.max(rowIndex+1,bottomRestriction)}}}}if(!options.skiprows||datarow)tableArray.push(colrow)},this));if(bottomRestriction&&rightRestriction){if(options.trim){tableArray.length=bottomRestriction;tableArray=tableArray.map(function(item){for(var i=item.length-1;i>=0;i--){if(item[i].span&&item[i].span.colspan){item[i].span.colspan=Math.min(item[i].span.colspan,item.length-i);break}}item.length=rightRestriction;return item})}base.push(tableArray)}if(newTableStart)this._getTableArray(options,base,newTableStart);else{if(options.footer)base=this._getTableHeader(base,columns,"footer");if(options.header)base=this._getTableHeader(base,columns,"header")}return base},_getTableHTML:function(tableData,options){var container=webix.html.create("div");tableData.forEach(webix.bind(function(table,i){var tableHTML=webix.html.create("table",{class:"webix_table_print "+this.$view.className+(options.borderless?" borderless":""),style:"border-collapse:collapse"});table.forEach(function(row){var tr=webix.html.create("tr");row.forEach(function(cell,i){if(!cell.$inspan){var td=webix.html.create("td");td.innerHTML=cell.txt;td.className=cell.className;for(var key in cell.style)td.style[key]=cell.style[key];if(cell.span){td.colSpan=cell.span.colspan;td.rowSpan=cell.span.rowspan}tr.appendChild(td)}});tableHTML.appendChild(tr)});container.appendChild(tableHTML);if(i+1<tableData.length){var br=webix.html.create("DIV",{class:"webix_print_pagebreak"});container.appendChild(br)}},this));return container}});webix.extend(webix.ui.datatable,webix.CustomPrint);webix.extend(webix.ui.datatable,{topSplit_setter:function(value){if(this.data)this.data.$freeze=value;return value},freezeRow:function(id,mode){var index,freezeLine=this._settings.topSplit,order=this.data.order,filterOrder=this.data._filter_order;function moveFrozenRow(index,id,mode,order,skipSplitChange){var i;if(mode&&index>=freezeLine){if(!skipSplitChange)freezeLine++;for(i=index;i>=freezeLine;i--){order[i]=order[i-1]}order[freezeLine-1]=id}if(!mode&&index<freezeLine){if(!skipSplitChange)freezeLine--;for(i=index;i<freezeLine;i++){order[i]=order[i+1]}order[freezeLine]=id}}if(id){index=this.getIndexById(id);id=id.toString();moveFrozenRow(index,id,mode,order);if(filterOrder)moveFrozenRow(filterOrder.find(id),id,mode,filterOrder,true)}else if(!mode)freezeLine=0;this.define("topSplit",freezeLine);this.refresh()}});webix.TreeTableClick={};webix.TreeTablePaste={insert:function(data){var parent=this.getSelectedId(true,true);for(var i=0;i<data.length;i++){var item={};for(var j=0;j<this._settings.columns.length;j++){item[this._settings.columns[j].id]=data[i][j]||""}if(!webix.isUndefined(item.id)&&this.exists(item.id))item.id=webix.uid();this.add(item,null,parent[0])}}};webix.protoUI({name:"treetable",$init:function(){webix.extend(this.data,webix.TreeStore,true);webix.extend(this.type,webix.TreeType);webix.extend(this,webix.TreeDataMove,true);for(var key in webix.TreeClick)if(!this.on_click[key])this.on_click[key]=this._unwrap_id(webix.TreeClick[key]);this.type.treetable=webix.template("{common.space()}{common.icon()} {common.folder()}");this.type.treecheckbox=function(obj,common){if(obj.indeterminate&&!obj.nocheckbox)return"<div class='webix_tree_checkbox webix_indeterminate'></div>";else return webix.TreeType.checkbox.apply(this,arguments)};this.data.provideApi(this,true);this._viewobj.setAttribute("role","treegrid")},$exportView:function(options){webix.extend(options,{filterHTML:true});return this},_drag_order_complex:false,_unwrap_id:function(original){return function(e,id){id=id.row;return original.call(this,e,id)}},getState:function(){var state=webix.DataState.getState.call(this);webix.extend(state,webix.TreeAPI.getState.call(this));return state},setState:function(state){if(webix.TreeAPI.setState.call(this,state)){webix.DataState.setState.call(this,state)}},clipboard_setter:function(value){webix.extend(this._paste,webix.TreeTablePaste);return webix.TablePaste.clipboard_setter.call(this,value)},_run_load_next:function(conf,direction){for(var i=0;i<conf.start;i++){var id=this.data.order[i];if(id&&this.getItem(id).$level!=1)conf.start--}return webix.ui.datatable.prototype._run_load_next.call(this,conf,direction)}},webix.TreeAPI,webix.TreeStateCheckbox,webix.TreeDataLoader,webix.ui.datatable);webix.extend(webix.ui.datatable,{spans_setter:function(value){if(value&&!this._spans_pull)this._init_spans_once();return value},_init_spans_once:function(){this._spans_pull={};this._spans_areas=[];this.data.attachEvent("onStoreLoad",webix.bind(function(driver,data){if(data&&data.spans)this.addSpan(data.spans)},this));this.data.attachEvent("onClearAll",webix.bind(function(){this._spans_pull={}},this));this.attachEvent("onScrollY",this._adjust_spans_xy);this.attachEvent("onScrollX",this._adjust_spans_xy);this.data.attachEvent("onStoreUpdated",webix.bind(function(id,obj,mode){if(mode!="paint"&&this._columns.length)this._paint_spans()},this));this.attachEvent("onStructureLoad",this._paint_spans);this.attachEvent("onStructureUpdate",this._paint_spans);this.attachEvent("onColumnResize",this._paint_spans);this.attachEvent("onRowResize",this._paint_spans);this.attachEvent("onSelectChange",this._paint_spans_selection)},addSpan:function(id,index,width,height,value,css){if(typeof id=="object"){for(var i=0;i<id.length;i++)this.addSpan.apply(this,id[i]);return}height=height||1;width=width||1;if(!this._spans_pull[id])this._spans_pull[id]={};this._spans_pull[id][index]=[width,height,value,css]},removeSpan:function(id,index){if(!arguments.length)this._spans_pull={};var line=this._spans_pull[id];if(line)delete line[index]},getSpan:function(row,column){if(!row)return this._spans_pull;var i,iSpan,j,jSpan,span,column,row,spans=this._spans_pull;i=this.getIndexById(row);j=this.getColumnIndex(column);for(row in spans){for(column in spans[row]){span=spans[row][column];iSpan=this.getIndexById(row);jSpan=this.getColumnIndex(column);if(!(i>iSpan+span[1]-1||i<iSpan||j>jSpan+span[0]-1||j<jSpan)){return[row,column].concat(span)}}}return null},_paint_spans:function(){webix.html.remove(this._spans_areas);for(var i=0;i<3;i++){var area=this._spans_areas[i]=webix.html.create("DIV",{class:"webix_span_layer"});this._body.childNodes[i].appendChild(area)}this.attachEvent("onSyncScroll",function(x,y,t){for(var i=0;i<3;i++){webix.Touch._set_matrix(this._spans_areas[i],i==1?x:0,y,t)}});this._adjust_spans_xy();if(this._settings.leftSplit)this._paint_spans_area(this._spans_areas[0],0,this._settings.leftSplit);if(this._settings.rightSplit)this._paint_spans_area(this._spans_areas[2],this._rightSplit,this._columns.length);this._paint_spans_area(this._spans_areas[1],this._settings.leftSplit,this._rightSplit||this._columns.length)},_paint_spans_area:function(area,start,end){var top=0;var count=this.data.order.length;for(var i=0;i<count;i++){var id=this.data.order[i];var line=this._spans_pull[id];if(line){for(var j=start;j<end;j++){var cid=this._columns[j].id;if(line[cid])this._add_span_to_area(area,i,j,line,top,start,id,cid)}}top+=this._getRowHeight(this.getItem(id))}},_paint_spans_selection:function(){var config=this.config.select;var cell=config=="cell"||config=="column";var selected=this.getSelectedId(true);var newselected=[];var last=this._last_selected||[];var id=webix.uid()+"";var repaint=false;for(var i=0;i<selected.length;i++){var line=this._spans_pull[selected[i]];if(line&&(!cell||line[selected[i].column])){if(!line.$selected||line.$selected.id!=selected[i].id)repaint=true;line.$selected=selected[i];line.$time=id;newselected.push(selected[i].id)}}for(var i=0;i<last.length;i++){var line=this._spans_pull[last[i]];if(line&&line.$time!==id){delete line.$selected;repaint=true}}this._last_selected=[].concat(selected);if(repaint)this._paint_spans()},_span_sum_width:function(start,end){var summ=0;for(var i=start;i<end;i++){var next=this._columns[i];summ+=next?next.width:0}return summ},_span_sum_height:function(start,end){var summ=0;for(var i=start;i<end;i++){var next=this.getItem(this.data.order[i]);summ+=next?this._getRowHeight(next):this._settings.rowHeight}return summ},_add_span_to_area:function(area,ind,cind,config,top,start,id,cid){var line=config[cid];var value=line[2]||this.getText(id,cid);var selected="";if(config.$selected&&(this._settings.select==="row"||config.$selected.column===cid))selected="webix_selected ";var attributes={column:cind,row:ind,class:selected+"webix_cell webix_table_cell webix_dtable_span "+(line[3]||""),"aria-colindex":cind+1,"aria-rowindex":ind+1};if(line[0]>1)attributes["aria-colspan"]=line[0];if(line[1]>1)attributes["aria-rowspan"]=line[1];var span=webix.html.create("DIV",attributes,""+value);span.style.top=top+"px";span.style.left=this._span_sum_width(start,cind)+"px";span.style.width=this._span_sum_width(cind,cind+line[0])+"px";span.style.height=this._span_sum_height(ind,ind+line[1])+"px";area.appendChild(span)},_adjust_spans_xy:function(){if(!this._settings.prerender){var state=this.getScrollState();for(var i=0;i<3;i++)this._spans_areas[i].style.top="-"+(state.y||0)+"px"}},_checkCellMerge:function(id0,id1){var span0,span1,result=false;if(this._spans_pull){span0=this.getSpan(id0.row,id0.column);span1=this.getSpan(id1.row,id1.column);if(span0&&span1&&span0[0]==span1[0]&&span0[1]==span1[1])result=true}return result}});webix.extend(webix.ui.datatable,{subrow_setter:function(value){if(value){this._init_subrow_once();this._settings.fixedRowHeight=false;return webix.template(value)}return false},subview_setter:function(value){if(value)this._settings.subrow=this.subrow_setter("<div></div>");return value},defaults:{subRowHeight:35},_refresh_sub_all:function(){this.data.each(function(obj){if(obj)obj.$sub=this._settings.subrow(obj,this.type)},this);this._resize_sub_all()},_resize_sub_all:function(resize){if(this._settings.subRowHeight==="auto"&&this._content_width)this._adjustSubRowHeight();if(resize&&this._settings.subview){for(var key in this._subViewStorage){var subview=webix.$$(this._subViewStorage[key]);if(!subview._settings.hidden)subview.adjust()}}},_refresh_sub_one:function(id){var obj=this.getItem(id);obj.$sub=this._settings.subrow(obj,this.type);if(this._settings.subRowHeight==="auto")this._adjustSubRowHeight(obj.id,obj.$sub)},$init:function(){this._init_subrow_once=webix.once(function(){var css="#"+this._top_id+" .webix_cell.webix_dtable_subview { line-height:normal;}";if(this._settings.fixedRowHeight)css+="#"+this._top_id+" .webix_column .webix_cell { white-space: nowrap;}";webix.html.addStyle(css);this._subViewStorage={};this.attachEvent("onSubViewRender",this._render_sub_view);this.data.attachEvent("onStoreUpdated",webix.bind(function(id,data,mode){if(!id)this._refresh_sub_all();else if(mode=="update"||mode=="add")this._refresh_sub_one(id)},this));this.attachEvent("onResize",function(w,h,wo){if(wo!=w)this._resize_sub_all(true)})});this.type.subrow=function(obj){if(obj.$sub){if(obj.$subopen)return"<div class='webix_tree_open webix_sub_open'></div>";else return"<div class='webix_tree_close webix_sub_close'></div>"}else return"<div class='webix_tree_none'></div>"};this.on_click.webix_sub_open=function(e,id){this.closeSub(id);return false};this.on_click.webix_sub_close=function(e,id){this.openSub(id);return false}},openSub:function(id){var obj=this.getItem(id);if(obj.$subopen)return;obj.$row=this._settings.subrow;obj.$subHeight=obj.$subHeight||this._settings.subRowHeight;obj.$subopen=true;var sub=this._subViewStorage[obj.$subContent];if(sub)sub.repaintMe=true;this.refresh(id);this.callEvent("onSubViewOpen",[id])},getSubView:function(id){var obj=this.getItem(id);if(obj){var sub=this._subViewStorage[obj.$subContent];if(sub)return webix.$$(sub)}return null},resizeSubView:function(id){var view=this.getSubView(id);if(view)this._resizeSubView(this.getItem(id),view)},_resizeSubView:function(obj,view){var height=view.$getSize(0,0)[2];var eheight=obj.$subHeight||this._settings.subRowHeight;var delta=Math.abs(height-(eheight||0));if(delta>2){obj.$subHeight=height;this.refresh(obj.id)}},_checkSubWidth:function(view){var width=view.$width;if(view._layout_sizes){var number=view._cells.length-view._hiddencells;if(view._vertical_orientation)width-=view._paddingX*2+2;else width-=view._margin*(number-1)+view._paddingX*2+number*2}return width>0},_render_sub_view:function(obj,row){var sub=this._subViewStorage[obj.$subContent],view;if(sub){row.firstChild.appendChild(sub);view=webix.$$(obj.$subContent);if(!this._checkSubWidth(view))view.adjust();if(sub.repaintMe){delete sub.repaintMe;view.config.hidden=false;view._render_hidden_views()}}else{view=webix.ui(webix.copy(this._settings.subview),row.firstChild);view.getMasterView=webix.bind(function(){return this},this);obj.$subContent=view.config.id;this._subViewStorage[obj.$subContent]=view.$view;view.attachEvent("onResize",webix.bind(function(w,h,wo,ho){if(h&&h!=ho)this.refresh(obj.id)},this));this.callEvent("onSubViewCreate",[view,obj])}this._resizeSubView(obj,view||webix.$$(sub))},_destroy_sub_view:function(id){var obj=this.getItem(id);var div=this._subViewStorage[obj.$subContent];if(div){delete obj.$subContent;var view=webix.$$(div);if(view&&view!=this)view.destructor()}},_adjustSubRowHeight:function(id,text){var d=webix.html.create("DIV",{class:"webix_measure_size webix_cell webix_dtable_subrow"},"");d.style.cssText="width:"+this._content_width+"px; height:auto; visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;";this.$view.appendChild(d);this.data.each(function(obj){if(obj&&!id||obj.id==id&&obj.$sub){d.innerHTML=text||this._settings.subrow(obj,this.type);obj.$subHeight=d.offsetHeight}},this);d=webix.html.remove(d)},closeSub:function(id){var obj=this.getItem(id);if(!obj.$subopen)return;obj.$row=false;obj.$subopen=false;var sub=this._subViewStorage[obj.$subContent];if(sub)webix.$$(sub).config.hidden=true;this.refresh(id);this.callEvent("onSubViewClose",[id])}});webix.extend(webix.ui.datatable,{headermenu_setter:function(value){if(value){if(value.data)this._preconfigured_hmenu=true;value=this._init_hmenu_once(value)}return value},_init_hmenu_once:function(value){var menuobj={view:"contextmenu",template:"<span class='webix_icon {common.hidden()}'></span> &nbsp; #value#",type:{hidden:function(obj){if(obj.hidden)return"fa-empty";else return"fa-eye"}},on:{onMenuItemClick:webix.bind(function(id,ev){var menu=webix.$$(this._settings.headermenu);var state=menu.getItem(id).hidden;menu.getItem(id).hidden=!state;menu.refresh(id);menu.$blockRender=true;if(state)this.showColumn(id);else this.hideColumn(id);menu.$blockRender=false;return false},this)},data:[]};if(typeof value=="object")webix.extend(menuobj,value,true);var menu=webix.ui(menuobj);menu.attachTo(this._header);this._destroy_with_me.push(menu);this.attachEvent("onStructureLoad",this._generate_menu_columns);this.attachEvent("onStructureUpdate",this._generate_menu_columns);this._init_hmenu_once=function(v){return v};return menu._settings.id},_generate_menu_columns:function(){var column,data,hidden,i;var menu=webix.$$(this._settings.headermenu);if(menu.$blockRender||this._preconfigured_hmenu)return;data=[];for(i=0;i<this._columns.length;i++){column=this._columns[i];var content=column.header[0];if(column.headermenu!==false&&content)data.push({id:column.id,value:content.groupText||content.text})}hidden=this.getState().hidden;for(i=hidden.length-1;i>=0;i--){column=this.getColumnConfig(hidden[i]);var content=column.header[0];if(column.headermenu!==false&&content)data.push({id:hidden[i],value:content.text,hidden:1})}if(data.length)menu.data.importData(data)}});webix.ui.datafilter.headerMenu={getValue:function(){},setValue:function(){},refresh:function(master,node,config){if(!master._settings.headermenu){master.define("headermenu",true);master._generate_menu_columns()}node.onclick=function(){webix.$$(master.config.headermenu).show(node)}},render:function(master,config){return"<span class='webix_icon fa-columns' role='button' tabindex='0' aria-label='"+webix.i18n.aria.headermenu+"'>"}};webix.ui.datafilter.richSelectFilter={getInputNode:function(node){return webix.$$(node.$webix)||null},getValue:function(node){var ui=this.getInputNode(node);return ui?ui.getValue():""},setValue:function(node,value){var ui=this.getInputNode(node);return ui?ui.setValue(value):""},compare:function(a,b){return a==b},refresh:function(master,node,value){if(master.$destructed)return;var select=webix.$$(value.richselect);if(!select.$view.parentNode){var d=webix.html.create("div",{class:"webix_richfilter"});d.appendChild(select.$view)}node.$webix=value.richselect;node.style.marginLeft="-10px";value.compare=value.compare||this.compare;value.prepare=value.prepare||this.prepare;master.registerFilter(node,value,this);var data;var options=value.options;if(options){if(typeof options=="string"){data=value.options=[];webix.ajax(options).then(webix.bind(function(data){value.options=data.json();var node=document.body.contains(node)?node:document.body.querySelector('[active_id="'+value.contentId+'"]');this.refresh(master,node,value)},this))}else data=options}else data=master.collectValues(value.columnId);var list=select.getPopup().getList();var optview=webix.$$(options);if(optview&&optview.data&&optview.data.getRange){data=optview.data.getRange()}node.firstChild.appendChild(select.$view.parentNode);if(list.parse){list.clearAll();list.parse(data);if(!this.$noEmptyOption&&value.emptyOption!==false||value.emptyOption){var emptyOption={id:"",value:value.emptyOption||"",$empty:true};list.add(emptyOption,0)}}if(value.value)this.setValue(node,value.value);select.render();webix.delay(select.resize,select)},render:function(master,config){if(!config.richselect){var d=webix.html.create("div",{class:"webix_richfilter"});var richconfig={container:d,view:this.inputtype,options:[]};var inputConfig=webix.extend(this.inputConfig||{},config.inputConfig||{},true);webix.extend(richconfig,inputConfig);if(config.separator)richconfig.separator=config.separator;if(config.suggest)richconfig.suggest=config.suggest;var richselect=webix.ui(richconfig);richselect.attachEvent("onChange",function(){master.filterByAll()});config.richselect=richselect._settings.id;master._destroy_with_me.push(richselect)}config.css="webix_div_filter";return" "},inputtype:"richselect"};webix.ui.datafilter.serverRichSelectFilter=webix.extend({$server:true},webix.ui.datafilter.richSelectFilter);webix.ui.datafilter.multiSelectFilter=webix.extend({$noEmptyOption:true,inputtype:"multiselect",prepare:function(value,filter){if(!value)return value;var hash={};var parts=value.toString().split(filter.separator||",");for(var i=0;i<parts.length;i++)hash[parts[i]]=1;return hash},compare:function(a,b){return!b||b[a]}},webix.ui.datafilter.richSelectFilter);webix.ui.datafilter.serverMultiSelectFilter=webix.extend({$server:true,_on_change:function(e,node,value){var id=this._comp_id;webix.$$(id).filterByAll()}},webix.ui.datafilter.multiSelectFilter);webix.ui.datafilter.multiComboFilter=webix.extend({inputtype:"multicombo",inputConfig:{tagMode:false}},webix.ui.datafilter.multiSelectFilter);webix.ui.datafilter.serverMultiComboFilter=webix.extend({inputtype:"multicombo",inputConfig:{tagMode:false}},webix.ui.datafilter.serverMultiSelectFilter);webix.ui.datafilter.datepickerFilter=webix.extend({prepare:function(value){return value||""},compare:function(a,b){return a*1==b*1},inputtype:"datepicker"},webix.ui.datafilter.richSelectFilter);webix.ui.datafilter.columnGroup={getValue:function(){},setValue:function(){},getHelper:function(node,config){return{open:function(){config.closed=true;node.onclick()},close:function(){config.closed=false;node.onclick()},isOpened:function(){return config.closed}}},refresh:function(master,node,config){node.onclick=function(e){webix.html.stopEvent(e);var mark=this.firstChild.firstChild;if(config.closed){config.closed=false;mark.className="webix_tree_open"}else{config.closed=true;mark.className="webix_tree_close"}webix.delay(function(){master.callEvent("onColumnGroupCollapse",[config.columnId,config.batch,!config.closed]);master.showColumnBatch(config.batch,!config.closed)})};if(!config.firstRun){config.firstRun=1;if(config.closed)master.showColumnBatch(config.batch,false)}},render:function(master,config){return"<div role='button' tabindex='0' aria-label='"+webix.i18n.aria[config.closed?"openGroup":"closeGroup"]+"' class='"+(config.closed?"webix_tree_close":"webix_tree_open")+"'></div>&nbsp;"+(config.groupText||"")}};webix.ui.datafilter.dateRangeFilter=webix.extend({prepare:function(value){return webix.ui.daterange.prototype._correct_value(value)},compare:function(a,b){return(!b.start||a>=b.start)&&(!b.end||a<=b.end)},inputtype:"daterangepicker"},webix.ui.datafilter.richSelectFilter);webix.ui.datafilter.serverDateRangeFilter=webix.extend({$server:true},webix.ui.datafilter.dateRangeFilter);webix.editors.$popup.multiselect={view:"multisuggest",suggest:{button:true}};webix.Canvas=webix.proto({$init:function(container){this._canvas_labels=[];this._canvas_series=!webix.isUndefined(container.series)?container.series:container.name;this._obj=webix.toNode(container.container||container);var width=container.width*(window.devicePixelRatio||1);var height=container.height*(window.devicePixelRatio||1);var style=container.style||"";style+=";width:"+container.width+"px;height:"+container.height+"px;";this._prepareCanvas(container.name,style,width,height)},_prepareCanvas:function(name,style,x,y){this._canvas=webix.html.create("canvas",{title:name,width:x,height:y,canvas_id:name,style:style||""});this._obj.appendChild(this._canvas);if(!this._canvas.getContext){if(webix.env.isIE){webix.require("legacy/excanvas/excanvas.js",true);G_vmlCanvasManager.init_(document);G_vmlCanvasManager.initElement(this._canvas)}else webix.assert(this._canvas.getContext,"Canvas is not supported in the browser")}return this._canvas},getCanvas:function(context){var ctx=(this._canvas||this._prepareCanvas(this._contentobj)).getContext(context||"2d");if(!this._webixDevicePixelRatio){this._webixDevicePixelRatio=true;ctx.scale(window.devicePixelRatio||1,window.devicePixelRatio||1)}return ctx},_resizeCanvas:function(x,y){if(this._canvas){this._canvas.setAttribute("width",x*(window.devicePixelRatio||1));this._canvas.setAttribute("height",y*(window.devicePixelRatio||1));this._canvas.style.width=x+"px";this._canvas.style.height=y+"px";this._webixDevicePixelRatio=false}},renderText:function(x,y,text,css,w){if(!text)return;if(w)w=Math.max(w,0);if(y)y=Math.max(y,0);var t=webix.html.create("DIV",{class:"webix_canvas_text"+(css?" "+css:""),style:"left:"+x+"px; top:"+y+"px;","aria-hidden":"true"},text);this._obj.appendChild(t);this._canvas_labels.push(t);if(w)t.style.width=w+"px";return t},renderTextAt:function(valign,align,x,y,t,c,w){var text=this.renderText.call(this,x,y,t,c,w);if(text){if(valign){if(valign=="middle")text.style.top=parseInt(y-text.offsetHeight/2,10)+"px";else text.style.top=y-text.offsetHeight+"px"}if(align){if(align=="left")text.style.left=x-text.offsetWidth+"px";else text.style.left=parseInt(x-text.offsetWidth/2,10)+"px"}}return text},clearCanvas:function(skipMap){var areas=[],i;webix.html.remove(this._canvas_labels);this._canvas_labels=[];if(!skipMap&&this._obj._htmlmap){areas=this._getMapAreas();while(areas.length){areas[0].parentNode.removeChild(areas[0]);areas.splice(0,1)}areas=null;if(!this._obj._htmlmap.getElementsByTagName("AREA").length){this._obj._htmlmap.parentNode.removeChild(this._obj._htmlmap);this._obj._htmlmap=null}}this.getCanvas().clearRect(0,0,this._canvas.offsetWidth,this._canvas.offsetHeight)},toggleCanvas:function(){this._toggleCanvas(this._canvas.style.display=="none")},showCanvas:function(){this._toggleCanvas(true)},hideCanvas:function(){this._toggleCanvas(false)},_toggleCanvas:function(show){var areas,i;for(i=0;i<this._canvas_labels.length;i++)this._canvas_labels[i].style.display=show?"":"none";if(this._obj._htmlmap){areas=this._getMapAreas();for(i=0;i<areas.length;i++){if(show)areas[i].removeAttribute("disabled");else areas[i].setAttribute("disabled","true")}}this._canvas.style.display=show?"":"none"},_getMapAreas:function(){var res=[],areas,i;areas=this._obj._htmlmap.getElementsByTagName("AREA");for(i=0;i<areas.length;i++){if(areas[i].getAttribute("userdata")==this._canvas_series){res.push(areas[i])}}return res}});webix.color={_toHex:["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],toHex:function(number,length){number=parseInt(number,10);var str="";while(number>0){str=this._toHex[number%16]+str;number=Math.floor(number/16)}while(str.length<length)str="0"+str;return str},hexToDec:function(hex){return parseInt(hex,16)},toRgb:function(rgb){var r,g,b,rgbArr;if(typeof rgb!="string"){r=rgb[0];g=rgb[1];b=rgb[2]}else if(rgb.indexOf("rgb")!=-1){rgbArr=rgb.substr(rgb.indexOf("(")+1,rgb.lastIndexOf(")")-rgb.indexOf("(")-1).split(",");r=rgbArr[0];g=rgbArr[1];b=rgbArr[2]}else{if(rgb.substr(0,1)=="#"){rgb=rgb.substr(1)}r=this.hexToDec(rgb.substr(0,2));g=this.hexToDec(rgb.substr(2,2));b=this.hexToDec(rgb.substr(4,2))}r=parseInt(r,10)||0;g=parseInt(g,10)||0;b=parseInt(b,10)||0;if(r<0||r>255)r=0;if(g<0||g>255)g=0;if(b<0||b>255)b=0;return[r,g,b]},hsvToRgb:function(h,s,v){var hi,f,p,q,t,r,g,b;hi=Math.floor(h/60)%6;f=h/60-hi;p=v*(1-s);q=v*(1-f*s);t=v*(1-(1-f)*s);r=0;g=0;b=0;switch(hi){case 0:r=v;g=t;b=p;break;case 1:r=q;g=v;b=p;break;case 2:r=p;g=v;b=t;break;case 3:r=p;g=q;b=v;break;case 4:r=t;g=p;b=v;break;case 5:r=v;g=p;b=q;break;default:break}r=Math.floor(r*255);g=Math.floor(g*255);b=Math.floor(b*255);return[r,g,b]},rgbToHsv:function(r,g,b){var r0,g0,b0,min0,max0,s,h,v;r0=r/255;g0=g/255;b0=b/255;min0=Math.min(r0,g0,b0);max0=Math.max(r0,g0,b0);h=0;s=max0===0?0:1-min0/max0;v=max0;if(max0==min0){h=0}else if(max0==r0&&g0>=b0){h=60*(g0-b0)/(max0-min0)+0}else if(max0==r0&&g0<b0){h=60*(g0-b0)/(max0-min0)+360}else if(max0==g0){h=60*(b0-r0)/(max0-min0)+120}else if(max0==b0){h=60*(r0-g0)/(max0-min0)+240}return[h,s,v]}};webix.HtmlMap=webix.proto({$init:function(key){this._id="map_"+webix.uid();this._key=key;this._map=[];this._areas=[]},addRect:function(id,points,userdata){this._createMapArea(id,"RECT",points,userdata)},addPoly:function(id,points,userdata){this._createMapArea(id,"POLY",points,userdata)},_createMapArea:function(id,shape,coords,userdata){var extra_data="";if(arguments.length==4)extra_data="userdata='"+userdata+"'";this._map.push("<area "+this._key+"='"+id+"' shape='"+shape+"' coords='"+coords.join()+"' "+extra_data+"></area>");this._areas.push({index:userdata,points:coords})},addSector:function(id,alpha0,alpha1,x,y,R,ky,userdata){var points=[];points.push(x);points.push(Math.floor(y*ky));for(var i=alpha0;i<alpha1;i+=Math.PI/18){points.push(Math.floor(x+R*Math.cos(i)));points.push(Math.floor((y+R*Math.sin(i))*ky))}points.push(Math.floor(x+R*Math.cos(alpha1)));points.push(Math.floor((y+R*Math.sin(alpha1))*ky));points.push(x);points.push(Math.floor(y*ky));return this.addPoly(id,points,userdata)},hide:function(obj,data,mode){if(obj.querySelectorAll){var nodes=obj.querySelectorAll('area[userdata="'+data+'"]');for(var i=0;i<nodes.length;i++)nodes[i].style.display=mode?"none":""}},render:function(obj){var d=webix.html.create("DIV");d.style.cssText="position:absolute; width:100%; height:100%; top:0px; left:0px;";obj.appendChild(d);var src=webix.env.isIE?"":"src='data:image/gif;base64,R0lGODlhEgASAIAAAP///////yH5BAUUAAEALAAAAAASABIAAAIPjI+py+0Po5y02ouz3pwXADs='";d.innerHTML="<map id='"+this._id+"' name='"+this._id+"'>"+this._map.join("\n")+"</map><img "+src+" class='webix_map_img' usemap='#"+this._id+"'>";obj._htmlmap=d;this._map=[]}});webix.protoUI({name:"chart",$init:function(config){this._series=[this._settings];this._legend_labels=[];this._contentobj.className+=" webix_chart";this.$ready.push(this._after_init_call);if(config.preset){this._definePreset(config)}if(config.series){var series=config.series;delete config.series;config.series=series}this.attachEvent("onMouseMove",this._switchSeries);this.data.provideApi(this,true)},_after_init_call:function(){this.data.attachEvent("onStoreUpdated",webix.bind(function(){this.render.apply(this,arguments)},this))},defaults:{ariaLabel:"chart",color:"default",alpha:"1",label:false,value:"{obj.value}",padding:{},type:"pie",lineColor:"#ffffff",cant:.5,barWidth:30,line:{width:2,color:"#1293f8"},item:{radius:3,borderColor:"#636363",borderWidth:1,color:"#ffffff",alpha:1,type:"r",shadow:false},shadow:true,gradient:false,border:true,labelOffset:20,origin:"auto",scale:"linear"},_id:"webix_area_id",on_click:{webix_chart_legend_item:function(e,id,obj){var series=obj.getAttribute("series_id");if(this.callEvent("onLegendClick",[e,series,obj])){var config=this._settings;var values=config.legend.values;var toggle=values&&values[series].toggle||config.legend.toggle;if(typeof series!="undefined"&&this._series.length>1){if(toggle){if(obj.className.indexOf("hidden")!=-1){this.showSeries(series)}else{this.hideSeries(series)}}}}}},on_dblclick:{},on_mouse_move:{},locate:function(e){return webix.html.locate(e,this._id)},$setSize:function(x,y){var res=webix.ui.view.prototype.$setSize.call(this,x,y);if(res){for(var c in this.canvases){this.canvases[c]._resizeCanvas(this._content_width,this._content_height)}this.render()}return res},type_setter:function(val){webix.assert(this["$render_"+val],"Chart type is not supported, or extension is not loaded: "+val);if(typeof this._settings.offset=="undefined"){this._settings.offset=!(val.toLowerCase().indexOf("area")!=-1)}if(val=="radar"&&!this._settings.yAxis)this.define("yAxis",{});if(val=="scatter"){if(!this._settings.yAxis)this.define("yAxis",{});if(!this._settings.xAxis)this.define("xAxis",{})}return val},destructor:function(){this.removeAllSeries();webix.Destruction.destructor.apply(this,arguments)},removeAllSeries:function(){this.clearCanvas();if(this._legendObj){this._legendObj.innerHTML="";this._legendObj.parentNode.removeChild(this._legendObj);this._legendObj=null}if(this.canvases){this.canvases={}}this._contentobj.innerHTML="";for(var i=0;i<this._series.length;i++){if(this._series[i].tooltip)this._series[i].tooltip.destructor()}this._series=[]},clearCanvas:function(){if(this.canvases&&typeof this.canvases=="object")for(var c in this.canvases){this.canvases[c].clearCanvas()}},render:function(id,data,type){var bounds,i,data,map,temp;if(!this.isVisible(this._settings.id))return;data=this._getChartData();if(!this.callEvent("onBeforeRender",[data,type]))return;if(this.canvases&&typeof this.canvases=="object"){for(i in this.canvases){this.canvases[i].clearCanvas()}}else this.canvases={};if(this._settings.legend){if(!this.canvases["legend"])this.canvases["legend"]=this._createCanvas("legend");this._drawLegend(this.data.getRange(),this._content_width,this._content_height)}this._map=map=new webix.HtmlMap(this._id);temp=this._settings;bounds=this._getChartBounds(this._content_width,this._content_height);if(this._series){for(i=0;i<this._series.length;i++){this._settings=this._series[i];if(!this.canvases[i])this.canvases[i]=this._createCanvas(this._settings.ariaLabel+" "+i,"z-index:"+(2+i),null,i);this["$render_"+this._settings.type](this.canvases[i].getCanvas(),data,bounds.start,bounds.end,i,map)}}map.render(this._contentobj);this._contentobj.lastChild.style.zIndex=100;this._applyBounds(this._contentobj.lastChild,bounds);this.callEvent("onAfterRender",[data]);this._settings=temp},_applyBounds:function(elem,bounds){var style={};style.left=bounds.start.x;style.top=bounds.start.y;style.width=bounds.end.x-bounds.start.x;style.height=bounds.end.y-bounds.start.y;for(var prop in style){elem.style[prop]=style[prop]+"px"}},_getChartData:function(){var axis,axisConfig,config,data,i,newData,start,units,value,valuesHash;data=this.data.getRange();axis=this._settings.type.toLowerCase().indexOf("barh")!=-1?"yAxis":"xAxis";axisConfig=this._settings[axis];if(axisConfig&&axisConfig.units&&typeof axisConfig.units=="object"){config=axisConfig.units;units=[];if(typeof config.start!="undefined"&&typeof config.end!="undefined"&&typeof config.next!="undefined"){start=config.start;while(start<=config.end){units.push(start);start=config.next.call(this,start)}}else if(Object.prototype.toString.call(config)==="[object Array]"){units=config}newData=[];if(units.length){value=axisConfig.value;valuesHash={};for(i=0;i<data.length;i++){valuesHash[value(data[i])]=i}for(i=0;i<units.length;i++){if(typeof valuesHash[units[i]]!="undefined"){data[valuesHash[units[i]]].$unit=units[i];newData.push(data[valuesHash[units[i]]])}else{newData.push({$unit:units[i]})}}}return newData}return data},series_setter:function(config){if(typeof config!="object"){webix.assert(config,"Chart :: Series must be an array or object")}else{this._parseSettings(!config.length?config:config[0]);this._series=[this._settings];for(var i=1;i<config.length;i++)this.addSeries(config[i])}return config},value_setter:webix.template,xValue_setter:webix.template,yValue_setter:function(config){this.define("value",config)},alpha_setter:webix.template,label_setter:webix.template,lineColor_setter:webix.template,borderColor_setter:webix.template,pieInnerText_setter:webix.template,gradient_setter:function(config){if(typeof config!="function"&&config&&config===true)config="light";return config},colormap:{RAINBOW:function(obj){var pos=Math.floor(this.getIndexById(obj.id)/this.count()*1536);if(pos==1536)pos-=1;return this._rainbow[Math.floor(pos/256)](pos%256)},default:function(obj){var count=this.count();var colorsCount=this._defColors.length;var i=this.getIndexById(obj.id);if(colorsCount>count){if(i){if(i<colorsCount-count)i=this._defColorsCursor+2;else i=this._defColorsCursor+1}this._defColorsCursor=i}else i=i%colorsCount;return this._defColors[i]}},color_setter:function(value){return this.colormap[value]||webix.template(value)},fill_setter:function(value){return!value||value=="0"?false:webix.template(value)},_definePreset:function(obj){this.define("preset",obj.preset);delete obj.preset},preset_setter:function(value){var a,b,preset;this.defaults=webix.extend({},this.defaults);preset=this.presets[value];if(typeof preset=="object"){for(a in preset){if(typeof preset[a]=="object"){if(!this.defaults[a]||typeof this.defaults[a]!="object"){this.defaults[a]=webix.extend({},preset[a])}else{this.defaults[a]=webix.extend({},this.defaults[a]);for(b in preset[a]){this.defaults[a][b]=preset[a][b]}}}else{this.defaults[a]=preset[a]}}return value}return false},legend_setter:function(config){if(!config){if(this._legendObj){this._legendObj.innerHTML="";this._legendObj=null}return false}if(typeof config!="object")config={template:config};this._mergeSettings(config,{width:150,height:18,layout:"y",align:"left",valign:"bottom",template:"",toggle:this._settings.type.toLowerCase().indexOf("stacked")!=-1?"":"hide",marker:{type:"square",width:15,height:15,radius:3},margin:4,padding:3});config.template=webix.template(config.template);return config},item_setter:function(config){if(typeof config!="object")config={color:config,borderColor:config};this._mergeSettings(config,webix.extend({},this.defaults.item));var settings=["alpha","borderColor","color","radius"];this._converToTemplate(settings,config);return config},line_setter:function(config){if(typeof config!="object")config={color:config};config=webix.extend(config,this.defaults.line);config.color=webix.template(config.color);return config},padding_setter:function(config){if(typeof config!="object")config={left:config,right:config,top:config,bottom:config};this._mergeSettings(config,{left:50,right:20,top:35,bottom:40});return config},xAxis_setter:function(config){if(!config)return false;if(typeof config!="object")config={template:config};this._mergeSettings(config,{title:"",color:"#000000",lineColor:"#cfcfcf",template:"{obj}",lines:true});var templates=["lineColor","template","lines"];this._converToTemplate(templates,config);this._configXAxis=webix.extend({},config);return config},yAxis_setter:function(config){this._mergeSettings(config,{title:"",color:"#000000",lineColor:"#cfcfcf",template:"{obj}",lines:true,bg:"#ffffff"});var templates=["lineColor","template","lines","bg"];this._converToTemplate(templates,config);this._configYAxis=webix.extend({},config);return config},_converToTemplate:function(arr,config){for(var i=0;i<arr.length;i++){config[arr[i]]=webix.template(config[arr[i]])}},_createCanvas:function(name,style,container,index){var params={container:container||this._contentobj,name:name,series:index,style:style||"",width:this._content_width,height:this._content_height};return new webix.Canvas(params)},_drawScales:function(data,point0,point1,start,end,cellWidth){var ctx,y=0;if(this._settings.yAxis){if(!this.canvases["y"])this.canvases["y"]=this._createCanvas("axis_y");y=this._drawYAxis(this.canvases["y"].getCanvas(),data,point0,point1,start,end)}if(this._settings.xAxis){if(!this.canvases["x"])this.canvases["x"]=this._createCanvas("axis_x");ctx=this.canvases["x"].getCanvas();if(this.callEvent("onBeforeXAxis",[ctx,data,point0,point1,cellWidth,y]))this._drawXAxis(ctx,data,point0,point1,cellWidth,y)}return y},_drawXAxis:function(ctx,data,point0,point1,cellWidth,y){var i,unitPos,config=this._settings,x0=point0.x-.5,y0=parseInt(y?y:point1.y,10)+.5,x1=point1.x,center=true,labelY=config.type=="stackedBar"?point1.y+.5:y0;for(i=0;i<data.length;i++){if(config.offset===true)unitPos=x0+cellWidth/2+i*cellWidth;else{unitPos=i==data.length-1&&!config.cellWidth?point1.x:x0+i*cellWidth;center=!!i}unitPos=Math.ceil(unitPos)-.5;var top=config.origin!="auto"&&config.type=="bar"&&parseFloat(config.value(data[i]))<config.origin;this._drawXAxisLabel(unitPos,labelY,data[i],center,top);if((config.offset||i||config.cellWidth)&&config.xAxis.lines.call(this,data[i]))this._drawXAxisLine(ctx,unitPos,point1.y,point0.y,data[i])}this.canvases["x"].renderTextAt(true,false,x0,point1.y+config.padding.bottom-3,config.xAxis.title,"webix_axis_title_x",point1.x-point0.x);this._drawLine(ctx,x0,y0,x1,y0,config.xAxis.color,1);if(!config.xAxis.lines.call(this,{})||!config.offset)return;this._drawLine(ctx,x1+.5,point1.y,x1+.5,point0.y+.5,config.xAxis.color,.2)},_drawYAxis:function(ctx,data,point0,point1,start,end){var step;var scaleParam={};if(!this._settings.yAxis)return;var x0=point0.x-.5;var y0=point1.y;var y1=point0.y;var lineX=point1.y+.5;if(this._settings.yAxis.step)step=parseFloat(this._settings.yAxis.step);if(typeof this._configYAxis.step=="undefined"||typeof this._configYAxis.start=="undefined"||typeof this._configYAxis.end=="undefined"){scaleParam=this._calculateScale(start,end);start=scaleParam.start;end=scaleParam.end;step=scaleParam.step;this._settings.yAxis.end=end;this._settings.yAxis.start=start}else if(this.config.scale=="logarithmic")this._logScaleCalc=true;this._setYAxisTitle(point0,point1);if(step===0)return;if(end==start){return y0}var stepHeight=(y0-y1)*step/(end-start);var c=0;for(var i=start;i<=end;i+=step){var value=this._logScaleCalc?Math.pow(10,i):i;if(scaleParam.fixNum)value=parseFloat(value).toFixed(scaleParam.fixNum);var yi=Math.floor(y0-c*stepHeight)+.5;if(!(i==start&&this._settings.origin=="auto")&&this._settings.yAxis.lines.call(this,i))this._drawLine(ctx,x0,yi,point1.x,yi,this._settings.yAxis.lineColor.call(this,i),1);if(i==this._settings.origin)lineX=yi;if(step<1&&!this._logScaleCalc){var power=Math.min(Math.floor(this._log10(step)),start<=0?0:Math.floor(this._log10(start)));var corr=Math.pow(10,-power);value=Math.round(value*corr)/corr;i=value}this.canvases["y"].renderText(0,yi-5,this._settings.yAxis.template(value.toString()),"webix_axis_item_y",point0.x-5);c++}this._drawLine(ctx,x0,y0+1,x0,y1,this._settings.yAxis.color,1);return lineX},_setYAxisTitle:function(point0,point1){var className="webix_axis_title_y"+(webix._isIE&&webix._isIE!=9?" webix_ie_filter":"");var text=this.canvases["y"].renderTextAt("middle",false,0,parseInt((point1.y-point0.y)/2+point0.y,10),this._settings.yAxis.title,className);if(text)text.style.left=(webix.env.transform?(text.offsetHeight-text.offsetWidth)/2:0)+"px"},_calculateLogScale:function(nmin,nmax){var startPower=Math.floor(this._log10(nmin));var endPower=Math.ceil(this._log10(nmax));return{start:startPower,step:1,end:endPower}},_normStep:function(step){var power=Math.floor(this._log10(step));var calculStep=Math.pow(10,power);var stepVal=step/calculStep;stepVal=stepVal>5?10:5;return parseInt(stepVal,10)*calculStep},_calculateScale:function(nmin,nmax){this._logScaleCalc=false;if(this._settings.scale=="logarithmic"){var logMin=Math.floor(this._log10(nmin));var logMax=Math.ceil(this._log10(nmax));if(nmin>0&&nmax>0&&logMax-logMin>1){this._logScaleCalc=true;return this._calculateLogScale(nmin,nmax)}}if(this._settings.origin!="auto"&&this._settings.origin<nmin)nmin=this._settings.origin;var step,start,end;step=this._normStep((nmax-nmin)/8||1);if(step>Math.abs(nmin))start=nmin<0?-step:0;else{var absNmin=Math.abs(nmin);var powerStart=Math.floor(this._log10(absNmin));var nminVal=absNmin/Math.pow(10,powerStart);start=Math.ceil(nminVal*10)/10*Math.pow(10,powerStart)-step;if(absNmin>1&&step>.1){start=Math.ceil(start)}while(nmin<0?start<=nmin:start>=nmin)start-=step;if(nmin<0)start=-start-2*step}if(nmax-start>10)step=this._normStep((nmax-start)/8||1);end=start;while(end<nmax){end+=step;end=parseFloat((end*1).toFixed(Math.abs(power)))}var power=Math.floor(this._log10(step));return{start:start,end:end,step:step,fixNum:power<0?Math.abs(power):0}},_getLimits:function(orientation,value){var data=this.data._obj_array();var maxValue,minValue;var axis=arguments.length&&orientation=="h"?this._configXAxis:this._configYAxis;value=value||"value";if(axis&&typeof axis.end!="undefined"&&typeof axis.start!="undefined"&&axis.step){maxValue=parseFloat(axis.end);minValue=parseFloat(axis.start)}else{maxValue=webix.GroupMethods.max(this._series[0][value],data);minValue=axis&&typeof axis.start!="undefined"?parseFloat(axis.start):webix.GroupMethods.min(this._series[0][value],data);if(this._series.length>1)for(var i=1;i<this._series.length;i++){var maxI=webix.GroupMethods.max(this._series[i][value],data);var minI=webix.GroupMethods.min(this._series[i][value],data);if(maxI>maxValue)maxValue=maxI;if(minI<minValue)minValue=minI}}return{max:maxValue,min:minValue}},_log10:function(n){var method_name="log";return Math[method_name](n)/Math.LN10},_drawXAxisLabel:function(x,y,obj,center,top){if(!this._settings.xAxis)return;var elem=this.canvases["x"].renderTextAt(top,center,x,y-(top?2:0),this._settings.xAxis.template(obj));if(elem)elem.className+=" webix_axis_item_x"},_drawXAxisLine:function(ctx,x,y1,y2,obj){if(!this._settings.xAxis||!this._settings.xAxis.lines)return;this._drawLine(ctx,x,y1,x,y2,this._settings.xAxis.lineColor.call(this,obj),1)},_drawLine:function(ctx,x1,y1,x2,y2,color,width){ctx.strokeStyle=color;ctx.lineWidth=width;ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke();ctx.lineWidth=1},_getRelativeValue:function(minValue,maxValue){var relValue,origRelValue;var valueFactor=1;if(maxValue!=minValue){relValue=maxValue-minValue}else relValue=minValue;return[relValue,valueFactor]},_rainbow:[function(pos){return"#FF"+webix.color.toHex(pos/2,2)+"00"},function(pos){return"#FF"+webix.color.toHex(pos/2+128,2)+"00"},function(pos){return"#"+webix.color.toHex(255-pos,2)+"FF00"},function(pos){return"#00FF"+webix.color.toHex(pos,2)},function(pos){return"#00"+webix.color.toHex(255-pos,2)+"FF"},function(pos){return"#"+webix.color.toHex(pos,2)+"00FF"}],_defColors:["#f55b50","#ff6d3f","#ffa521","#ffc927","#ffee54","#d3e153","#9acb61","#63b967","#21a497","#21c5da","#3ea4f5","#5868bf","#7b53c0","#a943ba","#ec3b77","#9eb0b8"],_defColorsCursor:0,addSeries:function(obj){var temp=webix.extend({},this._settings);this._settings=webix.extend({},temp);this._parseSettings(obj,{});this._series.push(this._settings);this._settings=temp},_switchSeries:function(id,e,tag){var tip;if(!tag.getAttribute("userdata"))return;this._active_serie=this._series.length==1?tag.getAttribute("userdata"):this._getActiveSeries(e);if(!this._series[this._active_serie])return;for(var i=0;i<this._series.length;i++){tip=this._series[i].tooltip;if(tip)tip.disable()}if(!tag.getAttribute("disabled")){tip=this._series[this._active_serie].tooltip;if(tip)tip.enable()}},_getActiveSeries:function(e){var a,areas,i,offset,pos,selection,x,y;areas=this._map._areas;offset=webix.html.offset(this._contentobj._htmlmap);pos=webix.html.pos(e);x=pos.x-offset.x;y=pos.y-offset.y;for(i=0;i<areas.length;i++){a=areas[i].points;if(x<=a[2]&&x>=a[0]&&y<=a[3]&&y>=a[1]){if(selection){if(areas[i].index>selection.index)selection=areas[i]}else selection=areas[i]}}return selection?selection.index:0},hideSeries:function(series){this.canvases[series].hideCanvas();var legend=this._settings.legend;if(legend&&legend.values&&legend.values[series]){legend.values[series].$hidden=true;this._drawLegend()}this._map.hide(this._contentobj,series,true)},showSeries:function(series){this.canvases[series].showCanvas();var legend=this._settings.legend;if(legend&&legend.values&&legend.values[series]){delete legend.values[series].$hidden;this._drawLegend()}this._map.hide(this._contentobj,series,false)},_drawLegend:function(data,width){var i,legend,legendContainer,legendHeight,legendItems,legendWidth,style,x=0,y=0,ctx,itemColor,disabled,item;data=data||[];width=width||this._content_width;ctx=this.canvases["legend"].getCanvas();legend=this._settings.legend;style=this._settings.legend.layout!="x"?"width:"+legend.width+"px":"";if(this._legendObj){this._legendObj.innerHTML="";this._legendObj.parentNode.removeChild(this._legendObj)}this.canvases["legend"].clearCanvas(true);legendContainer=webix.html.create("DIV",{class:"webix_chart_legend",style:"left:"+x+"px; top:"+y+"px;"+style},"");if(legend.padding){legendContainer.style.padding=legend.padding+"px"}this._legendObj=legendContainer;this._contentobj.appendChild(legendContainer);legendItems=[];if(!legend.values)for(i=0;i<data.length;i++){legendItems.push(this._drawLegendText(legendContainer,legend.template(data[i])))}else for(i=0;i<legend.values.length;i++){legendItems.push(this._drawLegendText(legendContainer,legend.values[i].text,typeof legend.values[i].id!="undefined"?typeof legend.values[i].id:i,legend.values[i].$hidden))}if(legendContainer.offsetWidth===0)legendContainer.style.width="auto";legendWidth=legendContainer.offsetWidth;legendHeight=legendContainer.offsetHeight;if(legendWidth<width){if(legend.layout=="x"&&legend.align=="center"){x=(width-legendWidth)/2}if(legend.align=="right"){x=width-legendWidth}if(legend.margin&&legend.align!="center"){x+=(legend.align=="left"?1:-1)*legend.margin}}if(legendHeight<this._content_height){if(legend.valign=="middle"&&legend.align!="center"&&legend.layout!="x")y=(this._content_height-legendHeight)/2;else if(legend.valign=="bottom")y=this._content_height-legendHeight;if(legend.margin&&legend.valign!="middle"){y+=(legend.valign=="top"?1:-1)*legend.margin}}legendContainer.style.left=x+"px";legendContainer.style.top=y+"px";ctx.save();for(i=0;i<legendItems.length;i++){item=legendItems[i];if(legend.values&&legend.values[i].$hidden){disabled=true;itemColor=legend.values[i].disableColor?legend.values[i].disableColor:"#d9d9d9"}else{disabled=false;itemColor=legend.values?legend.values[i].color:this._settings.color.call(this,data[i])}this._drawLegendMarker(ctx,item.offsetLeft+x,item.offsetTop+y,itemColor,item.offsetHeight,disabled,i)}ctx.restore();legendItems=null},_drawLegendText:function(cont,value,series,disabled){var style="";if(this._settings.legend.layout=="x")style="float:left;";var text=webix.html.create("DIV",{style:style+"padding-left:"+(10+this._settings.legend.marker.width)+"px",class:"webix_chart_legend_item"+(disabled?" hidden":""),role:"button",tabindex:"0","aria-label":webix.i18n.aria[(disabled?"show":"hide")+"Chart"]+" "+value},value);if(arguments.length>2)text.setAttribute("series_id",series);cont.appendChild(text);return text},_drawLegendMarker:function(ctx,x,y,color,height,disabled,i){var p=[];var marker=this._settings.legend.marker;var values=this._settings.legend.values;var type=values&&values[i].markerType?values[i].markerType:marker.type;if(color){ctx.strokeStyle=ctx.fillStyle=color}if(type=="round"||!marker.radius){ctx.beginPath();ctx.lineWidth=marker.height;ctx.lineCap=marker.type;x+=ctx.lineWidth/2+5;y+=height/2;ctx.moveTo(x,y);var x1=x+marker.width-marker.height+1;ctx.lineTo(x1,y);ctx.stroke();ctx.fill()}else if(type=="item"){if(this._settings.line&&this._settings.type!="scatter"&&!this._settings.disableLines){ctx.beginPath();ctx.lineWidth=this._series[i].line.width;ctx.strokeStyle=disabled?color:this._series[i].line.color.call(this,{});var x0=x+5;var y0=y+height/2;ctx.moveTo(x0,y0);var x1=x0+marker.width;ctx.lineTo(x1,y0);ctx.stroke()}var config=this._series[i].item;var radius=parseInt(config.radius.call(this,{}),10)||0;if(radius){ctx.beginPath();if(disabled){ctx.lineWidth=config.borderWidth;ctx.strokeStyle=color;ctx.fillStyle=color}else{ctx.lineWidth=config.borderWidth;ctx.fillStyle=config.color.call(this,{});ctx.strokeStyle=config.borderColor.call(this,{});ctx.globalAlpha=config.alpha.call(this,{})}ctx.beginPath();x+=marker.width/2+5;y+=height/2;this._strokeChartItem(ctx,x,y,radius+1,config.type);ctx.fill();ctx.stroke()}ctx.globalAlpha=1}else{ctx.beginPath();ctx.lineWidth=1;x+=5;y+=height/2-marker.height/2;p=[[x+marker.radius,y+marker.radius,marker.radius,Math.PI,3*Math.PI/2,false],[x+marker.width-marker.radius,y],[x+marker.width-marker.radius,y+marker.radius,marker.radius,-Math.PI/2,0,false],[x+marker.width,y+marker.height-marker.radius],[x+marker.width-marker.radius,y+marker.height-marker.radius,marker.radius,0,Math.PI/2,false],[x+marker.radius,y+marker.height],[x+marker.radius,y+marker.height-marker.radius,marker.radius,Math.PI/2,Math.PI,false],[x,y+marker.radius]];this._path(ctx,p);ctx.stroke();ctx.fill()}},_getChartBounds:function(width,height){var chartX0,chartY0,chartX1,chartY1;chartX0=this._settings.padding.left;chartY0=this._settings.padding.top;chartX1=width-this._settings.padding.right;chartY1=height-this._settings.padding.bottom;if(this._settings.legend){var legend=this._settings.legend;var legendWidth=this._settings.legend.width;var legendHeight=this._settings.legend.height;if(legend.layout=="x"){if(legend.valign=="center"){if(legend.align=="right")chartX1-=legendWidth;else if(legend.align=="left")chartX0+=legendWidth}else if(legend.valign=="bottom"){chartY1-=legendHeight}else{chartY0+=legendHeight}}else{if(legend.align=="right")chartX1-=legendWidth;else if(legend.align=="left")chartX0+=legendWidth}}return{start:{x:chartX0,y:chartY0},end:{x:chartX1,y:chartY1}}},_getStackedLimits:function(data){var i,j,maxValue,minValue,value;if(this._settings.yAxis&&typeof this._settings.yAxis.end!="undefined"&&typeof this._settings.yAxis.start!="undefined"&&this._settings.yAxis.step){maxValue=parseFloat(this._settings.yAxis.end);minValue=parseFloat(this._settings.yAxis.start)}else{for(i=0;i<data.length;i++){data[i].$sum=0;data[i].$min=Infinity;for(j=0;j<this._series.length;j++){value=Math.abs(parseFloat(this._series[j].value(data[i])||0));if(isNaN(value))continue;if(this._series[j].type.toLowerCase().indexOf("stacked")!=-1)data[i].$sum+=value;if(value<data[i].$min)data[i].$min=value}}maxValue=-Infinity;minValue=Infinity;for(i=0;i<data.length;i++){if(data[i].$sum>maxValue)maxValue=data[i].$sum;if(data[i].$min<minValue)minValue=data[i].$min}if(minValue>0)minValue=0}return{max:maxValue,min:minValue}},_setBarGradient:function(ctx,x1,y1,x2,y2,type,color,axis){var gradient,offset,rgb,hsv,color0,stops;if(type=="light"){if(axis=="x")gradient=ctx.createLinearGradient(x1,y1,x2,y1);else gradient=ctx.createLinearGradient(x1,y1,x1,y2);stops=[[0,"#FFFFFF"],[.9,color],[1,color]];offset=2}else if(type=="falling"||type=="rising"){if(axis=="x")gradient=ctx.createLinearGradient(x1,y1,x2,y1);else gradient=ctx.createLinearGradient(x1,y1,x1,y2);rgb=webix.color.toRgb(color);hsv=webix.color.rgbToHsv(rgb[0],rgb[1],rgb[2]);hsv[1]*=1/2;color0="rgb("+webix.color.hsvToRgb(hsv[0],hsv[1],hsv[2])+")";if(type=="falling"){stops=[[0,color0],[.7,color],[1,color]]}else if(type=="rising"){stops=[[0,color],[.3,color],[1,color0]]}offset=0}else{ctx.globalAlpha=.37;offset=0;if(axis=="x")gradient=ctx.createLinearGradient(x1,y2,x1,y1);else gradient=ctx.createLinearGradient(x1,y1,x2,y1);stops=[[0,"#9d9d9d"],[.3,"#e8e8e8"],[.45,"#ffffff"],[.55,"#ffffff"],[.7,"#e8e8e8"],[1,"#9d9d9d"]]}this._gradient(gradient,stops);return{gradient:gradient,offset:offset}},_getPositionByAngle:function(a,x,y,r){a*=-1;x=x+Math.cos(a)*r;y=y-Math.sin(a)*r;return{x:x,y:y}},_gradient:function(gradient,stops){for(var i=0;i<stops.length;i++){gradient.addColorStop(stops[i][0],stops[i][1])}},_path:function(ctx,points){var i,method;for(i=0;i<points.length;i++){method=i?"lineTo":"moveTo";if(points[i].length>2)method="arc";ctx[method].apply(ctx,points[i])}},_addMapRect:function(map,id,points,bounds,sIndex){map.addRect(id,[points[0].x-bounds.x,points[0].y-bounds.y,points[1].x-bounds.x,points[1].y-bounds.y],sIndex)}},webix.Group,webix.AutoTooltip,webix.DataLoader,webix.MouseEvents,webix.EventSystem,webix.ui.view);webix.extend(webix.ui.chart,{$render_pie:function(ctx,data,x,y,sIndex,map){this._renderPie(ctx,data,x,y,1,map,sIndex)},_renderPie:function(ctx,data,point0,point1,ky,map,sIndex){if(!data.length)return;var coord=this._getPieParameters(point0,point1);var radius=this._settings.radius?this._settings.radius:coord.radius;if(radius<0)return;var values=this._getValues(data);var totalValue=this._getTotalValue(values);var ratios=this._getRatios(values,totalValue);var x0=this._settings.x?this._settings.x:coord.x;var y0=this._settings.y?this._settings.y:coord.y;if(ky==1&&this._settings.shadow)this._addShadow(ctx,x0,y0,radius);y0=y0/ky;var alpha0=-Math.PI/2;var angles=[];ctx.scale(1,ky);if(this._settings.gradient){var x1=ky!=1?x0+radius/3:x0;var y1=ky!=1?y0+radius/3:y0;this._showRadialGradient(ctx,x0,y0,radius,x1,y1)}for(var i=0;i<data.length;i++){if(!values[i])continue;ctx.strokeStyle=this._settings.lineColor.call(this,data[i]);ctx.beginPath();ctx.moveTo(x0,y0);angles.push(alpha0);var alpha1=-Math.PI/2+ratios[i]-1e-4;ctx.arc(x0,y0,radius,alpha0,alpha1,false);ctx.lineTo(x0,y0);var color=this._settings.color.call(this,data[i]);ctx.fillStyle=color;ctx.fill();if(this._settings.pieInnerText)this._drawSectorLabel(x0,y0,5*radius/6,alpha0,alpha1,ky,this._settings.pieInnerText(data[i],totalValue),true);if(this._settings.label)this._drawSectorLabel(x0,y0,radius+this._settings.labelOffset,alpha0,alpha1,ky,this._settings.label(data[i]));if(ky!=1){this._createLowerSector(ctx,x0,y0,alpha0,alpha1,radius,true);ctx.fillStyle="#000000";ctx.globalAlpha=.2;this._createLowerSector(ctx,x0,y0,alpha0,alpha1,radius,false);ctx.globalAlpha=1;ctx.fillStyle=color}map.addSector(data[i].id,alpha0,alpha1,x0-point0.x,y0-point0.y/ky,radius,ky,sIndex);alpha0=alpha1}ctx.globalAlpha=.8;var p;for(i=0;i<angles.length;i++){p=this._getPositionByAngle(angles[i],x0,y0,radius);this._drawLine(ctx,x0,y0,p.x,p.y,this._settings.lineColor.call(this,data[i]),2)}if(ky==1){ctx.lineWidth=2;ctx.strokeStyle="#ffffff";ctx.beginPath();ctx.arc(x0,y0,radius+1,0,2*Math.PI,false);ctx.stroke()}ctx.globalAlpha=1;ctx.scale(1,1/ky)},_getValues:function(data){var v=[];for(var i=0;i<data.length;i++)v.push(Math.abs(parseFloat(this._settings.value(data[i])||0)));return v},_getTotalValue:function(values){var t=0;for(var i=0;i<values.length;i++)t+=values[i];return t},_getRatios:function(values,totalValue){var value;var ratios=[];var prevSum=0;totalValue=totalValue||this._getTotalValue(values);for(var i=0;i<values.length;i++){value=values[i];ratios[i]=Math.PI*2*(totalValue?(value+prevSum)/totalValue:1/values.length);prevSum+=value}return ratios},_getPieParameters:function(point0,point1){var width=point1.x-point0.x;var height=point1.y-point0.y;var x0=point0.x+width/2;var y0=point0.y+height/2;var radius=Math.min(width/2,height/2);return{x:x0,y:y0,radius:radius}},_createLowerSector:function(ctx,x0,y0,a1,a2,R,line){ctx.lineWidth=1;if(!(a1<=0&&a2>=0||a1>=0&&a2<=Math.PI||Math.abs(a1-Math.PI)>.003&&a1<=Math.PI&&a2>=Math.PI))return;if(a1<=0&&a2>=0){a1=0;line=false;this._drawSectorLine(ctx,x0,y0,R,a1,a2)}if(a1<=Math.PI&&a2>=Math.PI){a2=Math.PI;line=false;this._drawSectorLine(ctx,x0,y0,R,a1,a2)}var offset=(this._settings.pieHeight||Math.floor(R/4))/this._settings.cant;ctx.beginPath();ctx.arc(x0,y0,R,a1,a2,false);ctx.lineTo(x0+R*Math.cos(a2),y0+R*Math.sin(a2)+offset);ctx.arc(x0,y0+offset,R,a2,a1,true);ctx.lineTo(x0+R*Math.cos(a1),y0+R*Math.sin(a1));ctx.fill();if(line)ctx.stroke()},_drawSectorLine:function(ctx,x0,y0,R,a1,a2){ctx.beginPath();ctx.arc(x0,y0,R,a1,a2,false);ctx.stroke()},_addShadow:function(ctx,x,y,R){ctx.globalAlpha=.5;var shadows=["#c4c4c4","#c6c6c6","#cacaca","#dcdcdc","#dddddd","#e0e0e0","#eeeeee","#f5f5f5","#f8f8f8"];for(var i=shadows.length-1;i>-1;i--){ctx.beginPath();ctx.fillStyle=shadows[i];ctx.arc(x+1,y+1,R+i,0,Math.PI*2,true);ctx.fill()}ctx.globalAlpha=1},_getGrayGradient:function(gradient){gradient.addColorStop(0,"#ffffff");gradient.addColorStop(.7,"#7a7a7a");gradient.addColorStop(1,"#000000");return gradient},_showRadialGradient:function(ctx,x,y,radius,x0,y0){ctx.beginPath();var gradient;if(typeof this._settings.gradient!="function"){gradient=ctx.createRadialGradient(x0,y0,radius/4,x,y,radius);gradient=this._getGrayGradient(gradient)}else gradient=this._settings.gradient(gradient);ctx.fillStyle=gradient;ctx.arc(x,y,radius,0,Math.PI*2,true);ctx.fill();ctx.globalAlpha=.7},_drawSectorLabel:function(x0,y0,R,alpha1,alpha2,ky,text,in_width){var t=this.canvases[0].renderText(0,0,text,0,1);if(!t)return;var labelWidth=t.scrollWidth;t.style.width=labelWidth+"px";if(labelWidth>x0)labelWidth=x0;var width=alpha2-alpha1<.2?4:8;if(in_width)width=labelWidth/1.8;var alpha=alpha1+(alpha2-alpha1)/2;R=R-(width-8)/2;var corr_x=-width;var corr_y=-8;var align="right";if(alpha>=Math.PI/2&&alpha<Math.PI||alpha<=3*Math.PI/2&&alpha>=Math.PI){corr_x=-labelWidth-corr_x+1;align="left"}var offset=0;if(!in_width&&ky<1&&(alpha>0&&alpha<Math.PI))offset=(this._settings.height||Math.floor(R/4))/ky;var y=(y0+Math.floor((R+offset)*Math.sin(alpha)))*ky+corr_y;var x=x0+Math.floor((R+width/2)*Math.cos(alpha))+corr_x;var left_end=alpha2<Math.PI/2+.01;var left_start=alpha1<Math.PI/2;if(left_start&&left_end){x=Math.max(x,x0+3)}else if(!left_start&&!left_end)x=Math.min(x,x0-labelWidth);else if(!in_width&&(alpha>=Math.PI/2&&alpha<Math.PI||alpha<=3*Math.PI/2&&alpha>=Math.PI)){x+=labelWidth/3}t.style.top=y+"px";t.style.left=x+"px";t.style.width=labelWidth+"px";t.style.textAlign=align;t.style.whiteSpace="nowrap"},$render_pie3D:function(ctx,data,x,y,sIndex,map){this._renderPie(ctx,data,x,y,this._settings.cant,map)},$render_donut:function(ctx,data,point0,point1,sIndex,map){if(!data.length)return;this._renderPie(ctx,data,point0,point1,1,map,sIndex);var config=this._settings;var coord=this._getPieParameters(point0,point1);var pieRadius=config.radius?config.radius:coord.radius;var innerRadius=config.innerRadius&&config.innerRadius<pieRadius?config.innerRadius:pieRadius/3;var x0=config.x?config.x:coord.x;var y0=config.y?config.y:coord.y;ctx.fillStyle="#ffffff";ctx.beginPath();ctx.arc(x0,y0,innerRadius,0,Math.PI*2,true);ctx.fill()}});webix.extend(webix.ui.chart,{$render_bar:function(ctx,data,point0,point1,sIndex,map){var barWidth,cellWidth,i,limits,maxValue,minValue,relValue,valueFactor,relativeValues,startValue,unit,xax,yax,totalHeight=point1.y-point0.y;yax=!!this._settings.yAxis;xax=!!this._settings.xAxis;limits=this._getLimits();maxValue=limits.max;minValue=limits.min;cellWidth=(point1.x-point0.x)/data.length;if(!sIndex&&!(this._settings.origin!="auto"&&!yax)){this._drawScales(data,point0,point1,minValue,maxValue,cellWidth)}if(yax){maxValue=parseFloat(this._settings.yAxis.end);minValue=parseFloat(this._settings.yAxis.start)}relativeValues=this._getRelativeValue(minValue,maxValue);relValue=relativeValues[0];valueFactor=relativeValues[1];unit=relValue?totalHeight/relValue:relValue;if(!yax&&!(this._settings.origin!="auto"&&xax)){startValue=10;unit=relValue?(totalHeight-startValue)/relValue:startValue}if(!sIndex&&(this._settings.origin!="auto"&&!yax)&&this._settings.origin>minValue){this._drawXAxis(ctx,data,point0,point1,cellWidth,point1.y-unit*(this._settings.origin-minValue))}barWidth=parseInt(this._settings.barWidth,10);var seriesNumber=0;var seriesIndex=0;for(i=0;i<this._series.length;i++){if(i==sIndex){seriesIndex=seriesNumber}if(this._series[i].type=="bar")seriesNumber++}if(this._series&&barWidth*seriesNumber+4>cellWidth)barWidth=parseInt(cellWidth/seriesNumber-4,10);var barOffset=(cellWidth-barWidth*seriesNumber)/2;var radius=typeof this._settings.radius!="undefined"?parseInt(this._settings.radius,10):Math.round(barWidth/5);var inner_gradient=false;var gradient=this._settings.gradient;if(gradient&&typeof gradient!="function"){inner_gradient=gradient;gradient=false}else if(gradient){gradient=ctx.createLinearGradient(0,point1.y,0,point0.y);this._settings.gradient(gradient)}if(!xax){this._drawLine(ctx,point0.x,point1.y+.5,point1.x,point1.y+.5,"#000000",1)}for(i=0;i<data.length;i++){var value=parseFloat(this._settings.value(data[i])||0);if(this._logScaleCalc)value=this._log10(value);if(!value||isNaN(value))continue;if(value>maxValue)value=maxValue;value-=minValue;value*=valueFactor;var x0=point0.x+barOffset+i*cellWidth+(barWidth+1)*seriesIndex;var y0=point1.y;if(value<0||this._settings.yAxis&&value===0&&!(this._settings.origin!="auto"&&this._settings.origin>minValue)){this.canvases[sIndex].renderTextAt(true,true,x0+Math.floor(barWidth/2),y0,this._settings.label(data[i]));continue}if(!yax&&!(this._settings.origin!="auto"&&xax))value+=startValue/unit;var color=gradient||this._settings.color.call(this,data[i]);ctx.globalAlpha=this._settings.alpha.call(this,data[i]);var points=this._drawBar(ctx,point0,x0,y0,barWidth,minValue,radius,unit,value,color,gradient,inner_gradient);if(inner_gradient){this._drawBarGradient(ctx,x0,y0,barWidth,minValue,radius,unit,value,color,inner_gradient)}if(this._settings.border)this._drawBarBorder(ctx,x0,y0,barWidth,minValue,radius,unit,value,color);ctx.globalAlpha=1;if(points[0]!=x0)this.canvases[sIndex].renderTextAt(false,true,x0+Math.floor(barWidth/2),points[1],this._settings.label(data[i]));else this.canvases[sIndex].renderTextAt(true,true,x0+Math.floor(barWidth/2),points[3],this._settings.label(data[i]));map.addRect(data[i].id,[x0-point0.x,points[3]-point0.y,points[2]-point0.x,points[1]-point0.y],sIndex)}},_correctBarParams:function(ctx,x,y,value,unit,barWidth,minValue){var xax=this._settings.xAxis;var axisStart=y;if(!!xax&&this._settings.origin!="auto"&&this._settings.origin>minValue){y-=(this._settings.origin-minValue)*unit;axisStart=y;value=value-(this._settings.origin-minValue);if(value<0){value*=-1;ctx.translate(x+barWidth,y);ctx.rotate(Math.PI);x=0;y=0}y-=.5}return{value:value,x0:x,y0:y,start:axisStart}},_drawBar:function(ctx,point0,x0,y0,barWidth,minValue,radius,unit,value,color,gradient,inner_gradient){ctx.save();ctx.fillStyle=color;var p=this._correctBarParams(ctx,x0,y0,value,unit,barWidth,minValue);var points=this._setBarPoints(ctx,p.x0,p.y0,barWidth,radius,unit,p.value,this._settings.border?1:0);if(gradient&&!inner_gradient)ctx.lineTo(p.x0+(this._settings.border?1:0),point0.y);ctx.fill();ctx.restore();var x1=p.x0;var x2=p.x0!=x0?x0+points[0]:points[0];var y1=p.x0!=x0?p.start-points[1]-p.y0:p.y0;var y2=p.x0!=x0?p.start-p.y0:points[1];return[x1,y1,x2,y2]},_setBorderStyles:function(ctx,color){var hsv,rgb;rgb=webix.color.toRgb(color);hsv=webix.color.rgbToHsv(rgb[0],rgb[1],rgb[2]);hsv[2]/=1.4;color="rgb("+webix.color.hsvToRgb(hsv[0],hsv[1],hsv[2])+")";ctx.strokeStyle=color;if(ctx.globalAlpha==1)ctx.globalAlpha=.9},_drawBarBorder:function(ctx,x0,y0,barWidth,minValue,radius,unit,value,color){var p;ctx.save();p=this._correctBarParams(ctx,x0,y0,value,unit,barWidth,minValue);this._setBorderStyles(ctx,color);this._setBarPoints(ctx,p.x0,p.y0,barWidth,radius,unit,p.value,ctx.lineWidth/2,1);ctx.stroke();ctx.restore()},_drawBarGradient:function(ctx,x0,y0,barWidth,minValue,radius,unit,value,color,inner_gradient){ctx.save();var p=this._correctBarParams(ctx,x0,y0,value,unit,barWidth,minValue);var gradParam=this._setBarGradient(ctx,p.x0,p.y0,p.x0+barWidth,p.y0-unit*p.value+2,inner_gradient,color,"y");var borderOffset=this._settings.border?1:0;ctx.fillStyle=gradParam.gradient;this._setBarPoints(ctx,p.x0+gradParam.offset,p.y0,barWidth-gradParam.offset*2,radius,unit,p.value,gradParam.offset+borderOffset);ctx.fill();ctx.restore()},_setBarPoints:function(ctx,x0,y0,barWidth,radius,unit,value,offset,skipBottom){ctx.beginPath();var angle_corr=0;if(radius>unit*value){var cosA=(radius-unit*value)/radius;if(cosA<=1&&cosA>=-1)angle_corr=-Math.acos(cosA)+Math.PI/2}ctx.moveTo(x0+offset,y0);var y1=y0-Math.floor(unit*value)+radius+(radius?0:offset);if(radius<unit*value)ctx.lineTo(x0+offset,y1);var x2=x0+radius;if(radius&&radius>0)ctx.arc(x2,y1,Math.max(radius-offset,0),-Math.PI+angle_corr,-Math.PI/2,false);var x3=x0+barWidth-radius-offset;var y3=y1-radius+(radius?offset:0);ctx.lineTo(x3,y3);if(radius&&radius>0)ctx.arc(x3+offset,y1,Math.max(radius-offset,0),-Math.PI/2,0-angle_corr,false);var x5=x0+barWidth-offset;ctx.lineTo(x5,y0);if(!skipBottom){ctx.lineTo(x0+offset,y0)}return[x5,y3]}});webix.extend(webix.ui.chart,{$render_line:function(ctx,data,point0,point1,sIndex,map){var config,i,items,params,x0,x1,x2,y1,y2,y0,res1,res2;params=this._calculateLineParams(ctx,data,point0,point1,sIndex);config=this._settings;if(data.length){x0=config.offset?point0.x+params.cellWidth*.5:point0.x;items=[];for(i=0;i<data.length;i++){res2=this._getPointY(data[i],point0,point1,params);if(res2||res2=="0"){x2=!i?x0:params.cellWidth*i-.5+x0;y2=typeof res2=="object"?res2.y0:res2;if(i&&this._settings.fixOverflow){res1=this._getPointY(data[i-1],point0,point1,params);if(res1.out&&res1.out==res2.out){continue}x1=params.cellWidth*(i-1)-.5+x0;y1=typeof res1=="object"?res1.y0:res1;if(res1.out){y0=res1.out=="min"?point1.y:point0.y;items.push({x:this._calcOverflowX(x1,x2,y1,y2,y0),y:y0})}if(res2.out){y0=res2.out=="min"?point1.y:point0.y;items.push({x:this._calcOverflowX(x1,x2,y1,y2,y0),y:y0})}}if(!res2.out)items.push({x:x2,y:res2,index:i})}}this._mapStart=point0;for(i=1;i<=items.length;i++){x1=items[i-1].x;y1=items[i-1].y;if(i<items.length){x2=items[i].x;y2=items[i].y;this._drawLine(ctx,x1,y1,x2,y2,config.line.color.call(this,data[i-1]),config.line.width);if(config.line&&config.line.shadow){ctx.globalAlpha=.3;this._drawLine(ctx,x1+2,y1+config.line.width+8,x2+2,y2+config.line.width+8,"#eeeeee",config.line.width+3);ctx.globalAlpha=1}}if(typeof items[i-1].index!="undefined"){this._drawItem(ctx,x1,y1,data[items[i-1].index],config.label(data[items[i-1].index]),sIndex,map,point0)}}}},_calcOverflowX:function(x1,x2,y1,y2,y){return x1+(y-y1)*(x2-x1)/(y2-y1)},_drawItem:function(ctx,x0,y0,obj,label,sIndex,map){var config=this._settings.item;var R=parseInt(config.radius.call(this,obj),10)||0;var mapStart=this._mapStart;if(R){ctx.save();if(config.shadow){ctx.lineWidth=1;ctx.strokeStyle="#bdbdbd";ctx.fillStyle="#bdbdbd";var alphas=[.1,.2,.3];for(var i=alphas.length-1;i>=0;i--){ctx.globalAlpha=alphas[i];ctx.strokeStyle="#d0d0d0";ctx.beginPath();this._strokeChartItem(ctx,x0,y0+2*R/3,R+i+1,config.type);ctx.stroke()}ctx.beginPath();ctx.globalAlpha=.3;ctx.fillStyle="#bdbdbd";this._strokeChartItem(ctx,x0,y0+2*R/3,R+1,config.type);ctx.fill()}ctx.restore();ctx.lineWidth=config.borderWidth;ctx.fillStyle=config.color.call(this,obj);ctx.strokeStyle=config.borderColor.call(this,obj);ctx.globalAlpha=config.alpha.call(this,obj);ctx.beginPath();this._strokeChartItem(ctx,x0,y0,R+1,config.type);ctx.fill();ctx.stroke();ctx.globalAlpha=1}if(label){this.canvases[sIndex].renderTextAt(false,true,x0,y0-R-this._settings.labelOffset,this._settings.label.call(this,obj))}if(map){var areaPos=this._settings.eventRadius||R+1;map.addRect(obj.id,[x0-areaPos-mapStart.x,y0-areaPos-mapStart.y,x0+areaPos-mapStart.x,y0+areaPos-mapStart.y],sIndex)}},_strokeChartItem:function(ctx,x0,y0,R,type){var p=[];if(type&&(type=="square"||type=="s")){R*=Math.sqrt(2)/2;p=[[x0-R-ctx.lineWidth/2,y0-R],[x0+R,y0-R],[x0+R,y0+R],[x0-R,y0+R],[x0-R,y0-R]]}else if(type&&(type=="diamond"||type=="d")){var corr=ctx.lineWidth>1?ctx.lineWidth*Math.sqrt(2)/4:0;p=[[x0,y0-R],[x0+R,y0],[x0,y0+R],[x0-R,y0],[x0+corr,y0-R-corr]]}else if(type&&(type=="triangle"||type=="t")){p=[[x0,y0-R],[x0+Math.sqrt(3)*R/2,y0+R/2],[x0-Math.sqrt(3)*R/2,y0+R/2],[x0,y0-R]]}else p=[[x0,y0,R,0,Math.PI*2,true]];this._path(ctx,p)},_getPointY:function(data,point0,point1,params){var minValue=params.minValue;var maxValue=params.maxValue;var unit=params.unit;var valueFactor=params.valueFactor;var value=this._settings.value(data);if(this._logScaleCalc){value=this._log10(value)}var v=(parseFloat(value||0)-minValue)*valueFactor;if(!this._settings.yAxis)v+=params.startValue/unit;var y=point1.y-unit*v;if(this._settings.fixOverflow&&(this._settings.type=="line"||this._settings.type=="area")){if(value>maxValue)y={y:point0.y,y0:y,out:"max"};else if(v<0||value<minValue)y={y:point1.y,y0:y,out:"min"}}else{if(value>maxValue)y=point0.y;if(v<0||value<minValue)y=point1.y}return y},_calculateLineParams:function(ctx,data,point0,point1,sIndex){var params={};var relValue;params.totalHeight=point1.y-point0.y;if(this._settings.cellWidth)params.cellWidth=Math.min(point1.x-point0.x,this._settings.cellWidth);else params.cellWidth=(point1.x-point0.x)/(!this._settings.offset?data.length-1:data.length);var yax=!!this._settings.yAxis;var limits=this._settings.type.indexOf("stacked")!=-1?this._getStackedLimits(data):this._getLimits();params.maxValue=limits.max;params.minValue=limits.min;if(!sIndex)this._drawScales(data,point0,point1,params.minValue,params.maxValue,params.cellWidth);if(yax){params.maxValue=parseFloat(this._settings.yAxis.end);params.minValue=parseFloat(this._settings.yAxis.start)}var relativeValues=this._getRelativeValue(params.minValue,params.maxValue);relValue=relativeValues[0];params.valueFactor=relativeValues[1];params.unit=relValue?params.totalHeight/relValue:10;params.startValue=0;if(!yax){params.startValue=10;if(params.unit!=params.totalHeight)params.unit=relValue?(params.totalHeight-params.startValue)/relValue:10}return params}});webix.extend(webix.ui.chart,{$render_barH:function(ctx,data,point0,point1,sIndex,map){var barOffset,barWidth,cellWidth,color,gradient,i,limits,maxValue,minValue,innerGradient,valueFactor,relValue,radius,relativeValues,startValue,totalWidth,value,unit,x0,y0,xax;cellWidth=(point1.y-point0.y)/data.length;limits=this._getLimits("h");maxValue=limits.max;minValue=limits.min;totalWidth=point1.x-point0.x;xax=!!this._settings.xAxis;if(!sIndex)this._drawHScales(ctx,data,point0,point1,minValue,maxValue,cellWidth);if(xax){maxValue=parseFloat(this._settings.xAxis.end);minValue=parseFloat(this._settings.xAxis.start)}relativeValues=this._getRelativeValue(minValue,maxValue);relValue=relativeValues[0];valueFactor=relativeValues[1];unit=relValue?totalWidth/relValue:10;if(!xax){startValue=10;unit=relValue?(totalWidth-startValue)/relValue:10}barWidth=parseInt(this._settings.barWidth,10);if(barWidth*this._series.length+4>cellWidth)barWidth=cellWidth/this._series.length-4;barOffset=Math.floor((cellWidth-barWidth*this._series.length)/2);radius=typeof this._settings.radius!="undefined"?parseInt(this._settings.radius,10):Math.round(barWidth/5);innerGradient=false;gradient=this._settings.gradient;if(gradient&&typeof gradient!="function"){innerGradient=gradient;gradient=false}else if(gradient){gradient=ctx.createLinearGradient(point0.x,point0.y,point1.x,point0.y);this._settings.gradient(gradient)}if(!xax){this._drawLine(ctx,point0.x-.5,point0.y,point0.x-.5,point1.y,"#000000",1)}for(i=0;i<data.length;i++){value=parseFloat(this._settings.value(data[i]||0));if(this._logScaleCalc)value=this._log10(value);if(!value||isNaN(value))continue;if(value>maxValue)value=maxValue;value-=minValue;value*=valueFactor;x0=point0.x;y0=point0.y+barOffset+i*cellWidth+(barWidth+1)*sIndex;if(value<0&&this._settings.origin=="auto"||this._settings.xAxis&&value===0&&!(this._settings.origin!="auto"&&this._settings.origin>minValue)){this.canvases[sIndex].renderTextAt("middle","right",x0+10,y0+barWidth/2+barOffset,this._settings.label(data[i]));continue}if(value<0&&this._settings.origin!="auto"&&this._settings.origin>minValue){value=0}if(!xax)value+=startValue/unit;color=gradient||this._settings.color.call(this,data[i]);if(this._settings.border){this._drawBarHBorder(ctx,x0,y0,barWidth,minValue,radius,unit,value,color)}ctx.globalAlpha=this._settings.alpha.call(this,data[i]);var points=this._drawBarH(ctx,point1,x0,y0,barWidth,minValue,radius,unit,value,color,gradient,innerGradient);if(innerGradient){this._drawBarHGradient(ctx,x0,y0,barWidth,minValue,radius,unit,value,color,innerGradient)}ctx.globalAlpha=1;if(points[3]==y0){this.canvases[sIndex].renderTextAt("middle","left",points[0]-5,points[3]+Math.floor(barWidth/2),this._settings.label(data[i]));map.addRect(data[i].id,[points[0]-point0.x,points[3]-point0.y,points[2]-point0.x,points[3]+barWidth-point0.y],sIndex)}else{this.canvases[sIndex].renderTextAt("middle",false,points[2]+5,points[1]+Math.floor(barWidth/2),this._settings.label(data[i]));map.addRect(data[i].id,[points[0]-point0.x,y0-point0.y,points[2]-point0.x,points[3]-point0.y],sIndex)}}},_setBarHPoints:function(ctx,x0,y0,barWidth,radius,unit,value,offset,skipLeft){var angle_corr=0;if(radius>unit*value){var sinA=(radius-unit*value)/radius;angle_corr=-Math.asin(sinA)+Math.PI/2}ctx.moveTo(x0,y0+offset);var x1=x0+unit*value-radius-(radius?0:offset);x1=Math.max(x0,x1);if(radius<unit*value)ctx.lineTo(x1,y0+offset);var y2=y0+radius;if(radius&&radius>0)ctx.arc(x1,y2,radius-offset,-Math.PI/2+angle_corr,0,false);var y3=y0+barWidth-radius-(radius?0:offset);var x3=x1+radius-(radius?offset:0);ctx.lineTo(x3,y3);if(radius&&radius>0)ctx.arc(x1,y3,radius-offset,0,Math.PI/2-angle_corr,false);var y5=y0+barWidth-offset;ctx.lineTo(x0,y5);if(!skipLeft){ctx.lineTo(x0,y0+offset)}return[x3,y5]},_drawHScales:function(ctx,data,point0,point1,start,end,cellWidth){var x=0;if(this._settings.xAxis){if(!this.canvases["x"])this.canvases["x"]=this._createCanvas("axis_x");x=this._drawHXAxis(this.canvases["x"].getCanvas(),data,point0,point1,start,end)}if(this._settings.yAxis){if(!this.canvases["y"])this.canvases["y"]=this._createCanvas("axis_y");this._drawHYAxis(this.canvases["y"].getCanvas(),data,point0,point1,cellWidth,x)}},_drawHYAxis:function(ctx,data,point0,point1,cellWidth,yAxisX){if(!this._settings.yAxis)return;var unitPos;var x0=parseInt(yAxisX?yAxisX:point0.x,10)-.5;var y0=point1.y+.5;var y1=point0.y;this._drawLine(ctx,x0,y0,x0,y1,this._settings.yAxis.color,1);for(var i=0;i<data.length;i++){var right=this._settings.origin!="auto"&&this._settings.type=="barH"&&parseFloat(this._settings.value(data[i]))<this._settings.origin;unitPos=y1+cellWidth/2+i*cellWidth;this.canvases["y"].renderTextAt("middle",right?false:"left",right?x0+5:x0-5,unitPos,this._settings.yAxis.template(data[i]),"webix_axis_item_y",right?0:x0-10);if(this._settings.yAxis.lines.call(this,data[i]))this._drawLine(ctx,point0.x,unitPos,point1.x,unitPos,this._settings.yAxis.lineColor.call(this,data[i]),1)}if(this._settings.yAxis.lines.call(this,{}))this._drawLine(ctx,point0.x+.5,y1+.5,point1.x,y1+.5,this._settings.yAxis.lineColor.call(this,{}),1);this._setYAxisTitle(point0,point1)},_drawHXAxis:function(ctx,data,point0,point1,start,end){var step;var scaleParam={};var axis=this._settings.xAxis;if(!axis)return;var y0=point1.y+.5;var x0=point0.x-.5;var x1=point1.x-.5;var yAxisStart=point0.x;this._drawLine(ctx,x0,y0,x1,y0,axis.color,1);if(axis.step)step=parseFloat(axis.step);if(typeof this._configXAxis.step=="undefined"||typeof this._configXAxis.start=="undefined"||typeof this._configXAxis.end=="undefined"){scaleParam=this._calculateScale(start,end);start=scaleParam.start;end=scaleParam.end;step=scaleParam.step;this._settings.xAxis.end=end;this._settings.xAxis.start=start;this._settings.xAxis.step=step}if(step===0)return;var stepHeight=(x1-x0)*step/(end-start);var c=0;for(var i=start;i<=end;i+=step){var value=this._logScaleCalc?Math.pow(10,i):i;if(scaleParam.fixNum)value=parseFloat(value).toFixed(scaleParam.fixNum);var xi=Math.floor(x0+c*stepHeight)+.5;if(!(i==start&&this._settings.origin=="auto")&&axis.lines.call(this,i))this._drawLine(ctx,xi,y0,xi,point0.y,this._settings.xAxis.lineColor.call(this,i),1);if(i==this._settings.origin)yAxisStart=xi+1;if(step<1&&!this._logScaleCalc){var power=Math.min(Math.floor(this._log10(step)),start<=0?0:Math.floor(this._log10(start)));var corr=Math.pow(10,-power);value=Math.round(value*corr)/corr;i=value}this.canvases["x"].renderTextAt(false,true,xi,y0+2,axis.template(value.toString()),"webix_axis_item_x");c++}this.canvases["x"].renderTextAt(true,false,x0,point1.y+this._settings.padding.bottom-3,this._settings.xAxis.title,"webix_axis_title_x",point1.x-point0.x);if(!axis.lines.call(this,{})){this._drawLine(ctx,x0,point0.y-.5,x1,point0.y-.5,this._settings.xAxis.color,.2)}return yAxisStart},_correctBarHParams:function(ctx,x,y,value,unit,barWidth,minValue){var yax=this._settings.yAxis;var axisStart=x;if(!!yax&&this._settings.origin!="auto"&&this._settings.origin>minValue){x+=(this._settings.origin-minValue)*unit;axisStart=x;value=value-(this._settings.origin-minValue);if(value<0){value*=-1;ctx.translate(x,y+barWidth);ctx.rotate(Math.PI);x=.5;y=0}x+=.5}return{value:value,x0:x,y0:y,start:axisStart}},_drawBarH:function(ctx,point1,x0,y0,barWidth,minValue,radius,unit,value,color,gradient,inner_gradient){ctx.save();var p=this._correctBarHParams(ctx,x0,y0,value,unit,barWidth,minValue);ctx.fillStyle=color;ctx.beginPath();var points=this._setBarHPoints(ctx,p.x0,p.y0,barWidth,radius,unit,p.value,this._settings.border?1:0);if(gradient&&!inner_gradient)ctx.lineTo(point1.x,p.y0+(this._settings.border?1:0));ctx.fill();ctx.restore();var y1=p.y0;var y2=p.y0!=y0?y0:points[1];var x1=p.y0!=y0?p.start-points[0]:p.start;var x2=p.y0!=y0?p.start:points[0];return[x1,y1,x2,y2]},_drawBarHBorder:function(ctx,x0,y0,barWidth,minValue,radius,unit,value,color){ctx.save();var p=this._correctBarHParams(ctx,x0,y0,value,unit,barWidth,minValue);ctx.beginPath();this._setBorderStyles(ctx,color);ctx.globalAlpha=.9;this._setBarHPoints(ctx,p.x0,p.y0,barWidth,radius,unit,p.value,ctx.lineWidth/2,1);ctx.stroke();ctx.restore()},_drawBarHGradient:function(ctx,x0,y0,barWidth,minValue,radius,unit,value,color,inner_gradient){ctx.save();var p=this._correctBarHParams(ctx,x0,y0,value,unit,barWidth,minValue);var gradParam=this._setBarGradient(ctx,p.x0,p.y0+barWidth,p.x0+unit*p.value,p.y0,inner_gradient,color,"x");ctx.fillStyle=gradParam.gradient;ctx.beginPath();this._setBarHPoints(ctx,p.x0,p.y0+gradParam.offset,barWidth-gradParam.offset*2,radius,unit,p.value,gradParam.offset);ctx.fill();ctx.globalAlpha=1;ctx.restore()}});webix.extend(webix.ui.chart,{$render_stackedBar:function(ctx,data,point0,point1,sIndex,map){var maxValue,minValue,xAxisY,x0,y0;var valueFactor;var relValue;var config=this._settings;var total_height=point1.y-point0.y;var yax=!!config.yAxis;var xax=!!config.xAxis;var limits=this._getStackedLimits(data);var origin=config.origin===0;maxValue=limits.max;minValue=limits.min;var cellWidth=Math.floor((point1.x-point0.x)/data.length);if(!sIndex){xAxisY=this._drawScales(data,point0,point1,minValue,maxValue,cellWidth)}if(yax){maxValue=parseFloat(config.yAxis.end);minValue=parseFloat(config.yAxis.start)}var relativeValues=this._getRelativeValue(minValue,maxValue);relValue=relativeValues[0];valueFactor=relativeValues[1];var unit=relValue?total_height/relValue:10;var barWidth=parseInt(config.barWidth,10);if(barWidth+4>cellWidth)barWidth=cellWidth-4;var barOffset=Math.floor((cellWidth-barWidth)/2);var inner_gradient=config.gradient?config.gradient:false;if(!xax){this._drawLine(ctx,point0.x,point1.y+.5,point1.x,point1.y+.5,"#000000",1)}for(var i=0;i<data.length;i++){var value=Math.abs(parseFloat(config.value(data[i]||0)));if(this._logScaleCalc)value=this._log10(value);x0=point0.x+barOffset+i*cellWidth;var negValue=origin&&value<0;if(!sIndex){y0=xAxisY-1;data[i].$startY=y0;if(origin){if(negValue)y0=xAxisY+1;data[i].$startYN=xAxisY+1}}else{y0=negValue?data[i].$startYN:data[i].$startY}if(!value||isNaN(value))continue;if(!sIndex&&!origin)value-=minValue;value*=valueFactor;if(y0<point0.y+1)continue;var color=this._settings.color.call(this,data[i]);var firstSector=Math.abs(y0-(origin?point1.y+minValue*unit:point1.y))<3;ctx.globalAlpha=config.alpha.call(this,data[i]);ctx.fillStyle=ctx.strokeStyle=config.color.call(this,data[i]);ctx.beginPath();var y1=y0-unit*value+(firstSector?negValue?-1:1:0);var points=this._setStakedBarPoints(ctx,x0-(config.border?.5:0),y0,barWidth+(config.border?.5:0),y1,0,point0.y);ctx.fill();ctx.stroke();if(inner_gradient){ctx.save();var gradParam=this._setBarGradient(ctx,x0,y0,x0+barWidth,points[1],inner_gradient,color,"y");ctx.fillStyle=gradParam.gradient;ctx.beginPath();points=this._setStakedBarPoints(ctx,x0+gradParam.offset,y0,barWidth-gradParam.offset*2,y1,config.border?1:0,point0.y);ctx.fill();ctx.restore()}if(config.border){ctx.save();if(typeof config.border=="string")ctx.strokeStyle=config.border;else this._setBorderStyles(ctx,color);ctx.beginPath();this._setStakedBarPoints(ctx,x0-.5,parseInt(y0,10)+.5,barWidth+1,parseInt(y1,10)+.5,0,point0.y,firstSector);ctx.stroke();ctx.restore()}ctx.globalAlpha=1;this.canvases[sIndex].renderTextAt(false,true,x0+Math.floor(barWidth/2),points[1]+(y0-points[1])/2-7,this._settings.label(data[i]));map.addRect(data[i].id,[x0-point0.x,points[1]-point0.y,points[0]-point0.x,data[i][negValue?"$startYN":"$startY"]-point0.y],sIndex);data[i][negValue?"$startYN":"$startY"]=points[1]}},_setStakedBarPoints:function(ctx,x0,y0,barWidth,y1,offset,minY,skipBottom){ctx.moveTo(x0,y0);if(y1<minY)y1=minY;ctx.lineTo(x0,y1);var x3=x0+barWidth;var y3=y1;ctx.lineTo(x3,y3);var x5=x0+barWidth;ctx.lineTo(x5,y0);if(!skipBottom){ctx.lineTo(x0,y0)}return[x5,y3]}});webix.extend(webix.ui.chart,{$render_stackedBarH:function(ctx,data,point0,point1,sIndex,map){var maxValue,minValue;var valueFactor;var relValue;var total_width=point1.x-point0.x;var yax=!!this._settings.yAxis;var limits=this._getStackedLimits(data);maxValue=limits.max;minValue=limits.min;var cellWidth=Math.floor((point1.y-point0.y)/data.length);if(!sIndex)this._drawHScales(ctx,data,point0,point1,minValue,maxValue,cellWidth);if(yax){maxValue=parseFloat(this._settings.xAxis.end);minValue=parseFloat(this._settings.xAxis.start)}var relativeValues=this._getRelativeValue(minValue,maxValue);relValue=relativeValues[0];valueFactor=relativeValues[1];var unit=relValue?total_width/relValue:10;var startValue=0;if(!yax){startValue=10;unit=relValue?(total_width-startValue)/relValue:10}var barWidth=parseInt(this._settings.barWidth,10);if(barWidth+4>cellWidth)barWidth=cellWidth-4;var barOffset=(cellWidth-barWidth)/2;var radius=0;var inner_gradient=false;var gradient=this._settings.gradient;if(gradient){inner_gradient=true}if(!yax){this._drawLine(ctx,point0.x-.5,point0.y,point0.x-.5,point1.y,"#000000",1)}var seriesNumber=0;var seriesIndex=0;for(i=0;i<this._series.length;i++){if(i==sIndex){seriesIndex=seriesNumber}if(this._series[i].type=="stackedBarH")seriesNumber++}for(var i=0;i<data.length;i++){if(!seriesIndex)data[i].$startX=point0.x;var value=Math.abs(parseFloat(this._settings.value(data[i]||0)));if(value>maxValue)value=maxValue;value-=minValue;value*=valueFactor;var x0=point0.x;var y0=point0.y+barOffset+i*cellWidth;if(!seriesIndex)data[i].$startX=x0;else x0=data[i].$startX;if(!value||isNaN(value))continue;if(!yax)value+=startValue/unit;var color=this._settings.color.call(this,data[i]);ctx.globalAlpha=this._settings.alpha.call(this,data[i]);ctx.fillStyle=this._settings.color.call(this,data[i]);ctx.beginPath();var points=this._setBarHPoints(ctx,x0,y0,barWidth,radius,unit,value,0);if(gradient&&!inner_gradient)ctx.lineTo(point0.x+total_width,y0+(this._settings.border?1:0));ctx.fill();if(inner_gradient){var gradParam=this._setBarGradient(ctx,x0,y0+barWidth,x0,y0,inner_gradient,color,"x");ctx.fillStyle=gradParam.gradient;ctx.beginPath();points=this._setBarHPoints(ctx,x0,y0,barWidth,radius,unit,value,0);ctx.fill()}if(this._settings.border){this._drawBarHBorder(ctx,x0,y0,barWidth,minValue,radius,unit,value,color)}ctx.globalAlpha=1;this.canvases[sIndex].renderTextAt("middle",true,data[i].$startX+(points[0]-data[i].$startX)/2-1,y0+(points[1]-y0)/2,this._settings.label(data[i]));map.addRect(data[i].id,[data[i].$startX-point0.x,y0-point0.y,points[0]-point0.x,points[1]-point0.y],sIndex);data[i].$startX=points[0]}}});webix.extend(webix.ui.chart,{$render_spline:function(ctx,data,point0,point1,sIndex,map){var config,i,items,j,params,sparam,x,x0,x1,x2,y,y1,y2;params=this._calculateLineParams(ctx,data,point0,point1,sIndex);config=this._settings;this._mapStart=point0;items=[];if(data.length){x0=config.offset?point0.x+params.cellWidth*.5:point0.x;for(i=0;i<data.length;i++){y=this._getPointY(data[i],point0,point1,params);if(y||y=="0"){x=!i?x0:params.cellWidth*i-.5+x0;items.push({x:x,y:y,v:this._settings.value(data[i]),index:i})}}sparam=this._getSplineParameters(items);for(i=0;i<items.length;i++){x1=items[i].x;y1=items[i].y;if(i<items.length-1){x2=items[i+1].x;y2=items[i+1].y;for(j=x1;j<x2;j++){var sY1=this._getSplineYPoint(j,x1,i,sparam.a,sparam.b,sparam.c,sparam.d);if(sY1<point0.y)sY1=point0.y;if(sY1>point1.y)sY1=point1.y;var sY2=this._getSplineYPoint(j+1,x1,i,sparam.a,sparam.b,sparam.c,sparam.d);if(sY2<point0.y)sY2=point0.y;if(sY2>point1.y)sY2=point1.y;this._drawLine(ctx,j,sY1,j+1,sY2,config.line.color(data[i]),config.line.width)}this._drawLine(ctx,x2-1,this._getSplineYPoint(j,x1,i,sparam.a,sparam.b,sparam.c,sparam.d),x2,y2,config.line.color(data[i]),config.line.width)}this._drawItem(ctx,x1,y1,data[items[i].index],config.label(data[items[i].index]),sIndex,map)}}},_getSplineParameters:function(points){var a,b,c,d,i,s,u,v,h=[],m=[],n=points.length;for(i=0;i<n-1;i++){h[i]=points[i+1].x-points[i].x;m[i]=(points[i+1].y-points[i].y)/h[i]}u=[];v=[];u[0]=0;u[1]=2*(h[0]+h[1]);v[0]=0;v[1]=6*(m[1]-m[0]);for(i=2;i<n-1;i++){u[i]=2*(h[i-1]+h[i])-h[i-1]*h[i-1]/u[i-1];v[i]=6*(m[i]-m[i-1])-h[i-1]*v[i-1]/u[i-1]}s=[];s[n-1]=s[0]=0;for(i=n-2;i>=1;i--)s[i]=(v[i]-h[i]*s[i+1])/u[i];a=[];b=[];c=[];d=[];for(i=0;i<n-1;i++){a[i]=points[i].y;b[i]=-h[i]*s[i+1]/6-h[i]*s[i]/3+(points[i+1].y-points[i].y)/h[i];c[i]=s[i]/2;d[i]=(s[i+1]-s[i])/(6*h[i])}for(i=0;i<points.length-1;i++){if(points[i].v===0&&points[i+1].v===0){a[i]=points[i].y;d[i]=c[i]=b[i]=0}}return{a:a,b:b,c:c,d:d}},_getSplineYPoint:function(x,xi,i,a,b,c,d){return a[i]+(x-xi)*(b[i]+(x-xi)*(c[i]+(x-xi)*d[i]))}});webix.extend(webix.ui.chart,{$render_area:function(ctx,data,point0,point1,sIndex,map){var align,config,i,mapRect,obj,params,path,res1,res2,x0,x1,y1,x2,y2,y0;params=this._calculateLineParams(ctx,data,point0,point1,sIndex);config=this._settings;mapRect=config.eventRadius||Math.floor(params.cellWidth/2);if(data.length){path=[];x0=!config.offset?point0.x:point0.x+params.cellWidth*.5;for(i=0;i<data.length;i++){obj=data[i];res2=this._getPointY(obj,point0,point1,params);x2=x0+params.cellWidth*i;if(res2){y2=typeof res2=="object"?res2.y0:res2;if(i&&this._settings.fixOverflow){res1=this._getPointY(data[i-1],point0,point1,params);if(res1.out&&res1.out==res2.out){continue}x1=params.cellWidth*(i-1)-.5+x0;y1=typeof res1=="object"?res1.y0:res1;if(res1.out){y0=res1.out=="min"?point1.y:point0.y;path.push([this._calcOverflowX(x1,x2,y1,y2,y0),y0])}if(res2.out){y0=res2.out=="min"?point1.y:point0.y;path.push([this._calcOverflowX(x1,x2,y1,y2,y0),y0]);if(i==data.length-1&&y0==point0.y)path.push([x2,point0.y])}}if(!res2.out){path.push([x2,y2]);map.addRect(obj.id,[x2-mapRect-point0.x,y2-mapRect-point0.y,x2+mapRect-point0.x,y2+mapRect-point0.y],sIndex)}if(!config.yAxis){align=!config.offset&&i==data.length-1?"left":"center";this.canvases[sIndex].renderTextAt(false,align,x2,y2-config.labelOffset,config.label(obj))}}}if(path.length){path.push([x2,point1.y]);path.push([path[0][0],point1.y])}ctx.globalAlpha=this._settings.alpha.call(this,data[0]);ctx.fillStyle=this._settings.color.call(this,data[0]);ctx.beginPath();this._path(ctx,path);ctx.fill();ctx.lineWidth=1;ctx.globalAlpha=1;if(config.border){ctx.lineWidth=config.borderWidth||1;if(config.borderColor)ctx.strokeStyle=config.borderColor.call(this,data[0]);else this._setBorderStyles(ctx,ctx.fillStyle);ctx.beginPath();this._path(ctx,path);ctx.stroke()}}},$render_stackedArea:function(ctx,data,point0,point1,sIndex,map){var a0,a1,align,config,i,j,lastItem,mapRect,obj,params,path,x,y,yPos;params=this._calculateLineParams(ctx,data,point0,point1,sIndex);config=this._settings;mapRect=config.eventRadius||Math.floor(params.cellWidth/2);if(data.length){path=[];yPos=[];x=!config.offset?point0.x:point0.x+params.cellWidth*.5;var setOffset=function(i,y){return sIndex?data[i].$startY?y-point1.y+data[i].$startY:0:y};var solveEquation=function(x,p0,p1){var k=(p1.y-p0.y)/(p1.x-p0.x);return k*x+p0.y-k*p0.x};for(i=0;i<data.length;i++){obj=data[i];if(!i){y=setOffset(i,point1.y);path.push([x,y])}else{x+=params.cellWidth}y=setOffset(i,this._getPointY(obj,point0,point1,params));yPos.push(isNaN(y)&&!i?data[i].$startY||point1.y:y);if(y){path.push([x,y]);map.addRect(obj.id,[x-mapRect-point0.x,y-mapRect-point0.y,x+mapRect-point0.x,y+mapRect-point0.y],sIndex);if(!config.yAxis){align=!config.offset&&lastItem?"left":"center";this.canvases[sIndex].renderTextAt(false,align,x,y-config.labelOffset,config.label(obj))}}}path.push([x,setOffset(i-1,point1.y)]);if(sIndex){for(i=data.length-2;i>0;i--){x-=params.cellWidth;y=data[i].$startY;if(y)path.push([x,y])}}path.push([path[0][0],path[0][1]]);ctx.globalAlpha=this._settings.alpha.call(this,data[0]);ctx.fillStyle=this._settings.color.call(this,data[0]);ctx.beginPath();this._path(ctx,path);ctx.fill();for(i=0;i<data.length;i++){y=yPos[i];if(!y){if(i==data.length-1){y=data[i].$startY}for(j=i+1;j<data.length;j++){if(yPos[j]){a0={x:point0.x,y:yPos[0]};a1={x:point0.x+params.cellWidth*j,y:yPos[j]};y=solveEquation(point0.x+params.cellWidth*i,a0,a1);break}}}data[i].$startY=y}}}});webix.extend(webix.ui.chart,{$render_radar:function(ctx,data,x,y,sIndex,map){this._renderRadarChart(ctx,data,x,y,sIndex,map)},_renderRadarChart:function(ctx,data,point0,point1,sIndex,map){if(!data.length)return;var coord=this._getPieParameters(point0,point1);var radius=this._settings.radius?this._settings.radius:coord.radius;var x0=this._settings.x?this._settings.x:coord.x;var y0=this._settings.y?this._settings.y:coord.y;var ratioUnits=[];for(var i=0;i<data.length;i++)ratioUnits.push(1);var ratios=this._getRatios(ratioUnits,data.length);this._mapStart=point0;if(!sIndex)this._drawRadarAxises(ratios,x0,y0,radius,data);this._drawRadarData(ctx,ratios,x0,y0,radius,data,sIndex,map)},_drawRadarData:function(ctx,ratios,x,y,radius,data,sIndex,map){var alpha0,alpha1,config,i,min,max,pos0,pos1,posArr,r0,r1,relValue,startAlpha,value,value0,value1,valueFactor,unit,unitArr;config=this._settings;min=config.yAxis.start;max=config.yAxis.end;unitArr=this._getRelativeValue(min,max);relValue=unitArr[0];unit=relValue?radius/relValue:radius/2;valueFactor=unitArr[1];startAlpha=-Math.PI/2;alpha0=alpha1=startAlpha;posArr=[];pos1=0;for(i=0;i<data.length;i++){if(!value1){value=config.value(data[i]);if(this._logScaleCalc)value=this._log10(value);value0=(parseFloat(value||0)-min)*valueFactor}else value0=value1;r0=Math.floor(unit*value0);value=config.value(i!=data.length-1?data[i+1]:data[0]);if(this._logScaleCalc)value=this._log10(value);value1=(parseFloat(value||0)-min)*valueFactor;r1=Math.floor(unit*value1);alpha0=alpha1;alpha1=i!=data.length-1?startAlpha+ratios[i]-1e-4:startAlpha;pos0=pos1||this._getPositionByAngle(alpha0,x,y,r0);pos1=this._getPositionByAngle(alpha1,x,y,r1);posArr.push(pos0)}if(config.fill)this._fillRadarChart(ctx,posArr,data);if(!config.disableLines&&data.length>2)this._strokeRadarChart(ctx,posArr,data);if(!config.disableItems||data.length<3)this._drawRadarItemMarkers(ctx,posArr,data,sIndex,map);posArr=null},_drawRadarItemMarkers:function(ctx,points,data,sIndex,map){for(var i=0;i<points.length;i++){this._drawItem(ctx,points[i].x,points[i].y,data[i],this._settings.label.call(this,data),sIndex,map)}},_fillRadarChart:function(ctx,points,data){var pos0,pos1;ctx.globalAlpha=this._settings.alpha.call(this,{});ctx.beginPath();for(var i=0;i<points.length;i++){ctx.fillStyle=this._settings.fill.call(this,data[i]);pos0=points[i];pos1=points[i+1]||points[0];if(!i){ctx.moveTo(pos0.x,pos0.y)}ctx.lineTo(pos1.x,pos1.y)}ctx.fill();ctx.globalAlpha=1},_strokeRadarChart:function(ctx,points,data){var pos0,pos1;for(var i=0;i<points.length;i++){pos0=points[i];pos1=points[i+1]||points[0];this._drawLine(ctx,pos0.x,pos0.y,pos1.x,pos1.y,this._settings.line.color.call(this,data[i]),this._settings.line.width)}},_drawRadarAxises:function(ratios,x,y,radius,data){var configY=this._settings.yAxis;var configX=this._settings.xAxis;var start=configY.start;var end=configY.end;var step=configY.step;var scaleParam={};var config=this._configYAxis;if(typeof config.step=="undefined"||typeof config.start=="undefined"||typeof config.end=="undefined"){var limits=this._getLimits();scaleParam=this._calculateScale(limits.min,limits.max);start=scaleParam.start;end=scaleParam.end;step=scaleParam.step;configY.end=end;configY.start=start}var units=[];var i,j,p;var c=0;var stepHeight=radius*step/(end-start);var power,corr;if(step<1){power=Math.min(this._log10(step),start<=0?0:this._log10(start));corr=Math.pow(10,-power)}var angles=[];if(!this.canvases["scale"])this.canvases["scale"]=this._createCanvas("radar_scale");var ctx=this.canvases["scale"].getCanvas();for(i=end;i>=start;i-=step){var value=this._logScaleCalc?Math.pow(10,i):i;if(scaleParam.fixNum)value=parseFloat(i).toFixed(scaleParam.fixNum);units.push(Math.floor(c*stepHeight)+.5);if(corr&&!this._logScaleCalc){value=Math.round(value*corr)/corr;i=value}var unitY=y-radius+units[units.length-1];this.canvases["scale"].renderTextAt("middle","left",x,unitY,configY.template(value.toString()),"webix_axis_item_y webix_radar");if(ratios.length<2){this._drawScaleSector(ctx,"arc",x,y,radius-units[units.length-1],-Math.PI/2,3*Math.PI/2,i);return}var startAlpha=-Math.PI/2;var alpha0=startAlpha;var alpha1;for(j=0;j<ratios.length;j++){if(!c)angles.push(alpha0);alpha1=startAlpha+ratios[j]-1e-4;this._drawScaleSector(ctx,ratios.length>2?config.lineShape||"line":"arc",x,y,radius-units[units.length-1],alpha0,alpha1,i,j,data[i]);alpha0=alpha1}c++}for(i=0;i<angles.length;i++){p=this._getPositionByAngle(angles[i],x,y,radius);if(configX.lines.call(this,data[i],i))this._drawLine(ctx,x,y,p.x,p.y,configX?configX.lineColor.call(this,data[i]):"#cfcfcf",1);this._drawRadarScaleLabel(ctx,x,y,radius,angles[i],configX?configX.template.call(this,data[i]):"&nbsp;")}},_drawScaleSector:function(ctx,shape,x,y,radius,a1,a2,i,j){var pos1,pos2;if(radius<0)return false;pos1=this._getPositionByAngle(a1,x,y,radius);pos2=this._getPositionByAngle(a2,x,y,radius);var configY=this._settings.yAxis;if(configY.bg){ctx.beginPath();ctx.moveTo(x,y);if(shape=="arc")ctx.arc(x,y,radius,a1,a2,false);else{ctx.lineTo(pos1.x,pos1.y);ctx.lineTo(pos2.x,pos2.y)}ctx.fillStyle=configY.bg(i,j);ctx.moveTo(x,y);ctx.fill();ctx.closePath()}if(configY.lines.call(this,i)){ctx.lineWidth=1;ctx.beginPath();if(shape=="arc")ctx.arc(x,y,radius,a1,a2,false);else{ctx.moveTo(pos1.x,pos1.y);ctx.lineTo(pos2.x,pos2.y)}ctx.strokeStyle=configY.lineColor.call(this,i);ctx.stroke()}},_drawRadarScaleLabel:function(ctx,x,y,r,a,text){if(!text)return false;var t=this.canvases["scale"].renderText(0,0,text,"webix_axis_radar_title",1);var width=t.scrollWidth;var height=t.offsetHeight;var delta=.001;var pos=this._getPositionByAngle(a,x,y,r+5);var corr_x=0,corr_y=0;if(a<0||a>Math.PI){corr_y=-height}if(a>Math.PI/2){corr_x=-width}if(Math.abs(a+Math.PI/2)<delta||Math.abs(a-Math.PI/2)<delta){corr_x=-width/2}else if(Math.abs(a)<delta||Math.abs(a-Math.PI)<delta){corr_y=-height/2}t.style.top=pos.y+corr_y+"px";t.style.left=pos.x+corr_x+"px";t.style.width=width+"px";t.style.whiteSpace="nowrap"}});webix.extend(webix.ui.chart,{$render_scatter:function(ctx,data,point0,point1,sIndex,map){if(!this._settings.xValue)return webix.log("warning","Undefined propery: xValue");var limitsY=this._getLimits();var limitsX=this._getLimits("h","xValue");if(!sIndex){if(!this.canvases["x"])this.canvases["x"]=this._createCanvas("axis_x");if(!this.canvases["y"])this.canvases["y"]=this._createCanvas("axis_y");this._drawYAxis(this.canvases["y"].getCanvas(),data,point0,point1,limitsY.min,limitsY.max);this._drawHXAxis(this.canvases["x"].getCanvas(),data,point0,point1,limitsX.min,limitsX.max)}limitsY={min:this._settings.yAxis.start,max:this._settings.yAxis.end};limitsX={min:this._settings.xAxis.start,max:this._settings.xAxis.end};var params=this._getScatterParams(ctx,data,point0,point1,limitsX,limitsY);this._mapStart=point0;for(var i=0;i<data.length;i++){this._drawScatterItem(ctx,map,point0,point1,params,limitsX,limitsY,data[i],sIndex)}},_getScatterParams:function(ctx,data,point0,point1,limitsX,limitsY){var params={};params.totalHeight=point1.y-point0.y;params.totalWidth=point1.x-point0.x;this._calcScatterUnit(params,limitsX.min,limitsX.max,params.totalWidth,"X");this._calcScatterUnit(params,limitsY.min,limitsY.max,params.totalHeight,"Y");return params},_drawScatterItem:function(ctx,map,point0,point1,params,limitsX,limitsY,obj,sIndex){var x0=this._calculateScatterItemPosition(params,point1,point0,limitsX,obj,"X");var y0=this._calculateScatterItemPosition(params,point0,point1,limitsY,obj,"Y");this._drawItem(ctx,x0,y0,obj,this._settings.label.call(this,obj),sIndex,map)},_calculateScatterItemPosition:function(params,point0,point1,limits,obj,axis){var value=this._settings[axis=="X"?"xValue":"value"].call(this,obj);var valueFactor=params["valueFactor"+axis];var v=(parseFloat(value||0)-limits.min)*valueFactor;var unit=params["unit"+axis];var pos=point1[axis.toLowerCase()]-(axis=="X"?-1:1)*Math.floor(unit*v);if(v<0)pos=point1[axis.toLowerCase()];if(value>limits.max)pos=point0[axis.toLowerCase()];if(value<limits.min)pos=point1[axis.toLowerCase()];return pos},_calcScatterUnit:function(p,min,max,size,axis){var relativeValues=this._getRelativeValue(min,max);axis=axis||"";p["relValue"+axis]=relativeValues[0];p["valueFactor"+axis]=relativeValues[1];p["unit"+axis]=p["relValue"+axis]?size/p["relValue"+axis]:10}});webix.extend(webix.ui.chart,{presets:{simple:{item:{borderColor:"#ffffff",color:"#2b7100",shadow:false,borderWidth:2},line:{color:"#8ecf03",width:2}},plot:{color:"#1293f8",item:{borderColor:"#636363",borderWidth:1,color:"#ffffff",type:"r",shadow:false},line:{color:"#1293f8",width:2}},diamond:{color:"#b64040",item:{borderColor:"#b64040",color:"#b64040",type:"d",radius:3,shadow:true},line:{color:"#ff9000",width:2}},point:{color:"#fe5916",disableLines:true,fill:false,disableItems:false,item:{color:"#feb916",borderColor:"#fe5916",radius:2,borderWidth:1,type:"r"},alpha:1},line:{line:{color:"#3399ff",width:2},item:{color:"#ffffff",borderColor:"#3399ff",radius:2,borderWidth:2,type:"d"},fill:false,disableItems:false,disableLines:false,alpha:1},area:{fill:"#3399ff",line:{color:"#3399ff",width:1},disableItems:true,alpha:.2,disableLines:false},round:{item:{radius:3,borderColor:"#3f83ff",borderWidth:1,color:"#3f83ff",type:"r",shadow:false,alpha:.6}},square:{item:{radius:3,borderColor:"#447900",borderWidth:2,color:"#69ba00",type:"s",shadow:false,alpha:1}},column:{color:"RAINBOW",gradient:false,barWidth:45,radius:0,alpha:1,border:true},stick:{barWidth:5,gradient:false,color:"#67b5c9",radius:2,alpha:1,border:false},alpha:{color:"#b9a8f9",barWidth:70,gradient:"falling",radius:0,alpha:.5,border:true}}});webix.extend(webix.ui.chart,{$render_splineArea:function(ctx,data,point0,point1,sIndex,map){var color,i,items,j,mapRect,params,sParams,x,x0,x1,x2,y,y1,y2,config=this._settings,path=[];params=this._calculateLineParams(ctx,data,point0,point1,sIndex);mapRect=config.eventRadius||Math.floor(params.cellWidth/2);items=[];if(data.length){x0=point0.x;for(i=0;i<data.length;i++){y=this._getPointY(data[i],point0,point1,params);if(y||y=="0"){x=!i?x0:params.cellWidth*i-.5+x0;items.push({x:x,y:y,index:i});map.addRect(data[i].id,[x-mapRect-point0.x,y-mapRect-point0.y,x+mapRect-point0.x,y+mapRect-point0.y],sIndex)}}sParams=this._getSplineParameters(items);for(i=0;i<items.length;i++){x1=items[i].x;y1=items[i].y;if(i<items.length-1){x2=items[i+1].x;y2=items[i+1].y;for(j=x1;j<x2;j++){var sY1=this._getSplineYPoint(j,x1,i,sParams.a,sParams.b,sParams.c,sParams.d);if(sY1<point0.y)sY1=point0.y;if(sY1>point1.y)sY1=point1.y;var sY2=this._getSplineYPoint(j+1,x1,i,sParams.a,sParams.b,sParams.c,sParams.d);if(sY2<point0.y)sY2=point0.y;if(sY2>point1.y)sY2=point1.y;path.push([j,sY1]);path.push([j+1,sY2])}path.push([x2,y2])}}color=this._settings.color.call(this,data[0]);if(path.length){path.push([x2,point1.y]);path.push([path[0][0],point1.y])}ctx.globalAlpha=this._settings.alpha.call(this,data[0]);ctx.fillStyle=color;ctx.beginPath();this._path(ctx,path);ctx.fill();ctx.lineWidth=1;ctx.globalAlpha=1;if(config.border){ctx.lineWidth=config.borderWidth||1;if(config.borderColor)ctx.strokeStyle=config.borderColor.call(this,data[0]);else this._setBorderStyles(ctx,color);ctx.beginPath();path.splice(path.length-3);this._path(ctx,path);ctx.stroke()}}}});(function(){var animateDuration=400,cellWidth=30;webix.extend(webix.ui.chart,{dynamic_setter:function(value){if(value)init(this);return value}});function init(chart){if(chart._stockRenderHandler)return;var config=chart._settings;if(!config.cellWidth)config.cellWidth=cellWidth;if(!config.animateDuration)config.animateDuration=animateDuration;config.offset=false;chart._stockRenderHandler=chart.attachEvent("onBeforeRender",function(data,type){var bounds=chart._getChartBounds(chart._content_width,chart._content_height);resizeStockCanvases(chart);filterStockData(data,bounds.start,bounds.end,config.cellWidth);if(type=="add")startAnimation(chart)});chart._stockXAxisHandler=chart.attachEvent("onBeforeXAxis",function(ctx,data,point0,point1,cellWidth,y){drawXAxis(chart,ctx,data,point0,point1,cellWidth,y);return false})}function startAnimation(chart){var cellWidth=chart._settings.cellWidth;if(chart._stockAnimationOffset!=cellWidth){chart._stockAnimationOffset=cellWidth;chart.render()}chart._stockAnimationOffset=0;chart._stockAnimationStart=null;if(window.requestAnimationFrame&&!document.hidden)window.requestAnimationFrame(function(t){animate(chart,t)});if(!chart._stockAnimateHandler)chart._stockAnimateHandler=chart.attachEvent("onAfterRender",function(data){applyStockOffset(chart,data)})}function animate(chart,timestamp){var progress,duration=chart._settings.animateDuration,cellWidth=chart._settings.cellWidth;if(cellWidth&&chart.count()>1){if(!chart._stockAnimationStart)chart._stockAnimationStart=timestamp;progress=timestamp-chart._stockAnimationStart;chart._stockAnimationOffset=Math.min(Math.max(progress/duration*cellWidth,1),cellWidth);chart.render();if(progress<duration)window.requestAnimationFrame(function(t){animate(chart,t)})}}function applyStockOffset(chart,data){var count=chart.count(),bounds=chart._getChartBounds(chart._content_width,chart._content_height),cellWidth=chart._settings.cellWidth,offset=chart._stockAnimationOffset||0,isScroll=data.length<count||(data.length-1)*cellWidth>bounds.end.x-bounds.start.x;function setCanvasOffset(canvas,x0,x1,skipRight){var ctx=canvas.getCanvas(),elem=canvas._canvas,labels=canvas._canvas_labels,series=canvas._canvas_series;if(offset&&(data.length<count||(data.length-1)*cellWidth>x1-x0)){elem.style.left=-offset+"px";if(data.length>1){setLabelsOffset(labels,offset,series);ctx.clearRect(0,0,x0+offset,elem.offsetHeight);ctx.clearRect(x1+offset,0,elem.offsetWidth,elem.offsetHeight)}}else{elem.style.left="0px";if(!skipRight&&offset!=cellWidth)ctx.clearRect(x0+(data.length-1)*cellWidth-cellWidth+offset,0,elem.offsetWidth,elem.offsetHeight)}if(labels.length>1&&offset&&offset!=cellWidth){var last=labels.length-1;if(isAxisTitle(series,labels[last]))last-=1;labels[last].style.display="none"}}eachStockCanvas(chart,function(name,canvas){setCanvasOffset(canvas,bounds.start.x,bounds.end.x,name=="x")});setHtmlMapSizes(chart,bounds,isScroll?offset:0)}function isAxisTitle(series,label){return series==="axis_x"&&label.className.indexOf("webix_axis_title_x")!==-1}function setLabelsOffset(labels,offset,series){if(labels.length){webix.html.remove(labels[0]);for(var i=1;i<labels.length;i++){if(isAxisTitle(series,labels[i]))continue;labels[i].style.left=labels[i].offsetLeft-offset+"px"}}}function filterStockData(data,point0,point1,cellWidth){if(cellWidth&&data.length){var limit=Math.ceil((point1.x-point0.x)/cellWidth);if(data.length>limit+1)data.splice(0,data.length-limit-1)}}function eachStockCanvas(chart,func){if(chart.canvases){for(var i=0;i<chart._series.length;i++)if(chart.canvases[i])func(i,chart.canvases[i]);if(chart.canvases["x"])func("x",chart.canvases["x"])}}function resizeStockCanvases(chart){eachStockCanvas(chart,function(name,canvas){canvas._resizeCanvas(chart._content_width+2*chart._settings.cellWidth,chart._content_height)})}function setHtmlMapSizes(chart,bounds,offset){chart._contentobj._htmlmap.style.left=bounds.start.x-offset+"px";chart._contentobj._htmlmap.style.width=bounds.end.x-bounds.start.x+offset+"px"}function drawXAxis(chart,ctx,data,point0,point1,cellWidth,y){var center,i,isScroll,unitPos,config=chart._settings,x0=point0.x-.5,y0=parseInt(y?y:point1.y,10)+.5,x1=point1.x;if(!config.dynamic)return false;isScroll=(data.length-1)*cellWidth>x1-x0||data.length<chart.count();for(i=0;i<data.length;i++){unitPos=x0+i*cellWidth;center=isScroll?i>1:!!i;unitPos=Math.ceil(unitPos)-.5;chart._drawXAxisLabel(unitPos,y0,data[i],center);if(i&&config.xAxis.lines.call(chart,data[i]))chart._drawXAxisLine(ctx,unitPos,point1.y,point0.y,data[i])}chart.canvases["x"].renderTextAt(true,false,x0,point1.y+config.padding.bottom-3,config.xAxis.title,"webix_axis_title_x",point1.x-point0.x);chart._drawLine(ctx,x0,y0,x1+(isScroll?chart._stockAnimationOffset:0),y0,config.xAxis.color,1)}})();webix.protoUI({name:"calendar",defaults:{date:new Date,select:false,navigation:true,monthSelect:true,weekHeader:true,weekNumber:false,skipEmptyWeeks:false,calendarHeader:"%F %Y",calendarWeekHeader:"W#",events:webix.Date.isHoliday,minuteStep:5,icons:false,timepickerHeight:30,headerHeight:70,dayTemplate:function(d){return d.getDate()},width:260,height:250},dayTemplate_setter:webix.template,calendarHeader_setter:webix.Date.dateToStr,calendarWeekHeader_setter:webix.Date.dateToStr,calendarTime_setter:function(format){this._calendarTime=format;return webix.Date.dateToStr(format)},date_setter:function(date){return this._string_to_date(date)},maxDate_setter:function(date){return this._string_to_date(date)},minDate_setter:function(date){return this._string_to_date(date)},minTime_setter:function(time){if(typeof time=="string"){time=webix.i18n.parseTimeFormatDate(time);time=[time.getHours(),time.getMinutes()]}return time},maxTime_setter:function(time){if(typeof time=="string"){time=webix.i18n.parseTimeFormatDate(time);time=[time.getHours(),time.getMinutes()]}return time},_ariaFocus:function(){var ev="focus"+(webix.env.isIE?"in":"");webix._event(this.$view,ev,webix.bind(function(e){var t=e.target.className;var css=t.indexOf("webix_cal_day")!==-1?"webix_cal_day":t.indexOf("webix_cal_block")!==-1?"webix_cal_block":"";if(new Date-webix.UIManager._tab_time>300&&css){var prev=e.relatedTarget;if(prev&&!webix.isUndefined(prev.className)){var date=css=="webix_cal_day"?this._locate_day(e.target):this._locate_date(e.target);this._moveSelection(date,false)}}},this),{capture:!webix.env.isIE})},$init:function(){this._viewobj.className+=" webix_calendar";this._viewobj.setAttribute("role","region");this._viewobj.setAttribute("aria-label",webix.i18n.aria.calendar);this._special_dates={};this._selected_date_part=this._selected_date=null;this._zoom_level=0;this._ariaFocus();this.attachEvent("onKeyPress",this._onKeyPress);this.attachEvent("onAfterZoom",function(zoom){if(zoom>=0)this.$view.querySelector(".webix_cal_month_name").blur()})},type_setter:function(value){if(value=="time"){this._zoom_in=true;this._zoom_level=-1}else if(value=="year"){this._fixed=true}return value},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)){this.render()}},$getSize:function(dx,dy){if(this._settings.cellHeight){var state=this._getDateBoundaries(this._settings.date);this._settings.height=this._settings.cellHeight*state._rows+(webix.skin.$active.calendarHeight||70)}return webix.ui.view.prototype.$getSize.call(this,dx,dy)},moveSelection:function(mode,shift,focus){if(this.config.master)return;var date=webix.Date.copy(this.getSelectedDate()||this.getVisibleDate());this._moveSelection(date,mode,focus)},_moveSelection:function(date,mode,focus){var css=this._zoom_logic[this._zoom_level]._keyshift(date,mode,this);if(focus!==false){var sel=this._viewobj.querySelector("."+css+"[tabindex='0']");if(sel)sel.focus()}},_getDateBoundaries:function(date,reset){if(!this._set_date_bounds||reset){var month=date.getMonth();var year=date.getFullYear();var next=new Date(year,month+1,1);var start=webix.Date.weekStart(new Date(year,month,1));var days=Math.round((next.valueOf()-start.valueOf())/(60*1e3*60*24));var rows=this._settings.skipEmptyWeeks?Math.ceil(days/7):6;this._set_date_bounds={_month:month,_start:start,_next:next,_rows:rows}}return this._set_date_bounds},$skin:function(){if(webix.skin.$active.calendar){if(webix.skin.$active.calendar.width)this.defaults.width=webix.skin.$active.calendar.width;if(webix.skin.$active.calendar.height)this.defaults.height=webix.skin.$active.calendar.height;if(webix.skin.$active.calendar.headerHeight)this.defaults.headerHeight=webix.skin.$active.calendar.headerHeight;if(webix.skin.$active.calendar.timepickerHeight)this.defaults.timepickerHeight=webix.skin.$active.calendar.timepickerHeight}},_getColumnConfigSizes:function(date){var bounds=this._getDateBoundaries(date);var s=this._settings;var _columnsHeight=[];var _columnsWidth=[];var containerWidth=this._content_width-36;var containerHeight=this._content_height-this._settings.headerHeight-10-(this._settings.timepicker||this._icons?this._settings.timepickerHeight:0);var columnsNumber=s.weekNumber?8:7;for(var i=0;i<columnsNumber;i++){_columnsWidth[i]=Math.ceil(containerWidth/(columnsNumber-i));containerWidth-=_columnsWidth[i]}var rowsNumber=bounds._rows;for(var k=0;k<rowsNumber;k++){_columnsHeight[k]=Math.ceil(containerHeight/(rowsNumber-k));containerHeight-=_columnsHeight[k]}return[_columnsWidth,_columnsHeight]},icons_setter:function(value){if(!value)this._icons=null;else if(typeof value=="object")this._icons=value;else this._icons=this._icons2},_icons:[],_icons2:[{template:function(){return"<span role='button' tabindex='0' class='webix_cal_icon_today webix_cal_icon'>"+webix.i18n.calendar.today+"</span>"},on_click:{webix_cal_icon_today:function(){this.setValue(new Date);this.callEvent("onTodaySet",[this.getSelectedDate()])}}},{template:function(){return"<span role='button' tabindex='0' class='webix_cal_icon_clear webix_cal_icon'>"+webix.i18n.calendar.clear+"</span>"},on_click:{webix_cal_icon_clear:function(){this.setValue("");this.callEvent("onDateClear",[this.getSelectedDate()])}}}],refresh:function(){this.render()},render:function(){this._zoom_level=0;this._zoom_size=false;var s=this._settings;if(!this.isVisible(s.id))return;this._current_time=webix.Date.datePart(new Date);if(webix.debug_render)webix.log("Render: "+this.name+"@"+s.id);this.callEvent("onBeforeRender",[]);var date=this._settings.date;var bounds=this._getDateBoundaries(date,true);var sizes=this._getColumnConfigSizes(date);var width=sizes[0];var height=sizes[1];var html="<div class='webix_cal_month'><span role='button' tabindex='0' aria-live='assertive' aria-atomic='true' class='webix_cal_month_name"+(!this._settings.monthSelect?" webix_readonly":"")+"'>"+s.calendarHeader(date)+"</span>";if(s.navigation)html+="<div role='button' tabindex='0' aria-label='"+webix.i18n.aria.navMonth[0]+"' class='webix_cal_prev_button'></div><div role='button' tabindex='0' aria-label='"+webix.i18n.aria.navMonth[1]+"' class='webix_cal_next_button'></div>";html+="</div>";if(s.weekHeader)html+="<div class='webix_cal_header' aria-hidden='true'>"+this._week_template(width)+"</div>";html+="<div class='webix_cal_body'>"+this._body_template(width,height,bounds)+"</div>";if(this._settings.timepicker||this._icons){html+="<div class='webix_cal_footer'>";if(this._settings.timepicker)html+=this._timepicker_template(date);if(this._icons)html+=this._icons_template();html+="</div>"}this._contentobj.innerHTML=html;if(this._settings.type=="time"){var time=this._settings.date;if(time){if(typeof time=="string"){date=webix.i18n.parseTimeFormatDate(time)}else if(webix.isArray(time)){date.setHours(time[0]);date.setMinutes(time[1])}}this._changeZoomLevel(-1,date)}else if(this._settings.type=="month"){this._changeZoomLevel(1,date)}else if(this._settings.type=="year"){this._changeZoomLevel(2,date)}this.callEvent("onAfterRender",[])},_icons_template:function(date){var html="<div class='webix_cal_icons'>";var icons=this._icons;for(var i=0;i<icons.length;i++){if(icons[i].template){var template=typeof icons[i].template=="function"?icons[i].template:webix.template(icons[i].template);html+=template.call(this,date)}if(icons[i].on_click){webix.extend(this.on_click,icons[i].on_click)}}html+="</div>";return html},_timepicker_template:function(date){var timeFormat=this._settings.calendarTime||webix.i18n.timeFormatStr;var tpl="";if(!this._settings.master)tpl="<div role='button' tabindex='0' class='webix_cal_time"+(this._icons?" webix_cal_time_icons":"")+"'><span class='webix_icon fa-clock-o'></span> "+timeFormat(date)+"</div>";else{var range_date=webix.copy(webix.$$(this._settings.master)._settings.value);if(webix.Date.equal(range_date.end,date))range_date.start=range_date.end;for(var i in range_date){tpl+="<div role='button' tabindex='0' class='webix_range_time_"+i+" webix_cal_time'><span class='webix_icon fa-clock-o'></span> "+timeFormat(range_date[i])+"</div>"}}return tpl},_week_template:function(widths){var s=this._settings;var week_template="";var correction=0;if(s.weekNumber){correction=1;week_template+="<div class='webix_cal_week_header' style='width: "+widths[0]+"px;' >"+s.calendarWeekHeader()+"</div>"}var k=webix.Date.startOnMonday?1:0;for(var i=0;i<7;i++){var day_index=(k+i)%7;var day=webix.i18n.calendar.dayShort[day_index];week_template+="<div day='"+day_index+"' style='width: "+widths[i+correction]+"px;' >"+day+"</div>"}return week_template},blockDates_setter:function(value){return webix.toFunctor(value,this.$scope)},_day_css:function(day,bounds){var css="";if(webix.Date.equal(day,this._current_time))css+=" webix_cal_today";if(!this._checkDate(day))css+=" webix_cal_day_disabled";if(webix.Date.equal(day,this._selected_date_part))css+=" webix_cal_select";if(day.getMonth()!=bounds._month)css+=" webix_cal_outside";if(this._settings.events)css+=" "+(this._settings.events(day)||"");css+=" webix_cal_day";return css},_body_template:function(widths,heights,bounds){var s=this._settings;var html="";var day=webix.Date.datePart(webix.Date.copy(bounds._start));var start=s.weekNumber?1:0;var weekNumber=webix.Date.getISOWeek(webix.Date.add(day,2,"day",true));var min=this._settings.minDate||new Date(1,1,1);var max=this._settings.maxDate||new Date(9999,1,1);for(var y=0;y<heights.length;y++){html+="<div class='webix_cal_row' style='height:"+heights[y]+"px;line-height:"+heights[y]+"px'>";if(start){if(!day.getMonth()&&day.getDate()<7)weekNumber=webix.Date.getISOWeek(webix.Date.add(day,2,"day",true));html+="<div class='webix_cal_week_num' aria-hidden='true' style='width:"+widths[0]+"px'>"+weekNumber+"</div>"}for(var x=start;x<widths.length;x++){var css=this._day_css(day,bounds);var d=this._settings.dayTemplate.call(this,day);var sel=webix.Date.equal(day,this._selected_date_part);var alabel="";if(typeof d=="object"){alabel=d.aria||alabel;d=d.text}else alabel=webix.Date.dateToStr(webix.i18n.aria.dateFormat)(day);html+="<div day='"+x+"' role='gridcell' "+(day.getMonth()!=bounds._month?"aria-hidden='true'":"")+" aria-label='"+alabel+"' tabindex='"+(sel?"0":"-1")+"' aria-selected='"+(sel?"true":"false")+"' class='"+css+"' style='width:"+widths[x]+"px'><span aria-hidden='true' class='webix_cal_day_inner'>"+d+"</span></div>";day=webix.Date.add(day,1,"day");if(day.getHours()){day=webix.Date.datePart(day)}}html+="</div>";weekNumber++}return html},_changeDate:function(dir,step,notset){var now=this._settings.date;if(!step){step=this._zoom_logic[this._zoom_level]._changeStep}if(!this._zoom_level){now=webix.Date.copy(now);now.setDate(1)}var next=webix.Date.add(now,dir*step,"month",true);this._changeDateInternal(now,next)},_changeDateInternal:function(now,next){if(this.callEvent("onBeforeMonthChange",[now,next])){if(this._zoom_level){this._update_zoom_level(next)}else{this.showCalendar(next)}this.callEvent("onAfterMonthChange",[next,now])}},_zoom_logic:{"-2":{_isBlocked:function(i){var config=this._settings,date=config.date,isBlocked=false;var minHour=config.minTime?config.minTime[0]:0;var maxHour=config.maxTime?config.maxTime[0]+(config.maxTime[1]?1:0):24;var minMinute=config.minTime&&date.getHours()==minHour?config.minTime[1]:0;var maxMinute=config.maxTime&&config.maxTime[1]&&date.getHours()==maxHour-1?config.maxTime[1]:60;if(this._settings.blockTime){var d=webix.Date.copy(date);d.setMinutes(i);isBlocked=this._settings.blockTime(d)}return i<minMinute||i>=maxMinute||isBlocked},_setContent:function(next,i){next.setMinutes(i)},_findActive:function(date,mode,calendar){if(!this._isBlocked.call(calendar,date.getMinutes()))return date;else{var step=calendar._settings.minuteStep;var newdate=webix.Date.add(date,mode=="right"?step:-step,"minute",true);if(date.getHours()===newdate.getHours())return this._findActive(newdate,mode,calendar)}}},"-1":{_isBlocked:function(i){var config=this._settings,date=config.date;var minHour=config.minTime?config.minTime[0]:0;var maxHour=config.maxTime?config.maxTime[0]+(config.maxTime[1]?1:0):24;if(i<minHour||i>=maxHour)return true;if(config.blockTime){var d=webix.Date.copy(date);d.setHours(i);var minMinute=config.minTime&&i==minHour?config.minTime[1]:0;var maxMinute=config.maxTime&&config.maxTime[1]&&i==maxHour-1?config.maxTime[1]:60;for(var j=minMinute;j<maxMinute;j+=config.minuteStep){d.setMinutes(j);if(!config.blockTime(d))return false}return true}},_setContent:function(next,i){next.setHours(i)},_keyshift:function(date,mode,calendar){var newdate,inc,step=calendar._settings.minuteStep;if(mode==="bottom"||mode==="top"){date.setHours(mode==="bottom"?23:0);date.setMinutes(mode==="bottom"?55:0);date.setSeconds(0);date.setMilliseconds(0);newdate=date}else if(mode==="left"||mode==="right"){inc=mode==="right"?step:-step;if(mode==="left"&&date.getMinutes()<step)inc=60-step;if(mode==="right"&&date.getMinutes()>=60-step)inc=step-60;inc-=date.getMinutes()%step;newdate=calendar._zoom_logic["-2"]._findActive(webix.Date.add(date,inc,"minute"),mode,calendar)}else if(mode==="up"||mode==="down"){inc=mode==="down"?1:-1;if(mode==="down"&&date.getHours()===23)inc=-23;if(mode==="up"&&date.getHours()===0)inc=23;newdate=this._findActive(webix.Date.add(date,inc,"hour"),mode,calendar)}else if(mode===false)newdate=this._findActive(date,mode,calendar);calendar.selectDate(newdate,false);if(newdate){calendar._update_zoom_level(newdate);calendar.selectDate(newdate,false)}return"webix_cal_block"+(mode==="left"||mode==="right"?"_min":"")},_findActive:function(date,mode,calendar){if(!this._isBlocked.call(calendar,date.getHours()))return date;else{var newdate=webix.Date.add(date,mode=="down"?1:-1,"hour",true);if(date.getDate()===newdate.getDate())return this._findActive(newdate,mode,calendar)}}},0:{_changeStep:1,_keyshift:function(date,mode,calendar){var newdate=date;if(mode==="pgup"||mode==="pgdown")newdate=webix.Date.add(date,mode==="pgdown"?1:-1,"month");else if(mode==="bottom")newdate=new Date(date.getFullYear(),date.getMonth()+1,0);else if(mode==="top")newdate=new Date(date.setDate(1));else if(mode==="left"||mode==="right")newdate=webix.Date.add(date,mode==="right"?1:-1,"day");else if(mode==="up"||mode==="down")newdate=webix.Date.add(date,mode==="down"?1:-1,"week");if(!calendar._checkDate(newdate))newdate=calendar._findActive(date,mode);if(newdate)calendar.selectDate(newdate,true);return"webix_cal_day"}},1:{_isBlocked:function(i,calendar){var blocked=false,minYear,maxYear,min=calendar._settings.minDate||null,max=calendar._settings.maxDate||null,year=calendar._settings.date.getFullYear();if(min&&max){minYear=min.getFullYear();maxYear=max.getFullYear();if(year<minYear||year==minYear&&min.getMonth()>i||year>maxYear||year==maxYear&&max.getMonth()<i)blocked=true}return blocked},_correctDate:function(date,calendar){if(date<calendar._settings.minDate){date=webix.Date.copy(calendar._settings.minDate)}else if(date>calendar._settings.maxDate){date=webix.Date.copy(calendar._settings.maxDate)}return date},_getTitle:function(date){return date.getFullYear()},_getContent:function(i){return webix.i18n.calendar.monthShort[i]},_setContent:function(next,i){if(i!=next.getMonth())next.setDate(1);next.setMonth(i)},_changeStep:12,_keyshift:function(date,mode,calendar){var newdate=date;if(mode==="pgup"||mode==="pgdown")newdate=webix.Date.add(date,mode==="pgdown"?1:-1,"year");else if(mode==="bottom")newdate=new Date(date.setMonth(11));else if(mode==="top")newdate=new Date(date.setMonth(0));else if(mode==="left"||mode==="right")newdate=webix.Date.add(date,mode==="right"?1:-1,"month");else if(mode==="up"||mode==="down")newdate=webix.Date.add(date,mode==="down"?4:-4,"month");if(!calendar._checkDate(newdate))newdate=calendar._findActive(date,mode);if(newdate){calendar._update_zoom_level(newdate);calendar.selectDate(newdate,false)}return"webix_cal_block"}},2:{_isBlocked:function(i,calendar){i+=calendar._zoom_start_date;var blocked=false;var min=calendar._settings.minDate;var max=calendar._settings.maxDate;if(min&&max&&(min.getFullYear()>i||max.getFullYear()<i)){blocked=true}return blocked},_correctDate:function(date,calendar){if(date<calendar._settings.minDate){date=webix.Date.copy(calendar._settings.minDate)}else if(date>calendar._settings.maxDate){date=webix.Date.copy(calendar._settings.maxDate)}return date},_getTitle:function(date,calendar){var start=date.getFullYear();calendar._zoom_start_date=start=start-start%10-1;return start+" - "+(start+10+1)},_getContent:function(i,calendar){return calendar._zoom_start_date+i},_setContent:function(next,i,calendar){next.setFullYear(calendar._zoom_start_date+i)},_changeStep:12*10,_keyshift:function(date,mode,calendar){var newdate=date;if(mode==="pgup"||mode==="pgdown")newdate=webix.Date.add(date,mode==="pgdown"?10:-10,"year");else if(mode==="bottom")newdate=new Date(date.setYear(calendar._zoom_start_date+10));else if(mode==="top")newdate=new Date(date.setYear(calendar._zoom_start_date));else if(mode==="left"||mode==="right")newdate=webix.Date.add(date,mode==="right"?1:-1,"year");else if(mode==="up"||mode==="down")newdate=webix.Date.add(date,mode==="down"?4:-4,"year");if(!calendar._checkDate(newdate))newdate=calendar._findActive(date,mode);if(newdate){calendar._update_zoom_level(newdate);calendar.selectDate(newdate,false)}return"webix_cal_block"}}},_correctBlockedTime:function(){var i,isDisabledHour,isDisabledMinutes;isDisabledHour=this._zoom_logic[-1]._isBlocked.call(this,this._settings.date.getHours());if(isDisabledHour){for(i=0;i<24;i++){if(!this._zoom_logic[-1]._isBlocked.call(this,i)){this._settings.date.setHours(i);break}}}isDisabledMinutes=this._zoom_logic[-2]._isBlocked.call(this,this._settings.date.getMinutes());if(isDisabledMinutes){for(i=0;i<60;i+=this._settings.minuteStep){if(!this._zoom_logic[-2]._isBlocked.call(this,i)){this._settings.date.setMinutes(i);break}}}},_update_zoom_level:function(date){var config,css,height,i,index,sections,selected,type,width,zlogic,value,temp;var html="";config=this._settings;index=config.weekHeader?2:1;zlogic=this._zoom_logic[this._zoom_level];sections=this._contentobj.childNodes;if(date){config.date=date}type=config.type;if(!this._zoom_size){this._reserve_box_height=this._contentobj.offsetHeight-config.headerHeight;if(type!="year"&&type!="month")this._reserve_box_height-=config.timepickerHeight;else if(this._icons){this._reserve_box_height-=10}this._reserve_box_width=sections[index].offsetWidth;this._zoom_size=1}if(this._zoom_in){height=this._reserve_box_height/6;var timeColNum=6;var timeFormat=this._calendarTime||webix.i18n.timeFormat;var enLocale=timeFormat.match(/%([a,A])/);if(enLocale)timeColNum++;width=parseInt((this._reserve_box_width-3)/timeColNum,10);html+="<div class='webix_time_header'>"+this._timeHeaderTemplate(width,enLocale)+"</div>";html+="<div  class='webix_cal_body' style='height:"+this._reserve_box_height+"px'>";this._correctBlockedTime();html+="<div class='webix_hours'>";selected=config.date.getHours();temp=webix.Date.copy(config.date);for(i=0;i<24;i++){css="";if(enLocale){if(i%4===0){var label=!i?webix.i18n.am[0]:i==12?webix.i18n.pm[0]:"";html+="<div class='webix_cal_block_empty"+css+"' style='"+this._getCalSizesString(width,height)+"clear:both;"+"'>"+label+"</div>"}}if(this._zoom_logic[-1]._isBlocked.call(this,i)){css+=" webix_cal_day_disabled"}else if(selected==i)css+=" webix_selected";temp.setHours(i);html+="<div aria-label='"+webix.Date.dateToStr(webix.i18n.aria.hourFormat)(temp)+"' role='gridcell'"+" tabindex='"+(selected==i?"0":"-1")+"' aria-selected='"+(selected==i?"true":"false")+"' class='webix_cal_block"+css+"' data-value='"+i+"' style='"+this._getCalSizesString(width,height)+(i%4===0&&!enLocale?"clear:both;":"")+"'>"+webix.Date.toFixed(enLocale?!i||i==12?12:i%12:i)+"</div>"}html+="</div>";html+="<div class='webix_minutes'>";selected=config.date.getMinutes();temp=webix.Date.copy(config.date);for(i=0;i<60;i+=config.minuteStep){css="";if(this._zoom_logic[-2]._isBlocked.call(this,i)){css=" webix_cal_day_disabled"}else if(selected==i)css=" webix_selected";temp.setMinutes(i);html+="<div aria-label='"+webix.Date.dateToStr(webix.i18n.aria.minuteFormat)(temp)+"' role='gridcell' tabindex='"+(selected==i?"0":"-1")+"' aria-selected='"+(selected==i?"true":"false")+"' class='webix_cal_block webix_cal_block_min"+css+"' data-value='"+i+"' style='"+this._getCalSizesString(width,height)+(i%2===0?"clear:both;":"")+"'>"+webix.Date.toFixed(i)+"</div>"}html+="</div>";html+="</div>";html+="<div  class='webix_time_footer'>"+this._timeButtonsTemplate()+"</div>";this._contentobj.innerHTML=html}else{var header=sections[0].childNodes;var labels=webix.i18n.aria["nav"+(this._zoom_level==1?"Year":"Decade")];header[0].innerHTML=zlogic._getTitle(config.date,this);header[1].setAttribute("aria-label",labels[0]);header[2].setAttribute("aria-label",labels[1]);height=this._reserve_box_height/3;width=this._reserve_box_width/4;if(this._checkDate(config.date))selected=this._zoom_level==1?config.date.getMonth():config.date.getFullYear();for(i=0;i<12;i++){css=selected==(this._zoom_level==1?i:zlogic._getContent(i,this))?" webix_selected":"";if(zlogic._isBlocked(i,this)){css+=" webix_cal_day_disabled"}var format=webix.i18n.aria[(this._zoom_level==1?"month":"year")+"Format"];html+="<div role='gridcell' aria-label='"+webix.Date.dateToStr(format)(config.date)+"' tabindex='"+(css.indexOf("selected")!==-1?"0":"-1")+"' aria-selected='"+(css.indexOf("selected")!==-1?"true":"false")+"' class='webix_cal_block"+css+"' data-value='"+i+"' style='"+this._getCalSizesString(width,height)+"'>"+zlogic._getContent(i,this)+"</div>"}if(index-1){sections[index-1].style.display="none"}sections[index].innerHTML=html;if(type!="year"&&type!="month"){if(!sections[index+1])this._contentobj.innerHTML+="<div  class='webix_time_footer'>"+this._timeButtonsTemplate()+"</div>";else sections[index+1].innerHTML=this._timeButtonsTemplate()}sections[index].style.height=this._reserve_box_height+"px"}},_getCalSizesString:function(width,height){return"width:"+width+"px; height:"+height+"px; line-height:"+height+"px;"},_timeButtonsTemplate:function(){return"<input type='button' style='width:100%' class='webix_cal_done' value='"+webix.i18n.calendar.done+"'>"},_timeHeaderTemplate:function(width,enLocale){var w1=width*(enLocale?5:4);var w2=width*2;return"<div class='webix_cal_hours' style='width:"+w1+"px'>"+webix.i18n.calendar.hours+"</div><div class='webix_cal_minutes' style='width:"+w2+"px'>"+webix.i18n.calendar.minutes+"</div>"},_changeZoomLevel:function(zoom,date){var oldzoom=this._zoom_level;if(this.callEvent("onBeforeZoom",[zoom,oldzoom])){this._zoom_level=zoom;if(zoom)this._update_zoom_level(date);else this.showCalendar(date);this.callEvent("onAfterZoom",[zoom,oldzoom])}},_correctDate:function(date){if(!this._checkDate(date)&&this._zoom_logic[this._zoom_level]._correctDate)date=this._zoom_logic[this._zoom_level]._correctDate(date,this);return date},_mode_selected:function(target){var next=this._locate_date(target);var zoom=this._zoom_level-(this._fixed?0:1);next=this._correctDate(next);if(this._checkDate(next)){this._changeZoomLevel(zoom,next);var type=this._settings.type;if(type=="month"||type=="year")this._selectDate(next)}},_selectDate:function(date){if(this.callEvent("onBeforeDateSelect",[date])){this.selectDate(date,true);this.callEvent("onDateSelect",[date]);this.callEvent("onAfterDateSelect",[date])}},_locate_day:function(target){var cind=webix.html.index(target)-(this._settings.weekNumber?1:0);var rind=webix.html.index(target.parentNode);var date=webix.Date.add(this._getDateBoundaries()._start,cind+rind*7,"day",true);if(this._settings.timepicker){date.setHours(this._settings.date.getHours());date.setMinutes(this._settings.date.getMinutes())}return date},_locate_date:function(target){var value=target.getAttribute("data-value")*1;var level=target.className.indexOf("webix_cal_block_min")!=-1?this._zoom_level-1:this._zoom_level;var now=this._settings.date;var next=webix.Date.copy(now);this._zoom_logic[level]._setContent(next,value,this);return next},on_click:{webix_cal_prev_button:function(e,id,target){this._changeDate(-1)},webix_cal_next_button:function(e,id,target){this._changeDate(1)},webix_cal_day_disabled:function(){return false},webix_cal_outside:function(){if(!this._settings.navigation)return false},webix_cal_day:function(e,id,target){var date=this._locate_day(target);this._selectDate(date)},webix_cal_time:function(e){if(this._zoom_logic[this._zoom_level-1]){this._zoom_in=true;var zoom=this._zoom_level-1;this._changeZoomLevel(zoom)}},webix_range_time_start:function(){webix.$$(this._settings.master)._time_mode="start"},webix_range_time_end:function(){webix.$$(this._settings.master)._time_mode="end"},webix_cal_done:function(e){var date=webix.Date.copy(this._settings.date);date=this._correctDate(date);this._selectDate(date)},webix_cal_month_name:function(e){this._zoom_in=false;if(this._zoom_level==2||!this._settings.monthSelect)return;var zoom=Math.max(this._zoom_level,0)+1;this._changeZoomLevel(zoom)},webix_cal_block:function(e,id,trg){if(this._zoom_in){if(trg.className.indexOf("webix_cal_day_disabled")!==-1)return false;var next=this._locate_date(trg);this._update_zoom_level(next)}else{if(trg.className.indexOf("webix_cal_day_disabled")==-1)this._mode_selected(trg)}}},_string_to_date:function(date,format){if(!date){return webix.Date.datePart(new Date)}if(typeof date=="string"){if(format)date=webix.Date.strToDate(format)(date);else date=webix.i18n.parseFormatDate(date)}return date},_checkDate:function(date){var blockedDate=this._settings.blockDates&&this._settings.blockDates.call(this,date);var minDate=this._settings.minDate;var maxDate=this._settings.maxDate;var outOfRange=date<minDate||date>maxDate;return!blockedDate&&!outOfRange},_findActive:function(date,mode){var dir=mode==="top"||mode==="left"||mode==="pgup"||mode==="up"?-1:1;var newdate=webix.Date.add(date,dir,"day",true);if(this._checkDate(newdate))return newdate;else{var compare;if(this._zoom_level===0)compare=date.getMonth()===newdate.getMonth();else if(this._zoom_level===1)compare=date.getFullYear()===newdate.getFullYear();else if(this._zoom_level===2)compare=newdate.getFullYear()>this._zoom_start_date&&newdate.getFullYear()<this._zoom_start_date+10;if(compare)return this._findActive(newdate,mode)}},showCalendar:function(date){date=this._string_to_date(date);this._settings.date=date;this.render();this.resize()},getSelectedDate:function(){return this._selected_date?webix.Date.copy(this._selected_date):this._selected_date},getVisibleDate:function(){return webix.Date.copy(this._settings.date)},setValue:function(date,format){this.selectDate(date,true)},getValue:function(format){var date=this.getSelectedDate();if(format)date=webix.Date.dateToStr(format)(date);return date},selectDate:function(date,show){if(date){date=this._string_to_date(date);this._selected_date=date;this._selected_date_part=webix.Date.datePart(webix.Date.copy(date))}else{this._selected_date=null;this._selected_date_part=null;if(this._settings.date){webix.Date.datePart(this._settings.date)}}if(show)this.showCalendar(date);else if(show!==false)this.render();this.callEvent("onChange",[date])},locate:function(){return null}},webix.KeysNavigation,webix.MouseEvents,webix.ui.view,webix.EventSystem);webix.protoUI({name:"property",$init:function(){this._contentobj.className+=" webix_property";this._contentobj.setAttribute("role","listbox");this._destroy_with_me=[]},defaults:{nameWidth:100,editable:true},on_render:{checkbox:function(value,config){return"<input type='checkbox' class='webix_property_check' "+(value?"checked":"")+">"},color:function(value,config){return'<div class="webix_property_col_val"><div class=\'webix_property_col_ind\' style="background-color:'+(value||"#FFFFFF")+';"></div><span>'+value+"</span></div>"}},on_edit:{label:false},_id:"webix_f_id",on_click:{webix_property_check:function(ev){var id=this.locate(ev);this.getItem(id).value=!this.getItem(id).value;this.callEvent("onCheck",[id,this.getItem(id).value]);return false}},on_dblclick:{},registerType:function(name,data){if(data.template)this.on_render[name]=data.template;if(data.editor)this.on_edit[name]=data.editor;if(data.click)for(var key in data.click)this.on_click[key]=data.click[key]},elements_setter:function(data){this._idToLine={};for(var i=0;i<data.length;i++){var line=data[i];if(line.type=="multiselect")line.optionslist=true;line.id=line.id||webix.uid();line.label=line.label||"";line.value=line.value||"";this._idToLine[line.id]=i;this.template=this._map_options(data[i])}return data},showItem:function(id){webix.RenderStack.showItem.call(this,id)},locate:function(e){return webix.html.locate(arguments[0],this._id)},getItemNode:function(id){return this._dataobj.childNodes[this._idToLine[id]]},getItem:function(id){return this._settings.elements[this._idToLine[id]]},_get_editor_type:function(id){var type=this.getItem(id).type;if(type=="checkbox")return"inline-checkbox";var alter_type=this.on_edit[type];return alter_type===false?false:alter_type||type},_get_edit_config:function(id){return this.getItem(id)},_find_cell_next:function(start,check,direction){var row=this._idToLine[start.id];var order=this._settings.elements;if(direction){for(var i=row+1;i<order.length;i++){if(check.call(this,order[i].id))return order[i].id}}else{for(var i=row-1;i>=0;i--){if(check.call(this,order[i].id))return order[i].id}}return null},updateItem:function(key,data){data=data||{};var line=this.getItem(key);if(line)webix.extend(line,data,true);this.refresh()},_cellPosition:function(id){var html=this.getItemNode(id);return{left:html.offsetLeft+this._settings.nameWidth,top:html.offsetTop,height:html.firstChild.offsetHeight,width:this._data_width,parent:this._contentobj}},setValues:function(data,update){if(this._settings.complexData)data=webix.CodeParser.collapseNames(data);if(!update)this._clear();for(var key in data){var line=this.getItem(key);if(line)line.value=data[key]}this._props_dataset=data;this.refresh()},_clear:function(){var lines=this._settings.elements;for(var i=0;i<lines.length;i++)lines[i].value=""},getValues:function(){var data=webix.clone(this._props_dataset||{});for(var i=0;i<this._settings.elements.length;i++){var line=this._settings.elements[i];if(line.type!="label")data[line.id]=line.value}if(this._settings.complexData)data=webix.CodeParser.expandNames(data);return data},refresh:function(){this.render()},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)){this._data_width=this._content_width-this._settings.nameWidth;this.render()}},$getSize:function(dx,dy){if(this._settings.autoheight){var count=this._settings.elements.length;this._settings.height=Math.max(this.type.height*count,this._settings.minHeight||0)}return webix.ui.view.prototype.$getSize.call(this,dx,dy)},_toHTML:function(){var html=[];var els=this._settings.elements;if(els)for(var i=0;i<els.length;i++){var data=els[i];if(data.css&&typeof data.css=="object")data.css=webix.html.createCss(data.css);var pre='<div webix_f_id="'+data.id+'"'+(data.type!=="label"?'role="option" tabindex="0"':"")+' class="webix_property_line '+(data.css||"")+'">';if(data.type=="label")html[i]=pre+"<div class='webix_property_label_line'>"+data.label+"</div></div>";else{var render=this.on_render[data.type],content;var post="<div class='webix_property_label' style='width:"+this._settings.nameWidth+"px'>"+data.label+"</div><div class='webix_property_value' style='width:"+this._data_width+"px'>";if(data.collection||data.options){content=data.template(data,data.value)}else if(data.format)content=data.format(data.value);else content=data.value;if(render)content=render.call(this,data.value,data);html[i]=pre+post+content+"</div></div>"}}return html.join("")},type:{height:24,templateStart:webix.template(""),templateEnd:webix.template("</div>")},$skin:function(){this.type.height=webix.skin.$active.propertyItemHeight||24}},webix.AutoTooltip,webix.EditAbility,webix.MapCollection,webix.MouseEvents,webix.Scrollable,webix.SingleRender,webix.AtomDataLoader,webix.EventSystem,webix.ui.view);webix.protoUI({name:"colorboard",defaults:{template:'<div style="width:100%;height:100%;background-color:{obj.val}"></div>',palette:null,height:220,width:220,cols:12,rows:10,minLightness:.15,maxLightness:1,navigation:true},$init:function(config){webix._event(this._viewobj,"click",webix.bind(function(e){var value=webix.html.locate(e,"webix_val");this.setValue(value);this.callEvent("onItemClick",[this._settings.value,e]);this.callEvent("onSelect",[this._settings.value])},this));this.$view.setAttribute("role","grid");this._viewobj.setAttribute("aria-readonly","true")},_findIndex:function(value){var pal=this._settings.palette;value=(value||"").toUpperCase();for(var r=0,rows=pal.length;r<rows;r++)for(var c=0,cols=pal[r].length;c<cols;c++){if(pal[r][c].toUpperCase()==value){return{row:r,col:c}}}return null},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)){this.render()}},getValue:function(){return this._settings.value},_getBox:function(){return this._viewobj.firstChild},setValue:function(value){if(value&&value.toString().charAt(0)!="#")value="#"+value;var oldvalue=this._settings.value;this._settings.value=value;this.$setValue(value,oldvalue);return value},_selectBox:null,_getSelectBox:function(){if(this._selectBox&&this._selectBox.parentNode){return this._selectBox}else{var div=this._selectBox=document.createElement("div");div.className="webix_color_selector";this._viewobj.lastChild.appendChild(div);return div}},$setValue:function(value,oldvalue){if(this.isVisible(this._settings.id)){var cell,div,ind,parent,style,left=0,top=0;if(oldvalue)ind=this._findIndex(oldvalue);if(!ind)ind={row:0,col:0};this._viewobj.lastChild.childNodes[ind.row].childNodes[ind.col].setAttribute("tabindex","-1");ind=this._findIndex(value);if(ind){cell=this._viewobj.lastChild.childNodes[ind.row].childNodes[ind.col]}if(cell&&cell.parentNode&&cell.parentNode.parentNode){parent=cell.parentNode;left=cell.offsetLeft-parent.offsetLeft;top=-(this.$height-(cell.offsetTop-parent.parentNode.offsetTop));cell.setAttribute("tabindex","0");cell.setAttribute("aria-selected","true");cell.setAttribute("tabindex","0");cell.setAttribute("aria-selected","true")}else{if(this._selectBox)this._selectBox.style.left="-100px";this._viewobj.lastChild.childNodes[0].childNodes[0].setAttribute("tabindex","0");return}div=this._getSelectBox();style=["left:"+left+"px","top:"+top+"px","width:"+cell.style.width,"height:"+cell.style.height].join(";");if(typeof div.style.cssText!=="undefined"){div.style.cssText=style}else{div.setAttribute("style",style)}}},_initPalette:function(config){function numToHex(n){return webix.color.toHex(n,2)}function rgbToHex(r,g,b){return"#"+numToHex(Math.floor(r))+numToHex(Math.floor(g))+numToHex(Math.floor(b))}function hslToRgb(h,s,l){var r,g,b;if(!s){r=g=b=l}else{var q=l<.5?l*(1+s):l+s-l*s;var p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3)}return{r:r*255,g:g*255,b:b*255}}function hue2rgb(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;else if(t<=1/2)return q;else if(t<2/3)return p+(q-p)*(2/3-t)*6;else return p}function renderGrayBar(colCount){var gray=[],val=255,step=val/colCount;for(var i=0;i<colCount;i++){val=Math.round(val>0?val:0);gray.push(rgbToHex(val,val,val));val-=step}gray[gray.length-1]="#000000";return gray}var colors=[];var colorRows=config.rows-1;var colorStep=1/config.cols;var lightStep=(config.maxLightness-config.minLightness)/colorRows;var colorRange=null;colors.push(renderGrayBar(config.cols));for(var step=0,lt=config.minLightness;step<colorRows;step++){colorRange=[];for(var c=0,col=0;c<config.cols;c++){var val=hslToRgb(col,1,lt);colorRange.push(rgbToHex(val.r,val.g,val.b));col+=colorStep}colors.push(colorRange);lt+=lightStep}this._settings.palette=colors},moveSelection:function(mode,shift,focus){var value=this.getValue(),ind,cell;if(value)ind=this._findIndex(value);if(!ind)ind={row:0,col:0};if(ind){if(mode=="up"||mode=="down")ind.row=ind.row+(mode=="up"?-1:1);else if(mode=="right"||mode=="left")ind.col=ind.col+(mode=="right"?1:-1);else if(mode=="top")ind.row=ind.col=0;else if(mode=="bottom"){ind.row=this._viewobj.lastChild.querySelectorAll(".webix_color_row").length-1;ind.col=this._viewobj.lastChild.childNodes[ind.row].childNodes.length-1}if(ind.row>=0)cell=this._viewobj.lastChild.childNodes[ind.row].childNodes[ind.col];if(cell){value=cell.getAttribute("webix_val");this.setValue(value);this.callEvent("onSelect",[this._settings.value]);if(focus!==false){var sel=this._viewobj.querySelector("div[tabindex='0']");if(sel)sel.focus()}}}},render:function(){if(!this.isVisible(this._settings.id))return;if(!this._settings.palette)this._initPalette(this._settings);var palette=this._settings.palette;this.callEvent("onBeforeRender",[]);var config=this._settings,itemTpl=webix.template('<div role=\'gridcell\' tabindex=\'-1\' aria-label="{obj.val}" style="width:{obj.width}px;height:{obj.height}px;" webix_val="{obj.val}">'+(config.template||"")+"</div>"),data={width:0,height:0,val:0},width=this.$width,height=this.$height,widths=[];var html='<div class="webix_color_palette"role="rowgroup">';var firstRow=typeof palette[0]=="object"?palette[0]:palette;for(var i=0;i<firstRow.length;i++){widths[i]=Math.floor(width/(firstRow.length-i));width-=widths[i]}if(typeof palette[0]=="object"){for(var r=0;r<palette.length;r++){var cellHeight=Math.floor(height/(palette.length-r));height-=cellHeight;var row=palette[r];html+=renderRow(row,widths,cellHeight)}}else{html+=renderRow(palette,widths,height)}html+="</div>";this._viewobj.innerHTML=html;function renderRow(row,widths,height){var rowHtml='<div class="webix_color_row" role="row">';for(var cell=0;cell<row.length;cell++){data.width=widths[cell];data.height=height;data.val=row[cell];rowHtml+=itemTpl(data)}rowHtml+="</div>";return rowHtml}this._selectBox=null;if(this._settings.value)this.$setValue(this._settings.value);else this._viewobj.lastChild.childNodes[0].childNodes[0].setAttribute("tabindex","0");this.callEvent("onAfterRender",[])},refresh:function(){this.render()}},webix.KeysNavigation,webix.ui.view,webix.EventSystem);webix.protoUI({name:"daterange",defaults:{button:false,icons:false,calendarCount:2,borderless:false},$init:function(config){config.calendar=config.calendar||{};config.value=this._correct_value(config.value);delete config.calendar.type;this._viewobj.className+=" webix_daterange";this._zoom_level=this._types[config.calendar.type]||0;var cols=[],skinConf=webix.skin.$active.calendar,cheight=skinConf&&skinConf.height?skinConf.height:250,cwidth=skinConf&&skinConf.width?skinConf.width:250,calendar=webix.extend({view:"calendar",width:cwidth,height:cheight},config.calendar||{},true),count=config.calendarCount=this._zoom_level===0?config.calendarCount||this.defaults.calendarCount:this.defaults.calendarCount,basecss=(calendar.css?calendar.css+" ":"")+"webix_range_",start=config.value.start||new Date;for(var i=0;i<count;i++){var date=webix.Date.add(start,this._steps[this._zoom_level]*i,"month",true);webix.extend(calendar,{events:webix.bind(this._isInRange,this),css:basecss+(count===1?"":i===0?"0":i+1==count?"N":"1"),timepicker:this._zoom_level===0?config.timepicker:false,borderless:true,date:date,master:config.id},true);cols.push(webix.copy(calendar))}config.rows=[{type:"clean",cols:cols},this._footer_row(config,cwidth*count)];config.height=config.height||calendar.height+(config.icons||config.button?35:0);config.type="line";this.$ready.push(this._after_init);webix.event(this.$view,"keydown",webix.bind(function(e){this._onKeyPress(e.which||e.keyCode,e)},this))},value_setter:function(value){return this._correct_value(value)},getValue:function(){return this._settings.value},setValue:function(value,silent){value=this._correct_value(value);this._settings.value=value;var start=value.start||value.end||new Date;if(!silent){this._cals[0].showCalendar(value.start);for(var i=1;i<this._cals.length;i++){this._cals[i]._settings.date=start;this._changeDateSilent(this._cals[i],1,i)}}this.callEvent("onChange",[value]);this.refresh()},refresh:function(){var v=this._settings.value;for(var i=0;i<this._cals.length;i++){if(this._cals[i]._zoom_level===this._zoom_level){webix.html.removeCss(this._cals[i].$view,"webix_cal_timepicker");webix.html.removeCss(this._cals[i].$view,"webix_range_timepicker");var rel=this._related_date(this._cals[i].getVisibleDate());if(rel.start||rel.end){this._cals[i]._settings.date=rel.start||rel.end;if(this._settings.timepicker){var css="webix_"+(rel.start&&rel.end?"range":"cal")+"_timepicker";webix.html.addCss(this._cals[i].$view,css)}}else webix.Date.datePart(this._cals[i]._settings.date);this._cals[i].refresh()}}},addToRange:function(date){var value=this._add_date(this._string_to_date(date));this.setValue(value)},_icons:[{template:function(){return"<span role='button' tabindex='0' class='webix_cal_icon_today webix_cal_icon'>"+webix.i18n.calendar.today+"</span>"},on_click:{webix_cal_icon_today:function(){this.addToRange(new Date);this.callEvent("onTodaySet",[this.getValue()])}}},{template:function(){return"<span role='button' tabindex='0' class='webix_cal_icon_clear webix_cal_icon'>"+webix.i18n.calendar.clear+"</span>"},on_click:{webix_cal_icon_clear:function(){this.setValue("");this.callEvent("onDateClear",[])}}}],_icons_template:function(icons){if(!icons)return{width:0};else{icons=typeof icons=="object"?icons:this._icons;var icons_template={css:"webix_cal_footer ",borderless:true,height:30,template:"<div class='webix_cal_icons'>",onClick:{}};for(var i=0;i<icons.length;i++){if(icons[i].template){var template=typeof icons[i].template=="function"?icons[i].template:webix.template(icons[i].template);icons_template.template+=template.call(this)}if(icons[i].on_click){for(var k in icons[i].on_click){icons_template.onClick[k]=webix.bind(icons[i].on_click[k],this)}}}icons_template.template+="</div>";icons_template.width=webix.html.getTextSize(icons_template.template).width+30;return icons_template}},_footer_row:function(config,width){var button={view:"button",value:webix.i18n.calendar.done,minWidth:100,maxWidth:230,align:"center",height:30,click:function(){this.getParentView().getParentView().hide()}};var icons=this._icons_template(config.icons);var row={css:"webix_range_footer",cols:[{width:icons.width}]};if((config.button||config.icons)&&icons.width*2+button.minWidth>width)row.cols[0].width=0;row.cols.push(config.button?button:{});row.cols.push(icons);return row},_types:{time:-1,month:1,year:2},_steps:{0:1,1:12,2:120},_correct_value:function(value){if(!value)value={start:null,end:null};if(!value.start&&!value.end)value={start:value};value.end=this._string_to_date(value.end)||null;value.start=this._string_to_date(value.start)||null;if(value.end&&value.end<value.start||!value.start)value.end=[value.start,value.start=value.end][0];return value},_string_to_date:function(date,format){if(typeof date=="string"){if(format)date=webix.Date.strToDate(format)(date);else date=webix.i18n.parseFormatDate(date)}return isNaN(date*1)?null:date},_isInRange:function(date){var v=this._settings.value,s=v.start?webix.Date.datePart(webix.Date.copy(v.start)):null,e=v.end?webix.Date.datePart(webix.Date.copy(v.end)):null,d=webix.Date.datePart(date),css="";if(d>=s&&e&&d<=e)css="webix_cal_range";if(webix.Date.equal(d,s))css="webix_cal_range_start";if(webix.Date.equal(d,e))css="webix_cal_range_end";var holiday=webix.Date.isHoliday(date)+" "||"";return css+" "+holiday},_after_init:function(){var cals=this._cals=this.getChildViews()[0].getChildViews();var range=this;this._cals_hash={};for(var i=0;i<cals.length;i++){this._cals_hash[cals[i].config.id]=i;cals[i].attachEvent("onBeforeDateSelect",function(date){return range._on_date_select(this,date)});cals[i].attachEvent("onBeforeZoom",function(zoom){return range._before_zoom(this,zoom)});if(i===0||i===cals.length-1){cals[i].attachEvent("onAfterMonthChange",webix.bind(this._month_change,this));cals[i].attachEvent("onAfterZoom",function(zoom,oldzoom){range._after_zoom(this,zoom,oldzoom)})}}if(this._settings.timepicker)this.refresh()},_before_zoom:function(view,zoom){var ind=this._getIndexById(view.config.id);if(zoom>=0&&ind>0&&ind!==this._cals.length-1)return false;if(zoom===-1){var rel=this._related_date(view.getVisibleDate());if(rel.start&&rel.end)view._settings.date=rel[this._time_mode]}return true},_month_change:function(now,prev){var dir=now>prev?1:-1;var start=now>prev?this._cals[this._cals.length-1]:this._cals[0];var step=start._zoom_logic[start._zoom_level]._changeStep;this._shift(dir,step,start);this.refresh()},_after_zoom:function(start,zoom,oldzoom){var step=start._zoom_logic[start._zoom_level]._changeStep;var ind=this._getIndexById(start.config.id);var dir=ind===0?1:-1;if(!this._cals[ind+dir])return;var next=this._cals[ind+dir]._settings.date;if(oldzoom>zoom&&zoom>=0){var diff=0;if(zoom===1){var year=next.getFullYear();if(this._zoom_level||dir===-1&&next.getMonth()===11||dir===1&&next.getMonth()===0)year=year-dir;diff=start._settings.date.getFullYear()-year}else if(zoom===0){var month=next.getMonth()-dir;if(month===12||month==-1)month=month===-1?11:0;diff=start._settings.date.getMonth()-month}this._shift(diff,step,start);this.refresh()}},_changeDateSilent:function(view,dir,step){view.blockEvent();if(view._zoom_level>=0)view._changeDate(dir,step);view.unblockEvent()},_getIndexById:function(id){return this._cals_hash[id]},_shift:function(dir,step,start){for(var i=0;i<this._cals.length;i++){var next=this._cals[i];if(!start||next.config.id!==start.config.id)this._changeDateSilent(next,dir,step)}},_related_date:function(date){var v=this._settings.value;var rel={};if(v.start&&v.start.getYear()===date.getYear()&&v.start.getMonth()===date.getMonth())rel.start=v.start;if(v.end&&v.end.getYear()===date.getYear()&&v.end.getMonth()===date.getMonth())rel.end=v.end;return rel},_set_time:function(date,source){date.setHours(source.getHours());date.setMinutes(source.getMinutes());date.setSeconds(source.getSeconds());date.setMilliseconds(source.getMilliseconds())},_add_date:function(date,ind){var v=webix.copy(this._settings.value);if(this._zoom_level!==0&&!webix.isUndefined(ind)){var key=ind?"end":"start";v[key]=date}else{if(v.start&&!v.end)v.end=date;else{v.start=date;v.end=null}}return v},_on_date_select:function(view,date){if(this.callEvent("onBeforeDateSelect",[date])){var v=this._settings.value;if(view._zoom_level<0){var rel=webix.copy(this._related_date(date)),reldate;reldate=rel.start&&rel.end?rel[this._time_mode]:rel.start||rel.end;if(reldate)this._set_time(reldate,date);view._zoom_level=0;v=webix.extend(webix.copy(v),rel,true)}else{var vis=view.getVisibleDate();var ind=this._getIndexById(view.config.id);if(date.getMonth()!==vis.getMonth()&&(ind===0||ind===this._cals.length-1)){var dir=date>vis?1:-1;this._shift(dir,1)}v=this._add_date(date,ind)}if(view._zoom_level!==this._zoom_level)view.showCalendar(date);this.setValue(v,true);this.callEvent("onAfterDateSelect",[this.getValue()])}return false}},webix.ui.layout);webix.protoUI({name:"daterangesuggest",defaults:{type:"daterange",body:{view:"daterange",icons:true,button:true,borderless:true}},getValue:function(){return this.getRange().getValue()},setValue:function(value){this.getRange().setValue(webix.copy(value))},getRange:function(){return this.getBody()},getButton:function(){return this.getBody().getChildViews()[1].getChildViews()[1]},_setValue:function(value,hide){var master=webix.$$(this._settings.master);if(master){master.setValue(value);if(hide)this.hide()}else this.setValue(value)},_set_on_popup_click:function(){var range=this.getRange();range.attachEvent("onAfterDateSelect",webix.bind(function(value){this._setValue(value)},this));range.attachEvent("onDateClear",webix.bind(function(value){this._setValue(value)},this));range.attachEvent("onTodaySet",webix.bind(function(value){this._setValue(value)},this))}},webix.ui.suggest);webix.protoUI({$cssName:"datepicker",name:"daterangepicker",$init:function(){this._settings.value={}},_init_popup:function(){var obj=this._settings;if(obj.suggest)obj.popup=obj.suggest;else if(!obj.popup){obj.popup=obj.suggest=this.suggest_setter({view:"daterangesuggest",body:{timepicker:obj.timepicker,calendarCount:obj.calendarCount,height:250+(obj.button||obj.icons?30:0)}})}this._init_once=function(){}},$prepareValue:function(value){value=value||{};value.start=webix.ui.datepicker.prototype.$prepareValue.call(this,value.start?value.start:null);value.end=webix.ui.datepicker.prototype.$prepareValue.call(this,value.end?value.end:null);return value},$compareValue:function(oldvalue,value){var compare=webix.ui.datepicker.prototype.$compareValue;var start=compare.call(this,oldvalue.start,value.start);var end=compare.call(this,oldvalue.end,value.end);return start&&end},$setValue:function(value){value=value||{};var popup=webix.$$(this._settings.popup.toString());var daterange=popup.getRange();this._settings.text=(value.start?this._get_visible_text(value.start):"")+(value.end?" - "+this._get_visible_text(value.end):"");this._set_visible_text()},$render:function(obj){obj.value=this.$prepareValue(obj.value);this.$setValue(obj.value)},getValue:function(){var type=this._settings.type;var timeMode=type=="time";var timepicker=this.config.timepicker;var value=this._settings.value;if(this._settings.stringResult){var formatStr=webix.i18n.parseFormatStr;if(timeMode)formatStr=webix.i18n.parseTimeFormatStr;if(this._formatStr&&(type=="month"||type=="year")){formatStr=this._formatStr}return this._formatValue(formatStr,value)}return value||null},_formatValue:function(format,value){var popup=webix.$$(this._settings.popup.toString());var daterange=popup.getRange();value=webix.copy(daterange._correct_value(value));if(value.start)value.start=format(value.start);if(value.end)value.end=format(value.end);return value}},webix.ui.datepicker);webix.protoUI({name:"resizer",defaults:{width:7,height:7},$init:function(config){webix.assert(this.getParentView(),"Resizer can't be initialized outside a layout");this._viewobj.className+=" webix_resizer";var space=this.getParentView()._margin;webix._event(this._viewobj,webix.env.mouse.down,this._rsDown,{bind:this});webix.event(document.body,webix.env.mouse.up,this._rsUp,{bind:this});var dir=this._getResizeDir();this._rs_started=false;this._resizer_dir=dir;this._resizer_dim=dir=="x"?"width":"height";if(dir=="x")config.height=0;else config.width=0;if(space>0){this._viewobj.className+=" webix_resizer_v"+dir;this._viewobj.style.marginRight="-"+space+"px";if(dir=="x")config.width=space;else config.height=space;this.$nospace=true}else this._viewobj.className+=" webix_resizer_"+dir;this._viewobj.innerHTML="<div class='webix_resizer_content'></div>";if(dir=="y"&&space>0)this._viewobj.style.marginBottom="-"+(config.height||this.defaults.height)+"px";this._viewobj.setAttribute("tabindex","-1");this._viewobj.setAttribute("aria-grabbed","false")},_rsDown:function(e){var cells=this._getResizerCells();if(cells&&!this._settings.disabled){e=e||event;this._rs_started=true;this._rs_process=webix.html.pos(e);this._rsLimit=[];this._viewobj.setAttribute("aria-grabbed","true");for(var i=0;i<2;i++)cells[i].$view.setAttribute("aria-dropeffect","move");this._viewobj.setAttribute("aria-dropeffect","move");this._rsStart(e,cells[0])}},_rsUp:function(){this._rs_started=false;this._rs_process=false},_rsStart:function(e,cell){var dir,offset,pos,posParent,start;e=e||event;dir=this._resizer_dir;this.getParentView()._viewobj.style.position="relative";pos=webix.html.offset(this._viewobj);posParent=webix.html.offset(this.getParentView()._viewobj);start=pos[dir]-posParent[dir];offset=webix.html.offset(cell.$view)[dir]-webix.html.offset(this.getParentView().$view)[dir];this._rs_progress=[dir,cell,start,offset];this._resizeStick=new webix.ui.resizearea({container:this.getParentView()._viewobj,dir:dir,eventPos:this._rs_process[dir],start:start-1,height:this.$height,width:this.$width,border:1,margin:this.getParentView()["_padding"+dir.toUpperCase()]});this._resizeStick.attachEvent("onResizeEnd",webix.bind(this._rsEnd,this));this._resizeStick.attachEvent("onResize",webix.bind(this._rsResizeHandler,this));webix.html.addCss(document.body,"webix_noselect",1)},_getResizeDir:function(){return this.getParentView()._vertical_orientation?"y":"x"},_rsResizeHandler:function(){var cells,config,cDiff,diff,dir,i,limits,limitSizes,sizes,totalSize;if(this._rs_progress){cells=this._getResizerCells();dir=this._rs_progress[0];diff=this._resizeStick._last_result-this._rs_progress[2];sizes=this._rsGetDiffCellSizes(cells,dir,diff);totalSize=cells[0]["$"+this._resizer_dim]+cells[1]["$"+this._resizer_dim];limits=dir=="y"?["minHeight","maxHeight"]:["minWidth","maxWidth"];for(i=0;i<2;i++){config=cells[i]._settings;cDiff=i?-diff:diff;var min=config[limits[0]];var max=config[limits[1]];if(cDiff>0&&max&&max<=sizes[i]||cDiff<0&&(min||3)>=sizes[i]){this._rsLimit[i]=cDiff>0?max:min||3;limitSizes=this._rsGetLimitCellSizes(cells,dir);this._resizeStick._dragobj.style[dir=="y"?"top":"left"]=this._rs_progress[3]+limitSizes[0]+"px";return}else if(sizes[i]<3){this._resizeStick._dragobj.style[dir=="y"?"top":"left"]=this._rs_progress[3]+i*totalSize+1+"px"}else{this._rsLimit[i]=null}}}},_getResizerCells:function(){var cells,i;cells=this.getParentView()._cells;for(i=0;i<cells.length;i++){if(cells[i]==this){if(!cells[i-1]||cells[i-1]._settings.$noresize)return null;if(!cells[i+1]||cells[i+1]._settings.$noresize)return null;return[cells[i-1],cells[i+1]]}}},_rsEnd:function(result){if(typeof result=="undefined")return;var cells,dir,diff,i,size;var vertical=this.getParentView()._vertical_orientation;this._resizerStick=null;if(this._rs_progress){dir=this._rs_progress[0];diff=result-this._rs_progress[2];cells=this._getResizerCells();if(cells[0]&&cells[1]){size=this._rsGetCellSizes(cells,dir,diff);for(var i=0;i<2;i++){var cell_size=cells[i].$getSize(0,0);if(vertical?cell_size[2]==cell_size[3]:Math.abs(cell_size[1]-cell_size[0])<3){cells[i]._settings[this._resizer_dim]=size[i];if(cells[i]._bubble_size)cells[i]._bubble_size(this._resizer_dim,size[i],vertical)}else{var actualSize=cells[i].$view[vertical?"offsetHeight":"offsetWidth"];cells[i]._settings.gravity=size[i]/actualSize*cells[i]._settings.gravity}}cells[0].resize();for(var i=0;i<2;i++){if(cells[i].callEvent)cells[i].callEvent("onViewResize",[]);cells[i].$view.removeAttribute("aria-dropeffect")}webix.callEvent("onLayoutResize",[cells])}this._rs_progress=false}this._rs_progress=false;this._rs_started=false;this._rsLimit=null;webix.html.removeCss(document.body,"webix_noselect");this._viewobj.setAttribute("aria-grabbed","false");this._viewobj.removeAttribute("aria-dropeffect")},_rsGetLimitCellSizes:function(cells){var size1,size2,totalSize;totalSize=cells[0]["$"+this._resizer_dim]+cells[1]["$"+this._resizer_dim];if(this._rsLimit[0]){size1=this._rsLimit[0];size2=totalSize-size1}else if(this._rsLimit[1]){size2=this._rsLimit[1];size1=totalSize-size2}return[size1,size2]},_rsGetDiffCellSizes:function(cells,dir,diff){var sizes=[];var styleDim=this._resizer_dim=="height"?"offsetHeight":"offsetWidth";for(var i=0;i<2;i++)sizes[i]=cells[i].$view[styleDim]+(i?-1:1)*diff;return sizes},_rsGetCellSizes:function(cells,dir,diff){var i,sizes,totalSize;if(this._rsLimit[0]||this._rsLimit[1]){sizes=this._rsGetLimitCellSizes(cells,dir)}else{sizes=this._rsGetDiffCellSizes(cells,dir,diff);for(i=0;i<2;i++){if(sizes[i]<0){totalSize=sizes[0]+sizes[1];sizes[i]=1;sizes[1-i]=totalSize-1}}}return sizes}},webix.MouseEvents,webix.Destruction,webix.ui.view);webix.protoUI({name:"multiview",defaults:{animate:{}},setValue:function(val){webix.$$(val).show()},getValue:function(){return this.getActiveId()},$init:function(){this._active_cell=0;this._vertical_orientation=1;this._viewobj.style.position="relative";this._viewobj.className+=" webix_multiview";this._back_queue=[]},_ask_render:function(cell_id,view_id){var cell=webix.$$(cell_id);if(!cell._render_hash){cell._render_queue=[];cell._render_hash={}}if(!cell._render_hash[view_id]){cell._render_hash[view_id]=true;cell._render_queue.push(view_id)}},_render_activation:function(cell_id){var cell=webix.$$(cell_id);if(this._settings.keepViews)cell._viewobj.style.display="";if(this._back_queue[this._back_queue.length-2]!=cell_id){if(this._back_queue.length==10)this._back_queue.splice(0,1);this._back_queue.push(cell_id)}else this._back_queue.splice(this._back_queue.length-1,1);if(cell._render_hash){for(var i=0;i<cell._render_queue.length;i++){var subcell=webix.$$(cell._render_queue[i]);if(subcell)subcell.render()}cell._render_queue=[];cell._render_hash={}}},addView:function(){var id=webix.ui.baselayout.prototype.addView.apply(this,arguments);if(this._settings.keepViews)webix.$$(id)._viewobj.style.display="none";else webix.html.remove(webix.$$(id)._viewobj);return id},_beforeRemoveView:function(index,view){if(index==this._active_cell){var next=Math.max(index-1,0);if(this._cells[next]){this._in_animation=false;this._show(this._cells[next],false)}}if(index<this._active_cell)this._active_cell--},_hide:function(){},_parse_cells:function(collection){collection=collection||this._collection;for(var i=0;i<collection.length;i++)collection[i]._inner=this._settings.borderless?{top:1,left:1,right:1,bottom:1}:this._settings._inner||{};webix.ui.baselayout.prototype._parse_cells.call(this,collection);for(var i=1;i<this._cells.length;i++){if(this._settings.keepViews)this._cells[i]._viewobj.style.display="none";else webix.html.remove(this._cells[i]._viewobj)}for(var i=0;i<collection.length;i++){var cell=this._cells[i];if(cell._cells&&!cell._render_borders)continue;var _inner=cell._settings._inner;if(_inner.top)cell._viewobj.style.borderTopWidth="0px";if(_inner.left)cell._viewobj.style.borderLeftWidth="0px";if(_inner.right)cell._viewobj.style.borderRightWidth="0px";if(_inner.bottom)cell._viewobj.style.borderBottomWidth="0px";cell._viewobj.setAttribute("role","tabpanel")}this._render_activation(this.getActiveId())},cells_setter:function(value){webix.assert(value&&value.length,"Multiview must have at least one view in 'cells'");this._collection=value},_getDirection:function(next,active){var dir=(this._settings.animate||{}).direction;var vx=dir=="top"||dir=="bottom";return next<active?vx?"bottom":"right":vx?"top":"left"},_show:function(obj,animation_options){var parent=this.getParentView();if(parent&&parent.getTabbar)parent.getTabbar().setValue(obj._settings.$id||obj._settings.id);if(this._in_animation)return webix.delay(this._show,this,[obj,animation_options],100);var _next_cell=-1;for(var i=0;i<this._cells.length;i++)if(this._cells[i]==obj){_next_cell=i;break}if(_next_cell<0||_next_cell==this._active_cell)return;var prev=this._cells[this._active_cell];var next=this._cells[_next_cell];var size=prev.$getSize(0,0);if((animation_options||typeof animation_options=="undefined")&&webix.animate.isSupported()&&this._settings.animate){var aniset=webix.extend({},this._settings.animate);if(this._settings.keepViews)aniset.keepViews=true;aniset.direction=this._getDirection(_next_cell,this._active_cell);aniset=webix.Settings._mergeSettings(animation_options||{},aniset);var line=webix.animate.formLine(next._viewobj,prev._viewobj,aniset);next.$getSize(0,0);next.$setSize(this._content_width,this._content_height);var callback_original=aniset.callback;aniset.callback=function(){webix.animate.breakLine(line,this._settings.keepViews);this._in_animation=false;if(callback_original)callback_original.call(this);callback_original=aniset.master=aniset.callback=null;this.resize()};aniset.master=this;this._active_cell=_next_cell;this._render_activation(this.getActiveId());webix.animate(line,aniset);this._in_animation=true}else{if(this._settings.keepViews){prev._viewobj.style.display="none"}else{webix.html.remove(prev._viewobj);this._viewobj.appendChild(this._cells[i]._viewobj)}this._active_cell=_next_cell;prev.resize();this._render_activation(this.getActiveId())}if(next.callEvent){next.callEvent("onViewShow",[]);webix.ui.each(next,this._signal_hidden_cells)}this.callEvent("onViewChange",[prev._settings.id,next._settings.id])},$getSize:function(dx,dy){if(!this._cells.length)return webix.ui.baseview.prototype.$getSize.call(this,0,0);webix.debug_size_box_start(this,true);var size=this._cells[this._active_cell].$getSize(0,0);if(this._settings.fitBiggest){for(var i=0;i<this._cells.length;i++)if(i!=this._active_cell){var other=this._cells[i].$getSize(0,0);for(var j=0;j<4;j++)size[j]=Math.max(size[j],other[j])}}var self_size=webix.ui.baseview.prototype.$getSize.call(this,0,0);if(self_size[1]>=1e5)self_size[1]=0;if(self_size[3]>=1e5)self_size[3]=0;self_size[0]=(self_size[0]||size[0])+dx;self_size[1]=(self_size[1]||size[1])+dx;self_size[2]=(self_size[2]||size[2])+dy;self_size[3]=(self_size[3]||size[3])+dy;webix.debug_size_box_end(this,self_size);return self_size},$setSize:function(x,y){if(!this._cells.length)return;this._layout_sizes=[x,y];webix.ui.baseview.prototype.$setSize.call(this,x,y);this._cells[this._active_cell].$setSize(x,y)},isVisible:function(base_id,cell_id){if(cell_id&&cell_id!=this.getActiveId()){if(base_id)this._ask_render(cell_id,base_id);return false}return webix.ui.view.prototype.isVisible.call(this,base_id,this._settings.id)},getActiveId:function(){return this._cells.length?this._cells[this._active_cell]._settings.id:null},back:function(step){step=step||1;if(this.callEvent("onBeforeBack",[this.getActiveId(),step])){if(this._back_queue.length>step){var viewId=this._back_queue[this._back_queue.length-step-1];webix.$$(viewId).show();return viewId}return null}return null}},webix.ui.baselayout);webix.protoUI({name:"form",defaults:{type:"form",autoheight:true},_default_height:-1,_form_classname:"webix_form",_form_vertical:true,$init:function(){this._viewobj.setAttribute("role","form")},$getSize:function(dx,dy){if(this._scroll_y&&!this._settings.width)dx+=webix.ui.scrollSize;var sizes=webix.ui.layout.prototype.$getSize.call(this,dx,dy);if(this._settings.scroll||!this._settings.autoheight){sizes[2]=this._settings.height||this._settings.minHeight||0;sizes[3]+=1e5}return sizes}},webix.ui.toolbar);(function(){var controls={};for(var i in webix.UIManager._controls){controls[webix.UIManager._controls[i]]=i}var nav_controls={9:"tab",38:"up",40:"down",37:"left",39:"right"};webix.patterns={phone:{mask:"+# (###) ###-####",allow:/[0-9]/g},card:{mask:"#### #### #### ####",allow:/[0-9]/g},date:{mask:"####-##-## ##:##",allow:/[0-9]/g}};webix.extend(webix.ui.text,{$init:function(config){if(config.pattern){this.attachEvent("onKeyPress",function(code,e){if(e.ctrlKey||e.altKey)return;if(code>105&&code<112)code-=64;if(controls[code]&&code!==8&&code!==46){if(!nav_controls[code])webix.html.preventEvent(e);return}webix.html.preventEvent(e);this._on_key_pressed(e,code)});this.attachEvent("onAfterRender",this._after_render);this.getText=function(){return this.getInputNode().value};this._pattern=function(value,mode){if(mode===false)return this._getRawValue(value);else return this._matchPattern(value)};config.invalidMessage=config.invalidMessage||webix.i18n.controls.invalidMessage}},pattern_setter:function(value){var pattern=webix.patterns[value]||value;if(typeof pattern=="string")pattern={mask:pattern};pattern.allow=pattern.allow||/[A-Za-z0-9]/g;this._patternScheme(pattern);return pattern},_init_validation:function(){this.config.validate=this.config.validate||webix.bind(function(){var value=this.getText();var raw=value.replace(this._pattern_chars,"");var matches=(value.toString().match(this._pattern_allows)||[]).join("");return matches.length==raw.length&&value.length==this._settings.pattern.mask.length},this)},_after_render:function(){var ev=webix.env.isIE8?"propertychange":"input";webix._event(this.getInputNode(),ev,function(e){var stamp=(new Date).valueOf();var width=this.$view.offsetWidth;if(!this._property_stamp||stamp-this._property_stamp>100){this._property_stamp=stamp;this.$setValue(this.getText())}},{bind:this});webix._event(this.getInputNode(),"blur",function(e){this._applyChanges()},{bind:this})},_patternScheme:function(pattern){var mask=pattern.mask,scheme={},chars="",count=0;for(var i=0;i<mask.length;i++){if(mask[i]==="#"){scheme[i]=count;count++}else{scheme[i]=false;if(chars.indexOf(mask[i])===-1)chars+="\\"+mask[i]}}this._pattern_allows=pattern.allow;this._pattern_chars=new RegExp("["+chars+"]","g");this._pattern_scheme=scheme;this._init_validation()},_on_key_pressed:function(e,code){var node=this.getInputNode();var value=node.value;var pos=webix.html.getSelectionRange(node);var chr="";if(code==8||code==46){if(pos.start==pos.end){if(code==8)pos.start--;else pos.end++}}else{chr=String.fromCharCode(code);if(!e.shiftKey)chr=chr.toLowerCase()}value=value.substr(0,pos.start)+chr+value.substr(pos.end);pos=this._getCaretPos(chr,value.length,pos.start,code);this._input_code=code;this.$setValue(value);webix.html.setSelectionRange(node,pos)},_getCaretPos:function(chr,len,pos,code){if(chr&&chr.match(this._pattern_allows)||(code==8||code==46)){pos=chr?pos+1:pos;pos=this._fixCaretPos(pos,code)}else if(len-1==pos&&code!==8&&code!==46){var rest=this._settings.pattern.mask.indexOf("#",pos);if(rest>0)pos+=rest}return pos},_fixCaretPos:function(pos,code){var prev=pos-(code!==46)*1;if(this._pattern_scheme[prev]===false){pos=pos+(code==8?-1:1);return this._fixCaretPos(pos,code)}if(this._pattern_scheme[pos]===false&&code!==8)return this._fixCaretPos(pos+1,code)-1;return pos},_getRawValue:function(value){value=value||"";var matches=value.toString().match(this._pattern_allows)||[];return matches.join("").replace(this._pattern_chars,"")},_matchPattern:function(value){var raw=this._getRawValue(value),pattern=this._settings.pattern.mask,mask=this._settings.pattern.mask,scheme=this._pattern_scheme,end=false,index=0,rawIndex=0,rawLength=0;for(var i in scheme){if(scheme[i]!==false){if(!end){index=i*1;rawIndex=scheme[i];var rchar=raw[rawIndex]||"";var next=raw[rawIndex+1];pattern=(rchar?pattern.substr(0,index):"")+rchar+(rchar&&next?pattern.substr(index+1):"");if(!next)end=true}rawLength++}}var icode=this._input_code;if(icode&&icode!==8||!icode&&rawLength-1===rawIndex&&pattern.length<mask.length){if(raw){var nind=index+1;if(mask.charAt(nind)!=="#"&&pattern.length<mask.length){var lind=mask.indexOf("#",nind);if(lind<0)lind=mask.length;pattern+=mask.substr(nind,lind-nind)}}else if(icode!==46){pattern+=mask.substr(0,mask.indexOf("#"))}}this._input_code=null;return pattern}})})();webix.protoUI({name:"gridsuggest",defaults:{type:"datatable",fitMaster:false,width:0,body:{navigation:true,autoheight:true,autowidth:true,select:true},filter:function(item,value){var text=this.config.template(item);if(text.toString().toLowerCase().indexOf(value.toLowerCase())===0)return true;return false}},$init:function(obj){if(!obj.body.columns)obj.body.autoConfig=true;if(!obj.template)obj.template=webix.bind(this._getText,this)},_getText:function(item,common){var grid=this.getBody();var value=this.config.textValue||grid.config.columns[0].id;return grid.getText(item.id,value)}},webix.ui.suggest);webix.protoUI({name:"datasuggest",defaults:{type:"dataview",fitMaster:false,width:0,body:{xCount:3,autoheight:true,select:true}}},webix.ui.suggest);webix.protoUI({name:"multiselect",$cssName:"richselect",defaults:{separator:","},_suggest_config:function(value){var isobj=!webix.isArray(value)&&typeof value=="object"&&!value.name;var suggest={view:"checksuggest",separator:this.config.separator,buttonText:this.config.buttonText,button:this.config.button};if(this._settings.optionWidth)suggest.width=this._settings.optionWidth;else suggest.fitMaster=true;if(isobj)webix.extend(suggest,value,true);var view=webix.ui(suggest);var list=view.getList();if(typeof value=="string")list.load(value);else if(!isobj)list.parse(value);view.attachEvent("onShow",function(node,mode,point){view.setValue(webix.$$(view._settings.master).config.value)});return view},$setValue:function(value){if(!this._rendered_input)return;var popup=this.getPopup();var text="";if(popup){text=popup.setValue(value);if(typeof text=="object"){text=text.join(this.config.separator+" ")}}this._settings.text=text;var node=this.getInputNode();node.innerHTML=text||this._get_div_placeholder()},getValue:function(){return this._settings.value||""}},webix.ui.richselect);webix.editors.multiselect=webix.extend({popupType:"multiselect"},webix.editors.richselect);webix.type(webix.ui.list,{name:"multilist",templateStart:webix.template('<div webix_l_id="#!id#" class="{common.classname()}" style="width:{common.widthSize()}; height:{common.heightSize()}; overflow:hidden;" {common.aria()}>')},"default");webix.type(webix.ui.list,{name:"checklist",templateStart:webix.template('<div webix_l_id="#!id#" {common.aria()} class="{common.classname()}" style="width:{common.widthSize()}; height:{common.heightSize()}; overflow:hidden; white-space:nowrap;">{common.checkbox()}'),checkbox:function(obj,common){var icon=obj.$checked?"fa-check-square":"fa-square-o";return"<span role='checkbox' tabindex='-1' aria-checked='"+(obj.$checked?"true":"false")+"' class='webix_icon "+icon+"'></span>"},aria:function(obj){return"role='option' tabindex='-1' "+(obj.$checked?"aria-selected='true'":"")},template:webix.template("#value#")},"default");webix.protoUI({name:"multisuggest",defaults:{separator:",",type:"layout",button:true,width:0,filter:function(item,value){var itemText=this.getItemText(item.id);return itemText.toString().toLowerCase().indexOf(value.toLowerCase())>-1},body:{rows:[{view:"list",type:"multilist",borderless:true,autoheight:true,yCount:5,multiselect:"touch",select:true,on:{onItemClick:function(id){var popup=this.getParentView().getParentView();webix.delay(function(){popup._toggleOption(id)})}}},{view:"button",click:function(){var suggest=this.getParentView().getParentView();suggest.setMasterValue({id:suggest.getValue()});suggest.hide()}}]}},_toggleOption:function(id,ev){var value=this.getValue();var values=webix.toArray(value?this.getValue().split(this._settings.separator):[]);if(values.find(id)<0){values.push(id)}else values.remove(id);var master=webix.$$(this._settings.master);if(master){master.setValue(values.join(this._settings.separator))}else{var text=this.setValue(values);if(this._last_input_target)this._last_input_target.value=text.join(this._settings.separator)}if(ev){var checkbox=this.getList().getItemNode(id).getElementsByTagName("SPAN");if(checkbox&&checkbox.length)checkbox[0].focus()}},_get_extendable_cell:function(obj){return obj.rows[0]},_set_on_popup_click:function(){var button=this.getButton();var text=this._settings.button?this._settings.buttonText||webix.i18n.controls.select:0;if(button){if(text){button._settings.value=text;button.refresh()}else button.hide()}var list=this.getList();list.data.attachEvent("onAfterFilter",webix.bind(function(){return this._suggest_after_filter()},this))},getButton:function(){return this.getBody().getChildViews()[1]},getList:function(){return this.getBody().getChildViews()[0]},setValue:function(value){var text=[];var list=this.getList();list.unselect();if(value){if(typeof value=="string")value=value.split(this.config.separator);if(value[0]){for(var i=0;i<value.length;i++){if(list.getItem(value[i])){if(list.exists(value[i]))list.select(value[i],true);text.push(this.getItemText(value[i]))}}}}this._settings.value=value?value.join(this.config.separator):"";return text},getValue:function(){return this._settings.value}},webix.ui.suggest);webix.protoUI({name:"checksuggest",defaults:{button:false,body:{rows:[{view:"list",css:"webix_multilist",borderless:true,autoheight:true,yCount:5,select:true,type:"checklist",on:{onItemClick:function(id,e){var item=this.getItem(id);item.$checked=item.$checked?0:1;this.refresh(id);var popup=this.getParentView().getParentView();popup._click_stamp=new Date;popup._toggleOption(id,e)}}},{view:"button",click:function(){var suggest=this.getParentView().getParentView();suggest.setMasterValue({id:suggest.getValue()});suggest.hide()}}]}},$init:function(){this._valueHistory={};this.$ready.push(this._onReady)},_onReady:function(){var list=this.getList();if(list.config.dataFeed){var suggest=this;list.attachEvent("onAfterLoad",function(){suggest.setValue(suggest._settings.value)});list.getItem=function(id){return this.data.pull[id]||suggest._valueHistory[id]}}},$enterKey:function(popup,list){if(list.count&&list.count()){if(popup.isVisible()){var value=list.getSelectedId(false,true);if(value){this._toggleOption(value)}popup.hide(true)}else{popup.show(this._last_input_target)}}else{if(popup.isVisible())popup.hide(true)}},_show_selection:function(){var list=this.getList();if(list.select)list.unselect()},setValue:function(value){var i,list=this.getList(),text=[],values={},changed=[];value=value||[];if(typeof value=="string")value=value.split(this.config.separator);else if(list.config.dataFeed)value=this._toMultiValue(value);for(i=0;i<value.length;i++){values[value[i]]=1;if(list.getItem(value[i])){if(this._valueHistory)this._valueHistory[value[i]]=webix.copy(list.getItem(value[i]));text.push(this.getItemText(value[i]))}}list.data.each(function(item){if(item.$checked){if(!values[item.id]){item.$checked=0;changed.push(item.id)}}else{if(values[item.id]){item.$checked=1;changed.push(item.id)}}},this,true);for(i=0;i<changed.length;i++){list.refresh(changed[i])}this._settings.value=value.length?value.join(this.config.separator):"";return text},getValue:function(){return this._settings.value},_preselectMasterOption:function(){var node,master;if(this._settings.master){master=webix.$$(this._settings.master);node=master.getInputNode()}node=node||this._last_input_target;if(node)node.focus()},_toMultiValue:function(value){if(value&&webix.isArray(value)){var values=[];for(var i=0;i<value.length;i++){if(value[i].id){this._valueHistory[value[i].id]=webix.copy(value[i]);values.push(value[i].id)}else{values.push(value[i])}}value=values}return value}},webix.ui.multisuggest);webix.protoUI({name:"multicombo",$cssName:"text",defaults:{keepText:true,separator:",",icon:false,iconWidth:0,tagMode:true,tagTemplate:function(values){return values.length?values.length+" item(s)":""},template:function(obj,common){return common._render_value_block(obj,common)}},$init:function(){this.$view.className+=" webix_multicombo";this.attachEvent("onBeforeRender",function(){if(!this._inputHeight)this._inputHeight=webix.skin.$active.inputHeight;return true});this.attachEvent("onAfterRender",function(){this._last_size=null});this._renderCount=0},on_click:{webix_multicombo_delete:function(e,view,node){var value;if(!this._settings.readonly&&node&&(value=node.parentNode.getAttribute("optvalue")))this._removeValue(value);return false}},_onBlur:function(){var value=this.getInputNode().value;if(value&&this._settings.newValues&&new Date-(this.getPopup()._click_stamp||0)>100){this._addNewValue(value)}this._inputValue="";this.refresh()},_removeValue:function(value){var values=this._settings.value;if(typeof values=="string")values=values.split(this._settings.separator);values=webix.toArray(webix.copy(values));values.remove(value);this.setValue(values.join(this._settings.separator))},_addValue:function(newValue){var suggest=webix.$$(this.config.suggest);var list=suggest.getList();var item=list.getItem(newValue);if(item){var values=suggest.getValue();if(values&&typeof values=="string")values=values.split(suggest.config.separator);values=webix.toArray(values||[]);if(values.find(newValue)<0){values.push(newValue);suggest.setValue(values);this.setValue(suggest.getValue())}}},_addNewValue:function(value){var suggest=webix.$$(this.config.suggest);var list=suggest.getList();var id;value=value.replace(/^\s+|\s+$/g,"");if(value){for(var i in list.data.pull)if(suggest.getItemText(i)==value)id=i}if(!id&&value)id=list.add({id:value,value:value});this._addValue(id)},_suggest_config:function(value){var isObj=!webix.isArray(value)&&typeof value=="object"&&!value.name,suggest={view:"checksuggest",separator:this.config.separator,buttonText:this.config.buttonText,button:this.config.button},combo=this;if(this._settings.optionWidth)suggest.width=this._settings.optionWidth;if(isObj)webix.extend(suggest,value,true);var view=webix.ui(suggest);if(!this._settings.optionWidth)view.$customWidth=function(node){this.config.width=combo._get_input_width(combo._settings)};view.attachEvent("onBeforeShow",function(node,mode,point){if(this._settings.master){this.setValue(webix.$$(this._settings.master).config.value);if(webix.$$(this._settings.master).getInputNode().value){this.getList().refresh();this._dont_unfilter=true}else this.getList().filter();if(node.tagName&&node.tagName.toLowerCase()=="input"){webix.ui.popup.prototype.show.apply(this,[node.parentNode,mode,point]);return false}}});var list=view.getList();if(typeof value=="string")list.load(value);else if(!isObj)list.parse(value);view._suggest_after_filter=function(){};return view},_render_value_block:function(obj,common){var id,input,inputAlign,inputStyle,inputValue,inputWidth,height,html,label,list,message,padding,readOnly,width,bottomLabel="",top=this._settings.labelPosition=="top";id="x"+webix.uid();width=common._get_input_width(obj);inputAlign=obj.inputAlign||"left";height=this._inputHeight-2*webix.skin.$active.inputPadding-2;inputValue=this._inputValue||"";list="<ul class='webix_multicombo_listbox' style='line-height:"+height+"px'></ul>";inputWidth=Math.min(width,common._inputWidth||7);inputStyle="width: "+inputWidth+"px;height:"+height+"px;max-width:"+(width-20)+"px";readOnly=obj.readonly?" readonly ":"";input="<input id='"+id+"' role='combobox' aria-multiline='true' aria-label='"+webix.template.escape(obj.label)+"' tabindex='0' type='text' class='webix_multicombo_input' "+readOnly+" style='"+inputStyle+"' value='"+inputValue+"'/>";html="<div class='webix_inp_static' onclick='' style='line-height:"+height+"px;width: "+width+"px;  text-align: "+inputAlign+";height:auto' >"+list+input+"</div>";label=common.$renderLabel(obj,id);padding=this._settings.awidth-width-webix.skin.$active.inputPadding*2;message=(obj.invalid?obj.invalidMessage:"")||obj.bottomLabel;if(message)bottomLabel="<div class='webix_inp_bottom_label' style='width:"+width+"px;margin-left:"+Math.max(padding,webix.skin.$active.inputPadding)+"px;'>"+message+"</div>";if(top)return label+"<div class='webix_el_box' style='width:"+this._settings.awidth+"px; '>"+html+bottomLabel+"</div>";else return"<div class='webix_el_box' style='width:"+this._settings.awidth+"px; min-height:"+this._settings.aheight+"px;'>"+label+html+bottomLabel+"</div>"},_getValueListBox:function(){return this._getBox().getElementsByTagName("UL")[0]},_set_inner_size:function(){var popup=this.getPopup();if(popup){var textArr=popup?popup.setValue(this._settings.value):null;if(popup._toMultiValue)this._settings.value=popup._toMultiValue(this._settings.value);var html="";var listbox=this._getValueListBox();var text=textArr&&textArr.length;if(text){var height=this._inputHeight-2*webix.skin.$active.inputPadding-8;var values=this._settings.value;if(typeof values=="string")values=values.split(this._settings.separator);if(this._settings.tagMode){for(var i=0;i<textArr.length;i++){var content="<span>"+textArr[i]+"</span><span class='webix_multicombo_delete' role='button' aria-label='"+webix.i18n.aria.removeItem+"'>x</span>";html+="<li class='webix_multicombo_value' style='line-height:"+height+"px;' optvalue='"+values[i]+"'>"+content+"</li>"}}else{html+="<li class='webix_multicombo_tag' style='line-height:"+height+"px;'>"+this._settings.tagTemplate(values)+"</li>"}}listbox.innerHTML=html;var inp=this.getInputNode();if(this._settings.placeholder){if(text){inp.placeholder="";if(!inp.value&&inp.offsetWidth>20)inp.style.width="20px"}else if(!inp.value){inp.placeholder=this._settings.placeholder;inp.style.width=this._get_input_width(this._settings)+"px"}}if(!this._settings.tagMode&&listbox.firstChild)inp.style.width=this._getMultiComboInputWidth()+"px"}this._resizeToContent()},_focusAtEnd:function(inputEl){inputEl=inputEl||this.getInputNode();if(inputEl){if(inputEl.value.length){if(inputEl.createTextRange){var FieldRange=inputEl.createTextRange();FieldRange.moveStart("character",inputEl.value.length);FieldRange.collapse();FieldRange.select()}else if(inputEl.selectionStart||inputEl.selectionStart=="0"){var elemLen=inputEl.value.length;inputEl.selectionStart=elemLen;inputEl.selectionEnd=elemLen;inputEl.focus()}}else{inputEl.focus()}}},_resizeToContent:function(){var top=this._settings.labelPosition=="top";var inputDiv=this._getInputDiv();var inputHeight=Math.max(inputDiv.offsetHeight+2*webix.skin.$active.inputPadding,this._inputHeight);if(top)inputHeight+=this._labelTopHeight;inputHeight+=this._settings.bottomPadding||0;var sizes=this.$getSize(0,0);if(inputHeight!=sizes[2]){var cHeight=inputDiv.offsetHeight+(top?this._labelTopHeight:0);if(cHeight==this._calcHeight)this._renderCount++;else this._renderCount=0;if(this._renderCount>10)return false;this._calcHeight=cHeight;var topView=this.getTopParentView();clearTimeout(topView._template_resize_timer);topView._template_resize_timer=webix.delay(function(){this.config.height=this._calcHeight+2*webix.skin.$active.inputPadding;this.resize();if(this._typing){this._focusAtEnd(this.getInputNode());this._typing=false}if(this._enter){if(!this._settings.keepText)this.getInputNode().value="";else this.getInputNode().select();this._enter=false}if(this.getPopup().isVisible()||this._typing){this.getPopup().show(this._getInputDiv())}},this)}if(this._enter){this.getInputNode().select()}},_getInputDiv:function(){var parentNode=this._getBox();var nodes=parentNode.childNodes;for(var i=0;i<nodes.length;i++){if(nodes[i].className&&nodes[i].className.indexOf("webix_inp_static")!=-1)return nodes[i]}return parentNode},getInputNode:function(){return this._getBox().getElementsByTagName("INPUT")[0]},$setValue:function(){if(this._rendered_input)this._set_inner_size()},getValue:function(config){if(typeof config=="object"&&config.options)return this._getSelectedOptions();var value=this._settings.value;if(!value)return"";return typeof value!="string"?value.join(this._settings.separator):value},getText:function(){var value=this._settings.value;if(!value)return"";if(typeof value=="string")value=value.split(this._settings.separator);var text=[];for(var i=0;i<value.length;i++)text.push(this.getPopup().getItemText(value[i]));return text.join(this._settings.separator)},_getSelectedOptions:function(){var i,item,popup,options=[],value=this._settings.value;if(!value)return[];if(typeof value=="string")value=value.split(this._settings.separator);popup=this.getPopup();for(i=0;i<value.length;i++){item=popup.getList().getItem(value[i])||(popup._valueHistory?popup._valueHistory[value[i]]:null);if(item)options.push(item)}return options},$setSize:function(x,y){var config=this._settings;if(webix.ui.view.prototype.$setSize.call(this,x,y)){if(!x||!y)return;if(config.labelPosition=="top"){config.labelWidth=0}this.render()}},_calcInputWidth:function(value){var tmp=document.createElement("span");tmp.className="webix_multicombo_input";tmp.style.visibility="visible";tmp.style.height="0px";tmp.innerHTML=value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");document.body.appendChild(tmp);var width=tmp.offsetWidth+10;document.body.removeChild(tmp);return width},_getMultiComboInputWidth:function(){var listbox=this._getValueListBox();return listbox.offsetWidth-listbox.firstChild.offsetWidth-17},_init_onchange:function(){webix._event(this._getBox(),"click",function(){this.getInputNode().focus()},{bind:this});webix._event(this.getInputNode(),"focus",function(){if(this._getBox().className.indexOf("webix_focused")==-1)this._getBox().className+=" webix_focused"},{bind:this});webix._event(this.getInputNode(),"blur",function(){this._getBox().className=this._getBox().className.replace(" webix_focused","")},{bind:this});webix._event(this.getInputNode(),"input",function(){if(!this.getInputNode().value&&this._inputValue){this.getInputNode().style.width="20px";this._inputWidth=20;this._inputValue="";this._typing=true;this.getPopup().show(this._getInputDiv());this._resizeToContent()}},{bind:this});webix._event(this.getInputNode(),"keyup",function(e){var inp=this.getInputNode();var calcWidth,width;e=e||event;if(this._settings.placeholder&&!this._settings.value&&!inp.value)width=this._get_input_width(this._settings);else{width=calcWidth=this._calcInputWidth(inp.value)+10;if(!this._settings.tagMode&&this._getValueListBox().firstChild)width=this._getMultiComboInputWidth()}inp.style.width=width+"px";if(calcWidth!=this._inputWidth){if(this._settings.keepText||e.keyCode!=13){this._inputValue=inp.value}else{this._inputValue=false}this._typing=true;if(this._inputWidth)this.getPopup().show(this._getInputDiv());this._inputWidth=calcWidth||width;this._resizeToContent()}else if(this._windowHeight!=this.getPopup().$height){this.getPopup().show(this._getInputDiv())}if(inp.value.indexOf(this._settings.separator)>-1&&this._settings.tagMode){var newValue=inp.value.replace(this._settings.separator,"");if(newValue){if(this._settings.newValues)this._addNewValue(newValue);else{var newId=this.getPopup().getItemId(newValue);if(newId)this._addValue(newId)}}if(this._settings.keepText){this._inputValue=newValue;inp.value=newValue;this._enter=true;this._typing=true;this._resizeToContent()}else{inp.value=""}}},{bind:this});webix._event(this.getInputNode(),"keydown",function(e){this._enter=false;if(this.isVisible()){e=e||event;var node=this._getValueListBox().lastChild;this._windowHeight=this.getPopup().$height;if(e.keyCode==8&&node){if(!this.getInputNode().value&&(new Date).valueOf()-(this._backspaceTime||0)>100){this._typing=true;this._removeValue(node.getAttribute("optvalue"))}else{this._backspaceTime=(new Date).valueOf()}}if(e.keyCode==13||e.keyCode==9){var input=this.getInputNode();var id="";var suggest=webix.$$(this._settings.suggest);var list=suggest.getList();if(!list.getSelectedId()){if(input.value)id=suggest.getSuggestion();if(this._settings.newValues){if(e.keyCode==13)this._enter=true;this._addNewValue(input.value);if(this._settings.keepText)this._inputValue=input.value;else input.value=""}else if(id){if(e.keyCode==9){this._typing=false;this._inputValue="";this._inputWidth=10;input.value="";this._addValue(id)}else{this._enter=true;this._addValue(id);if(this._settings.keepText)this._inputValue=input.value;else input.value=""}}}if(e.keyCode==13){this._enter=true;this._typing=true}}}},{bind:this});webix.$$(this._settings.suggest).linkInput(this)}},webix.ui.richselect);webix.protoUI({name:"menu",_listClassName:"webix_menu",$init:function(config){this.data._scheme_init=webix.bind(function(obj){if(obj.disabled)this.data.addMark(obj.id,"webix_disabled",true,1,true)},this);if(config.autowidth){this._autowidth_submenu=true;delete config.autowidth}this.data.attachEvent("onStoreUpdated",webix.bind(function(){this._hide_sub_menu()},this));this.attachEvent("onMouseMove",this._mouse_move_menu);this.attachEvent("onMouseOut",function(){if(this._menu_was_activated()&&this._settings.openAction=="click")return;if(!this._child_menu_active)this._hide_sub_menu()});this.attachEvent("onItemClick",function(id,e,trg){var item=this.getItem(id);if(item){if(item.$template)return;var parent=this.getTopMenu();if(!this.data.getMark(id,"webix_disabled")){if(!parent.callEvent("onMenuItemClick",[id,e,trg])){e.showpopup=true;return}if(this!=parent)parent._call_onclick(id,e,trg);if(!item.submenu){parent._hide_sub_menu(true);if(parent._hide_on_item_click)parent.hide()}else{if((this===parent||webix.env.touch)&&parent._settings.openAction=="click"){this._mouse_move_activation(id,trg)}e.showpopup=true}}}});this.attachEvent("onKeyPress",function(code,e){if(code===9)this.getTopMenu()._hide_sub_menu();else if(code===13||code===32){var sel=this.getSelectedId(),node;if(sel)node=this.getItemNode(sel);if(node)webix.html.triggerEvent(node,"MouseEvents","click")}});this.data.attachEvent("onClearAll",function(){this._hidden_items=[]});this.data._hidden_items=[];this._viewobj.setAttribute("role","menubar")},sizeToContent:function(){if(this._settings.layout=="y"){var texts=[];var isSubmenu=false;this.data.each(function(obj){texts.push(this._toHTML(obj));if(obj.submenu)isSubmenu=true},this);this.config.width=webix.html.getTextSize(texts,this.$view.className).width+8*2+2+(isSubmenu?15:0);this.resize()}else webix.assert(false,"sizeToContent will work for vertical menu only")},getTopMenu:function(){var parent=this;while(parent._parent_menu)parent=webix.$$(parent._parent_menu);return parent},_auto_height_calc:function(count){if(this._settings.autoheight)count=this.count();var height=0;for(var i=0;i<count;i++){var item=this.data.pull[this.data.order[i]];if(item&&item.$template=="Separator")height+=4;else height+=this.type.height}return height},on_mouse_move:{},type:{css:"menu",width:"auto",aria:function(obj,common,marks){return'role="menuitem"'+(marks&&marks.webix_selected?' aria-selected="true" tabindex="0"':'tabindex="-1"')+(obj.submenu?'aria-haspopup="true"':"")+(marks&&marks.webix_disabled?' aria-disabled="true"':"")},templateStart:function(obj,common,mark){if(obj.$template==="Separator"||obj.$template==="Spacer"){return'<div webix_l_id="#id#" role="separator" tabindex="-1" class="webix_context_'+obj.$template.toLowerCase()+'">'}var link=(obj.href?" href='"+obj.href+"' ":"")+(obj.target?" target='"+obj.target+"' ":"");return webix.ui.list.prototype.type.templateStart(obj,common,mark).replace(/^<div/,"<a "+link)+(obj.submenu&&common.subsign?"<div class='webix_submenu_icon'></div>":"")},templateEnd:function(obj,common,mark){return obj.$template==="Separator"||obj.$template==="Spacer"?"</div>":"</a>"},templateSeparator:webix.template("<div class='sep_line'></div>"),templateSpacer:webix.template("<div></div>")},getMenu:function(id){if(!this.data.pull[id]){for(var subid in this.data.pull){var obj=this.getItem(subid);if(obj.submenu){var search=this._get_submenu(obj).getMenu(id);if(search)return search}}}else return this},getSubMenu:function(id){var menu=this.getMenu(id);var obj=menu.getItem(id);return obj.submenu?menu._get_submenu(obj):null},getMenuItem:function(id){return this.getMenu(id).getItem(id)},_get_submenu:function(data){var sub=webix.$$(data.submenu);if(!sub){data.submenu=this._create_sub_menu(data);sub=webix.$$(data.submenu)}return sub},_mouse_move_menu:function(id,e,target){if(!this._menu_was_activated())return;this._mouse_move_activation(id,target)},_menu_was_activated:function(){var top=this.getTopMenu();if(top._settings.openAction=="click"){if(webix.env.touch)return false;var sub=top._open_sub_menu;if(sub&&webix.$$(sub).isVisible())return true;return false}return true},_mouse_move_activation:function(id,target){var data=this.getItem(id);if(!data)return;this._child_menu_active=null;if(this._open_sub_menu&&data.submenu!=this._open_sub_menu)this._hide_sub_menu(true);if(data.submenu&&!this.config.hidden){var sub=this._get_submenu(data);if(this.data.getMark(id,"webix_disabled"))return;sub.show(target,{pos:this._settings.subMenuPos});sub._parent_menu=this._settings.id;this._open_sub_menu=data.submenu}},disableItem:function(id){this.getMenu(id).addCss(id,"webix_disabled")},enableItem:function(id){this.getMenu(id).removeCss(id,"webix_disabled")},_set_item_hidden:function(id,state){var menu=this.data;if(menu._hidden_items[id]!=state){menu._hidden_items[id]=state;menu.filter(function(obj){return!menu._hidden_items[obj.id]});this.resize()}},hideItem:function(id){var menu=this.getMenu(id);if(menu)menu._set_item_hidden(id,true)},showItem:function(id){var menu=this.getMenu(id);if(menu){menu._set_item_hidden(id,false);return webix.ui.list.prototype.showItem.call(menu,id)}},_hide_sub_menu:function(mode){if(this._open_sub_menu){var sub=webix.$$(this._open_sub_menu);if(sub._hide_sub_menu)sub._hide_sub_menu(mode);if(mode||!sub._show_on_mouse_out){sub.hide();this._open_sub_menu=null}}},_create_sub_menu:function(data){var listConfig={view:"submenu",data:data.submenu};var settings=this.getTopMenu()._settings.submenuConfig;if(settings)webix.extend(listConfig,settings,true);var parentData=this.getMenuItem(data.id);if(parentData&&parentData.config)webix.extend(listConfig,parentData.config,true);var menu=webix.ui(listConfig);menu._parent_menu=this;return menu._settings.id},_skip_item:function(id,prev,mode){var item=this.getItem(id);if(item.$template=="Separator"||item.$template=="Spacer"||this.data.getMark(id,"webix_disabled")){var index=this.getIndexById(id)+(mode=="up"?-1:1);id=index>=0?this.getIdByIndex(index):null;return id?this._skip_item(id,prev,mode):prev}else return id},$skin:function(){webix.ui.list.prototype.$skin.call(this);this.type.height=webix.skin.$active.menuHeight},defaults:{scroll:"",layout:"x",mouseEventDelay:100,subMenuPos:"bottom"}},webix.ui.list);webix.protoUI({name:"submenu",$init:function(){this._body_cell=webix.clone(this._dummy_cell_interface);this._body_cell._view=this;this.attachEvent("onMouseOut",function(){if(this.getTopMenu()._settings.openAction=="click")return;if(!this._child_menu_active&&!this._show_on_mouse_out)this.hide()});this.attachEvent("onMouseMoving",function(){if(this._parent_menu)webix.$$(this._parent_menu)._child_menu_active=true});this.attachEvent("onBeforeShow",function(){if(this.getTopMenu()._autowidth_submenu&&this.sizeToContent&&!this.isVisible())this.sizeToContent()});this._dataobj.setAttribute("role","menu")},$skin:function(){webix.ui.menu.prototype.$skin.call(this);webix.ui.popup.prototype.$skin.call(this);this.type.height=webix.skin.$active.menuHeight},_dummy_cell_interface:{$getSize:function(dx,dy){var h=this._view._settings.height*1;var w=this._view._settings.width*1;var size=webix.ui.menu.prototype.$getSize.call(this._view,dx,dy);this._view._settings.height=h;this._view._settings.width=w;return size},$setSize:function(x,y){if(this._view._settings.scroll)this._view._bodyobj.style.height=y+"px"},destructor:function(){this._view=null}},body_setter:function(){},getChildViews:function(){return[]},defaults:{width:150,subMenuPos:"right",layout:"y",autoheight:true},type:{height:webix.skin.menuHeight,subsign:true}},webix.ui.menu,webix.ui.popup);webix.ContextHelper={defaults:{padding:"4",hidden:true},body_setter:function(value){value=webix.ui.window.prototype.body_setter.call(this,value);this._body_cell._viewobj.style.borderWidth="0px";return value},attachTo:function(obj){webix.assert(obj,"Invalid target for Context::attach");var id;if(obj.on_context)id=obj.attachEvent("onAfterContextMenu",webix.bind(this._show_at_ui,this));else id=webix.event(obj,"contextmenu",this._show_at_node,{bind:this});this.attachEvent("onDestruct",function(){if(obj.detachEvent)obj.detachEvent(id);else webix.eventRemove(id);obj=null})},getContext:function(){return this._area},setContext:function(area){this._area=area},_show_at_node:function(e){this._area=webix.toNode(e||event);return this._show_at(e)},_show_at_ui:function(id,e,trg){this._area={obj:webix.$$(e),id:id};return this._show_at(e)},_show_at:function(e){var result=this.show(e,null,true);if(result===false)return result;webix.callEvent("onClick",[]);return webix.html.preventEvent(e)},_show_on_mouse_out:true,master_setter:function(value){this.attachTo(value);return null}};webix.protoUI({name:"context"},webix.ContextHelper,webix.ui.popup);webix.protoUI({name:"contextmenu",_hide_on_item_click:true,$init:function(config){if(config.submenuConfig)webix.extend(config,config.submenuConfig)}},webix.ContextHelper,webix.ui.submenu);webix.protoUI({name:"tabbar",$init:function(){this.attachEvent("onKeyPress",this._onKeyPress)},$skin:function(){var skin=webix.skin.$active;var defaults=this.defaults;defaults.topOffset=skin.tabTopOffset||0;defaults.tabOffset=typeof skin.tabOffset!="undefined"?skin.tabOffset:10;defaults.bottomOffset=skin.tabBottomOffset||0;defaults.height=skin.tabbarHeight;defaults.tabMargin=skin.tabMargin;defaults.inputPadding=skin.inputPadding;defaults.tabMinWidth=skin.tabMinWidth||100;defaults.tabMoreWidth=skin.tabMoreWidth||40},_getTabbarSizes:function(){var config=this._settings,i,len,tabs=this._tabs||config.options,totalWidth=this._input_width-config.tabOffset*2,limitWidth=config.optionWidth||config.tabMinWidth;len=tabs.length;if(config.tabMinWidth&&totalWidth/len<limitWidth){return{max:parseInt(totalWidth/limitWidth,10)||1}}if(!config.optionWidth){for(i=0;i<len;i++){if(tabs[i].width){totalWidth-=tabs[i].width+(!i&&!config.type?config.tabMargin:0);len--}}}return{width:len?totalWidth/len:config.tabMinWidth}},_init_popup:function(){var obj=this._settings;if(!obj.tabbarPopup){var popupConfig={view:"popup",width:obj.popupWidth||200,body:{view:"list",borderless:true,select:true,css:"webix_tab_list",autoheight:true,yCount:obj.yCount,type:{template:obj.popupTemplate}}};var view=webix.ui(popupConfig);view.getBody().attachEvent("onBeforeSelect",webix.bind(function(id){if(id&&this.callEvent("onBeforeTabClick",[id])){this.setValue(id);webix.$$(this._settings.tabbarPopup).hide();this.callEvent("onAfterTabClick",[id]);return true}},this));view.getBody().attachEvent("onAfterSelect",webix.bind(function(id){this.refresh()},this));obj.tabbarPopup=view._settings.id;this._destroy_with_me.push(view)}this._init_popup=function(){}},getPopup:function(){this._init_popup();return webix.$$(this._settings.tabbarPopup)},moreTemplate_setter:webix.template,popupTemplate_setter:webix.template,defaults:{popupWidth:200,popupTemplate:"#value#",yCount:7,moreTemplate:'<span class="webix_icon fa-ellipsis-h"></span>',template:function(obj,common){var contentWidth,html,i,leafWidth,resultHTML,style,sum,tabs,verticalOffset,width;common._tabs=tabs=common._filterOptions(obj.options);if(!tabs.length){html="<div class='webix_tab_filler' style='width:"+common._input_width+"px; border-right:0px;'></div>"}else{common._check_options(tabs);if(!obj.value&&tabs.length)obj.value=tabs[0].id;html="";if(obj.tabOffset)html+="<div class='webix_tab_filler' style='width:"+obj.tabOffset+"px;'>&nbsp;</div>";contentWidth=common._input_width-obj.tabOffset*2-(!obj.type?obj.tabMargin*(tabs.length-1):0);verticalOffset=obj.topOffset+obj.bottomOffset;var sizes=common._getTabbarSizes();if(sizes.max&&sizes.max<tabs.length){var popup=common.getPopup();popup.hide();var list=popup.getBody()||null;if(list){if(sizes.max){var found=false;for(i=0;i<tabs.length&&!found;i++)if(tabs[i].id==obj.value){found=true;if(i+1>sizes.max){var selectedTab=tabs.splice(i,1);var displayTabs=tabs.splice(0,sizes.max-1).concat(selectedTab);tabs=displayTabs.concat(tabs)}}list.clearAll();list.parse(tabs.slice(sizes.max))}else{list.clearAll()}}}else if(common._settings.tabbarPopup)webix.$$(common._settings.tabbarPopup).hide();sum=obj.tabOffset;var lastTab=false;for(i=0;i<tabs.length&&!lastTab;i++){if(sizes&&sizes.max){if(sizes.max==i+1){lastTab=true}contentWidth=common._input_width-obj.tabOffset*2-(!obj.type&&sizes.max>1?obj.tabMargin*(sizes.max-1):0);width=(contentWidth-obj.tabMoreWidth)/sizes.max}else width=sizes.width;width=tabs[i].width||obj.optionWidth||width;sum+=width+(i&&!obj.type?obj.tabMargin:0);if(obj.tabMargin>0&&i&&!obj.type)html+="<div class='webix_tab_filler' style='width:"+obj.tabMargin+"px;'></div>";html+=common._getTabHTML(tabs[i],width);if(lastTab){html+='<div role="button" tabindex="0" aria-label="'+webix.i18n.aria.showTabs+'" class="webix_tab_more_icon" style="width:'+obj.tabMoreWidth+'px;">'+obj.moreTemplate(obj,common)+"</div>";sum+=obj.tabMoreWidth}}leafWidth=common._content_width-sum;if(leafWidth>0&&!obj.type)html+="<div class='webix_tab_filler' style='width:"+leafWidth+"px;'>&nbsp;</div>"}resultHTML="";style=verticalOffset&&!obj.type?"height:"+(common._content_height-verticalOffset)+"px":"";if(obj.topOffset&&!obj.type)resultHTML+="<div class='webix_before_all_tabs' style='width:100%;height:"+obj.topOffset+"px'></div>";resultHTML+="<div style='"+style+"' role='tablist' class='webix_all_tabs "+(obj.type?"webixtype_"+obj.type:"")+"'>"+html+"</div>";if(obj.bottomOffset&&!obj.type)resultHTML+="<div class='webix_after_all_tabs' style='width:100%;height:"+obj.bottomOffset+"px'></div>";return resultHTML}},_getInputNode:function(){return this.$view.querySelectorAll(".webix_item_tab")},_getTabHTML:function(tab,width){var html,className="",config=this.config;if(tab.id==config.value)className=" webix_selected";if(tab.css)className+=" "+tab.css;width=tab.width||width;html='<div class="webix_item_tab'+className+'" button_id="'+tab.id+'" role="tab" aria-selected="'+(tab.id==config.value?"true":"false")+'" tabindex="'+(tab.id==config.value?"0":"-1")+'" style="width:'+width+'px;">';if(this._tabTemplate){var calcHeight=this._content_height-config.inputPadding*2-2;var height=this._content_height-2;var temp=webix.extend({cheight:calcHeight,aheight:height},tab);html+=this._tabTemplate(temp)}else{var icon=tab.icon?"<span class='webix_icon fa-"+tab.icon+"'></span> ":"";html+=icon+tab.value}if(tab.close||config.close)html+="<span role='button' tabindex='0' aria-label='"+webix.i18n.aria.closeTab+"' class='webix_tab_close webix_icon fa-times'></span>";html+="</div>";return html},_types:{image:"<div class='webix_img_btn_top' style='height:#cheight#px;background-image:url(#image#);'><div class='webix_img_btn_text'>#value#</div></div>",icon:"<div class='webix_img_btn' style='line-height:#cheight#px;height:#cheight#px;'><span class='webix_icon_btn fa-#icon#' style='max-width:#cheight#px;max-height:#cheight#px;'></span>#value#</div>",iconTop:"<div class='webix_img_btn_top' style='height:#cheight#px;width:100%;top:0px;text-align:center;'><span class='webix_icon fa-#icon#'></span><div class='webix_img_btn_text'>#value#</div></div>"},type_setter:function(value){this._settings.tabOffset=0;if(this._types[value])this._tabTemplate=webix.template(this._types[value]);return value}},webix.ui.segmented);webix.protoUI({name:"tabview",defaults:{type:"clean"},setValue:function(val){this._cells[0].setValue(val)},getValue:function(){return this._cells[0].getValue()},getTabbar:function(){return this._cells[0]},getMultiview:function(){return this._cells[1]},addView:function(obj){var id=obj.body.id=obj.body.id||webix.uid();this.getMultiview().addView(obj.body);obj.id=obj.body.id;obj.value=obj.header;delete obj.body;delete obj.header;var t=this.getTabbar();t.addOption(obj);return id},removeView:function(id){var t=this.getTabbar();t.removeOption(id);t.refresh()},$init:function(config){this.$ready.push(this._init_tabview_handlers);var cells=config.cells;var tabs=[];webix.assert(cells&&cells.length,"tabview must have cells collection");for(var i=cells.length-1;i>=0;i--){var view=cells[i].body||cells[i];if(!view.id)view.id="view"+webix.uid();tabs[i]={value:cells[i].header,id:view.id,close:cells[i].close,width:cells[i].width,hidden:!!cells[i].hidden};cells[i]=view}var tabbar={view:"tabbar",multiview:true};var mview={view:"multiview",cells:cells,animate:!!config.animate};if(config.value)tabbar.value=config.value;if(config.tabbar)webix.extend(tabbar,config.tabbar,true);if(config.multiview)webix.extend(mview,config.multiview,true);tabbar.options=tabbar.options||tabs;config.rows=[tabbar,mview];delete config.cells;delete config.tabs},_init_tabview_handlers:function(){this.getTabbar().attachEvent("onOptionRemove",function(id){var view=webix.$$(id);if(view){var parent=view.getParentView();if(parent)parent.removeView(view)}})}},webix.ui.layout);webix.protoUI({name:"fieldset",defaults:{borderless:true,$cssName:"webix_fieldset",paddingX:18,paddingY:30},$init:function(obj){webix.assert(obj.body,"fieldset must have not-empty body");this._viewobj.className+=" "+this.defaults.$cssName;this._viewobj.innerHTML="<fieldset><legend></legend><div></div></fieldset>"},label_setter:function(value){this._viewobj.firstChild.childNodes[0].innerHTML=value;return value},getChildViews:function(){return[this._body_view]},body_setter:function(config){this._body_view=webix.ui(config,this._viewobj.firstChild.childNodes[1]);this._body_view._parent_cell=this;return config},getBody:function(){return this._body_view},resizeChildren:function(){var x=this.$width-this._settings.paddingX;var y=this.$height-this._settings.paddingY;var sizes=this._body_view.$getSize(0,0);if(sizes[0]>x)x=sizes[0];if(sizes[2]>y)y=sizes[2];this._body_view.$setSize(x,y);this.resize()},$getSize:function(x,y){webix.debug_size_box_start(this,true);x+=this._settings.paddingX;y+=this._settings.paddingY;var t=this._body_view.$getSize(x,y);var s=this._last_body_size=webix.ui.view.prototype.$getSize.call(this,x,y);if(s[0]<t[0])s[0]=t[0];if(s[2]<t[2])s[2]=t[2];if(s[1]>t[1])s[1]=t[1];if(s[3]>t[3])s[3]=t[3];webix.debug_size_box_end(this,s);return s},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)){x=Math.min(this._last_body_size[1],x);y=Math.min(this._last_body_size[3],y);this._body_view.$setSize(x-this._settings.paddingX,y-this._settings.paddingY)}}},webix.ui.view);webix.protoUI({name:"forminput",defaults:{$cssName:"webix_forminput",labelWidth:80,labelAlign:"left"},setValue:function(value){this._body_view.setValue(value)},focus:function(){this._body_view.focus()},getValue:function(){return this._body_view.getValue()},value_setter:function(value){this.setValue(value)},getBody:function(){return this._body_view},$skin:function(){this._inputPadding=webix.skin.$active.inputPadding;this._inputSpacing=webix.skin.$active.inputSpacing},$init:function(obj){this.$ready.push(function(){var label=this._viewobj.firstChild.childNodes[0];label.style.width=this._settings.paddingX+"px";label.style.textAlign=this._settings.labelAlign;if(!this._settings.labelWidth)label.style.display="none"});var lw=webix.isUndefined(obj.labelWidth)?this.defaults.labelWidth:obj.labelWidth;obj.paddingX=lw-this._inputPadding*2+this._inputSpacing*2},setBottomText:function(text){var config=this._settings;if(typeof text!="undefined"){if(config.bottomLabel==text)return;config.bottomLabel=text}var message=(config.invalid?config.invalidMessage:"")||config.bottomLabel;if(this._invalidMessage){webix.html.remove(this._invalidMessage)}if(message){this.$view.style.position="relative";this._invalidMessage=webix.html.create("div",{class:"webix_inp_bottom_label",role:config.invalid?"alert":"","aria-relevant":"all",style:"position:absolute; bottom:0px; padding:2px; background: white; left:"+this._settings.labelWidth+"px; "},message);this._viewobj.appendChild(this._invalidMessage)}}},webix.ui.fieldset);webix.protoUI({name:"dbllist",defaults:{borderless:true},$init:function(config){this._moved={};this._inRight=webix.bind(function(obj){return this._moved[obj.id]},this);this._inLeft=webix.bind(function(obj){return!this._moved[obj.id]},this);this.$view.className+=" webix_dbllist";this.$ready.unshift(this._setLayout)},$onLoad:function(data,driver){this._updateAndResize(function(){this.$$("left").data.driver=driver;this.$$("left").parse(data);this.$$("right").data.driver=driver;this.$$("right").parse(data)});this._refresh()},_getButtons:function(){if(this._settings.buttons===false)return{width:10};var i18n=webix.i18n.dbllist;var buttons=[this._getButton("deselect_all",i18n.deselectAll),this._getButton("select_all",i18n.selectAll),this._getButton("deselect_one",i18n.deselectOne),this._getButton("select_one",i18n.selectOne)];var buttons={width:120,template:buttons.join(""),onClick:{dbllist_button:function(e,id,trg){this.getTopParentView()._update_list(trg.getAttribute("action"))}}};if(this._settings.buttons)buttons.template=this._settings.buttons;return buttons},_getButton:function(action,label){return"<button class='dbllist_button' action='"+action+"'>"+label+"</button>"},_getList:function(id,action,label,bottom){var list={view:"list",select:"multiselect",multiselect:"touch",id:id,action:action,drag:true,type:{margin:3,id:id},on:{onBeforeDrop:function(context){var source=context.from;var target=context.to;var top=source.getTopParentView();if(top===this.getTopParentView()){var mode=target._settings.action!="select_one";top.select(context.source,mode);top._refresh()}return false},onItemDblClick:function(){return this.getTopParentView()._update_list(this.config.action)}}};if(this._settings.list)webix.extend(list,this._settings.list,true);if(label)list={rows:[{view:"label",label:label},list]};if(bottom)return{rows:[list,{view:"label",height:20,label:bottom,css:"bottom_label"}]};return list},_setLayout:function(){var cols=[{margin:10,type:"clean",cols:[this._getList("left","select_one",this._settings.labelLeft,this._settings.labelBottomLeft),this._getButtons(),this._getList("right","deselect_one",this._settings.labelRight,this._settings.labelBottomRight)]}];this.cols_setter(cols)},_update_list:function(action){var top=this;var id=null;var mode=false;if(action==="select_all"){id=top.$$("left").data.order;mode=true}else if(action==="select_one"){id=top.$$("left").getSelectedId(true);mode=true}else if(action==="deselect_all"){id=top.$$("right").data.order;mode=false}else if(action==="deselect_one"){id=top.$$("right").getSelectedId(true);mode=false}top.select(id,mode)},select:function(id,mode){var i;if(typeof id!=="object")id=[id];if(mode){for(i=0;i<id.length;i++)this._moved[id[i]]=true}else{for(i=0;i<id.length;i++)delete this._moved[id[i]]}this.callEvent("onChange",[]);this._refresh()},_updateAndResize:function(handler,size){webix.ui.$freeze=true;handler.call(this);webix.ui.$freeze=false;if(size&&(this.$$("left")._settings.autoheight||this.$$("right")._settings.autoheight))this.resize()},_refresh:function(){var left=this.$$("left");var right=this.$$("right");if(left)this._updateAndResize(function(){left.filter(this._inLeft);right.filter(this._inRight)},true)},focus:function(){webix.UIManager.setFocus(this)},value_setter:function(val){this.setValue(val)},setValue:function(value){this._moved={};if(typeof value!=="object")value=value.toString().split(",");for(var i=0;i<value.length;i++)this._moved[value[i]]=true;this._refresh()},getValue:function(){var value=[];for(var key in this._moved)value.push(key);return value.join(",")}},webix.AtomDataLoader,webix.IdSpace,webix.ui.layout);webix.i18n.dbllist={selectAll:"<span class='webix_icon fa-angle-double-right'></span>",selectOne:"<span class='webix_icon fa-angle-right'></span>",deselectAll:"<span class='webix_icon fa-angle-double-left'></span>",deselectOne:"<span class='webix_icon fa-angle-left'></span>"};(function(){function _tagname(el){if(!el.tagName)return null;return el.tagName.toLowerCase()}function _attribute(el,name){if(!el.getAttribute)return null;var attr=el.getAttribute(name);return attr?attr.toLowerCase():null}function _get_html_value(){var tagname=_tagname(this);if(_get_value[tagname])return _get_value[tagname](this);return _get_value.other(this)}var _get_value={radio:function(el){for(var i=0;i<el.length;i++)if(el[i].checked)return el[i].value;return""},input:function(el){var type=_attribute(el,"type");if(type==="checkbox")return el.checked;return el.value},textarea:function(el){return el.value},select:function(el){var index=el.selectedIndex;return el.options[index].value},other:function(el){return el.innerHTML}};function _set_html_value(value){var tagname=_tagname(this);if(_set_value[tagname])return _set_value[tagname](this,value);return _set_value.other(this,value)}var _set_value={radio:function(el,value){for(var i=0;i<el.length;i++)el[i].checked=el[i].value==value},input:function(el,value){var type=_attribute(el,"type");if(type==="checkbox")el.checked=value?true:false;else el.value=value},textarea:function(el,value){el.value=value},select:function(el,value){el.value=value?value:el.firstElementChild.value||value},other:function(el,value){el.innerHTML=value}};webix.protoUI({name:"htmlform",$init:function(config){this.elements={};this._default_values=false;if(config.content&&(config.container==config.content||!config.container&&config.content==document.body))this._copy_inner_content=true},content_setter:function(content){content=webix.toNode(content);if(this._copy_inner_content){while(content.childNodes.length>1)this._viewobj.childNodes[0].appendChild(content.childNodes[0])}else{this._viewobj.childNodes[0].appendChild(content)}this._parse_inputs();return true},render:function(){webix.ui.template.prototype.render.apply(this,arguments);this._parse_inputs()},_parse_inputs:function(){var inputs=this._viewobj.querySelectorAll("[name]");this.elements={};for(var i=0;i<inputs.length;i++){var el=inputs[i];var name=_attribute(el,"name");if(name){var tag=_tagname(el)==="button";var type=_attribute(el,"type");var cant_clear=tag||type==="button"||type==="submit";if(type==="radio"){var stack=this.elements[name]||[];stack.tagName="radio";stack.push(el);el=stack}this.elements[name]=el;el.getValue=_get_html_value;el.setValue=_set_html_value;el._allowsClear=!cant_clear;el._settings={defaultValue:el.getValue()}}}return this.elements},_mark_invalid:function(id,obj){this._clear_invalid(id,obj);var el=this._viewobj.querySelector('[name="'+id+'"]');if(el)webix.html.addCss(el,"invalid")},_clear_invalid:function(id,obj){var el=this._viewobj.querySelector('[name="'+id+'"]');if(el)webix.html.removeCss(el,"invalid")}},webix.ui.template,webix.Values)})();(function(){var google,script;webix.protoUI({name:"google-map",$init:function(config){this.$view.innerHTML="<div class='webix_map_content' style='width:100%;height:100%'></div>";this._contentobj=this.$view.firstChild;this._waitMap=webix.promise.defer();this.data.provideApi(this,true);this.$ready.push(this.render)},getMap:function(waitMap){return waitMap?this._waitMap:this._map},_getCallBack:function(prev){return webix.bind(function(){if(typeof prev==="function")prev();google=google||window.google;this._initMap.call(this)},this)},render:function(){if(typeof window.google=="undefined"||typeof window.google.maps=="undefined"){if(!script){script=document.createElement("script");script.type="text/javascript";var config=this._settings;var src=config.src||"//maps.google.com/maps/api/js";src+=src.indexOf("?")===-1?"?":"&";if(config.key)src+="&key="+config.key;if(config.libraries)src+="&libraries="+config.libraries;script.src=src;document.getElementsByTagName("head")[0].appendChild(script)}script.onload=this._getCallBack(script.onload)}else this._getCallBack()()},_initMap:function(){var c=this.config;if(this.isVisible(c.id)){this._map=new google.maps.Map(this._contentobj,{zoom:c.zoom,center:new google.maps.LatLng(c.center[0],c.center[1]),mapTypeId:google.maps.MapTypeId[c.mapType]});this._waitMap.resolve(this._map)}},center_setter:function(config){if(this._map)this._map.setCenter(new google.maps.LatLng(config[0],config[1]));return config},mapType_setter:function(config){if(this._map)this._map.setMapTypeId(google.maps.MapTypeId[config]);return config},zoom_setter:function(config){if(this._map)this._map.setZoom(config);return config},layerType_setter:function(config){if(config=="heatmap")this.config.libraries="visualization";if(this._layerApi[config]){webix.extend(this,this._layerApi[config],true);this.data.attachEvent("onStoreUpdated",webix.bind(this.drawData,this))}return config},defaults:{zoom:5,center:[39.5,-98.5],mapType:"ROADMAP",layerType:"marker"},$setSize:function(){webix.ui.view.prototype.$setSize.apply(this,arguments);if(this._map)google.maps.event.trigger(this._map,"resize")},$onLoad:function(data){if(!this._map){this._waitMap.then(webix.bind(function(){this.parse(data)},this));return true}return false},_layerApi:{marker:{drawData:function(id,item,operation){switch(operation){case"add":item.$marker=this._getItemConfig(item);break;case"update":item.$marker.setMap(null);item.$marker=this._getItemConfig(item);break;case"delete":item.$marker.setMap(null);break;default:this.data.each(function(item){item.$marker=this._getItemConfig(item)},this);break}},clearAll:function(soft){this.data.each(function(obj){obj.$marker.setMap(null)});this.data.clearAll(soft)},showItem:function(id){var item=this.getItem(id);this._map.setCenter(new google.maps.LatLng(item.lat,item.lng))},_getItemConfig:function(item){var obj={};for(var i in item)obj[i]=item[i];obj.position=new google.maps.LatLng(item.lat,item.lng);obj.map=item.hidden?null:this._map;var marker=new google.maps.Marker(obj);this._events(marker);this.callEvent("onItemRender",[item]);return marker},_events:function(marker){var map=this;marker.addListener("click",function(){map.callEvent("onItemClick",[this.id,this])});if(marker.getDraggable()){marker.addListener("dragend",function(){map._onDrag(this,true)});marker.addListener("drag",function(){map._onDrag(this)})}},_onDrag:function(marker,end){var item=this.getItem(marker.id);var pos=marker.getPosition();var ev=end?"onAfterDrop":"onDrag";item.lat=pos.lat();item.lng=pos.lng();this.callEvent(ev,[item.id,item])}},heatmap:{heatmapConfig_setter:function(value){value=value||{};return value},drawData:function(){if(this._heatmap){this._heatmap.setMap(null);this._heatmap=null}var hdata=[];this.data.each(function(item){hdata.push(this._getConfig(item))},this);if(hdata.length){var data=webix.extend(this.config.heatmapConfig,{data:hdata,map:this._map},true);this._heatmap=new google.maps.visualization.HeatmapLayer(data);this.callEvent("onHeatMapRender",[this._heatmap])}},getHeatmap:function(){return this._heatmap},_getConfig:function(item){var obj={};for(var i in item)obj[i]=item[i];obj.location=new google.maps.LatLng(item.lat,item.lng);return obj}}}},webix.DataLoader,webix.EventSystem,webix.ui.view)})();webix.dp=function(name,getOnly){if(typeof name=="object"&&name._settings)name=name._settings.id;if(webix.dp._pull[name]||getOnly)return webix.dp._pull[name];if(typeof name=="string"||typeof name=="number")name={master:webix.$$(name)};var dp=new webix.DataProcessor(name);var masterId=dp._settings.master._settings.id;webix.dp._pull[masterId]=dp;webix.$$(masterId).attachEvent("onDestruct",function(){webix.dp._pull[this._settings.id]=null;delete webix.dp._pull[this._settings.id]});return dp};webix.dp._pull={};webix.dp.$$=function(id){return webix.dp._pull[id]};webix.DataProcessor=webix.proto({defaults:{autoupdate:true,updateFromResponse:false,mode:"post",operationName:"webix_operation",trackMove:false},$init:function(){this.reset();this._ignore=false;this.name="DataProcessor";this.$ready.push(this._after_init_call)},reset:function(){this._updates=[]},url_setter:function(value){var mode="";if(typeof value=="string"){var parts=value.split("->");if(parts.length>1){value=parts[1];mode=parts[0]}}else if(value&&value.mode){mode=value.mode;value=value.url}if(mode)return webix.proxy(mode,value);return value},master_setter:function(value){var store=value;if(value.name!="DataStore")store=value.data;this._settings.store=store;return value},_after_init_call:function(){webix.assert(this._settings.store,"store or master need to be defined for the dataprocessor");this._settings.store.attachEvent("onStoreUpdated",webix.bind(this._onStoreUpdated,this));this._settings.store.attachEvent("onDataMove",webix.bind(this._onDataMove,this))},ignore:function(code,master){var temp=this._ignore;this._ignore=true;code.call(master||this);this._ignore=temp},off:function(){this._ignore=true},on:function(){this._ignore=false},_copy_data:function(source){var obj={};for(var key in source)if(key.indexOf("$")!==0)obj[key]=source[key];return obj},save:function(id,operation,obj){operation=operation||"update";this._save_inner(id,obj||this._settings.store.getItem(id),operation)},_save_inner:function(id,obj,operation){if(typeof id=="object")id=id.toString();if(!id||this._ignore===true||!operation||operation=="paint")return true;var store=this._settings.store;if(store&&store._scheme_serialize)obj=store._scheme_serialize(obj);var update={id:id,data:this._copy_data(obj),operation:operation};if(!webix.isUndefined(obj.$parent))update.data.parent=obj.$parent;if(update.operation!="delete"){var master=this._settings.master;if(master&&master.data&&master.data.getMark&&master.data.getMark(id,"webix_invalid"))update._invalid=true;if(!this.validate(null,update.data))update._invalid=true}if(this._check_unique(update))this._updates.push(update);if(this._settings.autoupdate)this.send();return true},_onDataMove:function(sid,tindex,parent,targetid){if(this._settings.trackMove){var obj=webix.copy(this._settings.store.getItem(sid));var order=this._settings.store.order;obj.webix_move_index=tindex;obj.webix_move_id=targetid;obj.webix_move_parent=parent;this._save_inner(sid,obj,"order")}},_onStoreUpdated:function(id,obj,operation){switch(operation){case"save":operation="update";break;case"update":operation="update";break;case"add":operation="insert";break;case"delete":operation="delete";break;default:return true}return this._save_inner(id,obj,operation)},_check_unique:function(check){for(var i=0;i<this._updates.length;i++){var one=this._updates[i];if(one.id==check.id){if(check.operation=="delete"){if(one.operation=="insert")this._updates.splice(i,1);else one.operation="delete"}one.data=check.data;one._invalid=check._invalid;return false}}return true},send:function(){this._sendData()},_sendData:function(){if(!this._settings.url)return;var marked=this._updates;var to_send=[];var url=this._settings.url;for(var i=0;i<marked.length;i++){var tosave=marked[i];if(tosave._in_progress)continue;if(tosave._invalid)continue;var id=tosave.id;var operation=tosave.operation;var precise_url=typeof url=="object"&&!url.$proxy?url[operation]:url;var proxy=precise_url&&(precise_url.$proxy||typeof precise_url==="function");if(!precise_url)continue;if(this._settings.store._scheme_save)this._settings.store._scheme_save(tosave.data);if(!this.callEvent("onBefore"+operation,[id,tosave]))continue;tosave._in_progress=true;if(!this.callEvent("onBeforeDataSend",[tosave]))return;tosave.data=this._updatesData(tosave.data);var callback=this._send_callback({id:tosave.id,status:tosave.operation});if(precise_url.$proxy){if(precise_url.save)precise_url.save(this.config.master,tosave,this,callback);else to_send.push(tosave)}else{if(operation=="insert")delete tosave.data.id;if(proxy){precise_url(tosave.id,tosave.operation,tosave.data).then(function(data){if(data&&typeof data.json=="function")data=data.json();callback.success("",data,-1)},function(error){callback.error("",null,error)})}else{tosave.data[this._settings.operationName]=operation;this._send(precise_url,tosave.data,this._settings.mode,operation,callback)}}this.callEvent("onAfterDataSend",[tosave])}if(url.$proxy&&url.saveAll&&to_send.length)url.saveAll(this.config.master,to_send,this,this._send_callback({}))},_updatesData:function(source){var target={};for(var j in source){if(j.indexOf("$")!==0)target[j]=source[j]}return target},_send:function(url,post,mode,operation,callback){webix.assert(url,"url was not set for DataProcessor");if(typeof url=="function")return url(post,operation,callback);webix.ajax()[mode](url,post,callback)},_send_callback:function(id){var self=this;return{success:function(t,d,l){return self._processResult(id,t,d,l)},error:function(t,d,l){return self._processError(id,t,d,l)}}},attachProgress:function(start,end,error){this.attachEvent("onBeforeDataSend",start);this.attachEvent("onAfterSync",end);this.attachEvent("onAfterSaveError",error);this.attachEvent("onLoadError",error)},_processError:function(id,text,data,loader){if(id)this._innerProcessResult(true,id.id,false,id.status,false,{text:text,data:data,loader:loader});else{this.callEvent("onLoadError",arguments);webix.callEvent("onLoadError",[text,data,loader,this])}},_innerProcessResult:function(error,id,newid,status,obj,details){var master=this._settings.master;var update=this.getItemState(id);update._in_progress=false;if(error){if(this.callEvent("onBeforeSaveError",[id,status,obj,details])){update._invalid=true;if(this._settings.undoOnError&&master._settings.undo)master.undo(id);this.callEvent("onAfterSaveError",[id,status,obj,details]);return}}else this.setItemState(id,false);if(newid&&id!=newid)this._settings.store.changeId(id,newid);if(obj&&status!="delete"&&this._settings.updateFromResponse)this.ignore(function(){this._settings.store.updateItem(newid||id,obj)});if(this._settings.undoOnError&&master._settings.undo)master.removeUndo(newid||id);this.callEvent("onAfterSave",[obj,id,details]);this.callEvent("onAfter"+status,[obj,id,details])},processResult:function(state,hash,details){var error=hash&&(hash.status=="error"||hash.status=="invalid");var newid=hash?hash.newid||hash.id:false;this._innerProcessResult(error,state.id,newid,state.status,hash,details)},_processResult:function(state,text,data,loader){this.callEvent("onBeforeSync",[state,text,data,loader]);if(loader===-1){this.processResult(state,data,{})}else{var proxy=this._settings.url;if(proxy.$proxy&&proxy.result)proxy.result(state,this._settings.master,this,text,data,loader);else{var hash;if(text){hash=data.json();if(text&&typeof hash=="undefined")hash={status:"error"}}this.processResult(state,hash,{text:text,data:data,loader:loader})}}this.callEvent("onAfterSync",[state,text,data,loader])},escape:function(value){if(this._settings.escape)return this._settings.escape(value);else return encodeURIComponent(value)},getState:function(){if(!this._updates.length)return false;for(var i=this._updates.length-1;i>=0;i--)if(this._updates[i]._in_progress)return"saving";return true},getItemState:function(id){var index=this._get_stack_index(id);return this._updates[index]||null},setItemState:function(id,state){if(state)this.save(id,state);else{var index=this._get_stack_index(id);if(index>-1)this._updates.splice(index,1)}},_get_stack_index:function(id){var index=-1;var update=null;for(var i=0;i<this._updates.length;i++)if(this._updates[i].id==id){index=i;break}return index}},webix.Settings,webix.EventSystem,webix.ValidateData);(function(){var timers={};webix.jsonp=function(url,params,callback,master){var defer=webix.promise.defer();var id="webix_jsonp_"+webix.uid();var script=document.createElement("script");script.id=id;script.type="text/javascript";var head=document.getElementsByTagName("head")[0];if(typeof params=="function"){master=callback;callback=params;params={}}if(!params)params={};params.jsonp="webix.jsonp."+id;webix.jsonp[id]=function(){if(callback)callback.apply(master||window,arguments);defer.resolve(arguments[0]);window.clearTimeout(timers[id]);delete timers[id];script.parentNode.removeChild(script);callback=head=master=script=null;delete webix.jsonp[id]};timers[id]=window.setTimeout(function(){defer.reject();delete webix.jsonp[id]},webix.jsonp.timer);var vals=[];for(var key in params)vals.push(key+"="+encodeURIComponent(params[key]));url+=(url.indexOf("?")==-1?"?":"&")+vals.join("&");script.src=url;head.appendChild(script);return defer};webix.jsonp.timer=3e3})();webix.markup={namespace:"x",attribute:"data-",dataTag:"li",_dash:/-([a-z])/g,_after_dash:function(match){return match[1].toUpperCase()},_parse_int:{width:true,height:true,gravity:true,margin:true,padding:true,paddingX:true,paddingY:true,minWidth:true,maxWidth:true,minHeight:true,maxHeight:true,headerRowHeight:true},_parse_bool:{disabled:true,hidden:true},_view_has_method:function(view,name){return webix.ui.hasMethod(view,name)},init:function(node,target,scope){node=node||document.body;var els=[];var temp=this._get_core_els(node);var html=temp.html;var ui=null;for(var i=temp.length-1;i>=0;i--)els[i]=temp[i];for(var i=0;i<els.length;i++){var config,temp_config;config=this._sub_markup(els[i],html);config.$scope=scope;ui=this._initComponent(config,els[i],html,target)}return ui},parse:function(source,mode){if(typeof source=="string")source=webix.DataDriver[mode||"xml"].toObject(source,source);var els=this._get_core_els(source,mode);return this._sub_markup(els[0],els.html)},_initComponent:function(config,node,html,target){if(!target){config.container=node.parentNode;webix.html.remove(node)}else config.container=target;if(this._view_has_method(config.view,"setPosition"))delete config.container;return webix.ui(config)},_get_core_els:function(node){this._full_prefix=this.namespace?this.namespace+":":"";this._full_prefix_top=this._full_prefix+"ui";var els=node.getElementsByTagName(this._full_prefix_top);if(!els.length&&node.documentElement&&node.documentElement.tagName==this._full_prefix_top)els=[node.documentElement];if(!els.length&&this.namespace){els=node.getElementsByTagName("ui");if(!els.length&&node.documentElement&&node.documentElement.tagName=="ui")els=[node.documentElement]}if(!els.length){els=this._get_html_tops(node);els.html=true}return els},_get_html_tops:function(node){if(node.getAttribute&&node.getAttribute(this.attribute+"view"))return[node];var els=node.querySelectorAll("["+this.attribute+"view]");var tags=[];var marks=[];for(var i=0;i<els.length;i++)if(!els[i].parentNode.getAttribute(this.attribute+"view"))tags.push(els[i]);return tags},_sub_markup:function(el,html,json){var htmltable=false;if(!json){var name=this._get_name(el,html);if(name=="ui"){var childs=el.childNodes;for(var i=0;i<childs.length;i++)if(childs[i].nodeType==1){return this._sub_markup(childs[i],html)}}json={view:name};if(html&&el.tagName.toLowerCase()=="table"){json.data=el;json.datatype="htmltable";htmltable=true}}var is_layout=json.view=="cols"||json.view=="rows"||this._view_has_method(json.view,"addView");var subs=[];var has_tags=0;var allow_sub_tags=!(html||el.style);var first=el.firstChild;while(first){if(first.nodeType==1){var name=this._get_name(first,html);if(name=="data"){has_tags=1;var data=first;first=first.nextSibling;json.data=this._handle_data(data,html);continue}else if(name=="config"){this._get_config_html(first,json,html);var confignode=first;first=first.nextSibling;webix.html.remove(confignode);continue}else if(name=="column"){has_tags=1;var column=this._tag_to_json(first,html);column.header=column.header||column.value;column.width=column.width*1||"";json.columns=json.columns||[];json.columns.push(column)}else if(name||is_layout&&html){var obj=this._sub_markup(first,html,{view:name});if(obj.view=="head")json.head=obj.rows?obj.rows[0]:obj.template;else if(obj.view=="body"){if(this._view_has_method(json.view,"addView")){subs.push({body:obj.rows?obj.rows[0]:obj.value,header:obj.header||""})}else{json.body=obj.rows?obj.rows.length==1?obj.rows[0]:{rows:obj.rows}:obj.value}}else subs.push(obj)}else if(allow_sub_tags){has_tags=1;var tagName=first.tagName;if(html)tagName=tagName.toLowerCase().replace(this._dash,this._after_dash);json[tagName]=webix.DataDriver.xml.tagToObject(first)}}first=first.nextSibling}this._attrs_to_json(el,json,html);if(subs.length){if(json.stack)json[json.stack]=subs;else if(this._view_has_method(json.view,"setValues"))json["elements"]=subs;else if(json.view=="rows"){json.view="layout";json.rows=subs}else if(json.view=="cols"){json.view="layout";json.cols=subs}else if(this._view_has_method(json.view,"setValue")){json["cells"]=subs}else if(this._view_has_method(json.view,"getBody")){json.body=subs.length==1?subs[0]:{rows:subs}}else json["rows"]=subs}else if(!htmltable&&!has_tags){if(html&&!json.template&&(!json.view||json.view=="template")){json.view="template";json.content=el}else{var content=this._content(el,html);if(content){var target="template";if(this._view_has_method(json.view,"setValue"))target="value";json[target]=json[target]||content}}}return json},_empty:function(str){var clean=str.replace(/\s+/gm,"");return clean.length>0?false:true},_markup_names:{body:1,head:1,data:1,rows:1,cols:1,cells:1,elements:1,ui:1,column:1,config:1},_get_config_html:function(tag,json,html){var master=this._attrs_to_json(tag,{});if(master.name){json[master.name]=master;delete master.name}else if(master.stack)json[master.stack]=[];else json=master;var childs=tag.childNodes;for(var i=0;i<childs.length;i++){var sub=null;if(childs[i].nodeType==1&&childs[i].tagName.toLowerCase()=="config"&&childs[i].attributes.length)sub=this._get_config_html(childs[i],master,html);else sub=childs[i].innerHTML;if(master.stack&&sub)json[master.stack].push(sub)}return json},_get_name:function(tag,html){if(html)return tag.getAttribute(this.attribute+"view")||(tag.tagName.toLowerCase()=="config"?"config":null);var name=tag.tagName.toLowerCase();if(this.namespace){if(name.indexOf(this._full_prefix)===0||tag.scopeName==this.namespace)return name.replace(this._full_prefix,"")}else{if(webix.ui[name]||this._markup_names[name])return name}return 0},_handle_data:function(el,html){var data=[];var records=el.getElementsByTagName(webix.markup.dataTag);for(var i=0;i<records.length;i++){var rec=records[i];if(rec.parentNode.parentNode.tagName!=webix.markup.dataTag){var json=this._tag_to_json(rec,html);if(rec.className)json.$css=rec.className;data.push(json)}}webix.html.remove(el);return data},_content:function(el,html){if(el.style)return el.innerHTML;if(el.firstChild)return el.firstChild.wholeText||el.firstChild.data||"";return""},_tag_to_json:function(el,html){if(!html)return webix.DataDriver.xml.tagToObject(el);var json=this._attrs_to_json(el,{},html);if(!json.value&&el.childNodes.length)json.value=this._content(el,html);return json},_attrs_to_json:function(el,json,html){var attrs=el.attributes;for(var i=0;i<attrs.length;i++){var name=attrs[i].name;if(html){if(name.indexOf(this.attribute)!==0)continue;name=name.replace(this.attribute,"").replace(this._dash,this._after_dash)}var value=attrs[i].value;if(value.indexOf("json://")!=-1)value=JSON.parse(value.replace("json://",""));if(this._parse_int[name])value=parseInt(value,10);else if(this._parse_bool[name])value=value&&value!=="false"&&value!="0";json[name]=value}return json}};(function(){var _webix_msg_cfg=null;function callback(config,result){var usercall=config.callback;modality(false);config.box.parentNode.removeChild(config.box);_webix_msg_cfg=config.box=null;if(usercall)usercall(result,config.details)}function modal_key(e){if(_webix_msg_cfg){e=e||event;var code=e.which||event.keyCode;if(webix.message.keyboard){if(code==13||code==32)callback(_webix_msg_cfg,true);if(code==27)callback(_webix_msg_cfg,false);if(e.preventDefault)e.preventDefault();return!(e.cancelBubble=true)}}}webix.event(document,"keydown",modal_key,{capture:true});function modality(mode){if(!modality.cover||!modality.cover.parentNode){modality.cover=document.createElement("DIV");modality.cover.onkeydown=modal_key;modality.cover.className="webix_modal_cover";document.body.appendChild(modality.cover)}modality.cover.style.display=mode?"inline-block":"none"}function button(text,result,className){return"<div role='button' tabindex='0' aria-label='"+text+"' class='webix_popup_button"+(className?" "+className:"")+"' result='"+result+"' ><div>"+text+"</div></div>"}function info(text){if(!t.area){t.area=document.createElement("DIV");t.area.className="webix_message_area";t.area.style[t.position]="5px";document.body.appendChild(t.area)}t.area.setAttribute("role","alert");t.area.setAttribute("aria-atomic",true);t.hide(text.id);var message=document.createElement("DIV");message.innerHTML="<div>"+text.text+"</div>";message.className="webix_info webix_"+text.type;message.onclick=function(){t.hide(text.id);text=null};if(webix.$testmode)message.className+=" webix_no_transition";if(t.position=="bottom"&&t.area.firstChild)t.area.insertBefore(message,t.area.firstChild);else t.area.appendChild(message);if(text.expire>0)t.timers[text.id]=window.setTimeout(function(){t.hide(text.id)},text.expire);message.style.height=message.offsetHeight-2+"px";t.pull[text.id]=message;message=null;return text.id}function _boxStructure(config,ok,cancel){var box=document.createElement("DIV");box.className=" webix_modal_box webix_"+config.type;box.setAttribute("webixbox",1);box.setAttribute("role","alertdialog");box.setAttribute("aria-label",config.title||"");box.setAttribute("tabindex","0");var inner="";if(config.width)box.style.width=config.width+(webix.rules.isNumber(config.width)?"px":"");if(config.height)box.style.height=config.height+(webix.rules.isNumber(config.height)?"px":"");if(config.title)inner+='<div class="webix_popup_title">'+config.title+"</div>";inner+='<div class="webix_popup_text"><span>'+(config.content?"":config.text)+'</span></div><div  class="webix_popup_controls">';if(ok||config.ok)inner+=button(config.ok||"OK",true,"confirm");if(cancel||config.cancel)inner+=button(config.cancel||"Cancel",false);if(config.buttons){for(var i=0;i<config.buttons.length;i++)inner+=button(config.buttons[i],i)}inner+="</div>";box.innerHTML=inner;if(config.content){var node=config.content;if(typeof node=="string")node=document.getElementById(node);if(node.style.display=="none")node.style.display="";box.childNodes[config.title?1:0].appendChild(node)}box.onclick=function(e){e=e||event;var source=e.target||e.srcElement;if(!source.className)source=source.parentNode;if(source.className.indexOf("webix_popup_button")!=-1){var result=source.getAttribute("result");result=result=="true"||(result=="false"?false:result);callback(config,result)}e.cancelBubble=true};config.box=box;if(ok||cancel||config.buttons)_webix_msg_cfg=config;return box}function _createBox(config,ok,cancel){var box=config.tagName?config:_boxStructure(config,ok,cancel);if(!config.hidden)modality(true);webix.toNode(config.container||document.body).appendChild(box);var x=config.left||Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-box.offsetWidth)/2));var y=config.top||Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-box.offsetHeight)/2));if(config.position=="top")box.style.top="-3px";else box.style.top=y+"px";box.style.left=x+"px";box.onkeydown=modal_key;box.focus();if(config.hidden)webix.modalbox.hide(box);return box}function alertPopup(config){return _createBox(config,true,false)}function confirmPopup(config){return _createBox(config,true,true)}function boxPopup(config){return _createBox(config)}function box_params(text,type,callback){if(typeof text!="object"){if(typeof type=="function"){callback=type;type=""}text={text:text,type:type,callback:callback}}return text}function params(text,type,expire,id){if(typeof text!="object")text={text:text,type:type,expire:expire,id:id};text.id=text.id||t.uid();text.expire=text.expire||t.expire;return text}webix.alert=function(){var text=box_params.apply(this,arguments);text.type=text.type||"confirm";return alertPopup(text)};webix.confirm=function(){var text=box_params.apply(this,arguments);text.type=text.type||"alert";return confirmPopup(text)};webix.modalbox=function(){var text=box_params.apply(this,arguments);text.type=text.type||"alert";return boxPopup(text)};webix.modalbox.hide=function(node){if(node){while(node&&node.getAttribute&&!node.getAttribute("webixbox"))node=node.parentNode;if(node){node.parentNode.removeChild(node)}}modality(false);_webix_msg_cfg=null};var t=webix.message=function(text,type,expire,id){text=params.apply(this,arguments);text.type=text.type||"info";var subtype=text.type.split("-")[0];switch(subtype){case"alert":return alertPopup(text);case"confirm":return confirmPopup(text);case"modalbox":return boxPopup(text);default:return info(text)}};t.seed=(new Date).valueOf();t.uid=function(){return t.seed++};t.expire=4e3;t.keyboard=true;t.position="top";t.pull={};t.timers={};t.hideAll=function(){for(var key in t.pull)t.hide(key)};t.hide=function(id){var obj=t.pull[id];if(obj&&obj.parentNode){window.setTimeout(function(){obj.parentNode.removeChild(obj);obj=null},2e3);obj.style.height=0;obj.className+=" hidden";t.area.removeAttribute("role");if(t.timers[id])window.clearTimeout(t.timers[id]);delete t.pull[id]}}})();webix.debug_ready(function(){var ignore={_inner:true,awidth:true,cheight:true,bheight:true,aheight:true};function get_inspector_config(view){var values={};var options=[];view=webix.$$(view);for(var key in view.config){if(ignore[key])continue;if(typeof view.config[key]=="object")continue;if(typeof view.config[key]=="undefined")continue;if(typeof view.config[key]=="function")continue;if(key=="view"||key=="id")options.push({label:key,id:key});else options.push({label:key,type:"text",id:key});if(view.defaults[key]==view.config[key])options[options.length-1].css={color:"#888"};values[key]=view.config[key]}options.sort(function(a,b){if(!a.css&&b.css)return-1;if(a.css&&!b.css)return 1;return a.id>b.id?1:a.id==b.id?0:-1});return{elements:options,data:values,head:" ["+view.name+"] <strong>"+view._settings.id+"</strong>"}}function create_inspector(){if(!webix.$$("webix_debug_inspector_win"))webix.ui({id:"webix_debug_inspector_win",view:"window",top:2,left:0,width:350,height:350,head:false,autofit:false,body:{cols:[{width:10},{type:"clean",rows:[{view:"toolbar",elements:[{view:"label",value:"",id:"webix_debug_inspector_head"},{view:"button",width:100,value:"Hide",type:"custom",click:function(){webix.debug_inspect()}}]},{id:"webix_debug_inspector",nameWidth:150,view:"property",scroll:"y",elements:[],on:{onaftereditstop:function(state,editor){if(state.old==state.value)return;var value=state.value;if(value==="true"||value==="false"){value=value==="true"}else{var intvalue=parseInt(value,10);if(intvalue==value)value=intvalue}var view=webix.$$(this.config.view);view.define(editor.id,value);if(view.refreshColumns)view.refreshColumns();else if(view.refresh)view.refresh();view.resize()}}}]}]}})}function show_inspector(view,ev){create_inspector();var win=webix.$$("webix_debug_inspector_win");if(view){var config=get_inspector_config(view);var winx=document.body.offsetWidth;var winy=document.body.offsetHeight;var pos=ev?webix.html.pos(ev):{x:0,y:0};win.define("height",Math.max(350,winy-4));win.resize();var props=webix.$$("webix_debug_inspector");props.define("elements",config.elements);props.define("view",view);win.show({x:pos.x>winx/2?0:winx-370,y:0});webix.$$("webix_debug_inspector").setValues(config.data);webix.$$("webix_debug_inspector_head").setValue(config.head)}else win.hide()}webix.debug_inspect=show_inspector;function infi(value){if(value>=1e5)return"Any";return value}function log_level(data,prefix,now){window.console.log((data==now?">>":"  ")+prefix+data.name+" / "+data.config.id);prefix+="  ";if(data._cells)for(var i=0;i<data._cells.length;i++){log_level(data._cells[i],prefix,now)}if(data._head_cell)log_level(data._head_cell,prefix,now);if(data._body_cell)log_level(data._body_cell,prefix,now)}webix.ui({view:"contextmenu",id:"webix:debugmenu",on:{onBeforeShow:function(e){if(!e.ctrlKey)return false;var view=webix.html.locate(e,"view_id");if(!view)return false;this.config.lastTarget=view;webix.blockEvent();webix.delay(function(){webix.unblockEvent()})},onShow:function(){var view=webix.$$(this.config.lastTarget);var info="<span style='color:#888'>"+view._settings.id+"<sup style='float:right'>["+view.name+"]</sup></span>";document.getElementById("webix_debug_cmx").innerHTML=info}},data:["<div id='webix_debug_cmx'></div>",{id:"inspect",value:"Inspect"},{id:"docs",value:"Documentation"},{value:"Log to Console",submenu:[{id:"size",value:"Sizes"},{id:"tree",value:"Tree"},{id:"dump",value:"Dump"}]}],click:function(id,ev){var obj=webix.$$(this.config.lastTarget);if(id=="dump"){window.console.info("\n"+obj.name+" / "+obj.config.id);window.console.log("\nView: ",obj,", Config: ",obj.config,", Data: ",obj.data);window.console.log(obj.$view)}if(id=="tree"){var now=obj;while(obj.getParentView())obj=obj.getParentView();window.console.log("");log_level(obj,"",now)}if(id=="size"){window.console.info("");window.console.info("\n"+obj.name+" / "+obj.config.id);window.console.info("\n[min]   ",obj.config.width," x ",obj.config.height);var sizes=obj.$getSize(0,0);window.console.info("[max]    ",infi(sizes[1])," x ",infi(sizes[3])+(obj.config.autoheight?", auto height":""));window.console.info("[gravity]   ",obj.config.gravity);window.console.info("\n[content]    ",obj._content_width," x ",obj._content_height);window.console.info("[last set]   ",obj._last_size[0]," x ",obj._last_size[1]);if(obj._settings._inner)window.console.info("\n[borders]   ","left:",!obj._settings._inner.left,"\ttop:",!obj._settings._inner.top,"\tright:",!obj._settings._inner.right,"\tbottom:",!obj._settings._inner.bottom);else window.console.info("\n[borders]   none")}if(id=="docs")window.open("http://docs.webix.com/api__refs__ui."+obj.name+".html","__blank");if(id=="inspect"){show_inspector(this.config.lastTarget,ev)}},master:document.body})});webix.protoUI({name:"carousel",defaults:{scrollSpeed:"300ms",type:"clean",navigation:{},animate:true},$init:function(config){this._viewobj.className+=" webix_carousel";this._layout=null;this._dataobj=null;this._active_cell=0;this.$ready.unshift(this._initLayout);this.$ready.push(this._after_init_call)},addView:function(view,index){var t=this._layout.addView(view,index);this._fix_after_view_add();return t},removeView:function(id){this._layout.removeView(id);this._fix_after_view_add()},_replace:function(new_view,target_id){this._layout._replace(new_view,target_id);this._fix_after_view_add()},_fix_after_view_add:function(){this._cells=this._layout._cells;this._renderPanel();this.setActiveIndex(Math.min(this._active_cell,this._cells.length-1))},_initLayout:function(){if(this._layout&&this._layout.destructor)this._layout.destructor();var layout="";if(this.config.cols){layout="cols";this._vertical_orientation=0}else{layout="rows";this._vertical_orientation=1}var config={borderless:true,type:"clean"};config[layout]=webix.copy(this._settings[layout]);var layoutProp=["type","margin","marginX","marginY","padding","paddingX","paddingY"];var layoutConfig={};for(var i=0;i<layoutProp.length;i++){if(this._settings[layoutProp[i]]){layoutConfig[layoutProp[i]]=this._settings[layoutProp[i]]}}webix.extend(config,layoutConfig,true);this._layout=webix.ui._view(config);this._layout._parent_cell=this;this._viewobj.appendChild(this._layout._viewobj);this._cells=this._layout._cells;this._layout._show=webix.bind(webix.ui.carousel.prototype._show,this);this._layout.adjustScroll=webix.bind(webix.ui.carousel.prototype.adjustScroll,this);webix.attachEvent("onReconstruct",webix.bind(function(view){if(view==this._layout)this._setScroll()},this));this._contentobj=this._viewobj.firstChild},_onKeyPress:function(code,e){if(this._settings.navigation.items&&e.target.getAttribute("role")==="tab")this._moveActive(code,e);webix.ui.baseview.prototype._onKeyPress.call(this,code,e)},getChildViews:function(){return[this._layout]},getLayout:function(){return this._layout},_after_init_call:function(){this._contentobj.setAttribute("touch_scroll",this._vertical_orientation?"y":"x");this._layout.attachEvent("onAfterScroll",webix.bind(function(view){this.callEvent("onShow",[this.getActiveId()])},this));webix.ui.each(this._layout,function(view){view._viewobj.setAttribute("role","tabpanel")})},adjustScroll:function(matrix){var size=this._vertical_orientation?this._content_height:this._content_width;var correction;if(this._vertical_orientation){correction=Math.round(matrix.f/size);matrix.f=correction*size}else{correction=Math.round(matrix.e/size);matrix.e=correction*size}this._active_cell=-correction;if(this._settings.navigation)this._renderNavItems();return true},_show:function(obj){var i,layout,_nextCell,_size,x,y;_nextCell=-1;layout=this._layout;for(i=0;i<layout._cells.length;i++){if(layout._cells[i]==obj){_nextCell=i;break}}if(_nextCell<0||_nextCell==this._active_cell)return;this._active_cell=_nextCell;_size=layout._vertical_orientation?this._content_height:this._content_width;x=-(layout._vertical_orientation?0:_nextCell*_size);y=-(layout._vertical_orientation?_nextCell*_size:0);this.scrollTo(x,y);this.callEvent("onShow",[layout._cells[this._active_cell]._settings.id]);if(this._settings.navigation)this._renderPanel()},scrollTo:function(x,y){if(webix.Touch&&webix.animate.isSupported()&&this._settings.animate)webix.Touch._set_matrix(this._contentobj,x,y,this._settings.scrollSpeed||"100ms");else{this._contentobj.style.marginLeft=x+"px";this._contentobj.style.marginTop=y+"px"}},navigation_setter:function(config){this._mergeSettings(config,{type:"corner",buttons:true,items:true});return config},showNext:function(){if(this._active_cell<this._layout._cells.length-1)this.setActiveIndex(this._active_cell+1)},showPrev:function(){if(this._active_cell>0)this.setActiveIndex(this._active_cell-1)},setActiveIndex:function(value){webix.assert(value<this._layout._cells.length,"Not existing index in collection");var id=this._layout._cells[value]._settings.id;webix.$$(id).show()},getActiveIndex:function(){return this._active_cell},$getSize:function(dx,dy){var layoutSizes=this._layout.$getSize(0,0);var selfSizes=webix.ui.view.prototype.$getSize.call(this,dx,dy);if(this._layout._vertical_orientation){selfSizes[0]=Math.max(selfSizes[0],layoutSizes[0]);selfSizes[1]=Math.min(selfSizes[1],layoutSizes[1])}else{selfSizes[2]=Math.max(selfSizes[2],layoutSizes[2]);selfSizes[3]=Math.min(selfSizes[3],layoutSizes[3])}return selfSizes},$setSize:function(x,y){var layout=this._layout;var c=layout._cells.length;var changed=webix.ui.view.prototype.$setSize.call(this,x,y);var yc=this._content_height*(layout._vertical_orientation?c:1);var xc=this._content_width*(layout._vertical_orientation?1:c);if(changed){this._contentobj.style.height=yc+"px";this._contentobj.style.width=xc+"px";layout.$setSize(xc,yc);this._setScroll()}else layout.$setSize(xc,yc)},_setScroll:function(){var layout=this._layout;var activeCell=this._active_cell||0;var size=layout._vertical_orientation?this._content_height:this._content_width;var x=-(layout._vertical_orientation?0:activeCell*size);var y=-(layout._vertical_orientation?activeCell*size:0);this.scrollTo(x,y);if(this._settings.navigation)this._renderPanel()},getActiveId:function(){var cell=this._layout._cells[this._active_cell];return cell?cell._settings.id:null},setActive:function(value){webix.$$(value).show()}},webix.EventSystem,webix.NavigationButtons,webix.ui.view);webix.type(webix.ui.list,{name:"uploader",template:"#name#  {common.removeIcon()}{common.percent()}<div style='float:right'>#sizetext#</div>",percent:function(obj){if(obj.status=="transfer")return"<div style='width:60px; text-align:center; float:right'>"+obj.percent+"%</div>";return"<div class='webix_upload_"+obj.status+"'><span class='"+(obj.status=="error"?"error_icon":"fa-check webix_icon")+"'></span></div>"},removeIcon:function(obj){return"<div class='webix_remove_upload'><span class='cancel_icon'></span></div>"},on_click:{webix_remove_upload:function(ev,id){webix.$$(this.config.uploader).files.remove(id)}}});webix.UploadDriver={flash:{$render:function(render_config){if(!window.swfobject)webix.require("legacy/swfobject.js",true);var config=this._settings;config.swfId=config.swfId||"webix_swf_"+webix.uid();this._getBox().innerHTML+="<div class='webix_upload_flash'><div id='"+config.swfId+"'></div></div>";this._upload_area=this._getBox().lastChild;swfobject.embedSWF(webix.codebase+"/legacy/uploader.swf",config.swfId,"100%","100%","9",null,{uploaderId:config.id,ID:config.swfId,enableLogs:config.enableLogs?"1":"",paramName:config.inputName,multiple:config.multiple?"Y":""},{wmode:"transparent"});var v=swfobject.getFlashPlayerVersion();webix._event(this._viewobj,"click",webix.bind(function(){var now_date=new Date;if(now_date-(this._upload_timer_click||0)>250){this.fileDialog()}},this));this.files.attachEvent("onBeforeDelete",webix.bind(this._stop_file,this))},$applyFlash:function(name,params){return this[name].apply(this,params)},getSwfObject:function(){return swfobject.getObjectById(this._settings.swfId)},fileDialog:function(){if(this.getSwfObject())this.getSwfObject().showDialog()},send:function(id){if(typeof id=="function"){this._last_assigned_upload_callback=id;id=0}if(!id){var order=this.files.data.order;var complete=true;if(order.length)for(var i=0;i<order.length;i++){complete=this.send(order[i])&&complete}if(complete)this._upload_complete();return}var item=this.files.getItem(id);if(item.status!=="client")return false;item.status="transfer";if(this.getSwfObject()){var url=this._get_active_url(item);var details=webix.extend(item.formData||{},this._settings.formData||{});this.getSwfObject().upload(id,url,details)}return true},$beforeAddFileToQueue:function(id,name,size){var type=name.split(".").pop();var format=this._format_size(size);return this.callEvent("onBeforeFileAdd",[{id:id,name:name,size:size,sizetext:format,type:type}])},$addFileToQueue:function(id,name,size){if(this.files.exists(id))return false;if(!this._settings.multiple)this.files.clearAll();var type=name.split(".").pop();var format=this._format_size(size);var file_struct={name:name,id:id,size:size,sizetext:format,type:type,status:"client"};this.files.add(file_struct);this.callEvent("onAfterFileAdd",[file_struct]);if(id&&this._settings.autosend)this.send(id)},stopUpload:function(id){this._stop_file(id)},_stop_file:function(id){var item=this.files.getItem(id);if(item.status=="transfer"){this.getSwfObject().uploadStop(id);item.status="client"}},$onUploadComplete:function(){if(this._settings.autosend){this._upload_complete()}},$onUploadSuccess:function(id,name,response){var item=this.files.getItem(id);if(item){item.status="server";item.progress=100;if(response.text&&typeof response.text=="string"){webix.DataDriver.json.toObject(response.text);webix.extend(item,response,true)}this.callEvent("onFileUpload",[item,response]);this.callEvent("onChange",[]);this.files.updateItem(id)}},$onUploadFail:function(id){var item=this.files.getItem(id);item.status="error";delete item.percent;this.files.updateItem(id);this.callEvent("onFileUploadError",[item,""])}},html5:{$render:function(config){if(this._upload_area){this._contentobj.firstChild.appendChild(this._upload_area);return}this.files.attachEvent("onBeforeDelete",this._stop_file);var input_config={type:"file",class:"webix_hidden_upload",tabindex:-1};if(this._settings.accept)input_config.accept=this._settings.accept;if(this._settings.multiple)input_config.multiple="true";if(this._settings.directory){input_config.webkitdirectory="true";input_config.mozdirectory="true";input_config.directory="true"}var f=webix.html.create("input",input_config);this._upload_area=this._contentobj.firstChild.appendChild(f);webix._event(this._viewobj,"drop",webix.bind(function(e){this._drop(e);webix.html.preventEvent(e)},this));webix._event(f,"change",webix.bind(function(){this._add_files(f.files);if(webix.env.isIE){var t=document.createElement("form");t.appendChild(this._upload_area);t.reset();this._contentobj.firstChild.appendChild(f)}else f.value=""},this));webix._event(this._viewobj,"click",webix.bind(function(){var now_date=new Date;if(now_date-(this._upload_timer_click||0)>250){this.fileDialog()}},this));webix._event(this._viewobj,"dragenter",webix.html.preventEvent);webix._event(this._viewobj,"dragexit",webix.html.preventEvent);webix._event(this._viewobj,"dragover",webix.html.preventEvent)},_directoryEntry:function(value){return value.isDirectory},_directoryDrop:function(item,state,path){if(item.isFile){item.file(function(file){state.addFile(file,null,null,{name:path+"/"+file.name})})}else if(item.isDirectory){var dirReader=item.createReader();dirReader.readEntries(function(entries){for(var i=0;i<entries.length;i++){state._directoryDrop(entries[i],state,(path?path+"/":"")+item.name)}})}},_drop:function(e){var files=e.dataTransfer.files;var items=e.dataTransfer.items;if(this.callEvent("onBeforeFileDrop",[files,e])){for(var i=0;i<items.length;i++){var item=items[i];if(this._settings.directory&&item.webkitGetAsEntry){item=item.webkitGetAsEntry();if(item.isDirectory){this._directoryDrop(item,this,"");continue}}this.addFile(files[i])}}this.callEvent("onAfterFileDrop",[files,e])},fileDialog:function(context){this._upload_timer_click=new Date;this._last_file_context=context;var inputs=this._viewobj.getElementsByTagName("INPUT");inputs[inputs.length-1].click()},send:function(id){if(typeof id=="function"){this._last_assigned_upload_callback=id;id=0}if(!id){var order=this.files.data.order;var complete=true;if(order.length)for(var i=0;i<order.length;i++)complete=!this.send(order[i])&&complete;if(complete)this._upload_complete();return}var item=this.files.getItem(id);if(item.status!=="client")return false;webix.assert(this._settings.upload,"You need to define upload url for uploader component");item.status="transfer";var formData=new FormData;if(item.folder){for(var i=0;i<item.folder.length;i++){formData.append(this.config.inputName+i,item.folder[i],item.folder[i].webkitRelativePath)}}else{formData.append(this.config.inputName,item.file,item.name);if(this._settings.directory)formData.append(this.config.inputName+"_fullpath",item.name)}var headers={};var details=webix.extend(item.formData||{},this._settings.formData||{});var xhr=new XMLHttpRequest;var url=this._get_active_url(item);if(webix.callEvent("onBeforeAjax",["POST",url,details,xhr,headers,formData])){for(var key in details)formData.append(key,details[key]);item.xhr=xhr;xhr.upload.addEventListener("progress",webix.bind(function(e){this.$updateProgress(id,e.loaded/e.total*100)},this),false);xhr.onload=webix.bind(function(e){if(!xhr.aborted)this._file_complete(id)},this);xhr.open("POST",url,true);for(var key in headers)xhr.setRequestHeader(key,headers[key]);xhr.send(formData)}this.$updateProgress(id,0);return true},_file_complete:function(id){var item=this.files.getItem(id);if(item){var response=null;if(item.xhr.status<400){response=webix.DataDriver[this._settings.datatype||"json"].toObject(item.xhr.responseText)}if(!response||response.status=="error"){item.status="error";delete item.percent;this.files.updateItem(id);this.callEvent("onFileUploadError",[item,response])}else{this._complete(id,response)}delete item.xhr}},stopUpload:function(id){webix.bind(this._stop_file,this.files)(id)},_stop_file:function(id){var item=this.getItem(id);if(typeof item.xhr!=="undefined"){item.xhr.aborted=true;item.xhr.abort();delete item.xhr;item.status="client"}}}};webix.protoUI({name:"uploader",defaults:{autosend:true,multiple:true,inputName:"upload"},$cssName:"button",_allowsClear:true,on_click:{webix_hidden_upload:function(){return false}},send:function(){},fileDialog:function(){},stopUpload:function(){},$init:function(config){var driver=webix.UploadDriver.html5;this.files=new webix.DataCollection;if(webix.isUndefined(XMLHttpRequest)||webix.isUndefined((new XMLHttpRequest).upload))driver=webix.UploadDriver.flash;webix.assert(driver,"incorrect driver");webix.extend(this,driver,true)},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)){this.render()}},apiOnly_setter:function(value){webix.delay(this.render,this);return this.$apiOnly=value},_add_files:function(files){for(var i=0;i<files.length;i++)this.addFile(files[i])},link_setter:function(value){if(value)webix.delay(function(){var view=webix.$$(this._settings.link);if(!view){var top=this.getTopParentView();if(top.$$)view=top.$$(this._settings.link)}if(view.sync&&view.filter)view.sync(this.files);else if(view.setValues)this.files.data.attachEvent("onStoreUpdated",function(){view.setValues(this)});view._settings.uploader=this._settings.id},this);return value},addFile:function(name,size,type,extra){var file=null;if(typeof name=="object"){file=name;name=file.name;size=file.size}var format=this._format_size(size);type=type||name.split(".").pop();var file_struct={file:file,name:name,id:webix.uid(),size:size,sizetext:format,type:type,context:this._last_file_context,status:"client"};if(this._settings.directory&&file.webkitRelativePath)file_struct.name=file.webkitRelativePath;if(extra)webix.extend(file_struct,extra,true);if(this.callEvent("onBeforeFileAdd",[file_struct])){if(!this._settings.multiple)this.files.clearAll();var id=this.files.add(file_struct);this.callEvent("onAfterFileAdd",[file_struct]);if(id&&this._settings.autosend)this.send(id)}return file_struct},_get_active_url:function(item){var url=this._settings.upload;var urldata=webix.extend(item.urlData||{},this._settings.urlData||{});if(url&&urldata){var subline=[];for(var key in urldata)subline.push(encodeURIComponent(key)+"="+encodeURIComponent(urldata[key]));if(subline.length)url+=(url.indexOf("?")==-1?"?":"&")+subline.join("&")}return url},addDropZone:function(id,hover_text){var node=webix.toNode(id);var extra_css="";if(hover_text)extra_css=" "+webix.html.createCss({content:'"'+hover_text+'"'},":before");var fullcss="webix_drop_file"+extra_css;var timer=null;webix._event(node,"dragover",webix.html.preventEvent);webix._event(node,"dragover",function(e){webix.html.addCss(node,fullcss,true);if(timer){clearTimeout(timer);timer=null}});webix._event(node,"dragleave",function(e){timer=setTimeout(function(){webix.html.removeCss(node,fullcss)},150)});webix._event(node,"drop",webix.bind(function(e){webix.html.removeCss(node,fullcss);this._drop(e);return webix.html.preventEvent(e)},this))},_format_size:function(size){var index=0;while(size>1024){index++;size=size/1024}return Math.round(size*100)/100+" "+webix.i18n.fileSize[index]},_complete:function(id,response){if(response.status!="error"){var item=this.files.getItem(id);item.status="server";item.progress=100;webix.extend(item,response,true);this.callEvent("onFileUpload",[item,response]);this.callEvent("onChange",[]);this.files.updateItem(id)}if(this.isUploaded())this._upload_complete(response)},_upload_complete:function(response){this.callEvent("onUploadComplete",[response]);if(this._last_assigned_upload_callback){this._last_assigned_upload_callback.call(this,response);this._last_assigned_upload_callback=0}},isUploaded:function(){var order=this.files.data.order;for(var i=0;i<order.length;i++)if(this.files.getItem(order[i]).status!="server")return false;return true},$onUploadComplete:function(){},$updateProgress:function(id,percent){var item=this.files.getItem(id);item.percent=Math.round(percent);this.files.updateItem(id)},setValue:function(value){if(typeof value=="string"&&value)value={value:value,status:"server"};this.files.clearAll();if(value)this.files.parse(value);this.callEvent("onChange",[])},getValue:function(){var data=[];this.files.data.each(function(obj){if(obj.status=="server")data.push(obj.value||obj.name)});return data.join(",")}},webix.ui.button);webix.html.addMeta=function(name,value){document.getElementsByTagName("head").item(0).appendChild(webix.html.create("meta",{name:name,content:value}))};(function(){var orientation=function(){var new_orientation=!!(window.orientation%180);if(webix.ui.orientation===new_orientation)return;webix.ui.orientation=new_orientation;webix.callEvent("onRotate",[new_orientation])};if(webix.env.touch){webix.ui.orientation=!!((webix.isUndefined(window.orientation)?90:window.orientation)%180);webix.event(window,"onorientationchange"in window?"orientationchange":"resize",orientation)}if(webix.env.isFF&&window.matchMedia){window.matchMedia("(orientation: portrait)").addListener(function(){webix.ui.orientation=false});window.matchMedia("(orientation: landscape)").addListener(function(){webix.ui.orientation=true})}webix.ui.fullScreen=function(){if(!webix.env.touch)return;webix.html.addMeta("apple-mobile-web-app-capable","yes");webix.html.addMeta("viewport","initial-scale=1, maximum-scale=1, user-scalable=no");var size=document.body.offsetHeight||document.body.scrollHeight;var iphone=navigator.userAgent.indexOf("iPhone")!=-1;var ipad=navigator.userAgent.indexOf("iPad")!=-1;var version=navigator.userAgent.match(/iPhone OS (\d+)/);var iOS7=version&&version[1]>=7;var iphone_safari=iphone&&(size==356||size==208||size==306||size==158||size==444);var iphone5=window.screen.height==568;var fix=function(){var x=0;var y=0;if(iphone&&!iOS7){if(!webix.ui.orientation){x=320;y=iphone5?iphone_safari?504:548:iphone_safari?416:460}else{x=iphone5?568:480;y=iphone_safari?268:300}}else if(webix.env.isAndroid){if(!webix.env.isFF){document.body.style.width=document.body.style.height="1px";document.body.style.overflow="hidden";var dmod=window.outerWidth/window.innerWidth;x=window.outerWidth/dmod;y=window.outerHeight/dmod}}else if(!webix.env.isIEMobile){x=window.innerWidth;y=window.innerHeight}if(y){document.body.style.height=y+"px";document.body.style.width=x+"px"}webix.ui.$freeze=false;webix.ui.resize()};var onrotate=function(){webix.ui.$freeze=true;if(webix.env.isSafari)fix();else webix.delay(fix,null,[],500)};webix.attachEvent("onRotate",onrotate);orientation();webix.delay(onrotate)}})();webix.history={track:function(id,url){this._init_state(id,url);if(this._aHandler)webix.$$(this._aViewId).detachEvent(this._aHandler);if(id){this._aViewId=id;var view=webix.$$(id);var handler=function(){if(webix.history._ignored)return;if(view.getValue)webix.history.push(id,view.getValue())};if(view.getActiveId)this._aHandler=view.attachEvent("onViewChange",handler);else this._aHandler=view.attachEvent("onChange",handler)}},_set_state:function(view,state){webix.history._ignored=1;view=webix.$$(view);if(view.callEvent("onBeforeHistoryNav",[state]))if(view.setValue)view.setValue(state);webix.history._ignored=0},push:function(view,url,value){view=webix.$$(view);var new_url="";if(url)new_url="#!/"+url;if(webix.isUndefined(value)){if(view.getValue)value=view.getValue();else value=url}window.history.pushState({webix:true,id:view._settings.id,value:value},"",new_url)},_init_state:function(view,url){webix.event(window,"popstate",function(ev){if(ev.state&&ev.state.webix){webix.history._set_state(ev.state.id,ev.state.value)}});var state=window.location.hash;webix.noanimate=true;if(state&&state.indexOf("#!/")===0)webix.history._set_state(view,state.replace("#!/",""));else if(url){webix.history.push(view,url);webix.history._set_state(view,url)}webix.noanimate=false;this._init_state=function(){}}};webix.protoUI({name:"slider",$touchCapture:true,defaults:{min:0,max:100,value:50,step:1,title:false,template:function(obj,common){var id=common._handle_id="x"+webix.uid();var html="<div class='webix_slider_title'></div><div class='webix_slider_box'><div class='webix_slider_left'>&nbsp;</div><div class='webix_slider_right'></div><div class='webix_slider_handle' role='slider' aria-label='"+obj.label+(obj.title?" "+obj.title(obj):"")+"' aria-valuemax='"+obj.max+"' aria-valuemin='"+obj.min+"' aria-valuenow='"+obj.value+"' tabindex='0' id='"+id+"'>&nbsp;</div></div>";return common.$renderInput(obj,html,id)}},type_setter:function(type){this._viewobj.className+=" webix_slider_"+type},title_setter:function(value){if(typeof value=="string")return webix.template(value);return value},_get_slider_handle:function(){return this.$view.querySelector(".webix_slider_handle")},_set_inner_size:function(){var handle=this._get_slider_handle();var config=this._settings;if(handle){var width=this._get_input_width(config);var value=config.value%config.step?Math.round(config.value/config.step)*config.step:config.value;value=Math.max(Math.min(value,config.max),config.min);var max=config.max-config.min;var left=Math.ceil((width-2*this._sliderPadding)*(value-config.min)/max);var right=width-2*this._sliderPadding-left;handle.style.left=this._sliderPadding+left-this._sliderHandleWidth/2+"px";handle.parentNode.style.width=width+"px";right=Math.min(Math.max(right,2*this._sliderBorder),width-this._sliderPadding*2-2*this._sliderBorder);left=Math.min(Math.max(left,2*this._sliderBorder),width-this._sliderPadding*2-2*this._sliderBorder);var part=handle.previousSibling;part.style.width=right+"px";var last=part.previousSibling;last.style.width=left+"px";if(this._settings.title){handle.parentNode.previousSibling.innerHTML=this._settings.title(this._settings,this)}}},_set_value_now:function(){this._get_slider_handle().setAttribute("aria-valuenow",this._settings.value)},refresh:function(){var handle=this._get_slider_handle();if(handle){this._set_value_now();if(this._settings.title)handle.setAttribute("aria-label",this._settings.label+" "+this._settings.title(this._settings,this));this._set_inner_size()}},$setValue:function(){this.refresh()},$getValue:function(){return this._settings.value},$init:function(){if(webix.env.touch)this.attachEvent("onTouchStart",webix.bind(this._on_mouse_down_start,this));else webix._event(this._viewobj,"mousedown",webix.bind(this._on_mouse_down_start,this));webix._event(this.$view,"keydown",webix.bind(this._handle_move_keyboard,this))},$skin:function(){this._sliderHandleWidth=webix.skin.$active.sliderHandleWidth;this._sliderPadding=webix.skin.$active.sliderPadding;this._sliderBorder=webix.skin.$active.sliderBorder},_handle_move_keyboard:function(e){var code=e.keyCode,c=this._settings,value=c.value;if(code>32&&code<41){webix.html.preventEvent(e);var trg=e.target||e.srcElement;var match=/webix_slider_handle_(\d)/.exec(trg.className);this._activeIndex=match?parseInt(match[1],10):-1;if(match)value=c.value[this._activeIndex];value=value<c.min?c.min:value>c.max?c.max:value;if(code===35)value=c.min;else if(code===36)value=c.max;else{var inc=code===37||code===40||code===34?-1:1;if(code===33||code===34||c.step>1)inc=inc*c.step;value=value*1+inc}if(value>=c.min&&value<=c.max){if(match){var temp=[];for(var i=0;i<c.value.length;i++)temp[i]=i===this._activeIndex?value:c.value[i];value=temp}this.setValue(value);this._activeIndex=-1}}},_on_mouse_down_start:function(e){var trg=e.target||e.srcElement;if(this._mouse_down_process){this._mouse_down_process(e)}var value=this._settings.value;if(webix.isArray(value))value=webix.copy(value);if(trg.className.indexOf("webix_slider_handle")!=-1){this._start_value=value;return this._start_handle_dnd.apply(this,arguments)}else if(trg.className.indexOf("webix_slider")!=-1){this._start_value=value;this._settings.value=this._get_value_from_event.apply(this,arguments);this._start_handle_dnd(e)}},_start_handle_dnd:function(e){if(webix.env.touch){this._handle_drag_events=[this.attachEvent("onTouchMove",webix.bind(this._handle_move_process,this)),this.attachEvent("onTouchEnd",webix.bind(this._handle_move_stop,this))]}else this._handle_drag_events=[webix.event(document.body,"mousemove",webix.bind(this._handle_move_process,this)),webix.event(window,"mouseup",webix.bind(this._handle_move_stop,this))];webix.html.addCss(document.body,"webix_noselect")},_handle_move_stop:function(e){if(this._handle_drag_events){if(webix.env.touch){webix.detachEvent(this._handle_drag_events[0]);webix.detachEvent(this._handle_drag_events[1])}else{webix.eventRemove(this._handle_drag_events[0]);webix.eventRemove(this._handle_drag_events[1])}this._handle_drag_events=[]}webix.html.removeCss(document.body,"webix_noselect");var value=this._settings.value;if(webix.isArray(value))value=webix.copy(value);this._settings.value=this._start_value;this.setValue(value);this._get_slider_handle(this._activeIndex).focus();this._activeIndex=-1},_handle_move_process:function(e){this._settings.value=this._get_value_from_event.apply(this,arguments);this.refresh();this.callEvent("onSliderDrag",[])},_get_value_from_event:function(event,touchContext){var pos=0;if(webix.env.touch){pos=touchContext?touchContext.x:event.x}else pos=webix.html.pos(event).x;return this._get_value_from_pos(pos)},_get_value_from_pos:function(pos){var config=this._settings;var max=config.max-config.min;var left=webix.html.offset(this._get_slider_handle().parentNode).x+this._sliderPadding;var width=this._get_input_width(config)-2*this._sliderPadding;var newvalue=width?(pos-left)*max/width:0;newvalue=Math.round((newvalue+config.min)/config.step)*config.step;return Math.max(Math.min(newvalue,config.max),config.min)},_init_onchange:function(){}},webix.ui.text);webix.protoUI({name:"rangeslider",$cssName:"slider webix_rangeslider",defaults:{separator:",",value:"20,80",template:function(obj,common){var id="x"+webix.uid();common._handle_id=[id+"_0",id+"_1"];var aria="role='slider' aria-label='"+obj.label+(obj.title?" "+obj.title(obj):"")+"' aria-valuemax='"+obj.max+"' aria-valuemin='"+obj.min+"' tabindex='0'";var handles="<div class='webix_slider_handle webix_slider_handle_0' id='"+common._handle_id[0]+"' "+aria+" aria-valuenow='"+obj.value[0]+"'>&nbsp;</div>";handles+="<div class='webix_slider_handle webix_slider_handle_1' id='"+common._handle_id[1]+"' "+aria+" aria-valuenow='"+obj.value[1]+"'>&nbsp;</div>";var html="<div class='webix_slider_title'></div><div class='webix_slider_box'><div class='webix_slider_right'>&nbsp;</div><div class='webix_slider_left'></div>"+handles+"</div>";return common.$renderInput(obj,html,id)}},value_setter:function(value){if(!webix.isArray(value)){value=value.toString().split(this._settings.separator)}if(value.length<2)value[1]=value[0];value[0]=parseFloat(value[0]);value[1]=parseFloat(value[1]);return value},_get_slider_handle:function(index){index=index&&index>=0?index:0;return this.$view.querySelector(".webix_slider_handle_"+(index||0))},_get_left_pos:function(width,index){var config,max,value;config=this._settings;max=config.max-config.min;value=config.value[index]%config.step?Math.round(config.value[index]/config.step)*config.step:config.value[index];value=Math.max(Math.min(value,config.max),config.min);return Math.ceil((width-20)*(value-config.min)/max)},_set_inner_size:function(){var config,handle0,handle1,left0,left1,parentBox,width;handle0=this._get_slider_handle(0);handle1=this._get_slider_handle(1);config=this._settings;if(!webix.isArray(config.value)){this.define("value",config.value)}if(handle0){width=this._get_input_width(config);parentBox=handle0.parentNode;parentBox.style.width=width+"px";left0=this._get_left_pos(width,0);left1=this._get_left_pos(width,1);handle0.style.left=10+left0-8+"px";handle1.style.left=10+left1-8+"px";parentBox.firstChild.style.width=width-22+"px";parentBox.childNodes[1].style.width=left1-left0+"px";parentBox.childNodes[1].style.left=left0+12+"px";if(this._settings.title){handle0.parentNode.previousSibling.innerHTML=this._settings.title(this._settings,this)}}},_set_value_now:function(){for(var i=0;i<2;i++){this._get_slider_handle(i).setAttribute("aria-valuenow",this._settings.value[i])}},_mouse_down_process:function(e){var trg=e.target||e.srcElement;var match=/webix_slider_handle_(\d)/.exec(trg.className);this._activeIndex=match?parseInt(match[1],10):-1;if(match)this._set_handle_active(this._activeIndex)},setValue:function(value){var oldvalue=this._settings.value;var temp=typeof value=="object"?value.join(this._settings.separator):value;if(oldvalue.join(this._settings.separator)==temp)return false;this._settings.value=value;if(this._rendered_input)this.$setValue(value);this.callEvent("onChange",[value,oldvalue])},$getValue:function(){var value=this._settings.value;return this._settings.stringResult?value.join(this._settings.separator):value},_set_handle_active:function(index){var hActive=this._get_slider_handle(index);var h=this._get_slider_handle(1-index);if(hActive.className.indexOf("webix_slider_active")==-1)hActive.className+=" webix_slider_active";h.className=h.className.replace(" webix_slider_active","")},_get_value_from_pos:function(pos){var config=this._settings;var value=config.value;var max=config.max-config.min;var left=webix.html.offset(this._get_slider_handle().parentNode).x;var newvalue=Math.ceil((pos-left)*max/this._get_input_width(config));newvalue=Math.round((newvalue+config.min)/config.step)*config.step;var index=null;var pos0=webix.html.offset(this._get_slider_handle(0)).x;var pos1=webix.html.offset(this._get_slider_handle(1)).x;if(pos0==pos1&&(config.value[0]==config.min||config.value[0]==config.max)){index=config.value[0]==config.min?1:0;this._set_handle_active(index)}else{if(this._activeIndex>=0){index=this._activeIndex}else{if(pos0==pos1){index=pos<pos0?0:1}else{var dist0=Math.abs(pos0-pos);var dist1=Math.abs(pos1-pos);index=dist0<dist1?0:1;this._activeIndex=index}}}if(index){value[index]=Math.max(Math.min(newvalue,config.max),value[0])}else{value[index]=Math.max(Math.min(newvalue,value[1]),config.min)}return value}},webix.ui.slider);webix.proxy.offline={$proxy:true,storage:webix.storage.local,cache:false,data:"",_is_offline:function(){if(!this.cache&&!webix.env.offline){webix.callEvent("onOfflineMode",[]);webix.env.offline=true}},_is_online:function(){if(!this.cache&&webix.env.offline){webix.env.offline=false;webix.callEvent("onOnlineMode",[])}},load:function(view,callback){var mycallback={error:function(){var text=this.getCache()||this.data;var loader={responseText:text};var data=webix.ajax.prototype._data(loader);this._is_offline();webix.ajax.$callback(view,callback,text,data,loader)},success:function(text,data,loader){this._is_online();webix.ajax.$callback(view,callback,text,data,loader);this.setCache(text)}};if(this.cache&&this.getCache())mycallback.error.call(this);else{if(this.source.$proxy)this.source.load(this,mycallback);else webix.ajax(this.source,mycallback,this)}},getCache:function(){return this.storage.get(this._data_name())},clearCache:function(){this.storage.remove(this._data_name())},setCache:function(text){this.storage.put(this._data_name(),text)},_data_name:function(){if(this.source.$proxy)return this.source.source+"_$proxy$_data";else return this.source+"_$proxy$_data"},saveAll:function(view,update,dp,callback){this.setCache(view.serialize());webix.ajax.$callback(view,callback,"",update)},result:function(id,master,dp,text,data){for(var i=0;i<data.length;i++)dp.processResult({id:data[i].id,status:data[i].operation},{},{})}};webix.proxy.cache={init:function(){webix.extend(this,webix.proxy.offline)},cache:true};webix.proxy.local={init:function(){webix.extend(this,webix.proxy.offline)},cache:true,data:[]};webix.ActiveContent={$init:function(config){if(config.activeContent){this.$ready.push(this._init_active_content_list);this._active_holders={};this._active_holders_item={};this._active_holders_values={};this._active_references={};for(var key in config.activeContent){this[key]=this._bind_active_content(key);if(config.activeContent[key].earlyInit){var temp=webix._parent_cell;webix._parent_cell=null;this[key].call(this,{},this,config.activeContent);webix._parent_cell=temp}}}},_destructActiveContent:function(){for(var key in this._active_references){var elem=this._active_references[key];if(elem.destructor)elem.destructor()}},_init_active_content_list:function(){this.attachEvent("onDestruct",webix.bind(this._destructActiveContent,this));webix._event(this.$view,"blur",function(ev){var target=ev.target||ev.srcElement;if(target.tagName!="BUTTON"){var el=webix.$$(ev);if(el&&el!==this&&el.getValue&&el.setValue){el.getNode(ev);var newvalue=el.getValue();if(newvalue!=el._settings.value)el.setValue(newvalue)}}},{bind:this,capture:true});if(this.filter){for(var key in this._settings.activeContent){this.type[key]=this[key];this[key]=this._locate_active_content_by_id(key)}this.attachEvent("onBeforeRender",function(){this.type.masterUI=this});this.type.masterUI=this}},_locate_active_content_by_id:function(key){return function(id){var button=this._active_references[key];var button_id=button._settings.id;var html=this.getItemNode(id).getElementsByTagName("DIV");for(var i=0;i<html.length;i++){if(html[i].getAttribute("view_id")==button_id){button._viewobj=button._dataobj=html[i];break}}return button}},_get_active_node:function(el,key,master){return function(e){if(e){var trg=e.target||e.srcElement;while(trg){if(trg.getAttribute&&trg.getAttribute("view_id")){master._setActiveContentView(el,trg);if(master.locate){var id=master.locate(trg.parentNode);var value=master._active_holders_values[key][id];el._settings.value=value;el._settings.$masterId=id}return trg}trg=trg.parentNode}}return el._viewobj}},_set_new_active_value:function(key,master){return function(value){var data=master.data;if(master.filter){var id=master.locate(this._viewobj.parentNode);data=master.getItem(id);this.refresh();master._active_holders_item[key][id]=this._viewobj.outerHTML||(new XMLSerializer).serializeToString(this._viewobj);master._active_holders_values[key][id]=value}if(data)data[key]=value}},_bind_active_content:function(key){return function(obj,common,active){var object=common._active_holders?common:common.masterUI;if(!object._active_holders[key]){var d=document.createElement("DIV");active=active||object._settings.activeContent;var el=webix.ui(active[key],d);d.firstChild.setAttribute("onclick","event.processed = true; if (webix.env.isIE8) event.srcElement.w_view = '"+el._settings.id+"';");el.getNode=object._get_active_node(el,key,object);el.attachEvent("onChange",object._set_new_active_value(key,object));object._active_references[key]=el;object._active_holders[key]=d.innerHTML;object._active_holders_item[key]={};object._active_holders_values[key]={};el.$activeEl=el.$view}if(object.filter&&obj[key]!=object._active_holders_values[key]&&!webix.isUndefined(obj[key])){var el=object._active_references[key];el.blockEvent();object._setActiveContentView(el,el.$activeEl);if(!el.$view.firstChild)el.refresh();el.setValue(obj[key]);el.refresh();el.unblockEvent();object._active_holders_values[key][obj.id]=obj[key];object._active_holders_item[key][obj.id]=el._viewobj.outerHTML||(new XMLSerializer).serializeToString(el._viewobj)}return object._active_holders_item[key][obj.id]||object._active_holders[key]}},_setActiveContentView:function(el,view){el._dataobj=el._viewobj=el.$view=view}};webix.ProgressBar={$init:function(){if(webix.isUndefined(this._progress)&&this.attachEvent){this.attachEvent("onBeforeLoad",this.showProgress);this.attachEvent("onAfterLoad",this.hideProgress);this._progress=null}},showProgress:function(config){if(!this._progress){config=webix.extend({position:0,delay:2e3,type:"icon",icon:"refresh",hide:false},config||{},true);var incss=config.type=="icon"?"fa-"+config.icon+" fa-spin":"";this._progress=webix.html.create("DIV",{class:"webix_progress_"+config.type,role:"progressbar","aria-valuemin":"0","aria-valuemax":"100",tabindex:"0"},"<div class='webix_progress_state "+incss+"'></div>");if(!this.setPosition)this._viewobj.style.position="relative";webix.html.insertBefore(this._progress,this._viewobj.firstChild,this._viewobj);this._viewobj.setAttribute("aria-busy","true");if(!webix.Touch.$active){if(this.getScrollState){var scroll=this.getScrollState();if(this._viewobj.scrollWidth!=this.$width){this._progress.style.left=scroll.x+"px"}if(this._viewobj.scrollHeight!=this.$height){if(config.type!="bottom"){this._progress.style.top=scroll.y+"px"}else{this._progress.style.top=scroll.y+this.$height-this._progress.offsetHeight+"px"}}}}this._progress_delay=1}if(config&&config.type!="icon")webix.delay(function(){if(this._progress){var position=config.position||1;if(this._progress.style[webix.env.transitionDuration]!==webix.undefined||!config.delay){this._progress.firstChild.style.width=position*100+"%";if(config.delay)this._progress.firstChild.style[webix.env.transitionDuration]=config.delay+"ms"}else{var count=0,start=0,step=position/config.delay*30,view=this;if(this._progressTimer){window.clearInterval(this._progressTimer);start=this._progress.firstChild.offsetWidth/this._progress.offsetWidth*100}this._progressTimer=window.setInterval(function(){if(count*30==config.delay){window.clearInterval(view._progressTimer)}else{if(view._progress&&view._progress.firstChild)view._progress.firstChild.style.width=start+count*step*position*100+"%";count++}},30)}if(config.hide)webix.delay(this.hideProgress,this,[1],config.delay)}this._progress_delay=0},this);else if(config&&config.type=="icon"&&config.hide)webix.delay(this.hideProgress,this,[1],config.delay)},hideProgress:function(now){if(this._progress_delay)now=true;if(this._progress){if(now){if(this._progressTimer)window.clearInterval(this._progressTimer);webix.html.remove(this._progress);this._progress=null;this._viewobj.removeAttribute("aria-busy")}else{this.showProgress({position:1.1,delay:300,hide:true})}}}};webix.protoUI({name:"multitext",$cssName:"text",defaults:{icon:"plus-circle",iconWidth:25,separator:", "},getValueHere:function(){return webix.ui.text.prototype.getValue.call(this)},setValueHere:function(value){return webix.ui.text.prototype.$setValue.call(this,value)},getValue:function(){if(this.config.mode=="extra")return this.getValueHere();var values=[this.getValueHere(this)];for(var i=0;i<this._subs.length;i++){var seg=webix.$$(this._subs[i]).getValueHere();if(seg)values.push(seg)}return values.join(this.config.separator)},$setValue:function(value){value=value||"";if(this._known_value==value)return;this._known_value=value;if(this.config.mode=="extra")return this.setValueHere(value);this.removeSection();var parts=value.split(this.config.separator);this.setValueHere.call(this,parts[0]);for(var i=1;i<parts.length;i++){var next=this.addSection();webix.$$(next).setValueHere(parts[i])}},_subOnChange:function(call){var parent=this.config.master?webix.$$(this.config.master):this;var newvalue=parent.getValue();var oldvalue=parent._settings.value;if(newvalue!==oldvalue){parent._settings.value=newvalue;parent.callEvent("onChange",[newvalue,oldvalue])}},addSection:function(){var config=this.config,newConfig={labelWidth:config.labelWidth,inputWidth:config.inputWidth,width:config.width,label:config.label?"&nbsp;":"",view:this.name,mode:"extra",value:"",icon:"minus-circle",suggest:config.suggest||null,master:config.id};webix.extend(newConfig,config.subConfig||{},true);var newone=this.getParentView().addView(newConfig);webix.$$(newone).attachEvent("onChange",this._subOnChange);this._subs.push(newone);return newone},removeSection:function(id){var parent=this.config.master?webix.$$(this.config.master):this;for(var i=parent._subs.length-1;i>=0;i--){var section=parent._subs[i];if(!id||section==id){parent._subs.removeAt(i);this.getParentView().removeView(section)}}},on_click:{webix_input_icon:function(ev,id,html){if(this.config.mode=="extra"){this.removeSection(this.config.id);var childs=this.getParentView().getChildViews();childs[childs.length-1].focus();this._subOnChange()}else webix.$$(this.addSection()).focus();return false}},$init:function(){this._subs=webix.toArray([]);this.attachEvent("onKeyPress",this._onKeyPress)},$render:function(obj){this.$setValue(obj.value)}},webix.ui.text);webix.protoUI({name:"organogram",defaults:{scroll:"auto",ariaLabel:"lines"},$init:function(){this._viewobj.className+=" webix_organogram";this._html=document.createElement("DIV");this.$ready.push(this._afterInit);webix.extend(this.data,webix.TreeStore,true);this.data.provideApi(this,true)},_id:"webix_dg_id",on_click:{webix_organogram_item:function(e,id){if(this._settings.select){if(this._settings.select=="multiselect"||this._settings.multiselect)this.select(id,false,e.ctrlKey||e.metaKey||this._settings.multiselect=="touch",e.shiftKey);else this.select(id);this._no_animation=false}}},on_context:{},on_dblclick:{},_afterInit:function(){this._dataobj.style.position="relative";this.data.attachEvent("onStoreUpdated",webix.bind(this.render,this))},_toHTMLItem:function(obj){var mark=this.data._marks[obj.id];this.callEvent("onItemRender",[obj]);return this.type.templateStart.call(this,obj,this.type,mark)+(obj.$template?this.type["template"+obj.$template].call(this,obj,this.type,mark):this.type.template.call(this,obj,this.type,mark))+this.type.templateEnd.call(this)},_toHTML:function(obj){var html=this._toHTMLItem(obj);if(this.data.branch[obj.id])html+=this._renderBranch(obj.id);return html},_isListBlocks:function(){return this.type.listMarginX||this.type.listMarginY},_renderBranch:function(pId){var elem,i,id,html="",leaves=this.data.branch[pId],marks=this.data._marks[pId],pItem=this.getItem(pId),sizes,totalWidth,type=pItem?pItem.$type:false;if(!pId){this._colHeight=[];this.$xy={};totalWidth=this.$width-this.type.padding*2;this.$xy[0]={totalWidth:totalWidth,start:this.type.padding,width:0,height:0,left:totalWidth/2,top:this.type.padding||0}}if(leaves){sizes=this.$xy[pId];if(type=="list"&&!this._isListBlocks()){html+=this.type.templateListStart.call(this,pItem,this.type,marks)}var sumTotalWidth=0;for(i=0;i<leaves.length;i++){id=leaves[i];totalWidth=this._tw[id];var obj=this.getItem(id);if(obj.open==webix.undefined)obj.open=true;if(type=="list")this.data.addMark(id,"list_item","",1,true);var height=this._getItemHeight(id);if(type=="list"){var leftOffset=type=="list"&&this._isListBlocks()?this.type.listMarginX:0;var itemMargin=0;if(this._isListBlocks())itemMargin=this.type.listMarginY;else if(!i)itemMargin=this.type.marginY;this.$xy[id]={totalWidth:totalWidth,start:sizes.start,width:this.type.width,height:height,left:sizes.start+totalWidth/2-this.type.width/2+leftOffset,top:i?this.$xy[leaves[i-1]].top+this.$xy[leaves[i-1]].height+itemMargin:sizes.top+sizes.height+itemMargin}}else{this.$xy[id]={totalWidth:totalWidth,start:sizes.start+sumTotalWidth,width:this.type.width,height:height,left:sizes.start+sumTotalWidth+totalWidth/2-this.type.width/2,top:sizes.top+sizes.height+(pId?this.type.marginY:0)}}html+=this._toHTMLItem(obj);sumTotalWidth+=totalWidth}if(!pId&&sumTotalWidth){this._dataobj.style.width=sumTotalWidth+this.type.padding*2+"px"}for(i=0;i<leaves.length;i++){id=leaves[i];if(this.data.branch[id]&&this.getItem(id).open)html+=this._renderBranch(id);else if(pItem){if(pItem.$type!="list")this._colHeight.push(this.$xy[id].top+this.$xy[id].height);else if(i==leaves.length-1){this._colHeight.push(this.$xy[id].top+this.$xy[id].height)}}}if(type=="list"&&!this._isListBlocks())html+=this.type.templateListEnd(pItem,this.type,marks)}return html},_getItemHeight:function(id){var item=this.getItem(id);var height=this.type.height;if(typeof height=="function"){height=height.call(item,this.type,this.data._marks[id])}if(!this._hDiv){this._hDiv=webix.html.create("div");this._dataobj.appendChild(this._hDiv)}this._hDiv.className=this.type.classname(item,this.type,this.data._marks[id]);this._hDiv.style.cssText="width:"+this.type.width+"px;height:"+height+(height=="auto"?"":"px")+";";this._hDiv.innerHTML=this.type.template.call(this,item,this.type,this.data._marks[id]);return this._hDiv.scrollHeight},_calcTotalWidth:function(){var tw={};var width=this.type.width;var margin=this.type.marginX;this.data.each(function(obj){tw[obj.id]=width+margin;var parentId=this.getParentId(obj.id);if(parentId&&this.getItem(parentId).$type!="list")while(parentId){var leaves=this.branch[parentId];tw[parentId]=0;for(var i=0;i<leaves.length;i++){tw[parentId]+=tw[leaves[i]]||0}parentId=this.getParentId(parentId)}});this._tw=tw;return tw},getItemNode:function(searchId){if(this._htmlmap)return this._htmlmap[searchId];this._htmlmap={};var t=this._dataobj.childNodes;for(var i=0;i<t.length;i++){var id=t[i].getAttribute(this._id);if(id)this._htmlmap[id]=t[i];if(t[i].className.indexOf("webix_organogram_list")!=-1&&!this._isListBlocks()){var listNodes=t[i].childNodes;for(var j=0;j<listNodes.length;j++){id=listNodes[j].getAttribute(this._id);if(id)this._htmlmap[id]=listNodes[j]}}}return this.getItemNode(searchId)},_toHTMLObject:function(obj){this._html.innerHTML=this._toHTMLItem(obj);return this._html.firstChild},render:function(id,data,type){if(!this.isVisible(this._settings.id)||this.$blockRender)return;if(webix.debug_render)webix.log("Render: "+this.name+"@"+this._settings.id);if(type=="update"){var cont=this.getItemNode(id);var t=this._htmlmap[id]=this._toHTMLObject(data);webix.html.insertBefore(t,cont);webix.html.remove(cont);return true}else{if(this.callEvent("onBeforeRender",[this.data])){this._calcTotalWidth();this._htmlmap=null;this._dataobj.innerHTML=this._renderBranch(0);this._hDiv=null;this._dataobj.style.height=Math.max.apply(Math,this._colHeight)+this.type.padding+"px";this._renderCanvas();this.resize();this.callEvent("onAfterRender",[])}}return true},_renderCanvas:function(){if(this.canvas)this.canvas.clearCanvas(true);this.canvas=new webix.Canvas({container:this._dataobj,name:this._settings.ariaLabel,width:this._dataobj.offsetWidth,height:this._dataobj.offsetHeight});this._drawLines(0)},_drawLine:function(ctx,x1,y1,x2,y2,color,width){ctx.strokeStyle=color;ctx.lineCap="square";ctx.lineWidth=width;ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke();ctx.lineWidth=1},_drawLines:function(id,ctx){var i,item,leaves,p,s,x12,y1,y2,start,end;var layout=this.config.layout;if(!ctx)ctx=this.canvas.getCanvas();if(!this.$xy){return}id=id||0;leaves=this.data.branch[id];item=this.getItem(id);if(leaves&&leaves.length){p=this.$xy[id];if(id){x12=parseInt(p.left+p.width/2,10)+.5;y1=parseInt(p.top+p.height,10);y2=parseInt(p.top+p.height+this.type.marginY/2,10);if(item.$type=="list"){if(!this._isListBlocks()){y2=parseInt(p.top+p.height+this.type.marginY,10);this._drawLine(ctx,x12,y1,x12,y2,this.type.lineColor);return}}else this._drawLine(ctx,x12,y1,x12,y2,this.type.lineColor)}y1=parseInt(p.top+p.height+this.type.marginY/2,10)+.5;for(i=0;i<leaves.length;i++){if(id){s=this.$xy[leaves[i]];if(item.$type=="list"&&this._isListBlocks()){x12=parseInt(p.left+this.type.listMarginX/2,10)+.5;if(!i)start=x12;else if(i==leaves.length-1)end=x12;y2=parseInt(s.top+s.height/2,10);this._drawLine(ctx,x12,y1-this.type.marginY/2,x12,y2,this.type.lineColor);this._drawLine(ctx,x12,y2,x12+this.type.listMarginX/2,y2,this.type.lineColor)}else{x12=parseInt(s.left+s.width/2,10)+.5;if(!i)start=x12;else if(i==leaves.length-1)end=x12;y2=parseInt(s.top,10);this._drawLine(ctx,x12,y1,x12,y2,this.type.lineColor)}}if(this.getItem(leaves[i]).open)this._drawLines(leaves[i],ctx)}if(id)this._drawLine(ctx,start,y1,end,y1,this.type.lineColor)}},$getSize:function(dx,dy){var aW=this._settings.autowidth;var aH=this._settings.autoheight;if(aW){dx=this._dataobj.offsetWidth+(this._dataobj.offsetHeight>dy&&!aH?webix.ui.scrollSize:0)}if(aH){dy=this._dataobj.offsetHeight+(this._dataobj.offsetWidth>dx&&!aW?webix.ui.scrollSize:0)}return webix.ui.view.prototype.$getSize.call(this,dx,dy)},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)){this._dataobj.style.width=this.$width+"px";this._dataobj.style.height=this.$height+"px";this.render()}},type:{width:120,height:"auto",padding:20,marginX:20,marginY:20,listMarginX:0,listMarginY:0,lineColor:"#90caf9",classname:function(obj,common,marks){var css="webix_organogram_item ";if(obj.$css){if(typeof obj.$css=="object")obj.$css=webix.html.createCss(obj.$css);css+=" "+obj.$css}if(marks&&marks.list_item)css+=" webix_organogram_list_item ";if(marks&&marks.$css)css+=marks.$css;css+=" webix_organogram_level_"+obj.$level;return css},listClassName:function(obj){var css="webix_organogram_list webix_organogram_list_"+obj.$level;if(obj.$listCss){if(typeof obj.$listCss=="object")obj.$listCss=webix.html.createCss(obj.$listCss);css+=" "+obj.$listCss}return css},template:webix.template("#value#"),templateStart:function(obj,type,marks){var style="";if((!(marks&&marks.list_item)||type.listMarginX||type.listMarginY)&&this.$xy){var xy=this.$xy[obj.id];style+="width: "+xy.width+"px; height: "+xy.height+"px;";style+="top: "+xy.top+"px; left: "+xy.left+"px;"}return'<div webix_dg_id="'+obj.id+'" class="'+type.classname.call(this,obj,type,marks)+'"'+(style?'style="'+style+'"':"")+'">'},templateEnd:webix.template("</div>"),templateListStart:function(obj,type,marks){var style="";if(this.$xy){var xy=this.$xy[obj.id];style+="width: "+xy.width+"px;";style+="top: "+(xy.top+xy.height+type.marginY)+"px; left: "+xy.left+"px;"}return'<div class="'+type.listClassName.call(this,obj,type,marks)+'"'+(style?'style="'+style+'"':"")+'">'},templateListEnd:webix.template("</div>")}},webix.AutoTooltip,webix.Group,webix.TreeAPI,webix.DataMarks,webix.SelectionModel,webix.MouseEvents,webix.Scrollable,webix.RenderStack,webix.TreeDataLoader,webix.DataLoader,webix.ui.view,webix.EventSystem);webix.protoUI({name:"barcode",defaults:{type:"ean13",height:160,width:220,paddingY:10,paddingX:20,textHeight:20,color:"#000",ariaLabel:"bars"},$init:function(){this.$view.className+=" webix_barcode";if(!this.types){this.types={default:this.type};this.type.name="default"}},type:{},render:function(){if(this.isVisible(this._settings.id)){if(this.canvas)this.canvas.clearCanvas(true);this.$view.innerHTML="";this._renderCanvas()}},_renderCanvas:function(){this.canvas=new webix.Canvas({container:this.$view,name:this._settings.ariaLabel,width:this.$width,height:this.$height});this._drawBars()},_drawBars:function(){var code,ctx,i,len,value=this._settings.value,type=this._settings.type;if(!type||!this.types[type]||!value)return false;code=this.type.encode(value);len=code.length;ctx=this.canvas.getCanvas();if(len){var unitWidth=(this.$width-this.config.paddingX*2)/len;var unitNum=0;for(i=0;i<len;i++){var ch1=parseInt(code.charAt(i),10);if(ch1){unitNum++;if(i==len-1){this._drawBar(ctx,i+1,unitWidth,unitNum,len)}}else if(unitNum){this._drawBar(ctx,i,unitWidth,unitNum,len);unitNum=0}}this._addText(value,unitWidth)}},_drawBar:function(ctx,i,unitWidth,unitNum,num){var x0,x1,y0,y1;x1=parseInt(i*unitWidth+this.config.paddingX,10);x0=parseInt(x1-unitNum*unitWidth,10);y0=this.config.paddingY;y1=this.$height-this.config.paddingY-this.config.textHeight;if(this._isEAN()&&(i<4||i>num-4||i<num/2+2&&i>num/2-2)){y1+=this.config.textHeight/2}ctx.fillStyle=this.config.color;ctx.beginPath();ctx.moveTo(x0,y0);ctx.lineTo(x1,y0);ctx.lineTo(x1,y1);ctx.lineTo(x0,y1);ctx.lineTo(x0,y0);ctx.fill()},_addText:function(value,barWidth){var i,len,x;if(this.type.template)value=this.type.template(value);if(this._isEAN()){if(this.type.firstDigit){this.canvas.renderTextAt(true,"left",this.config.paddingX,this.$height-this.config.paddingY,value.charAt(0));value=value.slice(1)}len=value.length;if(this.type.lastDigit)len--;if(len){var tUnitWidth=(this.$width-this.config.paddingX*2-barWidth*11)/len;for(i=0;i<len;i++){x=this.config.paddingX+i*tUnitWidth+(i<len/2?3:8)*barWidth+tUnitWidth/2;this.canvas.renderTextAt(true,true,x,this.$height-this.config.paddingY,value.charAt(i))}if(this.type.lastDigit){x=this.config.paddingX+len*tUnitWidth+11*barWidth;this.canvas.renderTextAt(true,false,x,this.$height-this.config.paddingY,value.charAt(len))}}}else{this.canvas.renderTextAt(true,true,this.$width/2,this.$height-this.config.paddingY,value)}},setValue:function(value){this._settings.value=value;this.render();return value},getValue:function(){var value=this._settings.value;return this.type.template?this.type.template(value):value},type_setter:function(value){if(!this.types[value])this.customize(value);else{this.type=webix.clone(this.types[value]);if(this.type.css)this._contentobj.className+=" "+this.type.css}return value},_isEAN:function(){var type=this.config.type;return type.indexOf("ean")===0||type.indexOf("upcA")!=-1},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)){this.render()}}},webix.ui.view);webix.type(webix.ui.barcode,{name:"ean8",encodings:[["0001101","1110010"],["0011001","1100110"],["0010011","1101100"],["0111101","1000010"],["0100011","1011100"],["0110001","1001110"],["0101111","1010000"],["0111011","1000100"],["0110111","1001000"],["0001011","1110100"]],encode:function(value){var code,i;value=value.replace(/[^0-9]/g,"").substring(0,7);if(value.length!=7)return"";value=value+this.checksum(value);code="101";for(i=0;i<4;i++){code+=this.encodings[parseInt(value.charAt(i),10)][0]}code+="01010";for(i=4;i<8;i++){code+=this.encodings[parseInt(value.charAt(i),10)][1]}code+="101";return code},template:function(value){return value.replace(/[^0-9]/g,"").substring(0,7)+this.checksum(value)},checksum:function(value){value=value.substring(0,7);var i,odd=true,sum=0;for(i=0;i<7;i++){sum+=(odd?3:1)*parseInt(value.charAt(i),10);odd=!odd}return((10-sum%10)%10).toString()}});webix.type(webix.ui.barcode,{name:"ean13",firstDigit:true,encodings:[["0001101","0100111","1110010","000000"],["0011001","0110011","1100110","001011"],["0010011","0011011","1101100","001101"],["0111101","0100001","1000010","001110"],["0100011","0011101","1011100","010011"],["0110001","0111001","1001110","011001"],["0101111","0000101","1010000","011100"],["0111011","0010001","1000100","010101"],["0110111","0001001","1001000","010110"],["0001011","0010111","1110100","011010"]],encode:function(value){var code,columnIndexes,i;value=value.replace(/[^0-9]/g,"").substring(0,12);if(value.length!=12)return"";value+=this.checksum(value);code="101";columnIndexes=this.encodings[parseInt(value.charAt(0),10)][3];for(i=1;i<7;i++){code+=this.encodings[parseInt(value.charAt(i),10)][parseInt(columnIndexes.charAt(i-1),10)]}code+="01010";for(i=7;i<13;i++){code+=this.encodings[parseInt(value.charAt(i),10)][2]}code+="101";return code},template:function(value){return value.replace(/[^0-9]/g,"").substring(0,12)+this.checksum(value)},checksum:function(value){var i,odd=false,sum=0;value=value.substring(0,12);for(i=0;i<12;i++){sum+=(odd?3:1)*parseInt(value.charAt(i),10);odd=!odd}return((10-sum%10)%10).toString()}});webix.type(webix.ui.barcode,{name:"upcA",firstDigit:true,lastDigit:true,encode:function(value){if(value.length<12){value="0"+value}return webix.ui.barcode.prototype.types.ean13.encode(value)},template:function(value){return value.replace(/[^0-9]/g,"").substring(0,11)+this.checksum(value)},checksum:function(value){if(value.length<12){value="0"+value}return webix.ui.barcode.prototype.types.ean13.checksum(value)}});webix.protoUI({name:"abslayout",$init:function(){this.$view.className+=" webix_abslayout";delete this.rows_setter;delete this.cols_setter},cells_setter:function(cells){this._collection=cells},_parse_cells:function(){webix.ui.baselayout.prototype._parse_cells.call(this,this._collection)},$getSize:function(dx,dy){var self_size=webix.ui.baseview.prototype.$getSize.call(this,0,0);var sub=null;for(var i=0;i<this._cells.length;i++)if(this._cells[i]._settings.relative)sub=this._cells[i].$getSize(0,0);if(sub){if(self_size[1]>=1e5)self_size[1]=0;if(self_size[3]>=1e5)self_size[3]=0;self_size[0]=Math.max(self_size[0],sub[0]);self_size[1]=Math.max(self_size[1],sub[1]);self_size[2]=Math.max(self_size[2],sub[2]);self_size[3]=Math.max(self_size[3],sub[3])}return self_size},$setSize:function(x,y){this._layout_sizes=[x,y];webix.debug_size_box_start(this);webix.ui.baseview.prototype.$setSize.call(this,x,y);this._set_child_size(x,y);webix.debug_size_box_end(this,[x,y])},_set_child_size:function(x,y){for(var i=0;i<this._cells.length;i++){var view=this._cells[i];var conf=view._settings;if(conf.relative){conf.left=conf.top=0;conf.width=x;conf.height=y}var sizes=view.$getSize(0,0);view.$setSize(sizes[0],sizes[2]);var node=view.$view;var options=["left","right","top","bottom"];for(var j=0;j<options.length;j++){var key=options[j];if(key in conf)node.style[key]=conf[key]+"px"}}}},webix.ui.baselayout);webix.protoUI({name:"datalayout",$init:function(){this.data.provideApi(this,true);this.data.attachEvent("onStoreUpdated",webix.bind(this.render,this))},_parse_cells:function(cells){if(!this._origin_cells){this._origin_cells=this._collection;this._collection=[{}]}return webix.ui.layout.prototype._parse_cells.call(this,this._collection)},setValue:function(obj){this.parse(obj)},getValue:function(obj){var subcount=this._origin_cells.length;for(var i=0;i<this._cells.length;i++){var id=this.data.order[Math.floor(i/subcount)];var item=this.data.getItem(id);this._save_data(this._cells[i],item)}return this.data.serialize()},_save_data:function(view,prop){var name=view._settings.name;if(name){var data=null;if(view.getValues)data=view.getValues();else if(view.getValue)data=view.getValue();else if(view.serialize)data=view.serialize();if(name=="$value")webix.extend(prop,data,true);else prop[name]=data}else{var collection=view._cells;if(collection)for(var i=0;i<collection.length;i++)this._save_data(collection[i],prop)}},_fill_data:function(view,prop){var obj,name=view._settings.name;if(name){if(name=="$value")obj=prop;else obj=prop[name];if(view.setValues)view.setValues(obj);else if(view.setValue)view.setValue(obj);else if(view.parse){if(view.openAll)obj=webix.copy(obj);view.parse(obj)}}else{var collection=view._cells;if(collection)for(var i=0;i<collection.length;i++)this._fill_data(collection[i],prop)}},render:function(id,obj,mode){var subcount=this._origin_cells.length;if(id&&mode==="update"){var obj=this.getItem(id);var index=this.getIndexById(id);for(var i=0;i<subcount;i++)this._fill_data(this._cells[index*subcount+i],obj);return}var cells=this._collection=[];var order=this.data.order;for(var i=0;i<order.length;i++){if(subcount)for(var j=0;j<subcount;j++)cells.push(webix.copy(this._origin_cells[j]));else cells.push(this.getItem(order[i]))}if(!cells.length)cells.push({});this.reconstruct();if(subcount)for(var i=0;i<order.length;i++){var prop=this.getItem(order[i]);for(var j=0;j<subcount;j++){var view=this._cells[i*subcount+j];this._fill_data(view,prop)}}}},webix.DataLoader,webix.ui.layout);webix.protoUI({$init:function(){webix.extend(this,webix.FlexLayout,true)},name:"flexdatalayout"},webix.ui.datalayout);webix.protoUI({name:"video",$init:function(config){if(!config.id)config.id=webix.uid();this.$ready.push(this._init_video)},_init_video:function(){var c=this._settings;this._contentobj=webix.html.create("video",{class:"webix_view_video",style:"width:100%;height:100%;",autobuffer:"autobuffer"},"");if(c.poster)this._contentobj.poster=c.poster;if(c.src){if(typeof c.src!="object")c.src=[c.src];for(var i=0;i<c.src.length;i++)this._contentobj.innerHTML+=' <source src="'+c.src[i]+'">'}if(c.controls)this._contentobj.controls=true;if(c.autoplay)this._contentobj.autoplay=true;this._viewobj.appendChild(this._contentobj)},getVideo:function(){return this._contentobj},defaults:{src:"",controls:true}},webix.ui.view);webix.protoUI({name:"sidemenu",defaults:{animate:true,position:"left",width:200,borderless:true},$init:function(){this.$view.className+=" webix_sidemenu"},$skin:function(){this.defaults.padding=0},position_setter:function(value){var prevPosition=this._settings.position;if(prevPosition)webix.html.removeCss(this.$view," webix_sidemenu_"+prevPosition);webix.html.addCss(this.$view," webix_sidemenu_"+value);return value},$getSize:function(){var sizes=webix.ui.window.prototype.$getSize.apply(this,arguments);this._desired_sizes=sizes;return sizes},$setSize:function(x,y){webix.ui.view.prototype.$setSize.call(this,x,y);x=this._content_width-this._settings.padding*2;y=this._content_height-this._settings.padding*2;this._contentobj.style.padding=this._settings.padding+"px";this._headobj.style.display="none";this._bodyobj.style.height=y+"px";this._body_cell.$setSize(x,y)},show:function(){if(!this.callEvent("onBeforeShow",arguments))return false;this._settings.hidden=false;this._viewobj.style.zIndex=this._settings.zIndex||webix.ui.zIndex();if(this._settings.modal||this._modal){this._modal_set(true);this._modal=null}this._viewobj.style.display="block";this._render_hidden_views();if(this._settings.position)this._setPosition();this._hide_timer=1;webix.delay(function(){this._hide_timer=0},this,[],webix.env.touch?400:100);if(this.config.autofocus){this._prev_focus=webix.UIManager.getFocus();webix.UIManager.setFocus(this)}if(-1==webix.ui._popups.find(this))webix.ui._popups.push(this);this.callEvent("onShow",[])},_setPosition:function(x){var width,height,maxWidth,maxHeight,position,left=0,top=0,state={};this.$view.style.position="fixed";maxWidth=window.innerWidth||document.documentElement.offsetWidth;maxHeight=window.innerHeight||document.documentElement.offsetHeight;width=this._desired_sizes[0]||maxWidth;height=this._desired_sizes[2]||maxHeight;webix.assert(width&&height,"Attempt to show not rendered window");position=this._settings.position;if(position=="top"){width=maxWidth}else if(position=="right"){height=maxHeight;left=maxWidth-width}else if(position=="bottom"){width=maxWidth;top=maxHeight-height}else{height=maxHeight}state={left:left,top:top,width:width,height:height,maxWidth:maxWidth,maxHeight:maxHeight};if(typeof this._settings.state=="function")this._settings.state.call(this,state);this._state=state;this.$setSize(state.width,state.height);if(typeof x=="undefined"&&this._isAnimationSupported()){webix.html.removeCss(this.$view,"webix_animate",true);this._animate[this._settings.position].beforeShow.call(this,state);webix.delay(function(){webix.html.addCss(this.$view,"webix_animate",true)},this,null,1);webix.delay(function(){this._animate[this._settings.position].show.call(this,state)},this,null,10)}else{this.setPosition(state.left,state.top)}},_isAnimationSupported:function(){return webix.animate.isSupported()&&this._settings.animate&&!(webix.env.isIE&&navigator.appVersion.indexOf("MSIE 9")!=-1)},hidden_setter:function(value){if(value)this.hide(true);else this.show();return!!value},_animate:{left:{beforeShow:function(state){this.$view.style.left=-state.width+"px";this.$view.style.top=state.top+"px"},show:function(){this.$view.style.left="0px"},hide:function(state){this.$view.style.left=-state.width+"px"}},right:{beforeShow:function(state){this.$view.style.left="auto";this.$view.style.right=-state.width+"px";this.$view.style.top=state.top+"px"},show:function(){this.$view.style.right=0+"px"},hide:function(state){this.$view.style.right=-state.width+"px"}},top:{beforeShow:function(state){this.setPosition(state.left,state.top);this.$view.style.height="0px";this._bodyobj.style.height="0px"},show:function(state){this.$view.style.height=state.height+"px";this._bodyobj.style.height=state.height+"px"},hide:function(){this.$view.style.height="0px";this._bodyobj.style.height="0px"}},bottom:{beforeShow:function(state){this.$view.style.left=state.left+"px";this.$view.style.top="auto";var bottom=state.bottom!=webix.undefined?state.bottom:state.maxHeight-state.top-state.height;this.$view.style.bottom=bottom+"px";this.$view.style.height="0px"},show:function(state){this.$view.style.height=state.height+"px"},hide:function(){this.$view.style.height="0px"}}},hide:function(force){if(this.$destructed)return;if(this._settings.modal)this._modal_set(false);var maxWidth=window.innerWidth||document.documentElement.offsetWidth;var maxHeight=window.innerHeight||document.documentElement.offsetHeight;if(!force&&this._isAnimationSupported()&&maxWidth==this._state.maxWidth&&maxHeight==this._state.maxHeight){this._animate[this._settings.position].hide.call(this,this._state);var tid=webix.event(this.$view,webix.env.transitionEnd,webix.bind(function(ev){this._hide_callback();webix.eventRemove(tid)},this))}else{this._hide_callback()}if(this._settings.autofocus){var el=document.activeElement;if(el&&this._viewobj&&this._viewobj.contains(el)){webix.UIManager.setFocus(this._prev_focus);this._prev_focus=null}}this._hide_sub_popups()}},webix.ui.popup);(function(){var webixCustomScroll=webix.CustomScroll={scrollStep:40,init:function(){this._init_once();webix.env.$customScroll=true;webix.ui.scrollSize=0;webix.destructors.push({obj:{destructor:function(){this._last_active_node=null}}});webix.attachEvent("onReconstruct",webixCustomScroll._on_reconstruct);webix.attachEvent("onResize",webixCustomScroll._on_reconstruct);webix.attachEvent("onClick",webixCustomScroll._on_reconstruct)},resize:function(){this._on_reconstruct()},_enable_datatable:function(view){view._body._custom_scroll_view=view._settings.id;view.attachEvent("onAfterRender",function(){var scroll=webixCustomScroll._get_datatable_sizes(this);var y=Math.max(scroll.dy-scroll.py,0);var x=Math.max(scroll.dx-scroll.px,0);if(this._y_scroll&&this._scrollTop>y){this._y_scroll.scrollTo(y)}else if(this._x_scroll&&this._scrollLeft>x){this._x_scroll.scrollTo(x)}if(webixCustomScroll._last_active_node==this._body)webixCustomScroll._on_reconstruct()});webix._event(view._body,"mouseover",webixCustomScroll._mouse_in);webix._event(view._body,"mouseout",webixCustomScroll._mouse_out)},enable:function(view,mode){webixCustomScroll._init_once();if(view.mapCells)return this._enable_datatable(view);var node=view;if(view._dataobj)node=view._dataobj.parentNode;node._custom_scroll_mode=mode||"xy";webix._event(node,"mouseover",webixCustomScroll._mouse_in);webix._event(node,"mouseout",webixCustomScroll._mouse_out);webix._event(node,"mousewheel",webixCustomScroll._mouse_wheel);webix._event(node,"DOMMouseScroll",webixCustomScroll._mouse_wheel);this._setDataHandler(view)},_on_reconstruct:function(){var last=webixCustomScroll._last_active_node;if(last&&last._custom_scroll_size){webixCustomScroll._mouse_out_timed.call(last);webixCustomScroll._mouse_in.call(last)}},_init_once:function(e){webix.event(document.body,"mousemove",function(e){if(webixCustomScroll._active_drag_area)webixCustomScroll._adjust_scroll(webixCustomScroll._active_drag_area,webixCustomScroll._active_drag_area._scroll_drag_pos,webix.html.pos(e))});webixCustomScroll._init_once=function(){}},_mouse_in:function(e){webixCustomScroll._last_active_node=this;clearTimeout(this._mouse_out_timer);if(this._custom_scroll_size||webixCustomScroll._active_drag_area)return;var sizes;if(this._custom_scroll_view){var view=webix.$$(this._custom_scroll_view);if(!view)return;sizes=webixCustomScroll._get_datatable_sizes(view)}else{sizes={dx:this.scrollWidth,dy:this.scrollHeight,px:this.clientWidth,py:this.clientHeight};sizes._scroll_x=sizes.dx>sizes.px&&this._custom_scroll_mode.indexOf("x")!=-1;sizes._scroll_y=sizes.dy>sizes.py&&this._custom_scroll_mode.indexOf("y")!=-1}this._custom_scroll_size=sizes;if(sizes._scroll_x){sizes._scroll_x_node=webixCustomScroll._create_scroll(this,"x",sizes.dx,sizes.px,"width","height");sizes._sx=sizes.px-sizes._scroll_x_node.offsetWidth-4;sizes._vx=sizes.dx-sizes.px;if(webixCustomScroll.trackBar)sizes._bar_x=webixCustomScroll._create_bar(this,"x")}if(sizes._scroll_y){sizes._scroll_y_node=webixCustomScroll._create_scroll(this,"y",sizes.dy,sizes.py,"height","width");sizes._sy=sizes.py-sizes._scroll_y_node.offsetHeight-4;sizes._vy=sizes.dy-sizes.py;if(webixCustomScroll.trackBar)sizes._bar_y=webixCustomScroll._create_bar(this,"y")}webixCustomScroll._update_scroll(this)},_create_bar:function(node,mode){var bar=webix.html.create("DIV",{webixignore:"1",class:"webix_c_scroll_bar_"+mode},"");node.appendChild(bar);return bar},_adjust_scroll:function(node,old,pos){var config=node._custom_scroll_size;var view=node._custom_scroll_view;if(view)view=webix.$$(view);if(config._scroll_x_node==node._scroll_drag_enabled){var next=(pos.x-old.x)*config._vx/config._sx;if(view)view._x_scroll.scrollTo(view._scrollLeft+next);else webixCustomScroll._set_scroll_value(node,"scrollLeft",next)}if(config._scroll_y_node==node._scroll_drag_enabled){var next=(pos.y-old.y)*config._vy/config._sy;if(view)view._y_scroll.scrollTo(view._scrollTop+next);else webixCustomScroll._set_scroll_value(node,"scrollTop",next)}node._scroll_drag_pos=pos;webixCustomScroll._update_scroll(node)},_get_datatable_sizes:function(view){var sizes={};if(view._x_scroll&&view._settings.scrollX){sizes.dx=view._x_scroll._settings.scrollWidth;sizes.px=view._x_scroll._last_set_size||1;sizes._scroll_x=sizes.dx-sizes.px>1}if(view._y_scroll&&view._settings.scrollY){sizes.dy=view._y_scroll._settings.scrollHeight;sizes.py=view._y_scroll._last_set_size||1;sizes._scroll_y=sizes.dy-sizes.py>1}return sizes},_mouse_out:function(){clearTimeout(this._mouse_out_timer);this._mouse_out_timer=webix.delay(webixCustomScroll._mouse_out_timed,this,[],200)},_removeScroll:function(scroll){if(scroll){webix.html.remove(scroll);if(scroll._webix_event_sc1){webix.eventRemove(scroll._webix_event_sc1);webix.eventRemove(scroll._webix_event_sc2)}}},_mouse_out_timed:function(){if(this._custom_scroll_size){if(this._scroll_drag_enabled){this._scroll_drag_released=true;return}var sizes=this._custom_scroll_size;webixCustomScroll._removeScroll(sizes._scroll_x_node);webixCustomScroll._removeScroll(sizes._scroll_y_node);webix.html.removeCss(document.body,"webix_noselect");if(sizes._bar_x){webix.html.remove(sizes._bar_x)}if(sizes._bar_y){webix.html.remove(sizes._bar_y)}this._custom_scroll_size=null}},_mouse_wheel:function(e){var sizes=this._custom_scroll_size;var delta=e.wheelDelta/-40;var toblock=true;if(!delta&&e.detail&&webix.isUndefined(e.wheelDelta))delta=e.detail;if(sizes){if(sizes._scroll_x_node&&(e.wheelDeltaX||delta&&!sizes._scroll_y_node)){var x_dir=e.wheelDeltaX/-40||delta;toblock=webixCustomScroll._set_scroll_value(this,"scrollLeft",x_dir*webixCustomScroll.scrollStep)}else if(delta&&sizes._scroll_y_node){toblock=webixCustomScroll._set_scroll_value(this,"scrollTop",delta*webixCustomScroll.scrollStep)}}webixCustomScroll._update_scroll(this);if(toblock!==false)return webix.html.preventEvent(e)},_set_scroll_value:function(node,pose,value){var sizes=node._custom_scroll_size;var max_scroll=pose=="scrollLeft"?sizes.dx-sizes.px:sizes.dy-sizes.py;var now=node[pose];if(now+value>max_scroll)value=max_scroll-now;if(!value||now+value<0&&now===0)return false;if(webix.env.isIE){webixCustomScroll._update_scroll(node,pose,value+now);node[pose]+=value}else node[pose]+=value;return true},_create_scroll:function(node,mode,dy,py,dim,pos){var scroll=webix.html.create("DIV",{webixignore:"1",class:"webix_c_scroll_"+mode},"<div></div>");scroll.style[dim]=Math.max(py*py/dy-7,40)+"px";node.style.position="relative";node.appendChild(scroll);node._webix_event_sc1=webix.event(scroll,"mousedown",webixCustomScroll._scroll_drag(node));node._webix_event_sc2=webix.event(document.body,"mouseup",webix.bind(webixCustomScroll._scroll_drop,node));return scroll},_scroll_drag:function(node){return function(e){webix.html.addCss(document.body,"webix_noselect",1);this.className+=" webix_scroll_active";webixCustomScroll._active_drag_area=node;node._scroll_drag_enabled=this;node._scroll_drag_pos=webix.html.pos(e)}},_scroll_drop:function(node){if(this._scroll_drag_enabled){webix.html.removeCss(document.body,"webix_noselect");this._scroll_drag_enabled.className=this._scroll_drag_enabled.className.toString().replace(" webix_scroll_active","");this._scroll_drag_enabled=false;webixCustomScroll._active_drag_area=0;if(this._scroll_drag_released){webixCustomScroll._mouse_out_timed.call(this);this._scroll_drag_released=false}}},_update_scroll:function(node,pose,value){var sizes=node._custom_scroll_size;if(sizes&&(sizes._scroll_x_node||sizes._scroll_y_node)){var view=node._custom_scroll_view;var left_scroll=pose=="scrollLeft"?value:node.scrollLeft;var left=view?webix.$$(view)._scrollLeft:left_scroll;var shift_left=view?0:left;var top_scroll=pose=="scrollTop"?value:node.scrollTop;var top=view?webix.$$(view)._scrollTop:top_scroll;var shift_top=view?0:top;if(sizes._scroll_x_node){sizes._scroll_x_node.style.bottom=1-shift_top+"px";sizes._scroll_x_node.style.left=Math.round(sizes._sx*left/(sizes.dx-sizes.px))+shift_left+1+"px";if(sizes._bar_x){sizes._bar_x.style.bottom=1-shift_top+"px";sizes._bar_x.style.left=shift_left+"px"}}if(sizes._scroll_y_node){sizes._scroll_y_node.style.right=0-shift_left+"px";sizes._scroll_y_node.style.top=Math.round(sizes._sy*top/(sizes.dy-sizes.py))+shift_top+1+"px";if(sizes._bar_y){sizes._bar_y.style.right=0-shift_left+"px";sizes._bar_y.style.top=shift_top+"px"}}}},_setDataHandler:function(view){if(view.data&&view.data.attachEvent)view.data.attachEvent("onStoreUpdated",function(){var node=webixCustomScroll._last_active_node;if(node&&view.$view.contains(node))webixCustomScroll.resize()})}}})();webix.protoUI({name:"portlet",defaults:{layoutType:"wide"},$init:function(config){this._viewobj.style.position="relative";if(config.header&&config.body)config.body=[{template:config.header,type:"header"},config.body];this.$ready.push(this._init_drag_area);webix.attachEvent("onAfterPortletMove",this._refreshChildScrolls)},_refreshChildScrolls:function(source){webix.ui.each(source,function(view){if(view._restore_scroll_state)view._restore_scroll_state()})},_init_drag_area:function(){var childs=this.getChildViews();if(childs.length>1)webix.DragControl.addDrag(childs[0].$view,this);else{var drag=webix.html.create("div",{class:"portlet_drag"},"<span class='webix_icon fa-bars'></span>");this._viewobj.appendChild(drag);webix.DragControl.addDrag(drag,this)}},body_setter:function(value){return this.rows_setter(webix.isArray(value)?value:[value])},markDropArea:function(target,mode){if(!target)return webix.html.remove(this._markerbox);target=webix.$$(target);if(!this._markerbox)this._markerbox=webix.html.create("div",null,"&nbsp;");target.$view.appendChild(this._markerbox);this._markerbox.className="portlet_marker"+mode},movePortlet:function(target,mode){var parent=target.getParentView();var source=this.getParentView();var tindex=parent.index(target);var sindex=source.index(this);if(!webix.callEvent("onBeforePortletMove",[source,parent,this,target,mode]))return;webix.ui.$freeze=true;var shift=source!=parent?1:0;var isv=parent._vertical_orientation;if(mode=="top"||mode=="bottom"){if(isv!==1){parent=webix.ui({type:target._settings.layoutType,rows:[]},parent,tindex+shift);webix.ui(target,parent,0);tindex=0;shift=1}if(mode=="bottom")shift+=1}else if(mode=="left"||mode=="right"){if(isv!==0){parent=webix.ui({type:target._settings.layoutType,cols:[]},parent,tindex+shift);webix.ui(target,parent,0);tindex=0;shift=1}if(mode=="right")shift+=1}if(sindex<tindex)shift-=1;webix.ui(this,parent,tindex+shift);if(mode=="replace")webix.ui(target,source,sindex);this._removeEmptySource(source);webix.ui.$freeze=false;var tops=source.getTopParentView();target.resize();source.resize();webix.callEvent("onAfterPortletMove",[source,parent,this,target,mode])},_removeEmptySource:function(view){var childview;var maxcount=0;while(view.getChildViews().length<=maxcount){childview=view;view=view.getParentView();maxcount=1}if(maxcount)view.removeView(childview)},$drag:function(object,e){webix.html.addCss(this._viewobj,"portlet_in_drag");webix.DragControl._drag_context={source:object,from:object};return this._viewobj.innerHTML},$dragDestroy:function(target,html,e){webix.html.removeCss(this._viewobj,"portlet_in_drag");webix.html.remove(html);if(this._portlet_drop_target){this.movePortlet(this._portlet_drop_target,this._portlet_drop_mode);this.markDropArea();this._portlet_drop_target=null}},_getDragItemPos:function(){return webix.html.offset(this.$view)},$dragPos:function(pos,e,html){html.style.left="-10000px";var evObj=webix.env.mouse.context(e);var node=document.elementFromPoint(evObj.x,evObj.y);var view=null;if(node)view=webix.$$(node);this._portlet_drop_target=this._getPortletTarget(view);this._portlet_drop_mode=this._markPortletDrag(this._portlet_drop_target,e);pos.x=pos.x-this._content_width+10;pos.y=pos.y-20;webix.DragControl._skip=true},_markPortletDrag:function(view,ev){var drop="";var mode="";if(ev&&view){var box=webix.html.offset(view.$view);var pos=webix.html.pos(ev);var erx=pos.x-box.x-box.width/2;var ery=pos.y-box.y-box.height/2;mode=view._settings.mode;if(!mode)mode=Math.abs(erx)*(box.height/box.width)>Math.abs(ery)?"cols":"rows";if(mode=="cols"){drop=erx>=0?"right":"left"}else if(mode=="rows"){drop=ery>=0?"bottom":"top"}this.markDropArea(view,drop)}this.markDropArea(view,drop);return drop||mode},_getPortletTarget:function(view){while(view){if(view.movePortlet)return view;else view=view.getParentView()}}},webix.ui.layout);webix.UIManager.getState=function(node,children){children=children||false;node=webix.$$(node);var state={id:node.config.id,width:node.config.width,height:node.config.height,gravity:node.config.gravity};if(!webix.isUndefined(node.config.collapsed))state.collapsed=node.config.collapsed;if(node.name==="tabs"||node.name==="tabbar")state.activeCell=node.getValue();if(children){state=[state];if(node._cells){for(var i=0;i<node._cells.length;i++)state=state.concat(this.getState(node._cells[i],children))}}return state};webix.UIManager.setState=function(states){if(!webix.isArray(states))states=[states];for(var i=0;i<states.length;i++){var state=states[i];var node=webix.$$(state.id);if(!node)continue;if(!webix.isUndefined(state.collapsed))node.define("collapsed",state.collapsed);if(!webix.isUndefined(state.activeCell))node.setValue(state.activeCell);node.define("width",state.width);node.define("height",state.height);node.define("gravity",state.gravity)}var top=webix.$$(states[0].id);if(top)top.resize()};(function(){webix.toPNG=function(id,options){var defer=webix.promise.defer();webix.require(webix.cdn+"/extras/html2canvas.min.js",function(){if(typeof options==="string")options={filename:options};options=options||{};var view=webix.$$(id);if(view&&view.$exportView)view=view.$exportView(options);var node=view?view.$view:webix.toNode(id);var filename=(options.filename||"Data")+".png";window.html2canvas(node).then(function(canvas){var data=canvas.msToBlob?canvas.msToBlob():canvas.toDataURL("image/png");if(options.download!==false)webix.html.download(data,filename);canvas.remove();defer.resolve(data)})});return defer};webix.toExcel=function(id,options){var defer=webix.promise.defer();webix.require(webix.cdn+"/extras/xlsx.core.min.js",function(){options=options||{};var view=webix.$$(id);if(view.$exportView)view=view.$exportView(options);options._export_mode="excel";var scheme=getExportScheme(view,options);var result=getExportData(view,options,scheme);var spans=options.spans?getSpans(view,options):[];var data=getExcelData(result,scheme,spans);var wb={SheetNames:[],Sheets:[]};var name=options.name||"Data";name=name.replace(/[\*\?\:\[\]\\\/]/g,"").substring(0,31);wb.SheetNames.push(name);wb.Sheets[name]=data;var xls=XLSX.write(wb,{bookType:"xlsx",bookSST:false,type:"binary"});var filename=(options.filename||name)+".xlsx";var blob=new Blob([str2array(xls)],{type:"application/xlsx"});if(options.download!==false)webix.html.download(blob,filename);defer.resolve(blob)});return defer};webix.toCSV=function(id,options){options=options||{};var view=webix.$$(id);if(view.$exportView)view=view.$exportView(options);options._export_mode="csv";var scheme=getExportScheme(view,options);var result=getExportData(view,options,scheme);var data=getCsvData(result,scheme);var filename=(options.filename||"Data")+".csv";var blob=new Blob(["\ufeff"+data],{type:"text/csv"});if(options.download!==false)webix.html.download(blob,filename);return webix.promise.resolve(blob)};function getCsvData(data,scheme){return webix.csv.stringify(data)}var font;webix.toPDF=function(id,options){var defer=webix.promise.defer();webix.require(webix.cdn+"/extras/pdfjs.js",function(){options=options||{};var view=webix.$$(id);if(view.$exportView)view=view.$exportView(options);options._export_mode="pdf";options._export_font=font;options.fontName=options.fontName||"pt-sans.regular";var scheme=getExportScheme(view,options);var data=getExportData(view,options,scheme);var callback=function(pdf,options){var filename=(options.filename||"Data")+".pdf";var blob=new Blob([pdf.toString()],{type:"application/pdf"});if(options.download!==false)webix.html.download(blob,filename);defer.resolve(blob)};if(options._export_font)getPdfData(scheme,data,options,callback);else pdfjs.load(webix.cdn+"/extras/"+options.fontName+".ttf",function(err,buf){if(err)throw err;font=options._export_font=new pdfjs.TTFFont(buf);getPdfData(scheme,data,options,callback)})});return defer};function getExportScheme(view,options){var scheme=[];var h_count=0,f_count=0;var isTable=view.getColumnConfig;var columns=options.columns;var raw=!!options.rawValues;if(!columns){if(isTable){columns=[].concat(view._columns)}else{columns=[];var obj=view.data.pull[view.data.order[0]];for(var key in obj)if(key!=="id")columns.push({id:key})}}else if(!columns.length){var arr=[];for(var key in columns)arr.push(webix.extend({id:key},webix.extend({},columns[key])));columns=arr}if(options.ignore)for(var i=columns.length-1;i>=0;i--)if(options.ignore[columns[i].id])columns.splice(i,1);if(options.id)scheme.push({id:"id",width:50,header:" ",template:function(obj){return obj.id}});if(options.flatTree){var flatKey=options.flatTree.id;var copy=[].concat(options.flatTree.columns);var fill=[];var fillMode=!!options.flatTree.fill;for(var i=1;i<=copy.length;i++)copy[i-1].template=function(i,c){return function(obj){return obj.$level==i?fill[i]=obj[flatKey]:fillMode&&i<obj.$level?fill[i]:""}}(i);var index=0;for(var i=columns.length-1;i>=0;i--)if(columns[i].id===flatKey)index=i;columns=[].concat(columns.slice(0,index)).concat(copy).concat(columns.slice(index+1))}for(var j=0;j<columns.length;j++){var column=columns[j];var key=column.id;if(column.noExport)continue;if(isTable&&view._columns_pull[key])column=webix.extend(webix.extend({},column),view._columns_pull[key]);var record={id:column.id,template:(raw?null:column.template)||function(key,column){return function(obj){return column.format?column.format(obj[key]):obj[key]}}(key,column),width:(column.width||200)*(options._export_mode==="excel"?8.43/70:1),header:column.header!==false?column.header||key:""};if(typeof record.header==="string")record.header=[{text:record.header}];else record.header=webix.copy(record.header);for(var i=0;i<record.header.length;i++){record.header[i]=record.header[i]?record.header[i].contentId?"":record.header[i].text:""}h_count=Math.max(h_count,record.header.length);if(view._settings.footer){var footer=column.footer||"";if(typeof footer=="string")footer=[{text:footer}];else footer=webix.copy(footer);for(var i=0;i<footer.length;i++){if(footer[i])footer[i]=footer[i].contentId?view.getHeaderContent(footer[i].contentId).getValue():footer[i].text;else footer[i]=""}record.footer=footer;f_count=Math.max(f_count,record.footer.length)}scheme.push(record)}for(var i=0;i<scheme.length;i++){var diff=h_count-scheme[i].header.length;for(var d=0;d<diff;d++)scheme[i].header.push("");if(view._settings.footer){diff=f_count-scheme[i].footer.length;for(var d=0;d<diff;d++)scheme[i].footer.push("")}}return scheme}function getExportData(view,options,scheme){var filterHTML=!!options.filterHTML;var htmlFilter=/<[^>]*>/gi;var data=[];var header,headers;if(options.header!==false&&scheme.length){for(var h=0;h<scheme[0].header.length;h++){headers=[];for(var i=0;i<scheme.length;i++){header="";if(scheme[i].header[h]){header=scheme[i].header[h];if(filterHTML)header=scheme[i].header[h]=header.replace(htmlFilter,"")}headers.push(header)}if(options._export_mode==="excel")data.push(headers);if(options._export_mode==="csv"){headers.map(function(item){item.replace(/<[^>]*>/gi,"")});data.push(headers)}}}var isTree=view.data.name=="TreeStore";var treeline=options.flatTree||options.plainOutput?"":" - ";view.data.each(function(item){if(item){var line=[];for(var i=0;i<scheme.length;i++){var column=scheme[i];var cell=column.template(item,view.type,item[column.id],column,i);if(!cell&&cell!==0)cell="";if(filterHTML&&typeof cell==="string"){if(isTree)cell=cell.replace(/<div class=.webix_tree_none.><\/div>/,treeline);cell=cell.replace(htmlFilter,"")}if(typeof cell==="string"&&options._export_mode==="csv")cell=cell.trim();if(typeof cell==="string"&&(options._export_mode==="excel"||options._export_mode==="csv")){cell=cell.replace(/<br\s*\/?>/gm,"\n")}line.push(cell)}data.push(line)}},view);if(options.footer!==false){var f_count=scheme[0].footer?scheme[0].footer.length:0;for(var f=0;f<f_count;f++){var footers=[];for(var i=0;i<scheme.length;i++){var footer=scheme[i].footer[f];if(filterHTML)footer=scheme[i].footer[f]=footer.toString().replace(htmlFilter,"");footers.push(footer)}if(options._export_mode==="excel")data.push(footers)}}return data}function getColumnsWidths(scheme){var wscols=[];for(var i=0;i<scheme.length;i++)wscols.push({wch:scheme[i].width});return wscols}function excelDate(date){return Math.round(25569+date/(24*60*60*1e3))}function getSpans(view,options){var pull=view._spans_pull;var spans=[];if(pull){var xc=options.xCorrection||0;var yc=options.yCorrection||0;for(var row in pull){var cols=pull[row];for(var col in cols){var sc=view.getColumnIndex(col)-xc;var sr=view.getIndexById(row)-yc;var ec=sc+cols[col][0]-1;var er=sr+(cols[col][1]-1);spans.push({s:{c:sc,r:sr+1},e:{c:ec,r:er+1}})}}}return spans}var table="_table";function getExcelData(data,scheme,spans){var ws={};var range={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(var R=0;R!=data.length;++R){for(var C=0;C!=data[R].length;++C){if(range.s.r>R)range.s.r=R;if(range.s.c>C)range.s.c=C;if(range.e.r<R)range.e.r=R;if(range.e.c<C)range.e.c=C;var cell={v:data[R][C]};if(cell.v===null)continue;var cell_ref=XLSX.utils.encode_cell({c:C,r:R});if(typeof cell.v==="number")cell.t="n";else if(typeof cell.v==="boolean")cell.t="b";else if(cell.v instanceof Date){cell.t="n";cell.z=XLSX.SSF[table][14];cell.v=excelDate(cell.v)}else cell.t="s";ws[cell_ref]=cell}}if(range.s.c<1e7)ws["!ref"]=XLSX.utils.encode_range(range);ws["!cols"]=getColumnsWidths(scheme);if(spans.length)ws["!merges"]=spans;return ws}function str2array(s){var buf=new ArrayBuffer(s.length);var view=new Uint8Array(buf);for(var i=0;i!=s.length;++i)view[i]=s.charCodeAt(i)&255;return buf}function getPdfData(scheme,data,options,callback){options.header=webix.isUndefined(options.header)||options.header===true?{}:options.header;options.footer=webix.isUndefined(options.footer)||options.footer===true?{}:options.footer;options.table=options.table||{};var width=options.width||595.296,height=options.height||841.896;if(options.orientation&&options.orientation==="landscape")height=[width,width=height][0];if(options.autowidth){width=80;for(var i=0;i<scheme.length;i++)width+=scheme[i].width}var doc=new pdfjs.Document({padding:40,font:options._export_font,threshold:256,width:width,height:height});var h_count=options.header===false?0:scheme[0].header.length;var f_count=options.footer===false||!scheme[0].footer?0:scheme[0].footer.length;var colWidths=[];for(var i=0;i<scheme.length;i++)colWidths[i]=scheme[i].width;var tableOps=webix.extend(options.table,{borderWidth:1,height:20,lineHeight:1.1,borderColor:15658734,backgroundColor:16777215,color:6710886,textAlign:"left",paddingRight:10,paddingLeft:10,headerRows:h_count,widths:colWidths.length?colWidths:["100%"]});var table=doc.table(tableOps);if(h_count){var headerOps=webix.extend(options.header,{borderRightColor:11587299,borderBottomColor:11587299,color:4868682,backgroundColor:13820911,height:27,lineHeight:1.2});for(var i=0;i<h_count;i++){var header=table.tr(headerOps);for(var s=0;s<scheme.length;s++)header.td(scheme[s].header[i].toString())}}for(var r=0;r<data.length;r++){var row=table.tr({});for(var c=0;c<data[r].length;c++)row.td(data[r][c])}if(f_count){var footerOps=webix.extend(options.footer,{borderRightColor:15658734,borderBottomColor:15658734,backgroundColor:16448250,color:6710886,height:27,lineHeight:1.2});for(var i=0;i<f_count;i++){var footer=table.tr(footerOps);for(var s=0;s<scheme.length;s++)footer.td(scheme[s].footer[i].toString())}}if(options.docFooter!==false){var ft=doc.footer();ft.text({color:6710886,textAlign:"center"}).append(webix.i18n.dataExport.page||"Page").pageNumber().append("  "+(webix.i18n.dataExport.of||"of")+"  ").pageCount()}if(options.docHeader){if(typeof options.docHeader=="string")options.docHeader={text:options.docHeader};var docHeaderOps=webix.extend(options.docHeader,{color:6710886,textAlign:"right"});var hd=doc.header({paddingBottom:10});hd.text(docHeaderOps.text,docHeaderOps)}if(options.docHeaderImage){if(typeof options.docHeaderImage=="string")options.docHeaderImage={url:options.docHeaderImage};var hd=doc.header({paddingBottom:10});var docImageOps=webix.extend(options.docHeaderImage,{align:"right"});pdfjs.load(options.docHeaderImage.url,function(err,buffer){if(!err){var img=new pdfjs.Image(buffer);var image=hd.image(img,docImageOps)}var pdf=doc.render();callback(pdf,options)})}else{var pdf=doc.render();callback(pdf,options)}}})();webix.protoUI({name:"pdfviewer",defaults:{scale:"auto"},$init:function(config){this.$view.className+=" webix_pdf";var elm_wrapper=document.createElement("DIV");elm_wrapper.className="canvas_wrapper";var elm=document.createElement("canvas");this._currentPage=this.$view;this._container=this.$view.appendChild(elm_wrapper);this._canvas=this._container.appendChild(elm);this.$pdfDoc=null;this.$pageNum=0;this.$numPages=0;this._pageRendering=false;this._pageNumPending=null;this._ctx=this._canvas.getContext("2d");this._init_scale_value=.1;this._default_scale_delta=config.scaleDelta||1.1;this._min_scale=config.minScale||.25;this._max_scale=config.maxScale||10;this._max_auto_scale=1.25;this._hPadding=40;this._vPadding=10;this.$ready.push(this._attachHandlers)},toolbar_setter:function(toolbar){if(typeof toolbar=="string"){var ui_toolbar=webix.$$(toolbar);if(ui_toolbar){ui_toolbar.$master=this;ui_toolbar.refresh()}this.attachEvent("onDocumentReady",function(){if(ui_toolbar){ui_toolbar.setPage(this.$pageNum);ui_toolbar.setValues(this.$numPages,this._settings.scale)}else this.toolbar_setter(toolbar)});return toolbar}},_attachHandlers:function(){delete this._settings.datatype;this.attachEvent("onScaleChange",function(scale,update){if(update&&this._settings.toolbar&&webix.$$(this._settings.toolbar).setScale)webix.$$(this._settings.toolbar).setScale(scale)});if(webix.env.touch){this._touchDelta=false;webix._event(this._viewobj,"touchstart",webix.bind(function(e){var touches=e.targetTouches;if(touches.length===2){webix.html.preventEvent(e);this._touchDelta=Math.abs(touches[0].pageY-touches[1].pageY)}},this));webix._event(this.$view,"touchmove",webix.bind(function(e){var touches=e.targetTouches;if(touches.length===2&&this._touchDelta!==false){webix.html.preventEvent(e);if(Math.abs(touches[0].pageY-touches[1].pageY)>this._touchDelta)this.zoomIn();else this.zoomOut();this._touchDelta=false}},this));this.attachEvent("onSwipeX",function(start,end){this.$view.scrollLeft=this.$view.scrollLeft-(end.x-start.x)});this.attachEvent("onSwipeY",function(start,end){var ch=this.$view.clientHeight,sh=this.$view.scrollHeight,oh=this.$view.offsetHeight,stop=this.$view.scrollTop,delta=end.y-start.y;if(ch===sh||delta<0&&stop>sh-oh||delta>0&&stop===0){var page=this.$pageNum+(delta>0?-1:1);if(page>0&&page<=this.$numPages){this.$pageNum=page;this._queueRenderPage(this.$pageNum);this.$view.scrollTop=delta>0?sh:0}}else this.$view.scrollTop=stop-delta})}else{var evt=webix.env.isFF?"DOMMouseScroll":"mousewheel";webix.event(window,evt,webix.bind(function(e){var ticks=e.type==="DOMMouseScroll"?-e.detail:e.wheelDelta;var dir=ticks<0?"out":"in";if(e.ctrlKey){webix.html.preventEvent(e);if(dir=="in")this.zoomIn();else this.zoomOut()}},this))}},_getDocument:function(data){if(data.name){var reader=new FileReader;reader.onload=webix.bind(function(e){this._getDocument({data:e.target.result})},this);reader.readAsArrayBuffer(data)}else{PDFJS.getDocument({data:data.data}).then(webix.bind(function(pdfDoc_){this.clear();this.$pdfDoc=pdfDoc_;this.$numPages=this.$pdfDoc.numPages;this.$pageNum=1;this._renderPage(this.$pageNum).then(webix.bind(function(){this.callEvent("onDocumentReady")},this))},this))}},$onLoad:function(data){if(!window.PDFJS){webix.require([webix.cdn+"/extras/pdfjs/compatibility.min.js",webix.cdn+"/extras/pdfjs/pdf.min.js"],function(){PDFJS.workerSrc=webix.cdn+"/extras/pdfjs/pdf.worker.min.js";this._getDocument(data)},this)}else this._getDocument(data);return true},_getViewPort:function(page,scale){var viewport=page.getViewport(scale);this._canvas.height=viewport.height;this._canvas.width=viewport.width;this._container.style.width=viewport.width+"px";this._container.style.height=viewport.height+"px";return viewport},_renderPage:function(num){var viewer=this;viewer._pageRendering=true;return this.$pdfDoc.getPage(num).then(function(page){var scale=isNaN(parseFloat(viewer._settings.scale))?viewer._init_scale_value:viewer._settings.scale;var viewport=viewer._getViewPort(page,scale);if(scale!==viewer._settings.scale){scale=viewer._getScale(viewer._settings.scale);viewport=viewer._getViewPort(page,scale);viewer._settings.scale=scale}var renderContext={canvasContext:viewer._ctx,viewport:viewport};page.cleanupAfterRender=true;return page.render(renderContext).promise.then(function(){viewer.callEvent("onPageRender",[viewer.$pageNum]);viewer._pageRendering=false;if(viewer._pageNumPending!==null){viewer._renderPage(viewer._pageNumPending);viewer._pageNumPending=null}})})},_queueRenderPage:function(num){if(this._pageRendering)this._pageNumPending=num;else this._renderPage(num)},renderPage:function(num){if(!this.$pdfDoc||num<0||num>this.$numPages)return;this.$pageNum=num;this._queueRenderPage(this.$pageNum)},prevPage:function(){if(this.$pageNum<=1)return;this.$pageNum--;this._queueRenderPage(this.$pageNum)},nextPage:function(){if(this.$pageNum>=this.$numPages)return;this.$pageNum++;this._queueRenderPage(this.$pageNum)},zoomIn:function(){var newScale=this._settings.scale;newScale=(newScale*this._default_scale_delta).toFixed(2);newScale=Math.ceil(newScale*10)/10;newScale=Math.min(this._max_scale,newScale);this.setScale(newScale,true)},zoomOut:function(){var newScale=this._settings.scale;newScale=(newScale/this._default_scale_delta).toFixed(2);newScale=Math.floor(newScale*10)/10;newScale=Math.max(this._min_scale,newScale);this.setScale(newScale,true)},_getScale:function(value){if(!isNaN(parseFloat(value)))return value;if(isNaN(parseFloat(this._settings.scale)))this._settings.scale=this._init_scale_value;var scale=1;var pageWidthScale=((this._currentPage.clientWidth-this._hPadding)*this._settings.scale/this._canvas.clientWidth).toFixed(2);var pageHeightScale=((this._currentPage.clientHeight-this._vPadding)*this._settings.scale/this._canvas.clientHeight).toFixed(2);switch(value){case"page-actual":scale=1;break;case"page-width":scale=pageWidthScale;break;case"page-height":scale=pageHeightScale;break;case"page-fit":scale=Math.min(pageWidthScale,pageHeightScale);break;case"auto":var isLandscape=this._currentPage.clientWidth>this._currentPage.clientHeight;var horizontalScale=isLandscape?Math.min(pageHeightScale,pageWidthScale):pageWidthScale;scale=Math.min(this._max_auto_scale,horizontalScale);break}return scale},setScale:function(value,update){if(!isNaN(parseFloat(value))){this._setScale(value,update)}else{var scale=this._getScale(value);this._setScale(scale,update)}},_setScale:function(newScale,update){this._settings.scale=newScale;this.renderPage(this.$pageNum);this.callEvent("onScaleChange",[newScale,update])},download:function(){if(!this.$pdfDoc)return;var filename=(this._settings.downloadName||"document")+".pdf";this.$pdfDoc.getData().then(function(data){var blob=PDFJS.createBlob(data,"application/pdf");webix.html.download(blob,filename)})},clear:function(){if(this.$pdfDoc){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height);this._container.style.height=this._container.style.width=this._canvas.width=this._canvas.height=0;this._settings.scale="auto";this.$pageNum=this.$numPages=0;this.$pdfDoc.transport.startCleanup();this.$pdfDoc.destroy();this.$pdfDoc=null;if(this._settings.toolbar&&webix.$$(this._settings.toolbar))webix.$$(this._settings.toolbar).reset()}}},webix.EventSystem,webix.AtomDataLoader,webix.ui.view);webix.protoUI({name:"pdfbar",reset:function(){this.setPage(0);this.setValues(0,"auto")},$init:function(config){this.$view.className+=" pdf_bar";config.cols=[{view:"button",type:"icon",icon:"arrow-left",width:35,click:function(){this.getParentView()._navigate("prev")}},{view:"text",width:70,value:"0",on:{onBlur:function(){this.getParentView()._navigate(this.getValue())},onKeyPress:function(code){if(code===13)this.getParentView()._navigate(this.getValue())}}},{template:webix.i18n.PDFviewer.of+" #limit#",width:70,data:{limit:0},borderless:true},{view:"button",type:"icon",icon:"arrow-right",width:35,click:function(){this.getParentView()._navigate("next")}},{},{view:"button",type:"icon",icon:"minus",width:35,click:function(){this.getParentView().zoom("out")}},{view:"richselect",options:[],maxWidth:195,suggest:{padding:0,css:"pdf_opt_list",borderless:true,body:{type:{height:25},scroll:false,yCount:13}},on:{onChange:function(){this.getParentView().setMasterScale(this.getValue())}}},{view:"button",type:"icon",icon:"plus",width:35,click:function(){this.getParentView().zoom("in")}},{view:"button",type:"icon",icon:"download",width:35,click:function(){this.getParentView().download()}}];this.$ready.push(this._setScaleOptions)},_setScaleOptions:function(){var list=this.getChildViews()[6].getPopup().getBody();list.clearAll();list.parse([{id:"auto",value:webix.i18n.PDFviewer.automaticZoom},{id:"page-actual",value:webix.i18n.PDFviewer.actualSize},{id:"page-fit",value:webix.i18n.PDFviewer.pageFit},{id:"page-width",value:webix.i18n.PDFviewer.pageWidth},{id:"page-height",value:webix.i18n.PDFviewer.pageHeight},{id:"0.5",value:"50%"},{id:"0.75",value:"75%"},{id:"1",value:"100%"},{id:"1.25",value:"125%"},{id:"1.5",value:"150%"},{id:"2",value:"200%"},{id:"3",value:"300%"},{id:"4",value:"400%"}]);var width=0;list.data.each(function(obj){width=Math.max(webix.html.getTextSize(obj.value,"webixbutton").width,width)});this.getChildViews()[6].define("width",width+20);this.getChildViews()[6].resize()},_navigate:function(num){this.setMasterPage(num);this.setPage(this.$master.$pageNum)},setScale:function(scale){var sel=this.getChildViews()[6];sel.blockEvent();if(sel.getPopup().getList().exists(scale))sel.setValue(scale);else{sel.setValue("");sel.getInputNode().innerHTML=(scale*100).toFixed(0)+"%"}sel.unblockEvent()},setMasterScale:function(value){if(!this.$master)return;this.$master.setScale(value)},setMasterPage:function(num){if(!this.$master)return;if(num==="prev")this.$master.prevPage();else if(num==="next")this.$master.nextPage();else if(!isNaN(parseInt(num)))this.$master.renderPage(parseInt(num))},zoom:function(dir){if(!this.$master)return;if(dir==="out")this.$master.zoomOut();else if(dir==="in")this.$master.zoomIn()},setPage:function(num){this.getChildViews()[1].setValue(num)},setValues:function(num,scale){this.getChildViews()[2].data.limit=num;this.getChildViews()[2].refresh();this.setScale(scale)},download:function(){if(!this.$master)return;this.$master.download()}},webix.ui.toolbar);webix.protoUI({name:"excelbar",defaults:{padding:0,type:"line"},$init:function(config){config.cols=[{view:"tabbar",options:[""],optionWidth:200,on:{onaftertabclick:function(){this.getParentView().callEvent("onExcelSheetSelect",[this.getValue()])}}}]},getValue:function(){return this.getInput().getValue()},setValue:function(value){return this.getInput().setValue(value)},getInput:function(){return this.getChildViews()[0]},setSheets:function(sheets){var input=this.getInput();input.config.options=sheets;input.refresh()}},webix.ui.toolbar);webix.protoUI({name:"excelviewer",$init:function(){this.$ready.push(function(){if(this._settings.toolbar)webix.$$(this._settings.toolbar).attachEvent("onExcelSheetSelect",webix.bind(this.showSheet,this))})},defaults:{datatype:"excel"},$onLoad:function(data){if(data.sheets){this._excel_data=data;if(this._settings.toolbar)webix.$$(this._settings.toolbar).setSheets(data.names);var now=data.names[0];this.showSheet(now.id||now);return true}return false},showSheet:function(name){this.clearAll();var obj=this.data.driver.sheetToArray(this._excel_data.sheets[name],{spans:this._settings.spans});var header=this._settings.excelHeader;var letters="ABCDEFGHIJKLMNOPQRSTUVWXYZ";if(!header){header=webix.copy(obj.data[0]);for(var i=0;i<header.length;i++)header[i]={header:letters[i],id:"data"+i,adjust:true,editor:"text",sort:"string"}}else if(header===true){header=obj.data.splice(0,1)[0];for(var i=0;i<header.length;i++)header[i]={header:header[i],id:"data"+i,adjust:true,editor:"text",sort:"string"}}else header=webix.copy(header);this.config.columns=header;this.refreshColumns();this.parse(obj,this._settings.datatype);if(this._settings.spans&&obj.spans)this._paintSpans(obj.spans)},_paintSpans:function(spans){if(spans.length){this._spans_pull={};for(var i=0;i<spans.length;i++){if(this.config.excelHeader)spans[i][0]--;if(spans[i][0]>=0){spans[i][0]=this.getIdByIndex(spans[i][0]);spans[i][1]="data"+spans[i][1]}}this.addSpan(spans);this.refresh()}}},webix.ui.datatable);webix.DataDriver.excel=webix.extend({toObject:function(data){if(!data.excel){var opts=data.options||{};if(opts.dataurl)webix.extend(opts,this._urlToOptions(opts.dataurl));data=data.data||data;var promise=webix.promise.defer();if(data.name){opts.ext=data.name.split(".").pop();var reader=new FileReader;reader.onload=webix.bind(function(e){promise.resolve(this.parseData(e.target.result,opts))},this);reader.readAsArrayBuffer(data)}else promise.resolve(this.parseData(data,opts));return promise}return data},parseData:function(data,options){data=new Uint8Array(data);var arr=[];for(var i=0;i!=data.length;++i)arr[i]=String.fromCharCode(data[i]);var ext=(options.ext||options).toLowerCase();if(ext!="xls")ext="xlsx";return webix.require(webix.cdn+"/extras/"+ext+".core.min.js").then(webix.bind(function(){var workbook=ext=="xls"?XLS.read(arr.join(""),{type:"binary"}):XLSX.read(arr.join(""),{type:"binary"});var res={sheets:workbook.Sheets,names:workbook.SheetNames,options:options};return webix.extend(this.getSheet(res,options),res)},this))},getSheet:function(data,options){var name=options.name||data.names[0];data=this.sheetToArray(data.sheets[name],options);if(options.rows&&options.rows.length)data.data=data.data.splice(options.rows[0],Math.min(options.rows[1],data.data.length)-options.rows[0]);return data},sheetToArray:function(sheet,options){var all=[];var spans=[];if(sheet["!ref"]){var range=XLS.utils.decode_range(sheet["!ref"]),row,col,cellCoord,cell;for(row=range.s.r;row<=range.e.r;row++){var nrow=[];for(col=range.s.c;col<=range.e.c;col++){cellCoord=XLS.utils.encode_cell({r:row,c:col});cell=sheet[cellCoord];if(!cell)nrow.push("");else{var ncell="";if(options.math&&cell.f)ncell=cell.f.charAt(0)=="="?cell.f:"="+cell.f;else ncell=cell.t=="n"&&cell.w&&cell.v!=cell.w?cell.w:cell.v;nrow.push(ncell)}}all.push(nrow)}}if(sheet["!merges"]){var merges=sheet["!merges"];var full={data:all,spans:[]};for(var i=0;i<merges.length;i++){var s=merges[i].s;var e=merges[i].e;var sl=options.rows?options.rows[0]:0;spans.push([s.r+sl,s.c,e.c-s.c+1,e.r-s.r+1])}}return{data:all,spans:spans,excel:true}},_urlToOptions:function(details){var parts=details.split("[");var options={};options.name=parts[0];if(parts[1]){var rows=parts[1].split(/[^0-9]+/g);rows[0]=rows[0]*1||0;rows[1]=rows[1]||9999999;options.rows=rows}return options}},webix.DataDriver.jsarray);webix.protoUI({name:"treemap",defaults:{activeItem:false,subRender:true,header:true,headerHeight:35,value:webix.template("#value#"),headerTemplate:"",navigation:true},value_setter:webix.template,headerTemplate_setter:webix.template,header_setter:function(value){if(value&&value!==true){this.type.header=value}return value},$init:function(config){this.$view.className+=" webix_treemap";this._viewobj.setAttribute("role","tree");this._htmlElement=document.createElement("DIV");webix.extend(this.data,webix.TreeStore,true);this.data.provideApi(this,true);this.data.attachEvent("onClearAll",webix.bind(function(){this._html="";this.$values={};this.$xy={}},this));this.attachEvent("onKeyPress",this._onKeyPress)},_toHTMLItem:function(obj){var mark=this.data._marks[obj.id];this.callEvent("onItemRender",[obj]);var template=obj.$template?this.type["template"+obj.$template].call(this,obj,this.type,mark):this.type.template.call(this,obj,this.type,mark);return this.type.templateStart.call(this,obj,this.type,mark)+template+this.type.templateEnd.call(this)},_renderHeader:function(id){var item=this.getItem(id);var height=this._settings.headerHeight;var html="<div class='webix_treemap_header' style='height:"+height+"px;line-height:"+height+"px;'>";html+=this.type.header.call(this,item,this.type);html+="</div>";return html},_renderBranch:function(pId){var i,id,item,sizes,row,value,sum,leaves=[];if(!this.$width||!this.count()){this._html="";return false}if(!pId){pId=this.config.branch||0;this._html="";this.$values={};this.$xy={};this.$xy[pId]={width:this.$width,height:this.$height,top:0,left:0};if(pId&&this._settings.header){this.$xy[pId].height-=this._settings.headerHeight;this.$xy[pId].top=this._settings.headerHeight;this._html+=this._renderHeader(pId)}sum=0;this.data.each(function(item){var parentId=this.getParentId(item.id);if(!this.data.branch[item.id]){value=this.config.value.call(this,item)*1;if(!isNaN(value)&&value){this.$values[item.id]=value;sum+=value;while(parentId){if(!this.$values[parentId])this.$values[parentId]=0;this.$values[parentId]+=value;parentId=this.getParentId(parentId)}}}},this,false,pId)}this.data.eachChild(pId,function(item){if(this.$values[item.id])leaves.push(webix.copy(item))},this);sum=sum||this.$values[pId];if(leaves.length&&sum){sizes=this.$xy[pId];row={top:sizes.top,left:sizes.left,dx:sizes.width,dy:sizes.height,set:[],sum:0};row.dim=Math.min(row.dx,row.dy);var delta=row.dx*row.dy/sum;for(i=0;i<leaves.length;i++)leaves[i].$value=this.$values[leaves[i].id]*delta;leaves.sort(function(a,b){return a.$value>b.$value?-1:1});var bad=Infinity;var i=0;while(leaves[i]){var check=this._worst(row,leaves[i]);if(check<bad){row.sum+=leaves[i].$value;row.set.push(leaves[i]);bad=check;i++}else{this._renderRow(row);var r={top:row.top,left:row.left,dx:row.dx,dy:row.dy,set:[],sum:0};var delta=row.sum/row.dim;if(row.dx>row.dy){r.left+=delta;r.dx-=delta}else{r.top+=delta;r.dy-=delta}row=r;row.dim=Math.min(row.dx,row.dy);bad=Infinity}}}if(row)this._renderRow(row)},_renderRow:function(row){var i,id,item,x,y,top=row.top,left=row.left;row.mode=row.dy<row.dx;row.contra=row.sum/row.dim;for(i=0;i<row.set.length;i++){id=row.set[i].id;if(row.mode){x=row.contra;y=row.set[i].$value/row.contra}else{x=row.set[i].$value/row.contra;y=row.contra}this.$xy[id]={};this.$xy[id].top=top;this.$xy[id].left=left;if(row.mode)top+=y;else left+=x;this.$xy[id].width=x;this.$xy[id].height=y;this._html+=this._toHTMLItem(this.getItem(id));if(this._settings.subRender&&this.data.branch[id])this._renderBranch(id)}},_worst:function(row,add){var s=row.sum+add.$value;var a=s*s/(row.dim*row.dim*add.$value);if(row.set.length){a=Math.max(row.dim*row.dim*row.set[0].$value/(s*s),a)}return a>1?a:1/a},_toHTMLObject:function(obj){this._htmlElement.innerHTML=this._toHTMLItem(obj);return this._htmlElement.firstChild},showBranch:function(id){this._settings.branch=id;this.refresh()},render:function(id,data,type){if(!this.isVisible(this._settings.id)||this.$blockRender)return;if(type=="update"){var cont=this.getItemNode(id);if(cont){var t=this._htmlmap[id]=this._toHTMLObject(data);webix.html.insertBefore(t,cont);webix.html.remove(cont)}}else if(this.data.branch&&(!this._settings.branch||this.data.branch[this._settings.branch])){this._htmlmap=null;this.callEvent("onBeforeRender",[]);this._renderBranch();this._dataobj.innerHTML=this._html;this.callEvent("onAfterRender",[])}return true},_id:"webix_dm_id",on_click:{webix_treemap_item:function(e,id){if(this._settings.select){if(this._settings.select=="multiselect"||this._settings.multiselect)this.select(id,false,e.ctrlKey||e.metaKey||this._settings.multiselect=="touch",e.shiftKey);else this.select(id)}if(this._settings.activeItem&&this.isBranch(id)){this.showBranch(id)}},webix_treemap_header_item:function(e){var id=webix.html.locate(e,"webix_dm_header_id");this.define("branch",id);this.refresh()},webix_treemap_reset:function(e){this.define("branch",0);this.refresh()}},on_dblclick:{},on_mouse_move:{},_getCssText:function(style){var css="";for(var property in style){css+=property+":"+style[property]+";"}return css},type:{template:webix.template("#value#"),header:function(obj,common){var id=obj.id;var resetIcon="<div role='button' tabindex='0' aria-label='"+webix.i18n.aria.resetTreeMap+"' class='webix_treemap_reset'></div>";var arr=[];while(id){obj=this.getItem(id);arr.push(common.headerItem.call(this,obj,common));id=this.getParentId(id)}arr.reverse();return resetIcon+arr.join("<span class='webix_icon fa-angle-right webix_treemap_path_icon'></span>")},headerItem:function(obj){var template=this.config.headerTemplate(obj);var html='<a role="button" tabindex="0" aria-label="'+template+'" webix_dm_header_id="'+obj.id+'" class="webix_treemap_header_item">';html+=template;html+="</a>";return html},classname:function(obj,common,marks){var css="webix_treemap_item";if(common.css)css+=common.css+" ";if(obj.$css){if(typeof obj.$css=="object")obj.$css=webix.html.createCss(obj.$css);css+=" "+obj.$css}var xy=this.$xy[obj.id];if(marks&&marks.$css)css+=" "+marks.$css;css+=" webix_treemap_level_"+this.getItem(obj.id).$level;var parentId=this.getParentId(obj.id);if(!parentId||parentId==this._settings.branch)css+=" webix_treemap_level_top";if(this.$height-xy.top-xy.height<1)css+=" webix_treemap_item_bottom";if(this.$width-xy.left-xy.width<1)css+=" webix_treemap_item_right";if(common.cssClass){var cssClass=common.cssClass.call(this,obj,common,marks);if(cssClass){if(typeof cssClass=="object"){css+=" "+webix.html.createCss(cssClass)}else css+=" "+cssClass}}return css},templateStart:function(obj,type,marks){var className="",style="";if(this.$xy){var xy=this.$xy[obj.id];style+="width: "+xy.width+"px; height: "+xy.height+"px;";style+="top: "+xy.top+"px; left: "+xy.left+"px;"}return'<div role="treeitem" aria-level="'+obj.$level+'" '+(marks&&marks.webix_selected?'aria-selected="true" tabindex="0"':"")+' webix_dm_id="'+obj.id+'" class="'+type.classname.call(this,obj,type,marks)+'" style="'+style+'">'},templateEnd:webix.template("</div>")}},webix.AutoTooltip,webix.Group,webix.TreeAPI,webix.SelectionModel,webix.KeysNavigation,webix.MouseEvents,webix.Scrollable,webix.TreeDataLoader,webix.ui.proto,webix.TreeRenderStack,webix.CopyPaste,webix.EventSystem);webix.extend(webix.ui.datatable,{_init_areaselect:function(){this._arSelCheckKeys=true;this._areaSelStorage={};this.define("select","area");this.attachEvent("onAfterScroll",function(){this.refreshSelectArea()});this.attachEvent("onAfterRender",function(){this.refreshSelectArea()});this.attachEvent("onBeforeColumnHide",function(column){this._areaSelHiddenIndex=this.getColumnIndex(column)});this.attachEvent("onAfterColumnHide",function(){this._excludeColumnFromAreas(this._areaSelHiddenIndex)});this._bs_do_select=function(start,end,stopped,ev){if(start.row&&end.row){if(stopped){this.addSelectArea(start,end,true);this._arSelCheckKeys=true;return false}else{if(this.callEvent("onAreaDrag",[start,end,ev])){if(!this._activeAreaSName){if(this._arSelCheckKeys&&!(this._settings.multiselect&&ev&&ev.ctrlKey)){this.removeSelectArea();this._arSelCheckKeys=false}}else{this._removeAreaNodes(this._activeAreaSName)}}else return false}}};this.attachEvent("onBeforeAreaAdd",this._span_correct_range);webix._event(this._body,"mousedown",this._ars_down,{bind:this})},_block_sel_flag:true,_excludeColumnFromAreas:function(index){var areas=this._areaSelStorage;for(var a in areas){var area=areas[a];if(this.getColumnIndex(area.start.column)<0){if(area.start.column==area.end.column)this.removeSelectArea(area.name);else{var id=this.columnId(index+1);if(id)this._updateSelectArea(area.name,{row:area.start.row,column:id},null)}}else if(this.getColumnIndex(area.end.column)<0){var id=this.columnId(index-1);if(id)this._updateSelectArea(area.name,null,{row:area.end.row,column:id})}}},_extendAreaRange:function(id,area,mode){var sci,eci,sri,eri,ci,ri,iri,ici;if(area){sci=this.getColumnIndex(area.start.column);eci=this.getColumnIndex(area.end.column);sri=this.getIndexById(area.start.row);eri=this.getIndexById(area.end.row);ci=this.getColumnIndex(id.column);ri=this.getIndexById(id.row);iri=this.getIndexById(area.init.row);ici=this.getColumnIndex(area.init.column);if(sci>ci||mode=="left"){if(mode==="left"&&eci>ici)eci--;else sci=ci}else if(eci<=ci||mode=="right"){if(mode=="right"&&sci<ici)sci++;else eci=ci}if(sri>ri||mode=="up"){if(mode=="up"&&eri>iri)eri--;else sri=ri}else if(eri<ri||mode=="down"){if(mode=="down"&&sri<iri)sri++;else eri=ri}var start={row:this.getIdByIndex(sri),column:this.columnId(sci)};var end={row:this.getIdByIndex(eri),column:this.columnId(eci)};if(this.callEvent("onBeforeBlockSelect",[start,end,true])){this._updateSelectArea(area.name,start,end);this.callEvent("onSelectChange",[]);this.callEvent("onAfterBlockSelect",[start,end])}}},_updateSelectArea:function(name,start,end){var area=this._areaSelStorage[name];if(!area)return false;var range={start:start||area.start,end:end||area.end};this._span_correct_range(range);webix.extend(area,range,true);this.refreshSelectArea()},areaselect_setter:function(value){if(value){this._init_areaselect();this._init_areaselect=function(){}}this.define("blockselect",value);return value},addSelectArea:function(start,end,preserve,name,css,handle){var i0,i1,j0,j1,temp;i0=this.getIndexById(start.row);i1=this.getIndexById(end.row);j0=this.getColumnIndex(start.column);j1=this.getColumnIndex(end.column);if(i0>i1){temp=i0;i0=i1;i1=temp}if(j0>j1){temp=j0;j0=j1;j1=temp}name=name||this._activeAreaSName||webix.uid();this._activeAreaSName=null;var area={start:{row:this.getIdByIndex(i0),column:this.columnId(j0)},end:{row:this.getIdByIndex(i1),column:this.columnId(j1)}};if(css)area.css=css;if(handle||handle===false)area.handle=handle;if(this._areaSelStorage[name]){return this._updateSelectArea(name,area.start,area.end)}else{area.handle=true}area.name=name;area.init=area.start;if(this.callEvent("onBeforeAreaAdd",[area])){this._lastDefArea=name;if(!preserve)this.removeSelectArea();this._areaSelStorage[area.name]=area;this._selected_areas.push(area);this.refreshSelectArea();this.callEvent("onAfterAreaAdd",[area]);this.callEvent("onSelectChange",[])}},_renderSelectAreaBox:function(){var box=webix.html.create("DIV");box.className="webix_area_selection_layer";box.style.top=this._render_scroll_shift+"px";return box},refreshSelectArea:function(){var xr,yr,name,range,r0,r1,c0,c1,center=null,left=null,right=null,prerender=this._settings.prerender;if(!this._render_full_rows)return;xr=this._get_x_range(prerender);yr=this._get_y_range(prerender===true);if(!this._rselect_box){this._rselect_box=this._renderSelectAreaBox();this._body.childNodes[1].appendChild(this._rselect_box);this._rselect_box_left=this._renderSelectAreaBox();this._body.childNodes[0].appendChild(this._rselect_box_left);this._rselect_box_right=this._renderSelectAreaBox();this._body.childNodes[2].appendChild(this._rselect_box_right)}this._rselect_box.innerHTML="";this._rselect_box_left.innerHTML="";this._rselect_box_right.innerHTML="";var leftSplit=this._settings.leftSplit;var rightSplit=this._settings.rightSplit;for(name in this._areaSelStorage){range=this._areaSelStorage[name];var ind=this._calcAreaSelectIndexes(range,xr,yr);if(ind===null){this.removeSelectArea(name);continue}var startIndex=this.getColumnIndex(range.start.column);var endIndex=this.getColumnIndex(range.end.column);if(ind.r0<=ind.r1){if(this._settings.topSplit&&r0>=this._settings.topSplit&&r1<this._render_scroll_top)return false;if(startIndex<leftSplit)left=this._getSelectAreaCellPositions(ind.r0,startIndex,ind.r1,Math.min(endIndex,leftSplit-1));if(ind.c0<=ind.c1)center=this._getSelectAreaCellPositions(ind.r0,ind.c0,ind.r1,ind.c1);if(rightSplit&&endIndex>=this._rightSplit)right=this._getSelectAreaCellPositions(ind.r0,Math.max(startIndex,this._rightSplit),ind.r1,endIndex);if(left||center||right)this._setSelectAreaBorders(left,center,right,name,range.css,range.handle)}}},_calcAreaSelectIndexes:function(range,xr,yr){var r0,r1,c0,c1;var startIndex=this.getIndexById(range.start.row);var endIndex=this.getIndexById(range.end.row);var startColumn=this.getColumnIndex(range.start.column);var endColumn=this.getColumnIndex(range.end.column);if(startColumn===-1||endColumn===-1)return null;if(startIndex===-1||endIndex===-1)return null;r1=Math.min(yr[1],endIndex);if(this._settings.topSplit){r0=startIndex;if(r0>=this._settings.topSplit)r0=Math.max(yr[0]-this._settings.topSplit,startIndex);if(r1>=this._settings.topSplit){var endPos=this._cellPosition(this.getIdByIndex(endIndex),range.end.column);var splitPos=this._cellPosition(this.getIdByIndex(this._settings.topSplit-1),range.end.column);if(splitPos.top+splitPos.height>endPos.top+endPos.height)r1=this._settings.topSplit-1}}else r0=Math.max(yr[0],this.getIndexById(range.start.row));c0=Math.max(xr[0],startColumn);c1=Math.min(this._rightSplit?xr[1]-1:xr[1],endColumn);return{r0:r0,r1:r1,c0:c0,c1:c1}},_getSelectAreaCellPositions:function(i0,j0,i1,j1){var start=this._cellPosition(this.getIdByIndex(i0),this.columnId(j0));var end=this._cellPosition(this.getIdByIndex(i1),this.columnId(j1));return[start,end]},_setSelectAreaBorders:function(left,center,right,name,css,handle){var handleBox,handlePos,area=this._areaSelStorage[name],offset=0;if(this._settings.topSplit)offset=this._getTopSplitOffset(area.start,true);var renderArea=function(parentNode,start,end,skipLeft,skipRight){var bName,height,width,top,left,hor,borders={top:1,right:1,bottom:1,left:1};if(skipLeft)delete borders.left;if(skipRight)delete borders.right;height=end.top-start.top+end.height-1;width=end.left-start.left+end.width;for(bName in borders){top=start.top+offset;if(bName=="bottom")top=end.top+end.height;left=start.left;if(bName=="right"){left=end.left+end.width}hor=bName=="top"||bName=="bottom";parentNode.appendChild(webix.html.create("DIV",{class:"webix_area_selection webix_area_selection_"+bName+(css?" "+css:""),style:"left:"+left+"px;top:"+top+"px;"+(hor?"width:"+width+"px;":"height:"+(height-offset)+"px;"),webix_area_name:name},""));var elem=parentNode.lastChild;if(bName=="right")elem.style.left=left-elem.offsetWidth+"px";if(bName=="bottom")elem.style.top=top-elem.offsetHeight+"px"}};if(right)renderArea(this._rselect_box_right,right[0],right[1],!!center,false);if(center)renderArea(this._rselect_box,center[0],center[1],!!left,!!right);if(left)renderArea(this._rselect_box_left,left[0],left[1],false,!!center);if(handle){handlePos=right?right[1]:center?center[1]:left[1];handleBox=right?this._rselect_box_right:center?this._rselect_box:this._rselect_box_left;handleBox.appendChild(webix.html.create("DIV",{class:"webix_area_selection_handle"+(css?" "+css:""),style:"left:"+(handlePos.left+handlePos.width)+"px;top:"+(handlePos.top+handlePos.height)+"px;",webix_area_name:name},""))}},_removeAreaNodes:function(name){if(name){var removeNodes=function(parentNode){var nodes=parentNode.childNodes;for(var i=nodes.length-1;i>=0;i--){if(nodes[i].getAttribute("webix_area_name")==name){parentNode.removeChild(nodes[i])}}};removeNodes(this._rselect_box);removeNodes(this._rselect_box_left);removeNodes(this._rselect_box_right)}},removeSelectArea:function(name){if(name){if(this.callEvent("onBeforeAreaRemove",[name])){delete this._areaSelStorage[name];this._removeAreaNodes(name);this._selected_areas=[];for(var key in this._areaSelStorage)this._selected_areas.push(this._areaSelStorage[key]);this.callEvent("onAfterAreaRemove",[name])}}else{for(var n in this._areaSelStorage)this.removeSelectArea(n)}},_ars_down:function(e){var src=e.target||e.srcElement;var css=webix.html._getClassName(src);if(css&&css.indexOf("webix_area_selection_handle")!=-1){var name=src.getAttribute("webix_area_name");this._activeAreaSName=name;var area=this._areaSelStorage[name];var pos0=this._cellPosition(area.start.row,area.start.column);var pos1=this._cellPosition(area.end.row,area.end.column);var prerender=this._settings.prerender;var xCorrStart=this.getColumnIndex(area.start.column)<this._settings.leftSplit?0:this._left_width;var xCorrEnd=this.getColumnIndex(area.end.column)<this._settings.leftSplit?0:this._left_width;this._bs_ready=[pos0.left+1+xCorrStart-this._scrollLeft,pos0.top+1-(prerender?this._scrollTop:0),{row:area.start.row,column:area.start.column}];this._bs_start(e);this._bs_progress=[pos1.left+1+xCorrEnd-this._scrollLeft,pos1.top+1-(prerender?this._scrollTop:0)];this._bs_select(false,false);return webix.html.preventEvent(e)}},getSelectArea:function(name){return this._areaSelStorage[name||this._lastDefArea]},getAllSelectAreas:function(){return this._areaSelStorage},_span_correct_range:function(range){if(!this.config.spans)return true;var i,j,c0,c1,r0,r1,span,spanR0,spanC0,minR0,minC0,maxR1,maxC1,changed=false,start=range.start,end=range.end;minR0=r0=this.getIndexById(start.row);minC0=c0=this.getColumnIndex(start.column);maxR1=r1=this.getIndexById(end.row);maxC1=c1=this.getColumnIndex(end.column);for(i=r0;i<=r1;i++){for(j=c0;j<=c1;j++){span=this.getSpan(this.getIdByIndex(i),this.columnId(j));if(span){spanR0=this.getIndexById(span[0]);spanC0=this.getColumnIndex(span[1]);if(spanR0<minR0){minR0=spanR0;changed=true}if(spanC0<minC0){changed=true;minC0=spanC0}if(spanR0+span[3]-1>maxR1){changed=true;maxR1=spanR0+span[3]-1}if(spanC0+span[2]-1>maxC1){changed=true;maxC1=spanC0+span[2]-1}}}}if(changed){range.start={row:this.getIdByIndex(minR0),column:this.columnId(minC0)};range.end={row:this.getIdByIndex(maxR1),column:this.columnId(maxC1)};this._span_correct_range(range)}}});webix.protoUI({name:"rangechart",$init:function(){this.attachEvent("onAfterRender",this._init_frame);this._set_full_range()},_init_frame:function(){webix.assert(this._settings.type.indexOf("pie")===-1&&this._settings.type!=="radar"&&this._settings.type!=="donut","Not suppored chart type");if(!this._map._areas.length||this._frame){this._setHandle(true);return}this._setMap();this._item_radius=(this._map._areas[0].points[2]-this._map._areas[0].points[0])/2;this._rHandle=webix.html.create("div",{class:"webix_chart_resizer right",tabindex:"0",role:"button","aria-label":webix.i18n.aria.resizeChart});this._lHandle=webix.html.create("div",{class:"webix_chart_resizer left",tabindex:"0",role:"button","aria-label":webix.i18n.aria.resizeChart});this._frame=webix.html.create("div",{class:"webix_chart_frame"});this._viewobj.appendChild(this._lHandle);this._viewobj.appendChild(this._frame);this._viewobj.appendChild(this._rHandle);this._setHandle();webix._event(this._rHandle,webix.env.mouse.down,this._frDown,{bind:this});webix._event(this._lHandle,webix.env.mouse.down,this._frDown,{bind:this});webix._event(this._frame,webix.env.mouse.down,this._frDown,{bind:this});webix._event(webix.toNode(this._rHandle),"keydown",this._keyShift,{bind:this});webix._event(webix.toNode(this._lHandle),"keydown",this._keyShift,{bind:this});if(this._value)this._settings.range=this._set_full_range(this._value);this._refresh_range();this.callEvent("onAfterRangeChange",[this._value]);this.data.attachEvent("onStoreUpdated",webix.bind(this._refresh_range,this))},$setSize:function(x,y){if(webix.ui.chart.prototype.$setSize.call(this,x,y))this._setMap()},_setHandle:function(update){if(this._rHandle&&!this._handle_radius){this._handle_radius=this._rHandle.clientWidth/2;if(update)this._refresh_range()}},_setMap:function(){var bounds=this._getChartBounds(this._content_width,this._content_height);this._mapStart=bounds.start;this._mapEnd=bounds.end},removeAllSeries:function(){this._frame=this._rHandle=this._lHandle=null;webix.ui.chart.prototype.removeAllSeries.apply(this,arguments)},_keyShift:function(e){var code=e.which||e.keyCode;if(code===37||code===39){webix.html.preventEvent(e);var index=e.target.className.indexOf("right")!==-1?"eindex":"sindex";var id=e.target.className.indexOf("right")!==-1?"end":"start";var range=this._value;range[index]=range[index]+(code===37?-1:1);if(this._map._areas[range[index]]){range[id]=this._get_id_by_index(range[index]);this.setFrameRange(range)}}},_frDown:function(e){if(e.target.className.indexOf("webix_chart_resizer")!==-1)this._activeHandle=e.target;else if(this._map._areas.length){var spos=this._map._areas[this._value.sindex].points[2]-this._item_radius;var epos=this._map._areas[this._value.eindex].points[2];this._activeFrame={ex:webix.html.pos(e).x,fx:spos+this._mapStart.x,fw:epos-spos}}webix.html.addCss(this._viewobj,"webix_noselect webix_wresize_cursor");this._frClear();this._resizeHandlerMove=webix.event(document.body,webix.env.mouse.move,this._frMove,{bind:this});this._resizeHandlerUp=webix.event(document.body,webix.env.mouse.up,this._frUp,{bind:this})},_frClear:function(){if(webix._events[this._resizeHandlerMove]){webix.eventRemove(this._resizeHandlerMove);webix.eventRemove(this._resizeHandlerUp)}},_frMove:function(e){if(this._activeHandle){var pos_x=webix.html.pos(e).x-webix.html.offset(this.$view).x;if(pos_x>=this._mapStart.x&&pos_x<=this._mapEnd.x){if(this._activeHandle.className.indexOf("left")!==-1){if(pos_x<this._rHandle.offsetLeft){this._activeHandle.style.left=pos_x-this._handle_radius+"px";this._frame.style.left=pos_x+"px";this._frame.style.width=this._rHandle.offsetLeft-this._lHandle.offsetLeft-1+"px"}}else if(pos_x>this._lHandle.offsetLeft+this._handle_radius){this._activeHandle.style.left=pos_x-this._handle_radius+"px";this._frame.style.width=this._rHandle.offsetLeft-this._lHandle.offsetLeft-1+"px"}}}else if(this._activeFrame){var shift=webix.html.pos(e).x-this._activeFrame.ex;var lx=this._activeFrame.fx+shift;var rx=lx+this._activeFrame.fw;if(this._mapStart.x<=lx&&this._mapEnd.x>=rx){webix.extend(this._activeFrame,{lx:lx,rx:rx},true);this._lHandle.style.left=lx-this._handle_radius+"px";this._rHandle.style.left=rx-this._handle_radius+"px";this._frame.style.left=lx+"px"}}},_frUp:function(e){this._frClear();webix.html.removeCss(this._viewobj,"webix_noselect");webix.html.removeCss(this._viewobj,"webix_wresize_cursor");if(!this.count())return;if(this._activeHandle){var pos_x=webix.env.touch?e.changedTouches[0].pageX:webix.html.pos(e).x;pos_x-=webix.html.offset(this.$view).x+this._mapStart.x;var ind=this._get_index_by_pos(pos_x);var id=this._get_id_by_index(ind);if(this._activeHandle===this._lHandle){if(ind>=this._value.eindex){ind=this._value.eindex;id=this._get_id_by_index(ind)}this._value.start=id;this._value.sindex=ind}else{if(ind<=this._value.sindex){ind=this._value.sindex;id=this._get_id_by_index(ind)}this._value.end=id;this._value.eindex=ind}this._activeHandle=null}else if(this._activeFrame&&this._activeFrame.lx){var lind=this._value.sindex=this._get_index_by_pos(this._activeFrame.lx-this._mapStart.x);var rind=this._value.eindex=this._get_index_by_pos(this._activeFrame.rx-this._mapStart.x);this._value.start=this._get_id_by_index(lind);this._value.end=this._get_id_by_index(rind);this._activeFrame=null}this._refresh_range();this.callEvent("onAfterRangeChange",[this._value.start,this._value.end])},_get_id_by_index:function(ind){if(ind>=this.data.order.length)ind=this.data.order.length-1;return this.getItem(this.data.order[ind])[this._settings.frameId||"id"]},_get_index_by_pos:function(pos){var areas=this._map._areas;for(var i=0;i<areas.length;i++)if(pos<=areas[i].points[2]-this._item_radius)return i;return areas.length-1},_get_frame_index:function(value){var key=this._settings.frameId||"id";for(var i=0;i<this.data.order.length;i++)if(this.getItem(this.data.order[i])[key]==value)return i;return-1},_set_full_range:function(value){if(!value)value={start:0,end:0,sindex:0,eindex:0};else{if(value.start)value.sindex=this._get_frame_index(value.start);if(value.end)value.eindex=this._get_frame_index(value.end);value.start=value.start||this._get_id_by_index(value.sindex);value.end=value.end||this._get_id_by_index(value.eindex)}this._value=value},range_setter:function(value){this._set_full_range(value);return this._value},getFrameData:function(){var res=[];for(var i=this._value.sindex;i<=this._value.eindex;i++){var item=this.getItem(this.data.order[i]);if(item)res.push(item)}return res},setFrameRange:function(range){this._set_full_range(range);this._refresh_range();this.callEvent("onAfterRangeChange",[range])},_refresh_range:function(){if(!this._map)return;var areas=this._map._areas;if(areas.length){var sx=areas[this._value.sindex].points[0]+this._mapStart.x+this._item_radius-1;var ex=areas[this._value.eindex].points[0]+this._mapStart.x+this._item_radius-1;this._lHandle.style.left=sx-this._handle_radius+"px";this._rHandle.style.left=ex-this._handle_radius+"px";this._frame.style.left=sx+"px";this._frame.style.width=ex-sx+"px";this._settings.range=this._value}},getFrameRange:function(){return this._settings.range}},webix.ui.chart);webix.protoUI({name:"richtext",defaults:{label:"",labelWidth:80,labelPosition:"left"},$init:function(config){this.$ready.unshift(this._setLayout)},getInputNode:function(){return this.$view.querySelector(".webix_richtext_editor")},_button:function(name){return{view:"toggle",type:"iconButton",icon:name,name:name,id:name,label:webix.i18n.richtext[name],autowidth:true,action:name,click:this._add_data}},_setLayout:function(){var top=this;var editField={view:"template",css:"webix_richtext_container",borderless:true,template:"<div class='webix_richtext_editor' contenteditable='true'>"+this.getValue()+"</div>",on:{onAfterRender:function(){webix._event(top.getInputNode(),"input",function(){this.config.value=this.getInputNode().innerHTML},{bind:top});webix._event(top.getInputNode(),"keyup",function(){top._getselection()})}},onClick:{webix_richtext_editor:function(){top._getselection()}}};var editorToolbar={view:"toolbar",id:"toolbar",elements:[this._button("underline"),this._button("bold"),this._button("italic"),{}]};var rows=[editorToolbar,editField];if(this.config.labelPosition==="top"||!this.config.labelWidth){editorToolbar.elements.push({view:"label",label:this.config.label,align:"right"});this.rows_setter(rows)}else{this.config.borderless=true;this.cols_setter([{template:this.config.label||" ",width:this.config.labelWidth},{rows:rows}])}},_getselection:function(){var top=this;var bar=top.$$("toolbar");var sel;bar.setValues({italic:false,underline:false,bold:false});if(window.getSelection){sel=window.getSelection()}else{sel=document.selection.createRange()}for(var i=0;i<sel.rangeCount;++i){var range=sel.getRangeAt(i);if(top.$view.contains(this.getInputNode())){if(document.queryCommandState("bold")){top.$$("bold").setValue(true)}if(document.queryCommandState("underline")){top.$$("underline").setValue(true)}if(document.queryCommandState("italic")){top.$$("italic").setValue(true)}}}},refresh:function(){this.getInputNode().innerHTML=this.config.value},_execCommandOnElement:function(el,commandName){var sel,selText;if(window.getSelection()){sel=window.getSelection();selText=sel.toString().length}else{sel=document.selection.createRange();selText=sel.text.length}if(selText>0){for(var i=0;i<sel.rangeCount;++i){var range=sel.getRangeAt(i);if(!sel.isCollapsed){document.execCommand(commandName,false,"")}else{var textValue=sel.focusNode.textContent;var focusEl=sel.focusNode;var focustext=sel.anchorOffset;var wordBegining=textValue.substring(0,focustext).match(/[A-Za-z]*$/)[0];var wordEnd=textValue.substring(focustext).match(/^[A-Za-z]*/)[0];var startWord=focustext-wordBegining.length;var endWord=focustext+wordEnd.length;range.setStart(focusEl,startWord);range.setEnd(focusEl,endWord);sel.removeAllRanges();window.getSelection().addRange(range);document.execCommand(commandName,false,"")}}}},_add_data:function(){var style=this.config.action;var top=this.getTopParentView();var editableElement=top.getInputNode();if(this.$view.contains(this.getInputNode())){top._execCommandOnElement(editableElement,this.config.action)}},focus:function(){var editableElement=this.$view.querySelector(".webix_richtext_editor");editableElement.focus()},setValue:function(value){var old=this.config.value;this.config.value=value||"";if(old!==value)this.callEvent("onChange",[value,old]);this.refresh()},getValue:function(){var value=this.config.value;return value||(value===0?"0":"")}},webix.IdSpace,webix.ui.layout);webix.protoUI({name:"gage",defaults:{value:0,minRange:0,maxRange:100,minWidth:250,minHeight:200,smoothFlow:true,scale:3,stroke:7},$init:function(){this.$ready.push(webix.bind(this._setDefaultView,this));this.attachEvent("onDestruct",function(){this._circleGradient=this._gageGradientPoint=this._gage=null})},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)){this._refresh(this.config.value);this._animate(this.config.value)}},_refresh:function(){var curves=this.$view.querySelector(".webix_gage_curves"),gageInfo=this.$view.querySelector(".webix_gage_info"),kx=this.config.scale,x=this.$width;curves.setAttribute("r",x/kx);curves.setAttribute("strokeDasharray",Math.round(Math.PI*x/kx));curves.style.r=x/kx;curves.style.strokeDasharray=Math.round(Math.PI*x/kx);gageInfo.setAttribute("style","width: "+Math.round(x/kx*2)+"px;");this._gage.setAttribute("style","height: "+(x/kx+20)+"px;");this._circleGradient.setAttribute("r",x/kx);this._circleGradient.setAttribute("style","stroke-dasharray: "+Math.round(this.gradientLength*Math.PI*x/kx)+", 1900;");this._draw_line(curves.style.r)},_safeValue:function(value){return Math.min(Math.max(value,this._settings.minRange),this._settings.maxRange)},_draw_line:function(radius){var svgCoord=this.$width,arrowSpace=.05,value=this.config.value;value=this._safeValue(value);var currentChartValue=value-this.config.minRange;var degrees=Math.round(currentChartValue*180/(this.config.maxRange-this.config.minRange));if(degrees===0||degrees===180){this._gage.style.paddingTop="3px"}this._gageGradientPoint.style.transformOrigin=svgCoord/2-(.5+arrowSpace)+"px 0 0";this._gageGradientPoint.setAttribute("y1","0");this._gageGradientPoint.setAttribute("x1",Math.round(svgCoord*(.5+arrowSpace)));this._gageGradientPoint.setAttribute("y2",0);this._gageGradientPoint.setAttribute("x2",Math.round(svgCoord*(.5+arrowSpace/2)+parseInt(radius)))},_animate:function(value){var webixGageValue=this.$view.querySelector(".webix_gage-value");var currentChartValue=this._safeValue(value)-this.config.minRange;var degrees=Math.round(currentChartValue*180/(this.config.maxRange-this.config.minRange));var viewSize=this.$width;viewSize=Math.floor(viewSize/10);this.$view.style.fontSize=viewSize+"px";webixGageValue.innerHTML=value;this._circleGradient.style.stroke=this.color;this._circleGradient.setAttribute("stroke",this.color);this._gageGradientPoint.setAttribute("transform","rotate("+degrees+" "+this.$width/2+" 0)");this._gageGradientPoint.style.transform="rotate("+degrees+"deg)"},_setDash:function(){webix.assert(this.config.minRange<this.config.maxRange,"Invalid Range Values");this.gradientLength=(this._safeValue(this.config.value)-this.config.minRange)/(this.config.maxRange-this.config.minRange);var template=this.config.color;if(template){if(typeof template==="function")this.color=template.call(this,this.config.value);else this.color=template}else this.color="hsl("+(120-Math.round(this.gradientLength*120))+", 100%, 50%)";if(this.config.animation===true){this.defaultColor="hsl(125, 100%, 50%)"}else{this.defaultColor="hsl("+(120-Math.round(this.gradientLength*120))+", 100%, 50%)"}},_setDefaultView:function(){this.gradientLength=0;this._setDash();this.$view.innerHTML='<div class="webix_gage_label"><span>'+(this.config.label||"")+'</span></div><svg class="webix_gage" style="height:300px; position: relative;"><circle class="webix_gage_curves" r="0" cx="50%" cy="0" stroke="#EEEEEE" stroke-width="'+this.config.stroke+'%" fill="none"></circle><circle class="webix_gage_gradient" r="0" stroke="'+this.defaultColor+'" cx="50%" cy="0" stroke-width="'+this.config.stroke+'%" fill="none" style="stroke-dasharray: 0, 1900;"></circle><line class="webix_gage_gradient_point" x1="0" x2="0" y1="0" y2="0" style="stroke:#B0B0B0; stroke-width:4;"></line></svg><div class="webix_gage_info"><div class="webix_gage_min_range">'+this.config.minRange+'</div><div class="webix_gage_max_range">'+this.config.maxRange+'</div><div class="webix_gage_placeholder"><div class="webix_gage-value">'+this.config.value+'</div><div class="webix_gage_range_info">'+(this.config.placeholder||"")+"</div></div></div>";this._circleGradient=this.$view.querySelector(".webix_gage_gradient");this._gageGradientPoint=this.$view.querySelector(".webix_gage_gradient_point");this._gage=this.$view.querySelector(".webix_gage");if(this.isVisible()===true&&this.config.smoothFlow===true&&(webix.env.svganimation&&!webix.env.isEdge)){this._circleGradient.setAttribute("class","webix_gage_gradient webix_gage_animated");this._gageGradientPoint.setAttribute("class","webix_gage_gradient_point webix_gage_gradient_point_animated")}},setValue:function(value){this.config.value=value;this._setDash();this._refresh();this._animate(value)},getValue:function(){return this.config.value}},webix.EventSystem,webix.ui.view);webix.protoUI({name:"bullet",defaults:{color:"#394646",marker:false,layout:"x",barWidth:40,flowTime:500,labelWidth:150,stroke:8,bands:[{value:100,color:"#5be5d6"},{value:80,color:"#fff07e"},{value:60,color:"#fd8b8c"}],scale:{step:10}},label_setter:webix.template,placeholder_setter:webix.template,$init:function(obj){if(obj){if((!obj.layout||obj.layout==="x")&&!obj.height)obj.height=obj.scale===false?60:90;if(obj.layout==="y"&&!obj.width)obj.width=obj.scale===false?60:97}},scale_setter:function(config){config.step=config.step||10;config.template=webix.template(config.template||"#value#");return config},$setSize:function(x,y){if(webix.ui.view.prototype.$setSize.call(this,x,y)){this._setDefaultView(this._settings.layout==="y"?y:x);if(this._settings.value)this._animate(0,this._settings.value)}},_safeValue:function(value){return Math.min(Math.max(value,this._settings.minRange),this._settings.maxRange)},_animateFrame:function(timestamp){this._dt=timestamp-(this._time||timestamp);this._time=timestamp;var fps;if(this._settings.flowTime>this._dt){fps=this._settings.flowTime/this._dt}else{fps=this._settings.flowTime}if(fps>1e3||fps<5)fps=30;var step=(this._settings.value-this._prevValue)/fps;this._nowValue+=step;if(Math.abs(this._nowValue-this._settings.value)<Math.abs(step))this._nowValue=this._settings.value;if(this._nowValue!=this._settings.value){this._requestId=requestAnimationFrame(this._animateFrame.bind(this))}else{cancelAnimationFrame(this._requestId);this._requestId=null}this._bulletValue.setAttribute("width",Math.floor(this._nowValue*this._scale))},_animate:function(from,to){this._prevValue=this._nowValue=from;this._settings.value=to;var label=this._settings.label;if(label)this.$view.querySelector(".webix_bullet_header").textContent=label(this._settings);var placeholder=this._settings.placeholder;if(typeof placeholder==="function")this.$view.querySelector(".webix_bullet_subheader").textContent=placeholder(this._settings);if(this.isVisible()===true&&this._settings.smoothFlow===true&&window.requestAnimationFrame){if(!this._requestId)this._requestId=requestAnimationFrame(this._animateFrame.bind(this))}else{this._bulletValue.setAttribute("width",Math.floor(to*this._scale))}},_setAttr:function(tag,names,values){for(var i=0;i<names.length;i++)tag.setAttribute(names[i],values[i])},_createNS:function(tag,names,values){var ns="http://www.w3.org/2000/svg";var el=document.createElementNS(ns,tag);if(names)this._setAttr(el,names,values);return el},_dom:function(data){var top=this._createNS(data[0],data[1],data[2]);var child=data[3];if(child)for(var i=0;i<child.length;i++)top.appendChild(this._dom(child[i]));return top},_setView:function(){var id="d"+webix.uid();var svg=this._createNS("svg",["class"],["webix_bullet_graph_svg"]);var container=this._createNS("g");var containerBand=this._createNS("g");var value=this._createNS("rect",["x","y","width","height","class","style"],[this._leftStart,this._topStart,100,this._settings.stroke,"webix_bullet_value","filter:url(#"+id+");fill:"+this._settings.color]);var valueMarker=this._createNS("rect",["x","y","width","height","fill"],[0,5,3,this._settings.barWidth-10,"rgba(0,0,0,0.5)"]);var division=this._createNS("g",["stroke","stroke-width","fill"],["#8b94ac","2","none"]);var text=this._createNS("text",["text-anchor","stroke","fill"],["end","none","#8b94ac"]);var left=this._settings.layout=="y"?"50%":this._leftStart-10;var top=this._settings.layout=="y"?11:17;var textRow1=this._createNS("tspan",["x","y","class"],[left,top,"webix_bullet_header"]);var textRow2=this._createNS("tspan",["x","y","class"],[left,top+17,"webix_bullet_subheader"]);var range=this._createNS("text",["text-anchor","stroke","class","fill"],["middle","none","webix_bullet_scale","#8b94ac"]);var filter=this._dom(["filter",["id","x","y","width","height"],[id,"0","-150%","110%","400%"],[["feOffset",["in","dx","dy"],["SourceAlpha",0,0]],["feGaussianBlur",["stdDeviation"],["2"]],["feComponentTransfer",0,0,[["feFuncA",["type","slope"],["linear","0.5"]]]],["feMerge",0,0,[["feMergeNode"],["feMergeNode",["in"],["SourceGraphic"]]]]]]);svg.appendChild(filter);var tempContainer=document.createElement("div");container.appendChild(containerBand);if(this._settings.marker!==false){valueMarker.setAttribute("x",this._leftStart+this._safeValue(this._settings.marker)*this._scale-2);container.appendChild(valueMarker)}container.appendChild(value);text.appendChild(textRow1);text.appendChild(textRow2);svg.appendChild(text);var vertical=this._settings.layout==="y";if(this._settings.scale){for(var i=this._settings.minRange;i<=this._settings.maxRange;i+=this._settings.scale.step){var label=this._settings.labelHeight||this._settings.labelWidth;var left=Math.floor(label+i*this._scale-(i?.1:-1));var x=vertical?(this.$width-this._settings.barWidth)/2+-10:left;var y=vertical?this._chartWidth-left+label+44:this._settings.barWidth+28;var z=vertical?-13:this._settings.barWidth+3;var align=vertical?"end":"middle";var bulletRangeChild=this._createNS("tspan",["x","y","text-anchor"],[x,y,align]);var bulletDivChild=this._createNS("line",["x1","y1","x2","y2","stroke-width"],[left,z,left,z+10,1]);tempContainer.innerHTML=this._settings.scale.template({value:i});bulletRangeChild.appendChild(tempContainer.childNodes[0]);range.appendChild(bulletRangeChild);division.appendChild(bulletDivChild)}container.appendChild(division);svg.appendChild(range)}for(var i=0;i<this._settings.bands.length;i++){var obj=this._settings.bands[i];var band=this._createNS("path");var value=this._safeValue(obj.value)*this._scale;band.setAttribute("d","M "+this._leftStart+",0 l "+value+",0 l 0,"+this._settings.barWidth+" l -"+value+",0 z");band.setAttribute("fill",obj.color);containerBand.appendChild(band)}svg.appendChild(container);if(this._settings.layout==="y"){var w=this._settings.scale?this.$width/2-10:0;var h=this.$height+this._leftStart-28;container.setAttribute("transform","translate("+w+", "+h+") rotate(270)");text.setAttribute("text-anchor","middle");text.childNodes[0].setAttribute("x","55%");text.childNodes[1].setAttribute("x","55%");range.setAttribute("text-anchor","right")}svg.setAttribute("viewBox","0 0 "+this.$width+" "+this.$height+"");return svg},_setDefaultView:function(size){if(!size)return;webix.assert(this.config.minRange<this.config.maxRange,"Invalid Range Values");var _view=this.$view;_view.innerHTML="";var label=this._settings.labelHeight||this._settings.labelWidth;this._leftStart=this._settings.label?label:7;this._topStart=Math.floor((this._settings.barWidth-this._settings.stroke)/2);this._chartWidth=size-this._leftStart-30;this._scale=this._chartWidth/(this._settings.maxRange-this._settings.minRange);var svg=this._setView();svg.setAttribute("height",this.$height);svg.setAttribute("width",this.$width);_view.appendChild(svg);this._bulletValue=_view.querySelector(".webix_bullet_value")},setValue:function(value){if(this._settings.value!=value){this._animate(this._settings.value,value)}},getValue:function(){return this._settings.value}},webix.ui.gage,webix.ui.view);(function(){var d;window.AmCharts?d=window.AmCharts:(d={},window.AmCharts=d,d.themes={},d.maps={},d.inheriting={},d.charts=[],d.onReadyArray=[],d.useUTC=!1,d.updateRate=60,d.uid=0,d.lang={},d.translations={},d.mapTranslations={},d.windows={},d.initHandlers=[],d.amString="am",d.pmString="pm");d.Class=function(a){var b=function(){arguments[0]!==d.inheriting&&(this.events={},this.construct.apply(this,arguments))};a.inherits?(b.prototype=new a.inherits(d.inheriting),b.base=a.inherits.prototype,delete a.inherits):(b.prototype.createEvents=function(){for(var a=0;a<arguments.length;a++)this.events[arguments[a]]=[]},b.prototype.listenTo=function(a,b,c){this.removeListener(a,b,c);a.events[b].push({handler:c,scope:this})},b.prototype.addListener=function(a,b,c){this.removeListener(this,a,b);a&&this.events[a]&&this.events[a].push({handler:b,scope:c})},b.prototype.removeListener=function(a,b,c){if(a&&a.events&&(a=a.events[b]))for(b=a.length-1;0<=b;b--)a[b].handler===c&&a.splice(b,1)},b.prototype.fire=function(a){for(var b=this.events[a.type],c=0;c<b.length;c++){var d=b[c];d.handler.call(d.scope,a)}});for(var c in a)b.prototype[c]=a[c];return b};d.addChart=function(a){window.requestAnimationFrame?d.animationRequested||(d.animationRequested=!0,window.requestAnimationFrame(d.update)):d.updateInt||(d.updateInt=setInterval(function(){d.update()},Math.round(1e3/d.updateRate)));d.charts.push(a)};d.removeChart=function(a){for(var b=d.charts,c=b.length-1;0<=c;c--)b[c]==a&&b.splice(c,1);0===b.length&&d.updateInt&&(clearInterval(d.updateInt),d.updateInt=NaN)};d.isModern=!0;d.getIEVersion=function(){var a=0,b,c;"Microsoft Internet Explorer"==navigator.appName&&(b=navigator.userAgent,c=/MSIE ([0-9]{1,}[.0-9]{0,})/,null!==c.exec(b)&&(a=parseFloat(RegExp.$1)));return a};d.applyLang=function(a,b){var c=d.translations;b.dayNames=d.extend({},d.dayNames);b.shortDayNames=d.extend({},d.shortDayNames);b.monthNames=d.extend({},d.monthNames);b.shortMonthNames=d.extend({},d.shortMonthNames);b.amString="am";b.pmString="pm";c&&(c=c[a])&&(d.lang=c,c.monthNames&&(b.dayNames=d.extend({},c.dayNames),b.shortDayNames=d.extend({},c.shortDayNames),b.monthNames=d.extend({},c.monthNames),b.shortMonthNames=d.extend({},c.shortMonthNames)),c.am&&(b.amString=c.am),c.pm&&(b.pmString=c.pm));d.amString=b.amString;d.pmString=b.amString};d.IEversion=d.getIEVersion();9>d.IEversion&&0<d.IEversion&&(d.isModern=!1,d.isIE=!0);d.dx=0;d.dy=0;if(document.addEventListener||window.opera)d.isNN=!0,d.isIE=!1,d.dx=.5,d.dy=.5;document.attachEvent&&(d.isNN=!1,d.isIE=!0,d.isModern||(d.dx=0,d.dy=0));window.chrome&&(d.chrome=!0);d.handleMouseUp=function(a){for(var b=d.charts,c=0;c<b.length;c++){var e=b[c];e&&e.handleReleaseOutside&&e.handleReleaseOutside(a)}};d.handleMouseMove=function(a){for(var b=d.charts,c=0;c<b.length;c++){var e=b[c];e&&e.handleMouseMove&&e.handleMouseMove(a)}};d.handleWheel=function(a){for(var b=d.charts,c=0;c<b.length;c++){var e=b[c];if(e&&e.mouseIsOver){e.mouseWheelScrollEnabled||e.mouseWheelZoomEnabled?e.handleWheel&&e.handleWheel(a):a.stopPropagation&&a.stopPropagation();break}}};d.resetMouseOver=function(){for(var a=d.charts,b=0;b<a.length;b++){var c=a[b];c&&(c.mouseIsOver=!1)}};d.ready=function(a){d.onReadyArray.push(a)};d.handleLoad=function(){d.isReady=!0;for(var a=d.onReadyArray,b=0;b<a.length;b++){var c=a[b];isNaN(d.processDelay)?c():setTimeout(c,d.processDelay*b)}};d.addInitHandler=function(a,b){d.initHandlers.push({method:a,types:b})};d.callInitHandler=function(a){var b=d.initHandlers;if(d.initHandlers)for(var c=0;c<b.length;c++){var e=b[c];e.types?d.isInArray(e.types,a.type)&&e.method(a):e.method(a)}};d.getUniqueId=function(){d.uid++;return"AmChartsEl-"+d.uid};d.isNN&&(document.addEventListener("mousemove",d.handleMouseMove),document.addEventListener("mouseup",d.handleMouseUp,!0),window.addEventListener("load",d.handleLoad,!0),window.addEventListener("DOMMouseScroll",d.handleWheel,!0),document.addEventListener("mousewheel",d.handleWheel,!0));d.isIE&&(document.attachEvent("onmousemove",d.handleMouseMove),document.attachEvent("onmouseup",d.handleMouseUp),window.attachEvent("onload",d.handleLoad),document.attachEvent("onmousewheel",d.handleWheel));d.clear=function(){var a=d.charts;if(a)for(var b=a.length-1;0<=b;b--)a[b].clear();d.updateInt&&clearInterval(d.updateInt);d.charts=[];d.isNN&&(document.removeEventListener("mousemove",d.handleMouseMove,!0),document.removeEventListener("mouseup",d.handleMouseUp,!0),window.removeEventListener("load",d.handleLoad,!0),window.removeEventListener("DOMMouseScroll",d.handleWheel,!0),document.removeEventListener("mousewheel",d.handleWheel,!0));d.isIE&&(document.detachEvent("onmousemove",d.handleMouseMove),document.detachEvent("onmouseup",d.handleMouseUp),window.detachEvent("onload",d.handleLoad))};d.makeChart=function(a,b,c){var e=b.type,h=b.theme;d.isString(h)&&(h=d.themes[h],b.theme=h);var f;switch(e){case"serial":f=new d.AmSerialChart(h);break;case"xy":f=new d.AmXYChart(h);break;case"pie":f=new d.AmPieChart(h);break;case"radar":f=new d.AmRadarChart(h);break;case"gauge":f=new d.AmAngularGauge(h);break;case"funnel":f=new d.AmFunnelChart(h);break;case"map":f=new d.AmMap(h);break;case"stock":f=new d.AmStockChart(h);break;case"gantt":f=new d.AmGanttChart(h)}d.extend(f,b);d.isReady?isNaN(c)?f.write(a):setTimeout(function(){d.realWrite(f,a)},c):d.ready(function(){isNaN(c)?f.write(a):setTimeout(function(){d.realWrite(f,a)},c)});return f};d.realWrite=function(a,b){a.write(b)};d.updateCount=0;d.validateAt=Math.round(d.updateRate/10);d.update=function(){var a=d.charts;d.updateCount++;var b=!1;d.updateCount==d.validateAt&&(b=!0,d.updateCount=0);if(a)for(var c=a.length-1;0<=c;c--)a[c].update&&a[c].update(),b&&(a[c].autoResize?a[c].validateSize&&a[c].validateSize():a[c].premeasure&&a[c].premeasure());window.requestAnimationFrame&&window.requestAnimationFrame(d.update)};d.bezierX=3;d.bezierY=6;"complete"==document.readyState&&d.handleLoad()})();(function(){var d=window.AmCharts;d.toBoolean=function(a,b){if(void 0===a)return b;switch(String(a).toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return!!a}};d.removeFromArray=function(a,b){var c;if(void 0!==b&&void 0!==a)for(c=a.length-1;0<=c;c--)a[c]==b&&a.splice(c,1)};d.getPath=function(){var a=document.getElementsByTagName("script");if(a)for(var b=0;b<a.length;b++){var c=a[b].src;if(-1!==c.search(/\/(amcharts|ammap)\.js/))return c.replace(/\/(amcharts|ammap)\.js.*/,"/")}};d.normalizeUrl=function(a){return""!==a&&-1===a.search(/\/$/)?a+"/":a};d.isAbsolute=function(a){return 0===a.search(/^http[s]?:|^\//)};d.isInArray=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return!0;return!1};d.getDecimals=function(a){var b=0;isNaN(a)||(a=String(a),-1!=a.indexOf("e-")?b=Number(a.split("-")[1]):-1!=a.indexOf(".")&&(b=a.split(".")[1].length));return b};d.wordwrap=function(a,b,c,e){var h,f,g,k;a+="";if(1>b)return a;h=-1;for(a=(k=a.split(/\r\n|\n|\r/)).length;++h<a;k[h]+=g){g=k[h];for(k[h]="";g.length>b;k[h]+=d.trim(g.slice(0,f))+((g=g.slice(f)).length?c:""))f=2==e||(f=g.slice(0,b+1).match(/\S*(\s)?$/))[1]?b:f.input.length-f[0].length||1==e&&b||f.input.length+(f=g.slice(b).match(/^\S*/))[0].length;g=d.trim(g)}return k.join(c)};d.trim=function(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};d.wrappedText=function(a,b,c,e,h,f,g,k){var l=d.text(a,b,c,e,h,f,g);if(l){var m=l.getBBox();if(m.width>k){var n="\n";d.isModern||(n="<br>");k=Math.floor(k/(m.width/b.length));2<k&&(k-=2);b=d.wordwrap(b,k,n,!0);l.remove();l=d.text(a,b,c,e,h,f,g)}}return l};d.getStyle=function(a,b){var c="";if(document.defaultView&&document.defaultView.getComputedStyle)try{c=document.defaultView.getComputedStyle(a,"").getPropertyValue(b)}catch(e){}else a.currentStyle&&(b=b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),c=a.currentStyle[b]);return c};d.removePx=function(a){if(void 0!==a)return Number(a.substring(0,a.length-2))};d.getURL=function(a,b){if(a)if("_self"!=b&&b)if("_top"==b&&window.top)window.top.location.href=a;else if("_parent"==b&&window.parent)window.parent.location.href=a;else if("_blank"==b)window.open(a);else{var c=document.getElementsByName(b)[0];c?c.src=a:(c=d.windows[b])?c.opener&&!c.opener.closed?c.location.href=a:d.windows[b]=window.open(a):d.windows[b]=window.open(a)}else window.location.href=a};d.ifArray=function(a){return a&&"object"==typeof a&&0<a.length?!0:!1};d.callMethod=function(a,b){var c;for(c=0;c<b.length;c++){var e=b[c];if(e){if(e[a])e[a]();var d=e.length;if(0<d){var f;for(f=0;f<d;f++){var g=e[f];if(g&&g[a])g[a]()}}}}};d.toNumber=function(a){return"number"==typeof a?a:Number(String(a).replace(/[^0-9\-.]+/g,""))};d.toColor=function(a){if(""!==a&&void 0!==a)if(-1!=a.indexOf(",")){a=a.split(",");var b;for(b=0;b<a.length;b++){var c=a[b].substring(a[b].length-6,a[b].length);a[b]="#"+c}}else a=a.substring(a.length-6,a.length),a="#"+a;return a};d.toCoordinate=function(a,b,c){var e;void 0!==a&&(a=String(a),c&&c<b&&(b=c),e=Number(a),-1!=a.indexOf("!")&&(e=b-Number(a.substr(1))),-1!=a.indexOf("%")&&(e=b*Number(a.substr(0,a.length-1))/100));return e};d.fitToBounds=function(a,b,c){a<b&&(a=b);a>c&&(a=c);return a};d.isDefined=function(a){return void 0===a?!1:!0};d.stripNumbers=function(a){return a.replace(/[0-9]+/g,"")};d.roundTo=function(a,b){if(0>b)return a;var c=Math.pow(10,b);return Math.round(a*c)/c};d.toFixed=function(a,b){var c=String(Math.round(a*Math.pow(10,b)));if(0<b){var e=c.length;if(e<b){var d;for(d=0;d<b-e;d++)c="0"+c}e=c.substring(0,c.length-b);""===e&&(e=0);return e+"."+c.substring(c.length-b,c.length)}return String(c)};d.formatDuration=function(a,b,c,e,h,f){var g=d.intervals,k=f.decimalSeparator;if(a>=g[b].contains){var l=a-Math.floor(a/g[b].contains)*g[b].contains;"ss"==b?(l=d.formatNumber(l,f),1==l.split(k)[0].length&&(l="0"+l)):l=d.roundTo(l,f.precision);("mm"==b||"hh"==b)&&10>l&&(l="0"+l);c=l+""+e[b]+""+c;a=Math.floor(a/g[b].contains);b=g[b].nextInterval;return d.formatDuration(a,b,c,e,h,f)}"ss"==b&&(a=d.formatNumber(a,f),1==a.split(k)[0].length&&(a="0"+a));("mm"==b||"hh"==b)&&10>a&&(a="0"+a);c=a+""+e[b]+""+c;if(g[h].count>g[b].count)for(a=g[b].count;a<g[h].count;a++)b=g[b].nextInterval,"ss"==b||"mm"==b||"hh"==b?c="00"+e[b]+""+c:"DD"==b&&(c="0"+e[b]+""+c);":"==c.charAt(c.length-1)&&(c=c.substring(0,c.length-1));return c};d.formatNumber=function(a,b,c,e,h){a=d.roundTo(a,b.precision);isNaN(c)&&(c=b.precision);var f=b.decimalSeparator;b=b.thousandsSeparator;var g;g=0>a?"-":"";a=Math.abs(a);var k=String(a),l=!1;-1!=k.indexOf("e")&&(l=!0);0<=c&&!l&&(k=d.toFixed(a,c));var m="";if(l)m=k;else{var k=k.split("."),l=String(k[0]),n;for(n=l.length;0<=n;n-=3)m=n!=l.length?0!==n?l.substring(n-3,n)+b+m:l.substring(n-3,n)+m:l.substring(n-3,n);void 0!==k[1]&&(m=m+f+k[1]);void 0!==c&&0<c&&"0"!=m&&(m=d.addZeroes(m,f,c))}m=g+m;""===g&&!0===e&&0!==a&&(m="+"+m);!0===h&&(m+="%");return m};d.addZeroes=function(a,b,c){a=a.split(b);void 0===a[1]&&0<c&&(a[1]="0");return a[1].length<c?(a[1]+="0",d.addZeroes(a[0]+b+a[1],b,c)):void 0!==a[1]?a[0]+b+a[1]:a[0]};d.scientificToNormal=function(a){var b;a=String(a).split("e");var c;if("-"==a[1].substr(0,1)){b="0.";for(c=0;c<Math.abs(Number(a[1]))-1;c++)b+="0";b+=a[0].split(".").join("")}else{var e=0;b=a[0].split(".");b[1]&&(e=b[1].length);b=a[0].split(".").join("");for(c=0;c<Math.abs(Number(a[1]))-e;c++)b+="0"}return b};d.toScientific=function(a,b){if(0===a)return"0";var c=Math.floor(Math.log(Math.abs(a))*Math.LOG10E),e=String(e).split(".").join(b);return String(e)+"e"+c};d.randomColor=function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).substr(-6)};d.hitTest=function(a,b,c){var e=!1,h=a.x,f=a.x+a.width,g=a.y,k=a.y+a.height,l=d.isInRectangle;e||(e=l(h,g,b));e||(e=l(h,k,b));e||(e=l(f,g,b));e||(e=l(f,k,b));e||!0===c||(e=d.hitTest(b,a,!0));return e};d.isInRectangle=function(a,b,c){return a>=c.x-5&&a<=c.x+c.width+5&&b>=c.y-5&&b<=c.y+c.height+5?!0:!1};d.isPercents=function(a){if(-1!=String(a).indexOf("%"))return!0};d.formatValue=function(a,b,c,e,h,f,g,k){if(b){void 0===h&&(h="");var l;for(l=0;l<c.length;l++){var m=c[l],n=b[m];void 0!==n&&(n=f?d.addPrefix(n,k,g,e):d.formatNumber(n,e),a=a.replace(new RegExp("\\[\\["+h+""+m+"\\]\\]","g"),n))}}return a};d.formatDataContextValue=function(a,b){if(a){var c=a.match(/\[\[.*?\]\]/g),e;for(e=0;e<c.length;e++){var d=c[e],d=d.substr(2,d.length-4);void 0!==b[d]&&(a=a.replace(new RegExp("\\[\\["+d+"\\]\\]","g"),b[d]))}}return a};d.massReplace=function(a,b){for(var c in b)if(b.hasOwnProperty(c)){var e=b[c];void 0===e&&(e="");a=a.replace(c,e)}return a};d.cleanFromEmpty=function(a){return a.replace(/\[\[[^\]]*\]\]/g,"")};d.addPrefix=function(a,b,c,e,h){var f=d.formatNumber(a,e),g="",k,l,m;if(0===a)return"0";0>a&&(g="-");a=Math.abs(a);if(1<a)for(k=b.length-1;-1<k;k--){if(a>=b[k].number&&(l=a/b[k].number,m=Number(e.precision),1>m&&(m=1),c=d.roundTo(l,m),m=d.formatNumber(c,{precision:-1,decimalSeparator:e.decimalSeparator,thousandsSeparator:e.thousandsSeparator}),!h||l==c)){f=g+""+m+""+b[k].prefix;break}}else for(k=0;k<c.length;k++)if(a<=c[k].number){l=a/c[k].number;m=Math.abs(Math.floor(Math.log(l)*Math.LOG10E));l=d.roundTo(l,m);f=g+""+l+""+c[k].prefix;break}return f};d.remove=function(a){a&&a.remove()};d.getEffect=function(a){">"==a&&(a="easeOutSine");"<"==a&&(a="easeInSine");"elastic"==a&&(a="easeOutElastic");return a};d.getObjById=function(a,b){var c,e;for(e=0;e<a.length;e++){var d=a[e];if(d.id==b){c=d;break}}return c};d.applyTheme=function(a,b,c){b||(b=d.theme);b&&b[c]&&d.extend(a,b[c])};d.isString=function(a){return"string"==typeof a?!0:!1};d.extend=function(a,b,c){var e;a||(a={});for(e in b)c?a.hasOwnProperty(e)||(a[e]=b[e]):a[e]=b[e];return a};d.copyProperties=function(a,b){for(var c in a)a.hasOwnProperty(c)&&"events"!=c&&void 0!==a[c]&&"function"!=typeof a[c]&&"cname"!=c&&(b[c]=a[c])};d.processObject=function(a,b,c,e){if(!1===a instanceof b&&(a=e?d.extend(new b(c),a):d.extend(a,new b(c),!0),a.listeners))for(var h in a.listeners)b=a.listeners[h],a.addListener(b.event,b.method);return a};d.fixNewLines=function(a){var b=RegExp("\\n","g");a&&(a=a.replace(b,"<br />"));return a};d.fixBrakes=function(a){if(d.isModern){var b=RegExp("<br>","g");a&&(a=a.replace(b,"\n"))}else a=d.fixNewLines(a);return a};d.deleteObject=function(a,b){if(a){if(void 0===b||null===b)b=20;if(0!==b)if("[object Array]"===Object.prototype.toString.call(a))for(var c=0;c<a.length;c++)d.deleteObject(a[c],b-1),a[c]=null;else if(a&&!a.tagName)try{for(c in a)a[c]&&("object"==typeof a[c]&&d.deleteObject(a[c],b-1),"function"!=typeof a[c]&&(a[c]=null))}catch(e){}}};d.bounce=function(a,b,c,e,d){return(b/=d)<1/2.75?7.5625*e*b*b+c:b<2/2.75?e*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?e*(7.5625*(b-=2.25/2.75)*b+.9375)+c:e*(7.5625*(b-=2.625/2.75)*b+.984375)+c};d.easeInOutQuad=function(a,b,c,e,d){b/=d/2;if(1>b)return e/2*b*b+c;b--;return-e/2*(b*(b-2)-1)+c};d.easeInSine=function(a,b,c,e,d){return-e*Math.cos(b/d*(Math.PI/2))+e+c};d.easeOutSine=function(a,b,c,e,d){return e*Math.sin(b/d*(Math.PI/2))+c};d.easeOutElastic=function(a,b,c,e,d){a=1.70158;var f=0,g=e;if(0===b)return c;if(1==(b/=d))return c+e;f||(f=.3*d);g<Math.abs(e)?(g=e,a=f/4):a=f/(2*Math.PI)*Math.asin(e/g);return g*Math.pow(2,-10*b)*Math.sin(2*(b*d-a)*Math.PI/f)+e+c};d.fixStepE=function(a){a=a.toExponential(0).split("e");var b=Number(a[1]);9==Number(a[0])&&b++;return d.generateNumber(1,b)};d.generateNumber=function(a,b){var c="",e;e=0>b?Math.abs(b)-1:Math.abs(b);var d;for(d=0;d<e;d++)c+="0";return 0>b?Number("0."+c+String(a)):Number(String(a)+c)};d.setCN=function(a,b,c,e){if(a.addClassNames&&b&&(b=b.node)&&c){var d=b.getAttribute("class");a=a.classNamePrefix+"-";e&&(a="");d?b.setAttribute("class",d+" "+a+c):b.setAttribute("class",a+c)}};d.parseDefs=function(a,b){for(var c in a){var e=typeof a[c];if(0<a[c].length&&"object"==e)for(var h=0;h<a[c].length;h++)e=document.createElementNS(d.SVG_NS,c),b.appendChild(e),d.parseDefs(a[c][h],e);else"object"==e?(e=document.createElementNS(d.SVG_NS,c),b.appendChild(e),d.parseDefs(a[c],e)):b.setAttribute(c,a[c])}}})();(function(){var d=window.AmCharts;d.AxisBase=d.Class({construct:function(a){this.createEvents("clickItem","rollOverItem","rollOutItem");this.titleDY=this.y=this.x=this.dy=this.dx=0;this.axisThickness=1;this.axisColor="#000000";this.axisAlpha=1;this.gridCount=this.tickLength=5;this.gridAlpha=.15;this.gridThickness=1;this.gridColor="#000000";this.dashLength=0;this.labelFrequency=1;this.showLastLabel=this.showFirstLabel=!0;this.fillColor="#FFFFFF";this.fillAlpha=0;this.labelsEnabled=!0;this.labelRotation=0;this.autoGridCount=!0;this.offset=0;this.guides=[];this.visible=!0;this.counter=0;this.guides=[];this.ignoreAxisWidth=this.inside=!1;this.minHorizontalGap=75;this.minVerticalGap=35;this.titleBold=!0;this.minorGridEnabled=!1;this.minorGridAlpha=.07;this.autoWrap=!1;this.titleAlign="middle";this.labelOffset=0;this.bcn="axis-";this.centerLabels=!1;this.firstDayOfWeek=1;this.centerLabelOnFullPeriod=this.markPeriodChange=this.boldPeriodBeginning=!0;this.periods=[{period:"ss",count:1},{period:"ss",count:5},{period:"ss",count:10},{period:"ss",count:30},{period:"mm",count:1},{period:"mm",count:5},{period:"mm",count:10},{period:"mm",count:30},{period:"hh",count:1},{period:"hh",count:3},{period:"hh",count:6},{period:"hh",count:12},{period:"DD",count:1},{period:"DD",count:2},{period:"DD",count:3},{period:"DD",count:4},{period:"DD",count:5},{period:"WW",count:1},{period:"MM",count:1},{period:"MM",count:2},{period:"MM",count:3},{period:"MM",count:6},{period:"YYYY",count:1},{period:"YYYY",count:2},{period:"YYYY",count:5},{period:"YYYY",count:10},{period:"YYYY",count:50},{period:"YYYY",count:100}];this.dateFormats=[{period:"fff",format:"JJ:NN:SS"},{period:"ss",format:"JJ:NN:SS"},{period:"mm",format:"JJ:NN"},{period:"hh",format:"JJ:NN"},{period:"DD",format:"MMM DD"},{period:"WW",format:"MMM DD"},{period:"MM",format:"MMM"},{period:"YYYY",format:"YYYY"}];this.nextPeriod={fff:"ss",ss:"mm",mm:"hh",hh:"DD",DD:"MM",MM:"YYYY"};d.applyTheme(this,a,"AxisBase")},zoom:function(a,b){this.start=a;this.end=b;this.dataChanged=!0;this.draw()},fixAxisPosition:function(){var a=this.position;"H"==this.orientation?("left"==a&&(a="bottom"),"right"==a&&(a="top")):("bottom"==a&&(a="left"),"top"==a&&(a="right"));this.position=a},init:function(){this.createBalloon()},draw:function(){var a=this.chart;this.prevBY=this.prevBX=NaN;this.allLabels=[];this.counter=0;this.destroy();this.fixAxisPosition();this.setBalloonBounds();this.labels=[];var b=a.container,c=b.set();a.gridSet.push(c);this.set=c;b=b.set();a.axesLabelsSet.push(b);this.labelsSet=b;this.axisLine=new this.axisRenderer(this);this.autoGridCount?("V"==this.orientation?(a=this.height/this.minVerticalGap,3>a&&(a=3)):a=this.width/this.minHorizontalGap,this.gridCountR=Math.max(a,1)):this.gridCountR=this.gridCount;this.axisWidth=this.axisLine.axisWidth;this.addTitle()},setOrientation:function(a){this.orientation=a?"H":"V"},addTitle:function(){var a=this.title;this.titleLabel=null;if(a){var b=this.chart,c=this.titleColor;void 0===c&&(c=b.color);var e=this.titleFontSize;isNaN(e)&&(e=b.fontSize+1);a=d.text(b.container,a,c,b.fontFamily,e,this.titleAlign,this.titleBold);d.setCN(b,a,this.bcn+"title");this.titleLabel=a}},positionTitle:function(){var a=this.titleLabel;if(a){var b,c,e=this.labelsSet,h={};0<e.length()?h=e.getBBox():(h.x=0,h.y=0,h.width=this.width,h.height=this.height,d.VML&&(h.y+=this.y,h.x+=this.x));e.push(a);var e=h.x,f=h.y;d.VML&&(this.rotate?e-=this.x:f-=this.y);var g=h.width,h=h.height,k=this.width,l=this.height,m=0,n=a.getBBox().height/2,q=this.inside,p=this.titleAlign;switch(this.position){case"top":b="left"==p?-1:"right"==p?k:k/2;c=f-10-n;break;case"bottom":b="left"==p?-1:"right"==p?k:k/2;c=f+h+10+n;break;case"left":b=e-10-n;q&&(b-=5);m=-90;c=("left"==p?l+1:"right"==p?-1:l/2)+this.titleDY;break;case"right":b=e+g+10+n,q&&(b+=7),c=("left"==p?l+2:"right"==p?-2:l/2)+this.titleDY,m=-90}this.marginsChanged?(a.translate(b,c),this.tx=b,this.ty=c):a.translate(this.tx,this.ty);this.marginsChanged=!1;isNaN(this.titleRotation)||(m=this.titleRotation);0!==m&&a.rotate(m)}},pushAxisItem:function(a,b){var c=this,e=a.graphics();0<e.length()&&(b?c.labelsSet.push(e):c.set.push(e));if(e=a.getLabel())this.labelsSet.push(e),e.click(function(b){c.handleMouse(b,a,"clickItem")}).mouseover(function(b){c.handleMouse(b,a,"rollOverItem")}).mouseout(function(b){c.handleMouse(b,a,"rollOutItem")})},handleMouse:function(a,b,c){this.fire({type:c,value:b.value,serialDataItem:b.serialDataItem,axis:this,target:b.label,chart:this.chart,event:a})},addGuide:function(a){for(var b=this.guides,c=!1,e=b.length,h=0;h<b.length;h++)b[h]==a&&(c=!0,e=h);a=d.processObject(a,d.Guide,this.theme);a.id||(a.id="guideAuto"+e+"_"+(new Date).getTime());c||b.push(a)},removeGuide:function(a){var b=this.guides,c;for(c=0;c<b.length;c++)b[c]==a&&b.splice(c,1)},handleGuideOver:function(a){clearTimeout(this.chart.hoverInt);var b=a.graphics.getBBox(),c=this.x+b.x+b.width/2,b=this.y+b.y+b.height/2,e=a.fillColor;void 0===e&&(e=a.lineColor);this.chart.showBalloon(a.balloonText,e,!0,c,b)},handleGuideOut:function(){this.chart.hideBalloon()},addEventListeners:function(a,b){var c=this;a.mouseover(function(){c.handleGuideOver(b)});a.touchstart(function(){c.handleGuideOver(b)});a.mouseout(function(){c.handleGuideOut(b)})},getBBox:function(){var a;this.labelsSet&&(a=this.labelsSet.getBBox());a?d.VML||(a={x:a.x+this.x,y:a.y+this.y,width:a.width,height:a.height}):a={x:0,y:0,width:0,height:0};return a},destroy:function(){d.remove(this.set);d.remove(this.labelsSet);var a=this.axisLine;a&&d.remove(a.axisSet);d.remove(this.grid0)},chooseMinorFrequency:function(a){for(var b=10;0<b;b--)if(a/b==Math.round(a/b))return a/b},parseDatesDraw:function(){var a,b=this.chart,c=this.showFirstLabel,e=this.showLastLabel,h,f="",g=d.extractPeriod(this.minPeriod),k=d.getPeriodDuration(g.period,g.count),l,m,n,q,p,t=this.firstDayOfWeek,r=this.boldPeriodBeginning;a=this.minorGridEnabled;var u,x=this.gridAlpha,z,v=this.choosePeriod(0),A=v.period,v=v.count,y=d.getPeriodDuration(A,v);y<k&&(A=g.period,v=g.count,y=k);g=A;"WW"==g&&(g="DD");this.stepWidth=this.getStepWidth(this.timeDifference);var B=Math.ceil(this.timeDifference/y)+5,D=l=d.resetDateToMin(new Date(this.startTime-y),A,v,t).getTime();if(g==A&&1==v&&this.centerLabelOnFullPeriod||this.autoWrap||this.centerLabels)n=y*this.stepWidth,this.autoWrap&&!this.centerLabels&&(n=-n);this.cellWidth=k*this.stepWidth;q=Math.round(l/y);k=-1;q/2==Math.round(q/2)&&(k=-2,l-=y);q=this.firstTime;var C=0,J=0;a&&1<v&&(u=this.chooseMinorFrequency(v),z=d.getPeriodDuration(A,u),"DD"==A&&(z+=d.getPeriodDuration("hh")));if(0<this.gridCountR)for(B-5-k>this.autoRotateCount&&!isNaN(this.autoRotateAngle)&&(this.labelRotationR=this.autoRotateAngle),a=k;a<=B;a++){p=q+y*(a+Math.floor((D-q)/y))-C;"DD"==A&&(p+=36e5);p=d.resetDateToMin(new Date(p),A,v,t).getTime();"MM"==A&&(h=(p-l)/y,1.5<=(p-l)/y&&(p=p-(h-1)*y+d.getPeriodDuration("DD",3),p=d.resetDateToMin(new Date(p),A,1).getTime(),C+=y));h=(p-this.startTime)*this.stepWidth;if("radar"==b.type){if(h=this.axisWidth-h,0>h||h>this.axisWidth)continue}else this.rotate?"date"==this.type&&"middle"==this.gridPosition&&(J=-y*this.stepWidth/2):"date"==this.type&&(h=this.axisWidth-h);f=!1;this.nextPeriod[g]&&(f=this.checkPeriodChange(this.nextPeriod[g],1,p,l,g));l=!1;f&&this.markPeriodChange?(f=this.dateFormatsObject[this.nextPeriod[g]],this.twoLineMode&&(f=this.dateFormatsObject[g]+"\n"+f,f=d.fixBrakes(f)),l=!0):f=this.dateFormatsObject[g];r||(l=!1);this.currentDateFormat=f;f=d.formatDate(new Date(p),f,b);if(a==k&&!c||a==B&&!e)f=" ";this.labelFunction&&(f=this.labelFunction(f,new Date(p),this,A,v,m).toString());this.boldLabels&&(l=!0);m=new this.axisItemRenderer(this,h,f,!1,n,J,!1,l);this.pushAxisItem(m);m=l=p;if(!isNaN(u))for(h=1;h<v;h+=u)this.gridAlpha=this.minorGridAlpha,f=p+z*h,f=d.resetDateToMin(new Date(f),A,u,t).getTime(),f=new this.axisItemRenderer(this,(f-this.startTime)*this.stepWidth,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!0),this.pushAxisItem(f);this.gridAlpha=x}},choosePeriod:function(a){var b=d.getPeriodDuration(this.periods[a].period,this.periods[a].count),c=this.periods;return this.timeDifference<b&&0<a?c[a-1]:Math.ceil(this.timeDifference/b)<=this.gridCountR?c[a]:a+1<c.length?this.choosePeriod(a+1):c[a]},getStepWidth:function(a){var b;this.startOnAxis?(b=this.axisWidth/(a-1),1==a&&(b=this.axisWidth)):b=this.axisWidth/a;return b},timeZoom:function(a,b){this.startTime=a;this.endTime=b},minDuration:function(){var a=d.extractPeriod(this.minPeriod);return d.getPeriodDuration(a.period,a.count)},checkPeriodChange:function(a,b,c,e,h){c=new Date(c);var f=new Date(e),g=this.firstDayOfWeek;e=b;"DD"==a&&(b=1);c=d.resetDateToMin(c,a,b,g).getTime();b=d.resetDateToMin(f,a,b,g).getTime();return"DD"==a&&"hh"!=h&&c-b<d.getPeriodDuration(a,e)-d.getPeriodDuration("hh",1)?!1:c!=b?!0:!1},generateDFObject:function(){this.dateFormatsObject={};var a;for(a=0;a<this.dateFormats.length;a++){var b=this.dateFormats[a];this.dateFormatsObject[b.period]=b.format}},hideBalloon:function(){this.balloon&&this.balloon.hide&&this.balloon.hide();this.prevBY=this.prevBX=NaN},formatBalloonText:function(a){return a},showBalloon:function(a,b,c,e){var d=this.offset;switch(this.position){case"bottom":b=this.height+d;break;case"top":b=-d;break;case"left":a=-d;break;case"right":a=this.width+d}c||(c=this.currentDateFormat);if("V"==this.orientation){if(0>b||b>this.height)return;if(isNaN(b)){this.hideBalloon();return}b=this.adjustBalloonCoordinate(b,e);e=this.coordinateToValue(b)}else{if(0>a||a>this.width)return;if(isNaN(a)){this.hideBalloon();return}a=this.adjustBalloonCoordinate(a,e);e=this.coordinateToValue(a)}var f;if(d=this.chart.chartCursor)f=d.index;if(this.balloon&&void 0!==e&&this.balloon.enabled){if(this.balloonTextFunction){if("date"==this.type||!0===this.parseDates)e=new Date(e);e=this.balloonTextFunction(e)}else this.balloonText?e=this.formatBalloonText(this.balloonText,f,c):isNaN(e)||(e=this.formatValue(e,c));if(a!=this.prevBX||b!=this.prevBY)this.balloon.setPosition(a,b),this.prevBX=a,this.prevBY=b,e&&this.balloon.showBalloon(e)}},adjustBalloonCoordinate:function(a){return a},createBalloon:function(){var a=this.chart,b=a.chartCursor;b&&(b=b.cursorPosition,"mouse"!=b&&(this.stickBalloonToCategory=!0),"start"==b&&(this.stickBalloonToStart=!0),"ValueAxis"==this.cname&&(this.stickBalloonToCategory=!1));this.balloon&&(this.balloon.destroy&&this.balloon.destroy(),d.extend(this.balloon,a.balloon,!0))},setBalloonBounds:function(){var a=this.balloon;if(a){var b=this.chart;a.cornerRadius=0;a.shadowAlpha=0;a.borderThickness=1;a.borderAlpha=1;a.adjustBorderColor=!1;a.showBullet=!1;this.balloon=a;a.chart=b;a.mainSet=b.plotBalloonsSet;a.pointerWidth=this.tickLength;if(this.parseDates||"date"==this.type)a.pointerWidth=0;a.className=this.id;b="V";"V"==this.orientation&&(b="H");this.stickBalloonToCategory||(a.animationDuration=0);var c,e,d,f,g=this.inside,k=this.width,l=this.height;switch(this.position){case"bottom":c=0;e=k;g?(d=0,f=l):(d=l,f=l+1e3);break;case"top":c=0;e=k;g?(d=0,f=l):(d=-1e3,f=0);break;case"left":d=0;f=l;g?(c=0,e=k):(c=-1e3,e=0);break;case"right":d=0,f=l,g?(c=0,e=k):(c=k,e=k+1e3)}a.drop||(a.pointerOrientation=b);a.setBounds(c,d,e,f)}}})})();(function(){var d=window.AmCharts;d.ValueAxis=d.Class({inherits:d.AxisBase,construct:function(a){this.cname="ValueAxis";this.createEvents("axisChanged","logarithmicAxisFailed","axisZoomed","axisIntZoomed");d.ValueAxis.base.construct.call(this,a);this.dataChanged=!0;this.stackType="none";this.position="left";this.unitPosition="right";this.includeAllValues=this.recalculateToPercents=this.includeHidden=this.includeGuidesInMinMax=this.integersOnly=!1;this.durationUnits={DD:"d. ",hh:":",mm:":",ss:""};this.scrollbar=!1;this.baseValue=0;this.radarCategoriesEnabled=!0;this.axisFrequency=1;this.gridType="polygons";this.useScientificNotation=!1;this.axisTitleOffset=10;this.pointPosition="axis";this.minMaxMultiplier=1;this.logGridLimit=2;this.totalTextOffset=this.treatZeroAs=0;this.minPeriod="ss";this.relativeStart=0;this.relativeEnd=1;d.applyTheme(this,a,this.cname)},updateData:function(){0>=this.gridCountR&&(this.gridCountR=1);this.totals=[];this.data=this.chart.chartData;var a=this.chart;"xy"!=a.type&&(this.stackGraphs("smoothedLine"),this.stackGraphs("line"),this.stackGraphs("column"),this.stackGraphs("step"));this.recalculateToPercents&&this.recalculate();this.synchronizationMultiplier&&this.synchronizeWith?(d.isString(this.synchronizeWith)&&(this.synchronizeWith=a.getValueAxisById(this.synchronizeWith)),this.synchronizeWith&&(this.synchronizeWithAxis(this.synchronizeWith),this.foundGraphs=!0)):(this.foundGraphs=!1,this.getMinMax(),0===this.start&&this.end==this.data.length-1&&isNaN(this.minZoom)&&isNaN(this.maxZoom)&&(this.fullMin=this.min,this.fullMax=this.max,"date"!=this.type&&(isNaN(this.minimum)||(this.fullMin=this.minimum),isNaN(this.maximum)||(this.fullMax=this.maximum)),this.logarithmic&&(this.fullMin=this.logMin,0===this.fullMin&&(this.fullMin=this.treatZeroAs)),"date"==this.type&&(this.minimumDate||(this.fullMin=this.minRR),this.maximumDate||(this.fullMax=this.maxRR))))},draw:function(){d.ValueAxis.base.draw.call(this);var a=this.chart,b=this.set;this.labelRotationR=this.labelRotation;d.setCN(a,this.set,"value-axis value-axis-"+this.id);d.setCN(a,this.labelsSet,"value-axis value-axis-"+this.id);d.setCN(a,this.axisLine.axisSet,"value-axis value-axis-"+this.id);var c=this.type;"duration"==c&&(this.duration="ss");!0===this.dataChanged&&(this.updateData(),this.dataChanged=!1);"date"==c&&(this.logarithmic=!1,this.min=this.minRR,this.max=this.maxRR,this.reversed=!1,this.getDateMinMax());if(this.logarithmic){var e=this.treatZeroAs,h=this.getExtremes(0,this.data.length-1).min;!isNaN(this.minimum)&&this.minimum<h&&(h=this.minimum);this.logMin=h;this.minReal<h&&(this.minReal=h);isNaN(this.minReal)&&(this.minReal=h);0<e&&0===h&&(this.minReal=h=e);if(0>=h||0>=this.minimum){this.fire({type:"logarithmicAxisFailed",chart:a});return}}this.grid0=null;var f,g,k=a.dx,l=a.dy,e=!1,h=this.logarithmic;if(isNaN(this.min)||isNaN(this.max)||!this.foundGraphs||Infinity==this.min||-Infinity==this.max)e=!0;else{"date"==this.type&&this.min==this.max&&(this.max+=this.minDuration(),this.min-=this.minDuration());var m=this.labelFrequency,n=this.showFirstLabel,q=this.showLastLabel,p=1,t=0;this.minCalc=this.min;this.maxCalc=this.max;this.strictMinMax&&(isNaN(this.minimum)||(this.min=this.minimum),isNaN(this.maximum)||(this.max=this.maximum));isNaN(this.minZoom)||(this.minReal=this.min=this.minZoom);isNaN(this.maxZoom)||(this.max=this.maxZoom);if(this.logarithmic){g=Math.log(this.fullMax)*Math.LOG10E-Math.log(this.fullMin)*Math.LOG10E;var r=Math.log(this.max)/Math.LN10-Math.log(this.fullMin)*Math.LOG10E;this.relativeStart=(Math.log(this.minReal)/Math.LN10-Math.log(this.fullMin)*Math.LOG10E)/g;this.relativeEnd=r/g}else this.relativeStart=d.fitToBounds((this.min-this.fullMin)/(this.fullMax-this.fullMin),0,1),this.relativeEnd=d.fitToBounds((this.max-this.fullMin)/(this.fullMax-this.fullMin),0,1);var r=Math.round((this.maxCalc-this.minCalc)/this.step)+1,u;!0===h?(u=Math.log(this.max)*Math.LOG10E-Math.log(this.minReal)*Math.LOG10E,this.stepWidth=this.axisWidth/u,u>this.logGridLimit&&(r=Math.ceil(Math.log(this.max)*Math.LOG10E)+1,t=Math.round(Math.log(this.minReal)*Math.LOG10E),r>this.gridCountR&&(p=Math.ceil(r/this.gridCountR)))):this.stepWidth=this.axisWidth/(this.max-this.min);var x=0;1>this.step&&-1<this.step&&(x=d.getDecimals(this.step));this.integersOnly&&(x=0);x>this.maxDecCount&&(x=this.maxDecCount);var z=this.precision;isNaN(z)||(x=z);isNaN(this.maxZoom)&&(this.max=d.roundTo(this.max,this.maxDecCount),this.min=d.roundTo(this.min,this.maxDecCount));g={};g.precision=x;g.decimalSeparator=a.nf.decimalSeparator;g.thousandsSeparator=a.nf.thousandsSeparator;this.numberFormatter=g;var v;this.exponential=!1;for(g=t;g<r;g+=p){var A=d.roundTo(this.step*g+this.min,x);-1!=String(A).indexOf("e")&&(this.exponential=!0)}this.duration&&(this.maxInterval=d.getMaxInterval(this.max,this.duration));var x=this.step,y,A=this.minorGridAlpha;this.minorGridEnabled&&(y=this.getMinorGridStep(x,this.stepWidth*x));if(this.autoGridCount||0!==this.gridCount)if("date"==c)this.generateDFObject(),this.timeDifference=this.max-this.min,this.maxTime=this.lastTime=this.max,this.startTime=this.firstTime=this.min,this.parseDatesDraw();else for(r>=this.autoRotateCount&&!isNaN(this.autoRotateAngle)&&(this.labelRotationR=this.autoRotateAngle),c=this.minCalc,h&&(r++,c=this.maxCalc-r*x),g=t;g<r;g+=p)if(t=x*g+c,t=d.roundTo(t,this.maxDecCount+1),!this.integersOnly||Math.round(t)==t)if(isNaN(z)||Number(d.toFixed(t,z))==t){if(!0===h)if(u>this.logGridLimit)t=Math.pow(10,g);else if(0>=t&&(t=c+x*g+x/2,0>=t))continue;v=this.formatValue(t,!1,g);Math.round(g/m)!=g/m&&(v=void 0);if(0===g&&!n||g==r-1&&!q)v=" ";f=this.getCoordinate(t);var B;this.rotate&&this.autoWrap&&(B=this.stepWidth*x-10);v=new this.axisItemRenderer(this,f,v,void 0,B,void 0,void 0,this.boldLabels);this.pushAxisItem(v);if(t==this.baseValue&&"radar"!=a.type){var D,C;v=this.width;var J=this.height;"H"==this.orientation?0<=f&&f<=v+1&&(D=[f,f,f+k],C=[J,0,l]):0<=f&&f<=J+1&&(D=[0,v,v+k],C=[f,f,f+l]);D&&(v=d.fitToBounds(2*this.gridAlpha,0,1),isNaN(this.zeroGridAlpha)||(v=this.zeroGridAlpha),v=d.line(a.container,D,C,this.gridColor,v,1,this.dashLength),v.translate(this.x,this.y),this.grid0=v,a.axesSet.push(v),v.toBack(),d.setCN(a,v,this.bcn+"zero-grid-"+this.id),d.setCN(a,v,this.bcn+"zero-grid"))}if(!isNaN(y)&&0<A&&g<r-1){v=x/y;h&&(y=x*(g+p)+this.minCalc,y=d.roundTo(y,this.maxDecCount+1),u>this.logGridLimit&&(y=Math.pow(10,g+p)),v=9,y=(y-t)/v);f=this.gridAlpha;this.gridAlpha=this.minorGridAlpha;for(J=1;J<v;J++){var H=this.getCoordinate(t+y*J),H=new this.axisItemRenderer(this,H,"",!1,0,0,!1,!1,0,!0);this.pushAxisItem(H)}this.gridAlpha=f}}u=this.guides;B=u.length;if(0<B){D=this.fillAlpha;for(g=this.fillAlpha=0;g<B;g++)C=u[g],k=NaN,y=C.above,isNaN(C.toValue)||(k=this.getCoordinate(C.toValue),v=new this.axisItemRenderer(this,k,"",!0,NaN,NaN,C),this.pushAxisItem(v,y)),l=NaN,isNaN(C.value)||(l=this.getCoordinate(C.value),v=new this.axisItemRenderer(this,l,C.label,!0,NaN,(k-l)/2,C),this.pushAxisItem(v,y)),isNaN(k)&&(l-=3,k=l+3),isNaN(k-l)||0>l&&0>k||(k=new this.guideFillRenderer(this,l,k,C),this.pushAxisItem(k,y),y=k.graphics(),C.graphics=y,C.balloonText&&this.addEventListeners(y,C));this.fillAlpha=D}g=this.baseValue;this.min>this.baseValue&&this.max>this.baseValue&&(g=this.min);this.min<this.baseValue&&this.max<this.baseValue&&(g=this.max);h&&g<this.minReal&&(g=this.minReal);this.baseCoord=this.getCoordinate(g,!0);g={type:"axisChanged",target:this,chart:a};g.min=h?this.minReal:this.min;g.max=this.max;this.fire(g);this.axisCreated=!0}h=this.axisLine.set;g=this.labelsSet;b.translate(this.x,this.y);g.translate(this.x,this.y);this.positionTitle();"radar"!=a.type&&h.toFront();!this.visible||e?(b.hide(),h.hide(),g.hide()):(b.show(),h.show(),g.show());this.axisY=this.y;this.axisX=this.x},getDateMinMax:function(){this.minimumDate&&(this.minimumDate instanceof Date||(this.minimumDate=d.getDate(this.minimumDate,this.chart.dataDateFormat,"fff")),this.min=this.minimumDate.getTime());this.maximumDate&&(this.maximumDate instanceof Date||(this.maximumDate=d.getDate(this.maximumDate,this.chart.dataDateFormat,"fff")),this.max=this.maximumDate.getTime())},formatValue:function(a,b,c){var e=this.exponential,h=this.logarithmic,f=this.numberFormatter,g=this.chart;if(f)return!0===this.logarithmic&&(e=-1!=String(a).indexOf("e")?!0:!1),this.useScientificNotation&&(e=!0),this.usePrefixes&&(e=!1),e?(c=-1==String(a).indexOf("e")?a.toExponential(15):String(a),e=c.split("e"),c=Number(e[0]),e=Number(e[1]),c=d.roundTo(c,14),10==c&&(c=1,e+=1),c=c+"e"+e,0===a&&(c="0"),1==a&&(c="1")):(h&&(e=String(a).split("."),e[1]?(f.precision=e[1].length,0>c&&(f.precision=Math.abs(c)),b&&1<a&&(f.precision=0)):f.precision=-1),c=this.usePrefixes?d.addPrefix(a,g.prefixesOfBigNumbers,g.prefixesOfSmallNumbers,f,!b):d.formatNumber(a,f,f.precision)),this.duration&&(b&&(f.precision=0),c=d.formatDuration(a,this.duration,"",this.durationUnits,this.maxInterval,f)),"date"==this.type&&(c=d.formatDate(new Date(a),this.currentDateFormat,g)),this.recalculateToPercents?c+="%":(b=this.unit)&&(c="left"==this.unitPosition?b+c:c+b),this.labelFunction&&(c="date"==this.type?this.labelFunction(c,new Date(a),this).toString():this.labelFunction(a,c,this).toString()),c},getMinorGridStep:function(a,b){var c=[5,4,2];60>b&&c.shift();for(var e=Math.floor(Math.log(Math.abs(a))*Math.LOG10E),d=0;d<c.length;d++){var f=a/c[d],g=Math.floor(Math.log(Math.abs(f))*Math.LOG10E);if(!(1<Math.abs(e-g)))if(1>a){if(g=Math.pow(10,-g)*f,g==Math.round(g))return f}else if(f==Math.round(f))return f}},stackGraphs:function(a){var b=this.stackType;"stacked"==b&&(b="regular");"line"==b&&(b="none");"100% stacked"==b&&(b="100%");this.stackType=b;var c=[],e=[],h=[],f=[],g,k=this.chart.graphs,l,m,n,q,p,t=this.baseValue,r=!1;if("line"==a||"step"==a||"smoothedLine"==a)r=!0;if(r&&("regular"==b||"100%"==b))for(q=0;q<k.length;q++)n=k[q],n.stackGraph=null,n.hidden||(m=n.type,n.chart==this.chart&&n.valueAxis==this&&a==m&&n.stackable&&(l&&(n.stackGraph=l),l=n));n=this.start-10;l=this.end+10;q=this.data.length-1;n=d.fitToBounds(n,0,q);l=d.fitToBounds(l,0,q);for(p=n;p<=l;p++){var u=0;for(q=0;q<k.length;q++)if(n=k[q],n.hidden)n.newStack&&(h[p]=NaN,e[p]=NaN);else if(m=n.type,n.chart==this.chart&&n.valueAxis==this&&a==m&&n.stackable)if(m=this.data[p].axes[this.id].graphs[n.id],g=m.values.value,isNaN(g))n.newStack&&(h[p]=NaN,e[p]=NaN);else{var x=d.getDecimals(g);u<x&&(u=x);isNaN(f[p])?f[p]=Math.abs(g):f[p]+=Math.abs(g);f[p]=d.roundTo(f[p],u);x=n.fillToGraph;r&&x&&(x=this.data[p].axes[this.id].graphs[x.id])&&(m.values.open=x.values.value);"regular"==b&&(r&&(isNaN(c[p])?(c[p]=g,m.values.close=g,m.values.open=this.baseValue):(isNaN(g)?m.values.close=c[p]:m.values.close=g+c[p],m.values.open=c[p],c[p]=m.values.close)),"column"==a&&(n.newStack&&(h[p]=NaN,e[p]=NaN),m.values.close=g,0>g?(m.values.close=g,isNaN(e[p])?m.values.open=t:(m.values.close+=e[p],m.values.open=e[p]),e[p]=m.values.close):(m.values.close=g,isNaN(h[p])?m.values.open=t:(m.values.close+=h[p],m.values.open=h[p]),h[p]=m.values.close)))}}for(p=this.start;p<=this.end;p++)for(q=0;q<k.length;q++)(n=k[q],n.hidden)?n.newStack&&(h[p]=NaN,e[p]=NaN):(m=n.type,n.chart==this.chart&&n.valueAxis==this&&a==m&&n.stackable&&(m=this.data[p].axes[this.id].graphs[n.id],g=m.values.value,isNaN(g)||(c=g/f[p]*100,m.values.percents=c,m.values.total=f[p],n.newStack&&(h[p]=NaN,e[p]=NaN),"100%"==b&&(isNaN(e[p])&&(e[p]=0),isNaN(h[p])&&(h[p]=0),0>c?(m.values.close=d.fitToBounds(c+e[p],-100,100),m.values.open=e[p],e[p]=m.values.close):(m.values.close=d.fitToBounds(c+h[p],-100,100),m.values.open=h[p],h[p]=m.values.close)))))},recalculate:function(){var a=this.chart,b=a.graphs,c;for(c=0;c<b.length;c++){var e=b[c];if(e.valueAxis==this){var h="value";if("candlestick"==e.type||"ohlc"==e.type)h="open";var f,g,k=this.end+2,k=d.fitToBounds(this.end+1,0,this.data.length-1),l=this.start;0<l&&l--;var m;g=this.start;e.compareFromStart&&(g=0);if(!isNaN(a.startTime)&&(m=a.categoryAxis)){var n=m.minDuration(),n=new Date(a.startTime+n/2),q=d.resetDateToMin(new Date(a.startTime),m.minPeriod).getTime();d.resetDateToMin(new Date(n),m.minPeriod).getTime()>q&&g++}if(m=a.recalculateFromDate)m=d.getDate(m,a.dataDateFormat,"fff"),g=a.getClosestIndex(a.chartData,"time",m.getTime(),!0,0,a.chartData.length),k=a.chartData.length-1;for(m=g;m<=k&&(g=this.data[m].axes[this.id].graphs[e.id],f=g.values[h],e.recalculateValue&&(f=g.dataContext[e.valueField+e.recalculateValue]),isNaN(f));m++);this.recBaseValue=f;for(h=l;h<=k;h++){g=this.data[h].axes[this.id].graphs[e.id];g.percents={};var l=g.values,p;for(p in l)g.percents[p]="percents"!=p?l[p]/f*100-100:l[p]}}}},getMinMax:function(){var a=!1,b=this.chart,c=b.graphs,e;for(e=0;e<c.length;e++){var h=c[e].type;("line"==h||"step"==h||"smoothedLine"==h)&&this.expandMinMax&&(a=!0)}a&&(0<this.start&&this.start--,this.end<this.data.length-1&&this.end++);"serial"==b.type&&(!0!==b.categoryAxis.parseDates||a||this.end<this.data.length-1&&this.end++);this.includeAllValues&&(this.start=0,this.end=this.data.length-1);a=this.minMaxMultiplier;b=this.getExtremes(this.start,this.end);this.min=b.min;this.max=b.max;this.minRR=this.min;this.maxRR=this.max;a=(this.max-this.min)*(a-1);this.min-=a;this.max+=a;a=this.guides.length;if(this.includeGuidesInMinMax&&0<a)for(b=0;b<a;b++)c=this.guides[b],c.toValue<this.min&&(this.min=c.toValue),c.value<this.min&&(this.min=c.value),c.toValue>this.max&&(this.max=c.toValue),c.value>this.max&&(this.max=c.value);isNaN(this.minimum)||(this.min=this.minimum);isNaN(this.maximum)||(this.max=this.maximum);"date"==this.type&&this.getDateMinMax();this.min>this.max&&(a=this.max,this.max=this.min,this.min=a);isNaN(this.minZoom)||(this.min=this.minZoom);isNaN(this.maxZoom)||(this.max=this.maxZoom);this.minCalc=this.min;this.maxCalc=this.max;this.minReal=this.min;this.maxReal=this.max;0===this.min&&0===this.max&&(this.max=9);this.min>this.max&&(this.min=this.max-1);a=this.min;b=this.max;c=this.max-this.min;e=0===c?Math.pow(10,Math.floor(Math.log(Math.abs(this.max))*Math.LOG10E))/10:Math.pow(10,Math.floor(Math.log(Math.abs(c))*Math.LOG10E))/10;isNaN(this.maximum)&&(this.max=Math.ceil(this.max/e)*e+e);isNaN(this.minimum)&&(this.min=Math.floor(this.min/e)*e-e);0>this.min&&0<=a&&(this.min=0);0<this.max&&0>=b&&(this.max=0);"100%"==this.stackType&&(this.min=0>this.min?-100:0,this.max=0>this.max?0:100);c=this.max-this.min;e=Math.pow(10,Math.floor(Math.log(Math.abs(c))*Math.LOG10E))/10;this.step=Math.ceil(c/this.gridCountR/e)*e;c=Math.pow(10,Math.floor(Math.log(Math.abs(this.step))*Math.LOG10E));c=d.fixStepE(c);e=Math.ceil(this.step/c);5<e&&(e=10);5>=e&&2<e&&(e=5);this.step=Math.ceil(this.step/(c*e))*c*e;1>c?(this.maxDecCount=Math.abs(Math.log(Math.abs(c))*Math.LOG10E),this.maxDecCount=Math.round(this.maxDecCount),this.step=d.roundTo(this.step,this.maxDecCount+1)):this.maxDecCount=0;this.min=this.step*Math.floor(this.min/this.step);this.max=this.step*Math.ceil(this.max/this.step);0>this.min&&0<=a&&(this.min=0);0<this.max&&0>=b&&(this.max=0);1<this.minReal&&1<this.max-this.minReal&&(this.minReal=Math.floor(this.minReal));c=Math.pow(10,Math.floor(Math.log(Math.abs(this.minReal))*Math.LOG10E));0===this.min&&(this.minReal=c);0===this.min&&1<this.minReal&&(this.minReal=1);0<this.min&&0<this.minReal-this.step&&(this.minReal=this.min+this.step<this.minReal?this.min+this.step:this.min);this.logarithmic&&(2<Math.log(b)*Math.LOG10E-Math.log(a)*Math.LOG10E?(this.minReal=this.min=Math.pow(10,Math.floor(Math.log(Math.abs(a))*Math.LOG10E)),this.max=Math.pow(10,Math.ceil(Math.log(Math.abs(b))*Math.LOG10E))):(a=Math.pow(10,Math.floor(Math.log(Math.abs(a))*Math.LOG10E))/10,Math.pow(10,Math.floor(Math.log(Math.abs(this.min))*Math.LOG10E))/10<a&&(this.minReal=this.min=10*a)))},getExtremes:function(a,b){var c,e,d;for(d=a;d<=b;d++){var f=this.data[d].axes[this.id].graphs,g;for(g in f)if(f.hasOwnProperty(g)){var k=this.chart.graphsById[g];if(k.includeInMinMax&&(!k.hidden||this.includeHidden)){isNaN(c)&&(c=Infinity);isNaN(e)&&(e=-Infinity);this.foundGraphs=!0;k=f[g].values;this.recalculateToPercents&&(k=f[g].percents);var l;if(this.minMaxField)l=k[this.minMaxField],l<c&&(c=l),l>e&&(e=l);else for(var m in k)k.hasOwnProperty(m)&&"percents"!=m&&"total"!=m&&(l=k[m],l<c&&(c=l),l>e&&(e=l))}}}return{min:c,max:e}},zoomOut:function(){this.maxZoom=this.minZoom=NaN;this.zoomToRelativeValues(0,1)},zoomToRelativeValues:function(a,b,c){if(this.reversed){var e=a;a=1-b;b=1-e}var d=this.fullMax,e=this.fullMin,f=e+(d-e)*a,g=e+(d-e)*b;this.logarithmic&&(d=Math.log(d)*Math.LOG10E-Math.log(e)*Math.LOG10E,f=Math.pow(10,d*a+Math.log(e)*Math.LOG10E),g=Math.pow(10,d*b+Math.log(e)*Math.LOG10E));return this.zoomToValues(f,g,c)},zoomToValues:function(a,b,c){if(b<a){var e=b;b=a;a=e}var h=this.fullMax,e=this.fullMin;this.relativeStart=(a-e)/(h-e);this.relativeEnd=(b-e)/(h-e);if(this.logarithmic){var h=Math.log(h)*Math.LOG10E-Math.log(e)*Math.LOG10E,f=Math.log(b)/Math.LN10-Math.log(e)*Math.LOG10E;this.relativeStart=(Math.log(a)/Math.LN10-Math.log(e)*Math.LOG10E)/h;this.relativeEnd=f/h}if(this.minZoom!=a||this.maxZoom!=b){if(0!==this.relativeStart||1!=this.relativeEnd)this.minZoom=a,this.maxZoom=b;e={type:"axisZoomed"};e.chart=this.chart;e.valueAxis=this;e.startValue=a;e.endValue=b;e.relativeStart=this.relativeStart;e.relativeEnd=this.relativeEnd;this.prevStartValue==a&&this.prevEndValue==b||this.fire(e);this.prevStartValue=a;this.prevEndValue=b;c||(a={},d.copyProperties(e,a),a.type="axisIntZoomed",this.fire(a));return!0}},coordinateToValue:function(a){if(isNaN(a))return NaN;var b=this.axisWidth,c=this.stepWidth,e=this.reversed,d=this.rotate,f=this.min,g=this.minReal;return!0===this.logarithmic?Math.pow(10,(d?!0===e?(b-a)/c:a/c:!0===e?a/c:(b-a)/c)+Math.log(g)*Math.LOG10E):!0===e?d?f-(a-b)/c:a/c+f:d?a/c+f:f-(a-b)/c},getCoordinate:function(a,b){if(isNaN(a))return NaN;var c=this.rotate,e=this.reversed,d=this.axisWidth,f=this.stepWidth,g=this.min,k=this.minReal;!0===this.logarithmic?(0===a&&(a=this.treatZeroAs),g=Math.log(a)*Math.LOG10E-Math.log(k)*Math.LOG10E,c=c?!0===e?d-f*g:f*g:!0===e?f*g:d-f*g):c=!0===e?c?d-f*(a-g):f*(a-g):c?f*(a-g):d-f*(a-g);1e7<Math.abs(c)&&(c=c/Math.abs(c)*1e7);b||(c=Math.round(c));return c},synchronizeWithAxis:function(a){this.synchronizeWith=a;this.listenTo(this.synchronizeWith,"axisChanged",this.handleSynchronization)},handleSynchronization:function(){if(this.synchronizeWith){d.isString(this.synchronizeWith)&&(this.synchronizeWith=this.chart.getValueAxisById(this.synchronizeWith));var a=this.synchronizeWith,b=a.min,c=a.max,a=a.step,e=this.synchronizationMultiplier;e&&(this.min=b*e,this.max=c*e,this.step=a*e,b=Math.abs(Math.log(Math.abs(Math.pow(10,Math.floor(Math.log(Math.abs(this.step))*Math.LOG10E))))*Math.LOG10E),this.maxDecCount=b=Math.round(b),this.draw())}}})})();(function(){var d=window.AmCharts;d.RecAxis=d.Class({construct:function(a){var b=a.chart,c=a.axisThickness,e=a.axisColor,h=a.axisAlpha,f=a.offset,g=a.dx,k=a.dy,l=a.x,m=a.y,n=a.height,q=a.width,p=b.container;"H"==a.orientation?(e=d.line(p,[0,q],[0,0],e,h,c),this.axisWidth=a.width,"bottom"==a.position?(k=c/2+f+n+m-1,c=l):(k=-c/2-f+m+k,c=g+l)):(this.axisWidth=a.height,"right"==a.position?(e=d.line(p,[0,0,-g],[0,n,n-k],e,h,c),k=m+k,c=c/2+f+g+q+l-1):(e=d.line(p,[0,0],[0,n],e,h,c),k=m,c=-c/2-f+l));e.translate(c,k);c=b.container.set();c.push(e);b.axesSet.push(c);d.setCN(b,e,a.bcn+"line");this.axisSet=c;this.set=e}})})();(function(){var d=window.AmCharts;d.RecItem=d.Class({construct:function(a,b,c,e,h,f,g,k,l,m,n,q){b=Math.round(b);var p=a.chart;this.value=c;void 0==c&&(c="");l||(l=0);void 0==e&&(e=!0);var t=p.fontFamily,r=a.fontSize;void 0==r&&(r=p.fontSize);var u=a.color;void 0==u&&(u=p.color);void 0!==n&&(u=n);var x=a.chart.container,z=x.set();this.set=z;var v=a.axisThickness,A=a.axisColor,y=a.axisAlpha,B=a.tickLength,D=a.gridAlpha,C=a.gridThickness,J=a.gridColor,H=a.dashLength,S=a.fillColor,O=a.fillAlpha,Q=a.labelsEnabled;n=a.labelRotationR;var ia=a.counter,I=a.inside,Z=a.labelOffset,va=a.dx,ma=a.dy,Oa=a.orientation,ea=a.position,ca=a.previousCoord,X=a.height,ya=a.width,da=a.offset,fa,za;g?(void 0!==g.id&&(q=p.classNamePrefix+"-guide-"+g.id),Q=!0,isNaN(g.tickLength)||(B=g.tickLength),void 0!=g.lineColor&&(J=g.lineColor),void 0!=g.color&&(u=g.color),isNaN(g.lineAlpha)||(D=g.lineAlpha),isNaN(g.dashLength)||(H=g.dashLength),isNaN(g.lineThickness)||(C=g.lineThickness),!0===g.inside&&(I=!0,0<da&&(da=0)),isNaN(g.labelRotation)||(n=g.labelRotation),isNaN(g.fontSize)||(r=g.fontSize),g.position&&(ea=g.position),void 0!==g.boldLabel&&(k=g.boldLabel),isNaN(g.labelOffset)||(Z=g.labelOffset)):""===c&&(B=0);m&&!isNaN(a.minorTickLength)&&(B=a.minorTickLength);var ga="start";0<h&&(ga="middle");a.centerLabels&&(ga="middle");var T=n*Math.PI/180,Y,Ca,G=0,w=0,na=0,ha=Y=0,Pa=0;"V"==Oa&&(n=0);var ba;Q&&""!==c&&(ba=a.autoWrap&&0===n?d.wrappedText(x,c,u,t,r,ga,k,Math.abs(h),0):d.text(x,c,u,t,r,ga,k),ga=ba.getBBox(),ha=ga.width,Pa=ga.height);if("H"==Oa){if(0<=b&&b<=ya+1&&(0<B&&0<y&&b+l<=ya+1&&(fa=d.line(x,[b+l,b+l],[0,B],A,y,C),z.push(fa)),0<D&&(za=d.line(x,[b,b+va,b+va],[X,X+ma,ma],J,D,C,H),z.push(za))),w=0,G=b,g&&90==n&&I&&(G-=r),!1===e?(ga="start",w="bottom"==ea?I?w+B:w-B:I?w-B:w+B,G+=3,0<h&&(G+=h/2-3,ga="middle"),0<n&&(ga="middle")):ga="middle",1==ia&&0<O&&!g&&!m&&ca<ya&&(e=d.fitToBounds(b,0,ya),ca=d.fitToBounds(ca,0,ya),Y=e-ca,0<Y&&(Ca=d.rect(x,Y,a.height,S,O),Ca.translate(e-Y+va,ma),z.push(Ca))),"bottom"==ea?(w+=X+r/2+da,I?(0<n?(w=X-ha/2*Math.sin(T)-B-3,G+=ha/2*Math.cos(T)-4+2):0>n?(w=X+ha*Math.sin(T)-B-3+2,G+=-ha*Math.cos(T)-Pa*Math.sin(T)-4):w-=B+r+3+3,w-=Z):(0<n?(w=X+ha/2*Math.sin(T)+B+3,G-=ha/2*Math.cos(T)):0>n?(w=X+B+3-ha/2*Math.sin(T)+2,G+=ha/2*Math.cos(T)):w+=B+v+3+3,w+=Z)):(w+=ma+r/2-da,G+=va,I?(0<n?(w=ha/2*Math.sin(T)+B+3,G-=ha/2*Math.cos(T)):w+=B+3,w+=Z):(0<n?(w=-(ha/2)*Math.sin(T)-B-6,G+=ha/2*Math.cos(T)):w-=B+r+3+v+3,w-=Z)),"bottom"==ea?Y=(I?X-B-1:X+v-1)+da:(na=va,Y=(I?ma:ma-B-v+1)-da),f&&(G+=f),f=G,0<n&&(f+=ha/2*Math.cos(T)),ba&&(r=0,I&&(r=ha/2*Math.cos(T)),f+r>ya+2||0>f))ba.remove(),ba=null}else{0<=b&&b<=X+1&&(0<B&&0<y&&b+l<=X+1&&(fa=d.line(x,[0,B+1],[b+l,b+l],A,y,C),z.push(fa)),0<D&&(za=d.line(x,[0,va,ya+va],[b,b+ma,b+ma],J,D,C,H),z.push(za)));ga="end";if(!0===I&&"left"==ea||!1===I&&"right"==ea)ga="start";w=b-Pa/2+2;1==ia&&0<O&&!g&&!m&&(e=d.fitToBounds(b,0,X),ca=d.fitToBounds(ca,0,X),T=e-ca,Ca=d.polygon(x,[0,a.width,a.width,0],[0,0,T,T],S,O),Ca.translate(va,e-T+ma),z.push(Ca));w+=r/2;"right"==ea?(G+=va+ya+da,w+=ma,I?(f||(w-=r/2+3),G=G-(B+4)-Z):(G+=B+4+v,w-=2,G+=Z)):I?(G+=B+4-da,f||(w-=r/2+3),g&&(G+=va,w+=ma),G+=Z):(G+=-B-v-4-2-da,w-=2,G-=Z);fa&&("right"==ea?(na+=va+da+ya-1,Y+=ma,na=I?na-v:na+v):(na-=da,I||(na-=B+v)));f&&(w+=f);I=-3;"right"==ea&&(I+=ma);ba&&(w>X+1||w<I)&&(ba.remove(),ba=null)}fa&&(fa.translate(na,Y),d.setCN(p,fa,a.bcn+"tick"),d.setCN(p,fa,q,!0),g&&d.setCN(p,fa,"guide"));!1===a.visible&&(fa&&fa.remove(),ba&&(ba.remove(),ba=null));ba&&(ba.attr({"text-anchor":ga}),ba.translate(G,w,NaN,!0),0!==n&&ba.rotate(-n,a.chart.backgroundColor),a.allLabels.push(ba),this.label=ba,d.setCN(p,ba,a.bcn+"label"),d.setCN(p,ba,q,!0),g&&d.setCN(p,ba,"guide"));za&&(d.setCN(p,za,a.bcn+"grid"),d.setCN(p,za,q,!0),g&&d.setCN(p,za,"guide"));Ca&&(d.setCN(p,Ca,a.bcn+"fill"),d.setCN(p,Ca,q,!0));m?za&&d.setCN(p,za,a.bcn+"grid-minor"):(a.counter=0===ia?1:0,a.previousCoord=b);0===this.set.node.childNodes.length&&this.set.remove()},graphics:function(){return this.set},getLabel:function(){return this.label}})})();(function(){var d=window.AmCharts;d.RecFill=d.Class({construct:function(a,b,c,e){var h=a.dx,f=a.dy,g=a.orientation,k=0;if(c<b){var l=b;b=c;c=l}var m=e.fillAlpha;isNaN(m)&&(m=0);var l=a.chart.container,n=e.fillColor;"V"==g?(b=d.fitToBounds(b,0,a.height),c=d.fitToBounds(c,0,a.height)):(b=d.fitToBounds(b,0,a.width),c=d.fitToBounds(c,0,a.width));c-=b;isNaN(c)&&(c=4,k=2,m=0);0>c&&"object"==typeof n&&(n=n.join(",").split(",").reverse());"V"==g?(g=d.rect(l,a.width,c,n,m),g.translate(h,b-k+f)):(g=d.rect(l,c,a.height,n,m),g.translate(b-k+h,f));d.setCN(a.chart,g,"guide-fill");e.id&&d.setCN(a.chart,g,"guide-fill-"+e.id);this.set=l.set([g])},graphics:function(){return this.set},getLabel:function(){}})})();(function(){var d=window.AmCharts;d.AmChart=d.Class({construct:function(a){this.svgIcons=this.tapToActivate=!0;this.theme=a;this.classNamePrefix="amcharts";this.addClassNames=!1;this.version="3.20.1";d.addChart(this);this.createEvents("buildStarted","dataUpdated","init","rendered","drawn","failed","resized","animationFinished");this.height=this.width="100%";this.dataChanged=!0;this.chartCreated=!1;this.previousWidth=this.previousHeight=0;this.backgroundColor="#FFFFFF";this.borderAlpha=this.backgroundAlpha=0;this.color=this.borderColor="#000000";this.fontFamily="Verdana";this.fontSize=11;this.usePrefixes=!1;this.autoResize=!0;this.autoDisplay=!1;this.addCodeCredits=this.accessible=!0;this.touchStartTime=this.touchClickDuration=0;this.precision=-1;this.percentPrecision=2;this.decimalSeparator=".";this.thousandsSeparator=",";this.labels=[];this.allLabels=[];this.titles=[];this.marginRight=this.marginLeft=this.autoMarginOffset=0;this.timeOuts=[];this.creditsPosition="top-left";var b=document.createElement("div"),c=b.style;c.overflow="hidden";c.position="relative";c.textAlign="left";this.chartDiv=b;b=document.createElement("div");c=b.style;c.overflow="hidden";c.position="relative";c.textAlign="left";this.legendDiv=b;this.titleHeight=0;this.hideBalloonTime=150;this.handDrawScatter=2;this.handDrawThickness=1;this.prefixesOfBigNumbers=[{number:1e3,prefix:"k"},{number:1e6,prefix:"M"},{number:1e9,prefix:"G"},{number:1e12,prefix:"T"},{number:1e15,prefix:"P"},{number:1e18,prefix:"E"},{number:1e21,prefix:"Z"},{number:1e24,prefix:"Y"}];this.prefixesOfSmallNumbers=[{number:1e-24,prefix:"y"},{number:1e-21,prefix:"z"},{number:1e-18,prefix:"a"},{number:1e-15,prefix:"f"},{number:1e-12,prefix:"p"},{number:1e-9,prefix:"n"},{number:1e-6,prefix:"μ"},{number:.001,prefix:"m"}];this.panEventsEnabled=!0;this.product="amcharts";this.animations=[];this.balloon=new d.AmBalloon(this.theme);this.balloon.chart=this;this.processTimeout=0;this.processCount=1e3;this.animatable=[];d.applyTheme(this,a,"AmChart")},drawChart:function(){0<this.realWidth&&0<this.realHeight&&(this.drawBackground(),this.redrawLabels(),this.drawTitles(),this.brr(),this.renderFix(),this.chartDiv&&(this.boundingRect=this.chartDiv.getBoundingClientRect()))},makeAccessible:function(a,b){this.accessible&&a&&(a.setAttr("role","img"),a.setAttr("aria-label",b))},drawBackground:function(){d.remove(this.background);var a=this.container,b=this.backgroundColor,c=this.backgroundAlpha,e=this.set;d.isModern||0!==c||(c=.001);var h=this.updateWidth();this.realWidth=h;var f=this.updateHeight();this.realHeight=f;b=d.polygon(a,[0,h-1,h-1,0],[0,0,f-1,f-1],b,c,1,this.borderColor,this.borderAlpha);d.setCN(this,b,"bg");this.background=b;e.push(b);if(b=this.backgroundImage)a=a.image(b,0,0,h,f),d.setCN(this,b,"bg-image"),this.bgImg=a,e.push(a)},drawTitles:function(a){var b=this.titles;this.titleHeight=0;if(d.ifArray(b)){var c=20,e;for(e=0;e<b.length;e++){var h=b[e],h=d.processObject(h,d.Title,this.theme);if(!1!==h.enabled){var f=h.color;void 0===f&&(f=this.color);var g=h.size;isNaN(g)&&(g=this.fontSize+2);isNaN(h.alpha);var k=this.marginLeft,l=!0;void 0!==h.bold&&(l=h.bold);f=d.wrappedText(this.container,h.text,f,this.fontFamily,g,"middle",l,this.realWidth-35);f.translate(k+(this.realWidth-this.marginRight-k)/2,c);f.node.style.pointerEvents="none";h.sprite=f;d.setCN(this,f,"title");h.id&&d.setCN(this,f,"title-"+h.id);f.attr({opacity:h.alpha});c+=f.getBBox().height+5;a?f.remove():this.freeLabelsSet.push(f)}}this.titleHeight=c-10}},write:function(a){var b=this;if(b.listeners)for(var c=0;c<b.listeners.length;c++){var e=b.listeners[c];b.addListener(e.event,e.method)}b.fire({type:"buildStarted",chart:b});b.afterWriteTO&&clearTimeout(b.afterWriteTO);0<b.processTimeout?b.afterWriteTO=setTimeout(function(){b.afterWrite.call(b,a)},b.processTimeout):b.afterWrite(a)},afterWrite:function(a){if(a="object"!=typeof a?document.getElementById(a):a){for(;a.firstChild;)a.removeChild(a.firstChild);this.div=a;a.style.overflow="hidden";a.style.textAlign="left";var b=this.chartDiv,c=this.legendDiv,e=this.legend,h=c.style,f=b.style;this.measure();this.previousHeight=this.divRealHeight;this.previousWidth=this.divRealWidth;var g,k=document.createElement("div");g=k.style;g.position="relative";this.containerDiv=k;k.className=this.classNamePrefix+"-main-div";b.className=this.classNamePrefix+"-chart-div";a.appendChild(k);var l=this.exportConfig;l&&d.AmExport&&!this.AmExport&&(this.AmExport=new d.AmExport(this,l));this.amExport&&d.AmExport&&(this.AmExport=d.extend(this.amExport,new d.AmExport(this),!0));this.AmExport&&this.AmExport.init&&this.AmExport.init();if(e){e=this.addLegend(e,e.divId);if(e.enabled)switch(h.left=null,h.top=null,h.right=null,f.left=null,f.right=null,f.top=null,h.position="relative",f.position="relative",e.position){case"bottom":k.appendChild(b);k.appendChild(c);break;case"top":k.appendChild(c);k.appendChild(b);break;case"absolute":g.width=a.style.width;g.height=a.style.height;h.position="absolute";f.position="absolute";void 0!==e.left&&(h.left=e.left+"px");void 0!==e.right&&(h.right=e.right+"px");void 0!==e.top&&(h.top=e.top+"px");void 0!==e.bottom&&(h.bottom=e.bottom+"px");e.marginLeft=0;e.marginRight=0;k.appendChild(b);k.appendChild(c);break;case"right":g.width=a.style.width;g.height=a.style.height;h.position="relative";f.position="absolute";k.appendChild(b);k.appendChild(c);break;case"left":g.width=a.style.width;g.height=a.style.height;h.position="absolute";f.position="relative";k.appendChild(b);k.appendChild(c);break;case"outside":k.appendChild(b)}else k.appendChild(b);this.prevLegendPosition=e.position}else k.appendChild(b);this.listenersAdded||(this.addListeners(),this.listenersAdded=!0);this.initChart()}},createLabelsSet:function(){d.remove(this.labelsSet);this.labelsSet=this.container.set();this.freeLabelsSet.push(this.labelsSet)},initChart:function(){this.balloon=d.processObject(this.balloon,d.AmBalloon,this.theme);window.AmCharts_path&&(this.path=window.AmCharts_path);void 0===this.path&&(this.path=d.getPath());void 0===this.path&&(this.path="amcharts/");this.path=d.normalizeUrl(this.path);void 0===this.pathToImages&&(this.pathToImages=this.path+"images/");this.initHC||(d.callInitHandler(this),this.initHC=!0);d.applyLang(this.language,this);var a=this.numberFormatter;a&&(isNaN(a.precision)||(this.precision=a.precision),void 0!==a.thousandsSeparator&&(this.thousandsSeparator=a.thousandsSeparator),void 0!==a.decimalSeparator&&(this.decimalSeparator=a.decimalSeparator));(a=this.percentFormatter)&&!isNaN(a.precision)&&(this.percentPrecision=a.precision);this.nf={precision:this.precision,thousandsSeparator:this.thousandsSeparator,decimalSeparator:this.decimalSeparator};this.pf={precision:this.percentPrecision,thousandsSeparator:this.thousandsSeparator,decimalSeparator:this.decimalSeparator};this.destroy();(a=this.container)?(a.container.innerHTML="",a.width=this.realWidth,a.height=this.realHeight,a.addDefs(this),this.chartDiv.appendChild(a.container)):a=new d.AmDraw(this.chartDiv,this.realWidth,this.realHeight,this);this.container=a;this.extension=".png";this.svgIcons&&d.SVG&&(this.extension=".svg");this.checkDisplay();a.chart=this;d.VML||d.SVG?(a.handDrawn=this.handDrawn,a.handDrawScatter=this.handDrawScatter,a.handDrawThickness=this.handDrawThickness,d.remove(this.set),this.set=a.set(),d.remove(this.gridSet),this.gridSet=a.set(),d.remove(this.cursorLineSet),this.cursorLineSet=a.set(),d.remove(this.graphsBehindSet),this.graphsBehindSet=a.set(),d.remove(this.bulletBehindSet),this.bulletBehindSet=a.set(),d.remove(this.columnSet),this.columnSet=a.set(),d.remove(this.graphsSet),this.graphsSet=a.set(),d.remove(this.trendLinesSet),this.trendLinesSet=a.set(),d.remove(this.axesSet),this.axesSet=a.set(),d.remove(this.cursorSet),this.cursorSet=a.set(),d.remove(this.scrollbarsSet),this.scrollbarsSet=a.set(),d.remove(this.bulletSet),this.bulletSet=a.set(),d.remove(this.freeLabelsSet),this.freeLabelsSet=a.set(),d.remove(this.axesLabelsSet),this.axesLabelsSet=a.set(),d.remove(this.balloonsSet),this.balloonsSet=a.set(),d.remove(this.plotBalloonsSet),this.plotBalloonsSet=a.set(),d.remove(this.zoomButtonSet),this.zoomButtonSet=a.set(),d.remove(this.zbSet),this.zbSet=null,d.remove(this.linkSet),this.linkSet=a.set()):this.fire({type:"failed",chart:this})},premeasure:function(){var a=this.div;if(a){try{this.boundingRect=this.chartDiv.getBoundingClientRect()}catch(e){}var b=a.offsetWidth,c=a.offsetHeight;a.clientHeight&&(b=a.clientWidth,c=a.clientHeight);if(b!=this.mw||c!=this.mh)this.mw=b,this.mh=c,this.measure()}},measure:function(){var a=this.div;if(a){var b=this.chartDiv,c=a.offsetWidth,e=a.offsetHeight,h=this.container;a.clientHeight&&(c=a.clientWidth,e=a.clientHeight);var f=d.removePx(d.getStyle(a,"padding-left")),g=d.removePx(d.getStyle(a,"padding-right")),k=d.removePx(d.getStyle(a,"padding-top")),l=d.removePx(d.getStyle(a,"padding-bottom"));isNaN(f)||(c-=f);isNaN(g)||(c-=g);isNaN(k)||(e-=k);isNaN(l)||(e-=l);f=a.style;a=f.width;f=f.height;-1!=a.indexOf("px")&&(c=d.removePx(a));-1!=f.indexOf("px")&&(e=d.removePx(f));e=Math.round(e);c=Math.round(c);a=Math.round(d.toCoordinate(this.width,c));f=Math.round(d.toCoordinate(this.height,e));(c!=this.previousWidth||e!=this.previousHeight)&&0<a&&0<f&&(b.style.width=a+"px",b.style.height=f+"px",b.style.padding=0,h&&h.setSize(a,f),this.balloon=d.processObject(this.balloon,d.AmBalloon,this.theme));this.balloon.setBounds&&this.balloon.setBounds(2,2,a-2,f);this.balloon.chart=this;this.realWidth=a;this.realHeight=f;this.divRealWidth=c;this.divRealHeight=e}},checkDisplay:function(){if(this.autoDisplay&&this.container){var a=d.rect(this.container,10,10),b=a.getBBox();0===b.width&&0===b.height&&(this.divRealHeight=this.divRealWidth=this.realHeight=this.realWidth=0,this.previousWidth=this.previousHeight=NaN);a.remove()}},destroy:function(){this.chartDiv.innerHTML="";this.clearTimeOuts();this.legend&&this.legend.destroy()},clearTimeOuts:function(){var a=this.timeOuts;if(a){var b;for(b=0;b<a.length;b++)clearTimeout(a[b])}this.timeOuts=[]},clear:function(a){d.callMethod("clear",[this.chartScrollbar,this.scrollbarV,this.scrollbarH,this.chartCursor]);this.chartCursor=this.scrollbarH=this.scrollbarV=this.chartScrollbar=null;this.clearTimeOuts();this.container&&(this.container.remove(this.chartDiv),this.container.remove(this.legendDiv));a||d.removeChart(this);if(a=this.div)for(;a.firstChild;)a.removeChild(a.firstChild);this.legend&&this.legend.destroy()},setMouseCursor:function(a){"auto"==a&&d.isNN&&(a="default");this.chartDiv.style.cursor=a;this.legendDiv.style.cursor=a},redrawLabels:function(){this.labels=[];var a=this.allLabels;this.createLabelsSet();var b;for(b=0;b<a.length;b++)this.drawLabel(a[b])},drawLabel:function(a){var b=this;if(b.container&&!1!==a.enabled){a=d.processObject(a,d.Label,b.theme);var c=a.y,e=a.text,h=a.align,f=a.size,g=a.color,k=a.rotation,l=a.alpha,m=a.bold,n=d.toCoordinate(a.x,b.realWidth),c=d.toCoordinate(c,b.realHeight);n||(n=0);c||(c=0);void 0===g&&(g=b.color);isNaN(f)&&(f=b.fontSize);h||(h="start");"left"==h&&(h="start");"right"==h&&(h="end");"center"==h&&(h="middle",k?c=b.realHeight-c+c/2:n=b.realWidth/2-n);void 0===l&&(l=1);void 0===k&&(k=0);c+=f/2;e=d.text(b.container,e,g,b.fontFamily,f,h,m,l);e.translate(n,c);d.setCN(b,e,"label");a.id&&d.setCN(b,e,"label-"+a.id);0!==k&&e.rotate(k);a.url?(e.setAttr("cursor","pointer"),e.click(function(){d.getURL(a.url,b.urlTarget)})):e.node.style.pointerEvents="none";b.labelsSet.push(e);b.labels.push(e)}},addLabel:function(a,b,c,e,d,f,g,k,l,m){a={x:a,y:b,text:c,align:e,size:d,color:f,alpha:k,rotation:g,bold:l,url:m,enabled:!0};this.container&&this.drawLabel(a);this.allLabels.push(a)},clearLabels:function(){var a=this.labels,b;for(b=a.length-1;0<=b;b--)a[b].remove();this.labels=[];this.allLabels=[]},updateHeight:function(){var a=this.divRealHeight,b=this.legend;if(b){var c=this.legendDiv.offsetHeight,b=b.position;if("top"==b||"bottom"==b){a-=c;if(0>a||isNaN(a))a=0;this.chartDiv.style.height=a+"px"}}return a},updateWidth:function(){var a=this.divRealWidth,b=this.divRealHeight,c=this.legend;if(c){var e=this.legendDiv,d=e.offsetWidth;isNaN(c.width)||(d=c.width);c.ieW&&(d=c.ieW);var f=e.offsetHeight,e=e.style,g=this.chartDiv.style,c=c.position;if("right"==c||"left"==c){a-=d;if(0>a||isNaN(a))a=0;g.width=a+"px";this.balloon.setBounds(2,2,a-2,this.realHeight);"left"==c?(g.left=d+"px",e.left="0px"):(g.left="0px",e.left=a+"px");b>f&&(e.top=(b-f)/2+"px")}}return a},getTitleHeight:function(){this.drawTitles(!0);return this.titleHeight},addTitle:function(a,b,c,e,d){isNaN(b)&&(b=this.fontSize+2);a={text:a,size:b,color:c,alpha:e,bold:d,enabled:!0};this.titles.push(a);return a},handleWheel:function(a){var b=0;a||(a=window.event);a.wheelDelta?b=a.wheelDelta/120:a.detail&&(b=-a.detail/3);b&&this.handleWheelReal(b,a.shiftKey);a.preventDefault&&a.preventDefault()},handleWheelReal:function(){},handleDocTouchStart:function(){this.hideBalloonReal();this.handleMouseMove();this.tmx=this.mouseX;this.tmy=this.mouseY;this.touchStartTime=(new Date).getTime()},handleDocTouchEnd:function(){-.5<this.tmx&&this.tmx<this.divRealWidth+1&&0<this.tmy&&this.tmy<this.divRealHeight?(this.handleMouseMove(),4>Math.abs(this.mouseX-this.tmx)&&4>Math.abs(this.mouseY-this.tmy)?(this.tapped=!0,this.panRequired&&this.panEventsEnabled&&this.chartDiv&&(this.chartDiv.style.msTouchAction="none",this.chartDiv.style.touchAction="none")):this.mouseIsOver||this.resetTouchStyle()):(this.tapped=!1,this.resetTouchStyle())},resetTouchStyle:function(){this.panEventsEnabled&&this.chartDiv&&(this.chartDiv.style.msTouchAction="auto",this.chartDiv.style.touchAction="auto")},checkTouchDuration:function(a){var b=this,c=(new Date).getTime();if(a)if(a.touches)b.isTouchEvent=!0;else if(!b.isTouchEvent)return!0;if(c-b.touchStartTime>b.touchClickDuration)return!0;setTimeout(function(){b.resetTouchDuration()},300)},resetTouchDuration:function(){this.isTouchEvent=!1},checkTouchMoved:function(){if(4<Math.abs(this.mouseX-this.tmx)||4<Math.abs(this.mouseY-this.tmy))return!0},addListeners:function(){var a=this,b=a.chartDiv;document.addEventListener?("ontouchstart"in document.documentElement&&(b.addEventListener("touchstart",function(b){a.handleTouchStart.call(a,b)},!0),b.addEventListener("touchmove",function(b){a.handleMouseMove.call(a,b)},!0),b.addEventListener("touchend",function(b){a.handleTouchEnd.call(a,b)},!0),document.addEventListener("touchstart",function(b){a.handleDocTouchStart.call(a,b)}),document.addEventListener("touchend",function(b){a.handleDocTouchEnd.call(a,b)})),b.addEventListener("mousedown",function(b){a.mouseIsOver=!0;a.handleMouseMove.call(a,b);a.handleMouseDown.call(a,b);a.handleDocTouchStart.call(a,b)},!0),b.addEventListener("mouseover",function(b){a.handleMouseOver.call(a,b)},!0),b.addEventListener("mouseout",function(b){a.handleMouseOut.call(a,b)},!0),b.addEventListener("mouseup",function(b){a.handleDocTouchEnd.call(a,b)},!0)):(b.attachEvent("onmousedown",function(b){a.handleMouseDown.call(a,b)}),b.attachEvent("onmouseover",function(b){a.handleMouseOver.call(a,b)}),b.attachEvent("onmouseout",function(b){a.handleMouseOut.call(a,b)}))},dispDUpd:function(){this.skipEvents||(this.dispatchDataUpdated&&(this.dispatchDataUpdated=!1,this.fire({type:"dataUpdated",chart:this})),this.chartCreated||(this.chartCreated=!0,this.fire({type:"init",chart:this})),this.chartRendered||(this.fire({type:"rendered",chart:this}),this.chartRendered=!0),this.fire({type:"drawn",chart:this}));this.skipEvents=!1},validateSize:function(){var a=this;a.premeasure();a.checkDisplay();if(a.divRealWidth!=a.previousWidth||a.divRealHeight!=a.previousHeight){var b=a.legend;if(0<a.realWidth&&0<a.realHeight){a.sizeChanged=!0;if(b){a.legendInitTO&&clearTimeout(a.legendInitTO);var c=setTimeout(function(){b.invalidateSize()},10);a.timeOuts.push(c);a.legendInitTO=c}a.marginsUpdated=!1;clearTimeout(a.initTO);c=setTimeout(function(){a.initChart()},10);a.timeOuts.push(c);a.initTO=c}a.renderFix();b&&b.renderFix&&b.renderFix();clearTimeout(a.resizedTO);a.resizedTO=setTimeout(function(){a.fire({type:"resized",chart:a})},10);a.previousHeight=a.divRealHeight;a.previousWidth=a.divRealWidth}},invalidateSize:function(){this.previousHeight=this.previousWidth=NaN;this.invalidateSizeReal()},invalidateSizeReal:function(){var a=this;a.marginsUpdated=!1;clearTimeout(a.validateTO);var b=setTimeout(function(){a.validateSize()},5);a.timeOuts.push(b);a.validateTO=b},validateData:function(a){this.chartCreated&&(this.dataChanged=!0,this.marginsUpdated=!1,this.initChart(a))},validateNow:function(a,b){this.initTO&&clearTimeout(this.initTO);a&&(this.dataChanged=!0,this.marginsUpdated=!1);this.skipEvents=b;this.chartRendered=!1;var c=this.legend;c&&c.position!=this.prevLegendPosition&&(this.previousWidth=this.mw=0,c.invalidateSize&&(c.invalidateSize(),this.validateSize()));this.write(this.div)},showItem:function(a){a.hidden=!1;this.initChart()},hideItem:function(a){a.hidden=!0;this.initChart()},hideBalloon:function(){var a=this;clearTimeout(a.hoverInt);clearTimeout(a.balloonTO);a.hoverInt=setTimeout(function(){a.hideBalloonReal.call(a)},a.hideBalloonTime)},cleanChart:function(){},hideBalloonReal:function(){var a=this.balloon;a&&a.hide&&a.hide()},showBalloon:function(a,b,c,e,d){var f=this;clearTimeout(f.balloonTO);clearTimeout(f.hoverInt);f.balloonTO=setTimeout(function(){f.showBalloonReal.call(f,a,b,c,e,d)},1)},showBalloonReal:function(a,b,c,e,d){this.handleMouseMove();var f=this.balloon;f.enabled&&(f.followCursor(!1),f.changeColor(b),!c||f.fixedPosition?(f.setPosition(e,d),isNaN(e)||isNaN(d)?f.followCursor(!0):f.followCursor(!1)):f.followCursor(!0),a&&f.showBalloon(a))},handleMouseOver:function(){this.outTO&&clearTimeout(this.outTO);d.resetMouseOver();this.mouseIsOver=!0},handleMouseOut:function(){var a=this;d.resetMouseOver();a.outTO&&clearTimeout(a.outTO);a.outTO=setTimeout(function(){a.handleMouseOutReal()},10)},handleMouseOutReal:function(){this.mouseIsOver=!1},handleMouseMove:function(a){a||(a=window.event);this.mouse2Y=this.mouse2X=NaN;var b,c,e,d;if(a){if(a.touches){var f=a.touches.item(1);f&&this.panEventsEnabled&&this.boundingRect&&(e=f.clientX-this.boundingRect.left,d=f.clientY-this.boundingRect.top);a=a.touches.item(0);if(!a)return}else this.wasTouched=!1;this.boundingRect&&a.clientX&&(b=a.clientX-this.boundingRect.left,c=a.clientY-this.boundingRect.top);isNaN(e)?this.mouseX=b:(this.mouseX=Math.min(b,e),this.mouse2X=Math.max(b,e));isNaN(d)?this.mouseY=c:(this.mouseY=Math.min(c,d),this.mouse2Y=Math.max(c,d))}},handleTouchStart:function(a){this.hideBalloonReal();a&&(a.touches&&this.tapToActivate&&!this.tapped||!this.panRequired)||(this.handleMouseMove(a),this.handleMouseDown(a))},handleTouchEnd:function(a){this.wasTouched=!0;this.handleMouseMove(a);d.resetMouseOver();this.handleReleaseOutside(a)},handleReleaseOutside:function(){this.handleDocTouchEnd.call(this)},handleMouseDown:function(a){d.resetMouseOver();this.mouseIsOver=!0;a&&a.preventDefault&&(this.panEventsEnabled?a.preventDefault():a.touches||a.preventDefault())},addLegend:function(a,b){a=d.processObject(a,d.AmLegend,this.theme);a.divId=b;a.ieW=0;var c;c="object"!=typeof b&&b?document.getElementById(b):b;this.legend=a;a.chart=this;c?(a.div=c,a.position="outside",a.autoMargins=!1):a.div=this.legendDiv;return a},removeLegend:function(){this.legend=void 0;this.previousWidth=0;this.legendDiv.innerHTML=""},handleResize:function(){(d.isPercents(this.width)||d.isPercents(this.height))&&this.invalidateSizeReal();this.renderFix()},renderFix:function(){if(!d.VML){var a=this.container;a&&a.renderFix()}},getSVG:function(){if(d.hasSVG)return this.container},animate:function(a,b,c,e,h,f,g){a["an_"+b]&&d.removeFromArray(this.animations,a["an_"+b]);c={obj:a,frame:0,attribute:b,from:c,to:e,time:h,effect:f,suffix:g};a["an_"+b]=c;this.animations.push(c);return c},setLegendData:function(a){var b=this.legend;b&&b.setData(a)},stopAnim:function(a){d.removeFromArray(this.animations,a)},updateAnimations:function(){var a;this.container&&this.container.update();if(this.animations)for(a=this.animations.length-1;0<=a;a--){var b=this.animations[a],c=d.updateRate*b.time,e=b.frame+1,h=b.obj,f=b.attribute;if(e<=c){b.frame++;var g=Number(b.from),k=Number(b.to)-g,c=d[b.effect](0,e,g,k,c);0===k?(this.animations.splice(a,1),h.node.style[f]=Number(b.to)+b.suffix):h.node.style[f]=c+b.suffix}else h.node.style[f]=Number(b.to)+b.suffix,h.animationFinished=!0,this.animations.splice(a,1)}},update:function(){this.updateAnimations();var a=this.animatable;if(0<a.length){for(var b=!0,c=a.length-1;0<=c;c--){var e=a[c];e&&(e.animationFinished?a.splice(c,1):b=!1)}b&&(this.fire({type:"animationFinished",chart:this}),this.animatable=[])}},inIframe:function(){try{return window.self!==window.top}catch(a){return!0}},brr:function(){if(!this.hideCredits){var a="amcharts.com",b=window.location.hostname.split("."),c;2<=b.length&&(c=b[b.length-2]+"."+b[b.length-1]);this.amLink&&(b=this.amLink.parentNode)&&b.removeChild(this.amLink);b=this.creditsPosition;if(c!=a||!0===this.inIframe()){var a="http://www."+a,e=c=0,d=this.realWidth,f=this.realHeight,g=this.type;if("serial"==g||"xy"==g||"gantt"==g)c=this.marginLeftReal,e=this.marginTopReal,d=c+this.plotAreaWidth,f=e+this.plotAreaHeight;var g=a+"/javascript-charts/",k="JavaScript charts",l="";"ammap"==this.product&&(g=a+"/javascript-maps/",k="Interactive JavaScript maps",l="JS map by amCharts");a=document.createElement("a");l=document.createTextNode(l);a.setAttribute("href",g);a.setAttribute("title",k);this.urlTarget&&a.setAttribute("target",this.urlTarget);a.appendChild(l);this.chartDiv.appendChild(a);this.amLink=a;g=a.style;g.position="absolute";g.textDecoration="none";g.color=this.color;g.fontFamily=this.fontFamily;g.fontSize="11px";g.opacity=.7;g.display="block";var k=a.offsetWidth,a=a.offsetHeight,l=5+c,m=e+5;"bottom-left"==b&&(l=5+c,m=f-a-3);"bottom-right"==b&&(l=d-k-5,m=f-a-3);"top-right"==b&&(l=d-k-5,m=e+5);g.left=l+"px";g.top=m+"px"}}}});d.Slice=d.Class({construct:function(){}});d.SerialDataItem=d.Class({construct:function(){}});d.GraphDataItem=d.Class({construct:function(){}});d.Guide=d.Class({construct:function(a){this.cname="Guide";d.applyTheme(this,a,this.cname)}});d.Title=d.Class({construct:function(a){this.cname="Title";d.applyTheme(this,a,this.cname)}});d.Label=d.Class({construct:function(a){this.cname="Label";d.applyTheme(this,a,this.cname)}})})();(function(){var d=window.AmCharts;d.AmGraph=d.Class({construct:function(a){this.cname="AmGraph";this.createEvents("rollOverGraphItem","rollOutGraphItem","clickGraphItem","doubleClickGraphItem","rightClickGraphItem","clickGraph","rollOverGraph","rollOutGraph");this.type="line";this.stackable=!0;this.columnCount=1;this.columnIndex=0;this.centerCustomBullets=this.showBalloon=!0;this.maxBulletSize=50;this.minBulletSize=4;this.balloonText="[[value]]";this.hidden=this.scrollbar=this.animationPlayed=!1;this.pointPosition="middle";this.depthCount=1;this.includeInMinMax=!0;this.negativeBase=0;this.visibleInLegend=!0;this.showAllValueLabels=!1;this.showBulletsAt=this.showBalloonAt="close";this.lineThickness=1;this.dashLength=0;this.connect=!0;this.lineAlpha=1;this.bullet="none";this.bulletBorderThickness=2;this.bulletBorderAlpha=0;this.bulletAlpha=1;this.bulletSize=8;this.cornerRadiusTop=this.hideBulletsCount=this.bulletOffset=0;this.cursorBulletAlpha=1;this.gradientOrientation="vertical";this.dy=this.dx=0;this.periodValue="";this.clustered=!0;this.periodSpan=1;this.accessibleLabel="[[title]] [[value]]";this.y=this.x=0;this.switchable=!0;this.tcc=this.minDistance=1;this.labelRotation=0;this.labelAnchor="auto";this.labelOffset=3;this.bcn="graph-";this.dateFormat="MMM DD, YYYY";this.noRounding=!0;d.applyTheme(this,a,this.cname)},init:function(){this.createBalloon()},draw:function(){var a=this.chart;a.isRolledOverBullet=!1;var b=a.type;if(a.drawGraphs){isNaN(this.precision)||(this.numberFormatter?this.numberFormatter.precision=this.precision:this.numberFormatter={precision:this.precision,decimalSeparator:a.decimalSeparator,thousandsSeparator:a.thousandsSeparator});var c=a.container;this.container=c;this.destroy();var e=c.set();this.set=e;e.translate(this.x,this.y);var h=c.set();this.bulletSet=h;h.translate(this.x,this.y);this.behindColumns?(a.graphsBehindSet.push(e),a.bulletBehindSet.push(h)):(a.graphsSet.push(e),a.bulletSet.push(h));var f=this.bulletAxis;d.isString(f)&&(this.bulletAxis=a.getValueAxisById(f));c=c.set();d.remove(this.columnsSet);this.columnsSet=c;d.setCN(a,e,"graph-"+this.type);d.setCN(a,e,"graph-"+this.id);d.setCN(a,h,"graph-"+this.type);d.setCN(a,h,"graph-"+this.id);this.columnsArray=[];this.ownColumns=[];this.allBullets=[];this.animationArray=[];h=this.labelPosition;h||(f=this.valueAxis.stackType,h="top","column"==this.type&&(a.rotate&&(h="right"),"100%"==f||"regular"==f)&&(h="middle"),this.labelPosition=h);d.ifArray(this.data)&&(a=!1,"xy"==b?this.xAxis.axisCreated&&this.yAxis.axisCreated&&(a=!0):this.valueAxis.axisCreated&&(a=!0),!this.hidden&&a&&this.createGraph());e.push(c)}},createGraph:function(){var a=this,b=a.chart;a.startAlpha=b.startAlpha;a.seqAn=b.sequencedAnimation;a.baseCoord=a.valueAxis.baseCoord;void 0===a.fillAlphas&&(a.fillAlphas=0);a.bulletColorR=a.bulletColor;void 0===a.bulletColorR&&(a.bulletColorR=a.lineColorR,a.bulletColorNegative=a.negativeLineColor);void 0===a.bulletAlpha&&(a.bulletAlpha=a.lineAlpha);if("step"==c||d.VML)a.noRounding=!1;var c=b.type;"gantt"==c&&(c="serial");clearTimeout(a.playedTO);if(!isNaN(a.valueAxis.min)&&!isNaN(a.valueAxis.max)){switch(c){case"serial":a.categoryAxis&&(a.createSerialGraph(),"candlestick"==a.type&&1>a.valueAxis.minMaxMultiplier&&a.positiveClip(a.set));break;case"radar":a.createRadarGraph();break;case"xy":a.createXYGraph()}a.playedTO=setTimeout(function(){a.setAnimationPlayed.call(a)},500*a.chart.startDuration)}},setAnimationPlayed:function(){this.animationPlayed=!0},createXYGraph:function(){var a=[],b=[],c=this.xAxis,e=this.yAxis;this.pmh=e.height;this.pmw=c.width;this.pmy=this.pmx=0;var d;for(d=this.start;d<=this.end;d++){var f=this.data[d].axes[c.id].graphs[this.id],g=f.values,k=g.x,l=g.y,g=c.getCoordinate(k,this.noRounding),m=e.getCoordinate(l,this.noRounding);if(!isNaN(k)&&!isNaN(l)&&(a.push(g),b.push(m),f.x=g,f.y=m,k=this.createBullet(f,g,m,d),l=this.labelText)){var l=this.createLabel(f,l),n=0;k&&(n=k.size);this.positionLabel(f,g,m,l,n)}}this.drawLineGraph(a,b);this.launchAnimation()},createRadarGraph:function(){var a=this.valueAxis.stackType,b=[],c=[],e=[],d=[],f,g,k,l,m;for(m=this.start;m<=this.end;m++){var n=this.data[m].axes[this.valueAxis.id].graphs[this.id],q,p;"none"==a||"3d"==a?q=n.values.value:(q=n.values.close,p=n.values.open);if(isNaN(q))this.connect||(this.drawLineGraph(b,c,e,d),b=[],c=[],e=[],d=[]);else{var t=this.valueAxis.getCoordinate(q,this.noRounding)-this.height,t=t*this.valueAxis.rMultiplier,r=-360/(this.end-this.start+1)*m;"middle"==this.valueAxis.pointPosition&&(r-=180/(this.end-this.start+1));q=t*Math.sin(r/180*Math.PI);t*=Math.cos(r/180*Math.PI);b.push(q);c.push(t);if(!isNaN(p)){var u=this.valueAxis.getCoordinate(p,this.noRounding)-this.height,u=u*this.valueAxis.rMultiplier,x=u*Math.sin(r/180*Math.PI),r=u*Math.cos(r/180*Math.PI);e.push(x);d.push(r);isNaN(k)&&(k=x);isNaN(l)&&(l=r)}r=this.createBullet(n,q,t,m);n.x=q;n.y=t;if(x=this.labelText)x=this.createLabel(n,x),u=0,r&&(u=r.size),this.positionLabel(n,q,t,x,u);isNaN(f)&&(f=q);isNaN(g)&&(g=t)}}b.push(f);c.push(g);isNaN(k)||(e.push(k),d.push(l));this.drawLineGraph(b,c,e,d);this.launchAnimation()},positionLabel:function(a,b,c,e,d){if(e){var f=this.chart,g=this.valueAxis,k="middle",l=!1,m=this.labelPosition,n=e.getBBox(),q=this.chart.rotate,p=a.isNegative,t=this.fontSize;void 0===t&&(t=this.chart.fontSize);c-=n.height/2-t/2-1;void 0!==a.labelIsNegative&&(p=a.labelIsNegative);switch(m){case"right":m=q?p?"left":"right":"right";break;case"top":m=q?"top":p?"bottom":"top";break;case"bottom":m=q?"bottom":p?"top":"bottom";break;case"left":m=q?p?"right":"left":"left"}var t=a.columnGraphics,r=0,u=0;t&&(r=t.x,u=t.y);var x=this.labelOffset;switch(m){case"right":k="start";b+=d/2+x;break;case"top":c=g.reversed?c+(d/2+n.height/2+x):c-(d/2+n.height/2+x);break;case"bottom":c=g.reversed?c-(d/2+n.height/2+x):c+(d/2+n.height/2+x);break;case"left":k="end";b-=d/2+x;break;case"inside":"column"==this.type&&(l=!0,q?p?(k="end",b=r-3-x):(k="start",b=r+3+x):c=p?u+7+x:u-10-x);break;case"middle":"column"==this.type&&(l=!0,q?b-=(b-r)/2+x-3:c-=(c-u)/2+x-3)}"auto"!=this.labelAnchor&&(k=this.labelAnchor);e.attr({"text-anchor":k});this.labelRotation&&e.rotate(this.labelRotation);e.translate(b,c);!this.showAllValueLabels&&t&&l&&(n=e.getBBox(),n.height>a.columnHeight||n.width>a.columnWidth)&&(e.remove(),e=null);e&&"radar"!=f.type&&(0>b||b>this.width||0>c||c>this.height)&&(e.remove(),e=null);if(e&&("serial"==f.type||"gantt"==f.type))if(q){if(0>c||c>this.height)e.remove(),e=null}else if(0>b||b>this.width)e.remove(),e=null;e&&this.allBullets.push(e);return e}},getGradRotation:function(){var a=270;"horizontal"==this.gradientOrientation&&(a=0);return this.gradientRotation=a},createSerialGraph:function(){this.dashLengthSwitched=this.fillColorsSwitched=this.lineColorSwitched=void 0;var a=this.chart,b=this.id,c=this.index,e=this.data,h=this.chart.container,f=this.valueAxis,g=this.type,k=this.columnWidthReal,l=this.showBulletsAt;isNaN(this.columnWidth)||(k=this.columnWidth);isNaN(k)&&(k=.8);var m=this.useNegativeColorIfDown,n=this.width,q=this.height,p=this.y,t=this.rotate,r=this.columnCount,u=d.toCoordinate(this.cornerRadiusTop,k/2),x=this.connect,z=[],v=[],A,y,B,D,C=this.chart.graphs.length,J,H=this.dx/this.tcc,S=this.dy/this.tcc,O=f.stackType,Q=this.start,ia=this.end,I=this.scrollbar,Z="graph-column-";I&&(Z="scrollbar-graph-column-");var va=this.categoryAxis,ma=this.baseCoord,Oa=this.negativeBase,ea=this.columnIndex,ca=this.lineThickness,X=this.lineAlpha,ya=this.lineColorR,da=this.dashLength,fa=this.set,za,ga=this.getGradRotation(),T=this.chart.columnSpacing,Y=va.cellWidth,Ca=(Y*k-r)/r;T>Ca&&(T=Ca);var G,w,na,ha=q,Pa=n,ba=0,tb=0,ub,vb,gb,hb,wb=this.fillColorsR,Qa=this.negativeFillColors,Ja=this.negativeLineColor,Ya=this.fillAlphas,Za=this.negativeFillAlphas;"object"==typeof Ya&&(Ya=Ya[0]);"object"==typeof Za&&(Za=Za[0]);var xb=this.noRounding;"step"==g&&(xb=!1);var ib=f.getCoordinate(f.min);f.logarithmic&&(ib=f.getCoordinate(f.minReal));this.minCoord=ib;this.resetBullet&&(this.bullet="none");if(!(I||"line"!=g&&"smoothedLine"!=g&&"step"!=g||(1==e.length&&"step"!=g&&"none"==this.bullet&&(this.bullet="round",this.resetBullet=!0),!Qa&&void 0==Ja||m))){var Ua=Oa;Ua>f.max&&(Ua=f.max);Ua<f.min&&(Ua=f.min);f.logarithmic&&(Ua=f.minReal);var Ka=f.getCoordinate(Ua),Lb=f.getCoordinate(f.max);t?(ha=q,Pa=Math.abs(Lb-Ka),ub=q,vb=Math.abs(ib-Ka),hb=tb=0,f.reversed?(ba=0,gb=Ka):(ba=Ka,gb=0)):(Pa=n,ha=Math.abs(Lb-Ka),vb=n,ub=Math.abs(ib-Ka),gb=ba=0,f.reversed?(hb=p,tb=Ka):hb=Ka)}var La=Math.round;this.pmx=La(ba);this.pmy=La(tb);this.pmh=La(ha);this.pmw=La(Pa);this.nmx=La(gb);this.nmy=La(hb);this.nmh=La(ub);this.nmw=La(vb);d.isModern||(this.nmy=this.nmx=0,this.nmh=this.height);this.clustered||(r=1);k="column"==g?(Y*k-T*(r-1))/r:Y*k;1>k&&(k=1);var Mb=this.fixedColumnWidth;isNaN(Mb)||(k=Mb);var L;if("line"==g||"step"==g||"smoothedLine"==g){if(0<Q){for(L=Q-1;-1<L;L--)if(G=e[L],w=G.axes[f.id].graphs[b],na=w.values.value,!isNaN(na)){Q=L;break}if(this.lineColorField)for(L=Q;-1<L;L--)if(G=e[L],w=G.axes[f.id].graphs[b],w.lineColor){this.bulletColorSwitched=this.lineColorSwitched=w.lineColor;break}if(this.fillColorsField)for(L=Q;-1<L;L--)if(G=e[L],w=G.axes[f.id].graphs[b],w.fillColors){this.fillColorsSwitched=w.fillColors;break}if(this.dashLengthField)for(L=Q;-1<L;L--)if(G=e[L],w=G.axes[f.id].graphs[b],!isNaN(w.dashLength)){this.dashLengthSwitched=w.dashLength;break}}if(ia<e.length-1)for(L=ia+1;L<e.length;L++)if(G=e[L],w=G.axes[f.id].graphs[b],na=w.values.value,!isNaN(na)){ia=L;break}}ia<e.length-1&&ia++;var U=[],V=[],Ra=!1;if("line"==g||"step"==g||"smoothedLine"==g)if(this.stackable&&"regular"==O||"100%"==O||this.fillToGraph)Ra=!0;var Nb=this.noStepRisers,jb=-1e3,kb=-1e3,lb=this.minDistance,Sa=!0,$a=!1;for(L=Q;L<=ia;L++){G=e[L];w=G.axes[f.id].graphs[b];w.index=L;var ab,Ta=NaN;if(m&&void 0==this.openField)for(var yb=L+1;yb<e.length&&(!e[yb]||!(ab=e[L+1].axes[f.id].graphs[b])||!ab.values||(Ta=ab.values.value,isNaN(Ta)));yb++);var R,P,K,aa,ja=NaN,E=NaN,F=NaN,N=NaN,M=NaN,pa=NaN,qa=NaN,ra=NaN,sa=NaN,wa=NaN,Da=NaN,ka=NaN,la=NaN,W=NaN,zb=NaN,Ab=NaN,ta=NaN,ua=void 0,Ma=wb,Va=Ya,Ha=ya,Aa,Ea,Bb=this.proCandlesticks,mb=this.topRadius,Fa=q-1,oa=n-1,bb=this.pattern;void 0!=w.pattern&&(bb=w.pattern);isNaN(w.alpha)||(Va=w.alpha);isNaN(w.dashLength)||(da=w.dashLength);var Ia=w.values;f.recalculateToPercents&&(Ia=w.percents);if(Ia){W=this.stackable&&"none"!=O&&"3d"!=O?Ia.close:Ia.value;if("candlestick"==g||"ohlc"==g)W=Ia.close,Ab=Ia.low,qa=f.getCoordinate(Ab),zb=Ia.high,sa=f.getCoordinate(zb);ta=Ia.open;F=f.getCoordinate(W,xb);isNaN(ta)||(M=f.getCoordinate(ta,xb),m&&"regular"!=O&&"100%"!=O&&(Ta=ta,ta=M=NaN));m&&(void 0==this.openField?ab&&(ab.isNegative=Ta<W?!0:!1,isNaN(Ta)&&(w.isNegative=!Sa)):w.isNegative=Ta>W?!0:!1);if(!I)switch(this.showBalloonAt){case"close":w.y=F;break;case"open":w.y=M;break;case"high":w.y=sa;break;case"low":w.y=qa}var ja=G.x[va.id],Wa=this.periodSpan-1;"step"!=g||isNaN(G.cellWidth)||(Y=G.cellWidth);var xa=Math.floor(Y/2)+Math.floor(Wa*Y/2),Ga=xa,nb=0;"left"==this.stepDirection&&(nb=(2*Y+Wa*Y)/2,ja-=nb);"center"==this.stepDirection&&(nb=Y/2,ja-=nb);"start"==this.pointPosition&&(ja-=Y/2+Math.floor(Wa*Y/2),xa=0,Ga=Math.floor(Y)+Math.floor(Wa*Y));"end"==this.pointPosition&&(ja+=Y/2+Math.floor(Wa*Y/2),xa=Math.floor(Y)+Math.floor(Wa*Y),Ga=0);if(Nb){var Cb=this.columnWidth;isNaN(Cb)||(xa*=Cb,Ga*=Cb)}I||(w.x=ja);-1e5>ja&&(ja=-1e5);ja>n+1e5&&(ja=n+1e5);t?(E=F,N=M,M=F=ja,isNaN(ta)&&!this.fillToGraph&&(N=ma),pa=qa,ra=sa):(N=E=ja,isNaN(ta)&&!this.fillToGraph&&(M=ma));if(!Bb&&W<ta||Bb&&W<za)w.isNegative=!0,Qa&&(Ma=Qa),Za&&(Va=Za),void 0!=Ja&&(Ha=Ja);$a=!1;isNaN(W)||(m?W>Ta?(Sa&&($a=!0),Sa=!1):(Sa||($a=!0),Sa=!0):w.isNegative=W<Oa?!0:!1,za=W);var Ob=!1;I&&a.chartScrollbar.ignoreCustomColors&&(Ob=!0);Ob||(void 0!=w.color&&(Ma=w.color),w.fillColors&&(Ma=w.fillColors));switch(g){case"line":if(isNaN(W))x||(this.drawLineGraph(z,v,U,V),z=[],v=[],U=[],V=[]);else{if(Math.abs(E-jb)>=lb||Math.abs(F-kb)>=lb)z.push(E),v.push(F),jb=E,kb=F;wa=E;Da=F;ka=E;la=F;!Ra||isNaN(M)||isNaN(N)||(U.push(N),V.push(M));if($a||void 0!=w.lineColor&&w.lineColor!=this.lineColorSwitched||void 0!=w.fillColors&&w.fillColors!=this.fillColorsSwitched||!isNaN(w.dashLength))this.drawLineGraph(z,v,U,V),z=[E],v=[F],U=[],V=[],!Ra||isNaN(M)||isNaN(N)||(U.push(N),V.push(M)),m?Sa?(this.lineColorSwitched=ya,this.fillColorsSwitched=wb):(this.lineColorSwitched=Ja,this.fillColorsSwitched=Qa):(this.lineColorSwitched=w.lineColor,this.fillColorsSwitched=w.fillColors),this.dashLengthSwitched=w.dashLength;w.gap&&(this.drawLineGraph(z,v,U,V),z=[],v=[],U=[],V=[])}break;case"smoothedLine":if(isNaN(W))x||(this.drawSmoothedGraph(z,v,U,V),z=[],v=[],U=[],V=[]);else{if(Math.abs(E-jb)>=lb||Math.abs(F-kb)>=lb)z.push(E),v.push(F),jb=E,kb=F;wa=E;Da=F;ka=E;la=F;!Ra||isNaN(M)||isNaN(N)||(U.push(N),V.push(M));void 0==w.lineColor&&void 0==w.fillColors&&isNaN(w.dashLength)||(this.drawSmoothedGraph(z,v,U,V),z=[E],v=[F],U=[],V=[],!Ra||isNaN(M)||isNaN(N)||(U.push(N),V.push(M)),this.lineColorSwitched=w.lineColor,this.fillColorsSwitched=w.fillColors,this.dashLengthSwitched=w.dashLength);w.gap&&(this.drawSmoothedGraph(z,v,U,V),z=[],v=[],U=[],V=[])}break;case"step":if(!isNaN(W)){t?(isNaN(A)||(z.push(A),v.push(F-xa)),v.push(F-xa),z.push(E),v.push(F+Ga),z.push(E),!Ra||isNaN(M)||isNaN(N)||(isNaN(B)||(U.push(B),V.push(M-xa)),U.push(N),V.push(M-xa),U.push(N),V.push(M+Ga))):(isNaN(y)||(v.push(y),z.push(E-xa)),z.push(E-xa),v.push(F),z.push(E+Ga),v.push(F),!Ra||isNaN(M)||isNaN(N)||(isNaN(D)||(U.push(N-xa),V.push(D)),U.push(N-xa),V.push(M),U.push(N+Ga),V.push(M)));A=E;y=F;B=N;D=M;wa=E;Da=F;ka=E;la=F;if($a||void 0!=w.lineColor||void 0!=w.fillColors||!isNaN(w.dashLength)){var cc=z[z.length-2],dc=v[v.length-2];z.pop();v.pop();this.drawLineGraph(z,v,U,V);z=[cc];v=[dc];t?(v.push(F+Ga),z.push(E)):(z.push(E+Ga),v.push(F));U=[];V=[];this.lineColorSwitched=w.lineColor;this.fillColorsSwitched=w.fillColors;this.dashLengthSwitched=w.dashLength;m&&(Sa?(this.lineColorSwitched=ya,this.fillColorsSwitched=wb):(this.lineColorSwitched=Ja,this.fillColorsSwitched=Qa))}if(Nb||w.gap)A=y=NaN,this.drawLineGraph(z,v,U,V),z=[],v=[],U=[],V=[]}else if(!x){if(1>=this.periodSpan||1<this.periodSpan&&E-A>xa+Ga)A=y=NaN;this.drawLineGraph(z,v,U,V);z=[];v=[];U=[];V=[]}break;case"column":Aa=Ha;void 0!=w.lineColor&&(Aa=w.lineColor);if(!isNaN(W)){m||(w.isNegative=W<Oa?!0:!1);w.isNegative&&(Qa&&(Ma=Qa),void 0!=Ja&&(Aa=Ja));var Pb=f.min,Qb=f.max,ob=ta;isNaN(ob)&&(ob=Oa);if(!(W<Pb&&ob<Pb||W>Qb&&ob>Qb)){var Ba;if(t){"3d"==O?(P=F-(r/2-this.depthCount+1)*(k+T)+T/2+S*ea,R=N+H*ea,Ba=ea):(P=Math.floor(F-(r/2-ea)*(k+T)+T/2),R=N,Ba=0);K=k;wa=E;Da=P+k/2;ka=E;la=P+k/2;P+K>q+Ba*S&&(K=q-P+Ba*S);P<Ba*S&&(K+=P,P=Ba*S);aa=E-N;var ec=R;R=d.fitToBounds(R,0,n);aa+=ec-R;aa=d.fitToBounds(aa,-R,n-R+H*ea);w.labelIsNegative=0>aa?!0:!1;0===aa&&1/W===1/-0&&(w.labelIsNegative=!0);isNaN(G.percentWidthValue)||(K=this.height*G.percentWidthValue/100,P=ja-K/2,Da=P+K/2);K=d.roundTo(K,2);aa=d.roundTo(aa,2);P<q&&0<K&&(ua=new d.Cuboid(h,aa,K,H-a.d3x,S-a.d3y,Ma,Va,ca,Aa,X,ga,u,t,da,bb,mb,Z),w.columnWidth=Math.abs(aa),w.columnHeight=Math.abs(K))}else{"3d"==O?(R=E-(r/2-this.depthCount+1)*(k+T)+T/2+H*ea,P=M+S*ea,Ba=ea):(R=E-(r/2-ea)*(k+T)+T/2,P=M,Ba=0);K=k;wa=R+k/2;Da=F;ka=R+k/2;la=F;R+K>n+Ba*H&&(K=n-R+Ba*H);R<Ba*H&&(K+=R-Ba*H,R=Ba*H);aa=F-M;w.labelIsNegative=0<aa?!0:!1;0===aa&&-0===W&&(w.labelIsNegative=!0);var fc=P;P=d.fitToBounds(P,this.dy,q);aa+=fc-P;aa=d.fitToBounds(aa,-P+S*ea,q-P);isNaN(G.percentWidthValue)||(K=this.width*G.percentWidthValue/100,R=ja-K/2,wa=R+K/2);K=d.roundTo(K,2);aa=d.roundTo(aa,2);R<n+ea*H&&0<K&&(this.showOnAxis&&(P-=S/2),ua=new d.Cuboid(h,K,aa,H-a.d3x,S-a.d3y,Ma,Va,ca,Aa,this.lineAlpha,ga,u,t,da,bb,mb,Z),w.columnHeight=Math.abs(aa),w.columnWidth=Math.abs(K))}}if(ua){Ea=ua.set;d.setCN(a,ua.set,"graph-"+this.type);d.setCN(a,ua.set,"graph-"+this.id);w.className&&d.setCN(a,ua.set,w.className,!0);w.columnGraphics=Ea;R=d.roundTo(R,2);P=d.roundTo(P,2);Ea.translate(R,P);(w.url||this.showHandOnHover)&&Ea.setAttr("cursor","pointer");if(!I){"none"==O&&(J=t?(this.end+1-L)*C-c:C*L+c);"3d"==O&&(t?(J=(this.end+1-L)*C-c-1e3*this.depthCount,wa+=H*this.columnIndex,ka+=H*this.columnIndex,w.y+=H*this.columnIndex):(J=(C-c)*(L+1)+1e3*this.depthCount,Da+=S*this.columnIndex,la+=S*this.columnIndex,w.y+=S*this.columnIndex));if("regular"==O||"100%"==O)J=t?0<Ia.value?(this.end+1-L)*C+c:(this.end+1-L)*C-c:0<Ia.value?C*L+c:C*L-c;this.columnsArray.push({column:ua,depth:J});w.x=t?P+K/2:R+K/2;this.ownColumns.push(ua);this.animateColumns(ua,L,E,N,F,M);this.addListeners(Ea,w)}this.columnsSet.push(Ea)}}break;case"candlestick":if(!isNaN(ta)&&!isNaN(W)){var Xa,cb;Aa=Ha;void 0!=w.lineColor&&(Aa=w.lineColor);wa=E;la=Da=F;ka=E;if(t){"open"==l&&(ka=N);"high"==l&&(ka=ra);"low"==l&&(ka=pa);E=d.fitToBounds(E,0,oa);N=d.fitToBounds(N,0,oa);pa=d.fitToBounds(pa,0,oa);ra=d.fitToBounds(ra,0,oa);if(0===E&&0===N&&0===pa&&0===ra)continue;if(E==oa&&N==oa&&pa==oa&&ra==oa)continue;P=F-k/2;R=N;K=k;P+K>q&&(K=q-P);0>P&&(K+=P,P=0);if(P<q&&0<K){var Db,Eb;W>ta?(Db=[E,ra],Eb=[N,pa]):(Db=[N,ra],Eb=[E,pa]);!isNaN(ra)&&!isNaN(pa)&&F<q&&0<F&&(Xa=d.line(h,Db,[F,F],Aa,X,ca),cb=d.line(h,Eb,[F,F],Aa,X,ca));aa=E-N;ua=new d.Cuboid(h,aa,K,H,S,Ma,Ya,ca,Aa,X,ga,u,t,da,bb,mb,Z)}}else{"open"==l&&(la=M);"high"==l&&(la=sa);"low"==l&&(la=qa);F=d.fitToBounds(F,0,Fa);M=d.fitToBounds(M,0,Fa);qa=d.fitToBounds(qa,0,Fa);sa=d.fitToBounds(sa,0,Fa);if(0===F&&0===M&&0===qa&&0===sa)continue;if(F==Fa&&M==Fa&&qa==Fa&&sa==Fa)continue;R=E-k/2;P=M+ca/2;K=k;R+K>n&&(K=n-R);0>R&&(K+=R,R=0);aa=F-M;if(R<n&&0<K){Bb&&W>=ta&&(Va=0);var ua=new d.Cuboid(h,K,aa,H,S,Ma,Va,ca,Aa,X,ga,u,t,da,bb,mb,Z),Fb,Gb;W>ta?(Fb=[F,sa],Gb=[M,qa]):(Fb=[M,sa],Gb=[F,qa]);!isNaN(sa)&&!isNaN(qa)&&E<n&&0<E&&(Xa=d.line(h,[E,E],Fb,Aa,X,ca),cb=d.line(h,[E,E],Gb,Aa,X,ca),d.setCN(a,Xa,this.bcn+"line-high"),w.className&&d.setCN(a,Xa,w.className,!0),d.setCN(a,cb,this.bcn+"line-low"),w.className&&d.setCN(a,cb,w.className,!0))}}ua&&(Ea=ua.set,w.columnGraphics=Ea,fa.push(Ea),Ea.translate(R,P-ca/2),(w.url||this.showHandOnHover)&&Ea.setAttr("cursor","pointer"),Xa&&(fa.push(Xa),fa.push(cb)),I||(w.x=t?P+K/2:R+K/2,this.animateColumns(ua,L,E,N,F,M),this.addListeners(Ea,w)))}break;case"ohlc":if(!(isNaN(ta)||isNaN(zb)||isNaN(Ab)||isNaN(W))){var Rb=h.set();fa.push(Rb);W<ta&&(w.isNegative=!0,void 0!=Ja&&(Ha=Ja));var pb,qb,rb;if(t){la=F;ka=E;"open"==l&&(ka=N);"high"==l&&(ka=ra);"low"==l&&(ka=pa);pa=d.fitToBounds(pa,0,oa);ra=d.fitToBounds(ra,0,oa);if(0===E&&0===N&&0===pa&&0===ra)continue;if(E==oa&&N==oa&&pa==oa&&ra==oa)continue;var Hb=F-k/2,Hb=d.fitToBounds(Hb,0,q),Sb=d.fitToBounds(F,0,q),Ib=F+k/2,Ib=d.fitToBounds(Ib,0,q);0<=N&&N<=oa&&(qb=d.line(h,[N,N],[Hb,Sb],Ha,X,ca,da));0<F&&F<q&&(pb=d.line(h,[pa,ra],[F,F],Ha,X,ca,da));0<=E&&E<=oa&&(rb=d.line(h,[E,E],[Sb,Ib],Ha,X,ca,da))}else{la=F;"open"==l&&(la=M);"high"==l&&(la=sa);"low"==l&&(la=qa);var ka=E,qa=d.fitToBounds(qa,0,Fa),sa=d.fitToBounds(sa,0,Fa),Jb=E-k/2,Jb=d.fitToBounds(Jb,0,n),Tb=d.fitToBounds(E,0,n),Kb=E+k/2,Kb=d.fitToBounds(Kb,0,n);0<=M&&M<=Fa&&(qb=d.line(h,[Jb,Tb],[M,M],Ha,X,ca,da));0<E&&E<n&&(pb=d.line(h,[E,E],[qa,sa],Ha,X,ca,da));0<=F&&F<=Fa&&(rb=d.line(h,[Tb,Kb],[F,F],Ha,X,ca,da))}fa.push(qb);fa.push(pb);fa.push(rb);d.setCN(a,qb,this.bcn+"stroke-open");d.setCN(a,rb,this.bcn+"stroke-close");d.setCN(a,pb,this.bcn+"stroke");w.className&&d.setCN(a,Rb,w.className,!0);wa=E;Da=F}}if(!I&&!isNaN(W)){var Ub=this.hideBulletsCount;if(this.end-this.start<=Ub||0===Ub){var Vb=this.createBullet(w,ka,la,L),Wb=this.labelText;if(Wb&&!isNaN(wa)&&!isNaN(wa)){var gc=this.createLabel(w,Wb),Xb=0;Vb&&(Xb=Vb.size);this.positionLabel(w,wa,Da,gc,Xb)}if("regular"==O||"100%"==O){var Yb=f.totalText;if(Yb){var Na=this.createLabel(w,Yb,f.totalTextColor);d.setCN(a,Na,this.bcn+"label-total");this.allBullets.push(Na);if(Na){var Zb=Na.getBBox(),$b=Zb.width,ac=Zb.height,db,eb,sb=f.totalTextOffset,bc=f.totals[L];bc&&bc.remove();var fb=0;"column"!=g&&(fb=this.bulletSize);t?(eb=Da,db=0>W?E-$b/2-2-fb-sb:E+$b/2+3+fb+sb):(db=wa,eb=0>W?F+ac/2+fb+sb:F-ac/2-3-fb-sb);Na.translate(db,eb);f.totals[L]=Na;t?(0>eb||eb>q)&&Na.remove():(0>db||db>n)&&Na.remove()}}}}}}}if("line"==g||"step"==g||"smoothedLine"==g)"smoothedLine"==g?this.drawSmoothedGraph(z,v,U,V):this.drawLineGraph(z,v,U,V),I||this.launchAnimation();this.bulletsHidden&&this.hideBullets();this.customBulletsHidden&&this.hideCustomBullets()},animateColumns:function(a,b){var c=this,e=c.chart.startDuration;0<e&&!c.animationPlayed&&(c.seqAn?(a.set.hide(),c.animationArray.push(a),e=setTimeout(function(){c.animate.call(c)},e/(c.end-c.start+1)*(b-c.start)*1e3),c.timeOuts.push(e)):c.animate(a),c.chart.animatable.push(a))},createLabel:function(a,b,c){var e=this.chart,h=a.labelColor;h||(h=this.color);h||(h=e.color);c&&(h=c);c=this.fontSize;void 0===c&&(this.fontSize=c=e.fontSize);var f=this.labelFunction;b=e.formatString(b,a);b=d.cleanFromEmpty(b);f&&(b=f(a,b));if(void 0!==b&&""!==b)return a=d.text(this.container,b,h,e.fontFamily,c),a.node.style.pointerEvents="none",d.setCN(e,a,this.bcn+"label"),this.bulletSet.push(a),a},positiveClip:function(a){a.clipRect(this.pmx,this.pmy,this.pmw,this.pmh)},negativeClip:function(a){a.clipRect(this.nmx,this.nmy,this.nmw,this.nmh)},drawLineGraph:function(a,b,c,e){var h=this;if(1<a.length){var f=h.noRounding,g=h.set,k=h.chart,l=h.container,m=l.set(),n=l.set();g.push(n);g.push(m);var q=h.lineAlpha,p=h.lineThickness,g=h.fillAlphas,t=h.lineColorR,r=h.negativeLineAlpha;isNaN(r)&&(r=q);var u=h.lineColorSwitched;u&&(t=u);var u=h.fillColorsR,x=h.fillColorsSwitched;x&&(u=x);var z=h.dashLength;(x=h.dashLengthSwitched)&&(z=x);var x=h.negativeLineColor,v=h.negativeFillColors,A=h.negativeFillAlphas,y=h.baseCoord;0!==h.negativeBase&&(y=h.valueAxis.getCoordinate(h.negativeBase,f),y>h.height&&(y=h.height),0>y&&(y=0));q=d.line(l,a,b,t,q,p,z,!1,!0,f);d.setCN(k,q,h.bcn+"stroke");m.push(q);m.click(function(a){h.handleGraphEvent(a,"clickGraph")}).mouseover(function(a){h.handleGraphEvent(a,"rollOverGraph")}).mouseout(function(a){h.handleGraphEvent(a,"rollOutGraph")}).touchmove(function(a){h.chart.handleMouseMove(a)}).touchend(function(a){h.chart.handleTouchEnd(a)});void 0===x||h.useNegativeColorIfDown||(p=d.line(l,a,b,x,r,p,z,!1,!0,f),d.setCN(k,p,h.bcn+"stroke"),d.setCN(k,p,h.bcn+"stroke-negative"),n.push(p));if(0<g||0<A)if(p=a.join(";").split(";"),r=b.join(";").split(";"),q=k.type,"serial"==q||"radar"==q?0<c.length?(c.reverse(),e.reverse(),p=a.concat(c),r=b.concat(e)):"radar"==q?(r.push(0),p.push(0)):h.rotate?(r.push(r[r.length-1]),p.push(y),r.push(r[0]),p.push(y),r.push(r[0]),p.push(p[0])):(p.push(p[p.length-1]),r.push(y),p.push(p[0]),r.push(y),p.push(a[0]),r.push(r[0])):"xy"==q&&(b=h.fillToAxis)&&(d.isString(b)&&(b=k.getValueAxisById(b)),"H"==b.orientation?(y="top"==b.position?0:b.height,p.push(p[p.length-1]),r.push(y),p.push(p[0]),r.push(y),p.push(a[0]),r.push(r[0])):(y="left"==b.position?0:b.width,r.push(r[r.length-1]),p.push(y),r.push(r[0]),p.push(y),r.push(r[0]),p.push(p[0]))),a=h.gradientRotation,0<g&&(b=d.polygon(l,p,r,u,g,1,"#000",0,a,f),b.pattern(h.pattern,NaN,k.path),d.setCN(k,b,h.bcn+"fill"),m.push(b)),v||void 0!==x)isNaN(A)&&(A=g),v||(v=x),f=d.polygon(l,p,r,v,A,1,"#000",0,a,f),d.setCN(k,f,h.bcn+"fill"),d.setCN(k,f,h.bcn+"fill-negative"),f.pattern(h.pattern,NaN,k.path),n.push(f),n.click(function(a){h.handleGraphEvent(a,"clickGraph")}).mouseover(function(a){h.handleGraphEvent(a,"rollOverGraph")}).mouseout(function(a){h.handleGraphEvent(a,"rollOutGraph")}).touchmove(function(a){h.chart.handleMouseMove(a)}).touchend(function(a){h.chart.handleTouchEnd(a)});h.applyMask(n,m)}},applyMask:function(a,b){var c=a.length();"serial"!=this.chart.type||this.scrollbar||(this.positiveClip(b),0<c&&this.negativeClip(a))},drawSmoothedGraph:function(a,b,c,e){if(1<a.length){var h=this.set,f=this.chart,g=this.container,k=g.set(),l=g.set();h.push(l);h.push(k);var m=this.lineAlpha,n=this.lineThickness,h=this.dashLength,q=this.fillAlphas,p=this.lineColorR,t=this.fillColorsR,r=this.negativeLineColor,u=this.negativeFillColors,x=this.negativeFillAlphas,z=this.baseCoord,v=this.lineColorSwitched;v&&(p=v);(v=this.fillColorsSwitched)&&(t=v);var A=this.negativeLineAlpha;isNaN(A)&&(A=m);v=this.getGradRotation();m=new d.Bezier(g,a,b,p,m,n,t,0,h,void 0,v);d.setCN(f,m,this.bcn+"stroke");k.push(m.path);void 0!==r&&(n=new d.Bezier(g,a,b,r,A,n,t,0,h,void 0,v),d.setCN(f,n,this.bcn+"stroke"),d.setCN(f,n,this.bcn+"stroke-negative"),l.push(n.path));0<q&&(m=a.join(";").split(";"),p=b.join(";").split(";"),n="",0<c.length?(c.push("M"),e.push("M"),c.reverse(),e.reverse(),m=a.concat(c),p=b.concat(e)):(this.rotate?(n+=" L"+z+","+b[b.length-1],n+=" L"+z+","+b[0]):(n+=" L"+a[a.length-1]+","+z,n+=" L"+a[0]+","+z),n+=" L"+a[0]+","+b[0]),c=new d.Bezier(g,m,p,NaN,0,0,t,q,h,n,v),d.setCN(f,c,this.bcn+"fill"),c.path.pattern(this.pattern,NaN,f.path),k.push(c.path),u||void 0!==r)&&(x||(x=q),u||(u=r),a=new d.Bezier(g,a,b,NaN,0,0,u,x,h,n,v),a.path.pattern(this.pattern,NaN,f.path),d.setCN(f,a,this.bcn+"fill"),d.setCN(f,a,this.bcn+"fill-negative"),l.push(a.path));this.applyMask(l,k)}},launchAnimation:function(){var a=this,b=a.chart.startDuration;if(0<b&&!a.animationPlayed){var c=a.set,e=a.bulletSet;d.VML||(c.attr({opacity:a.startAlpha}),e.attr({opacity:a.startAlpha}));c.hide();e.hide();a.seqAn?(b=setTimeout(function(){a.animateGraphs.call(a)},a.index*b*1e3),a.timeOuts.push(b)):a.animateGraphs()}},animateGraphs:function(){var a=this.chart,b=this.set,c=this.bulletSet,e=this.x,d=this.y;b.show();c.show();var f=a.startDuration,g=a.startEffect;b&&(this.rotate?(b.translate(-1e3,d),c.translate(-1e3,d)):(b.translate(e,-1e3),c.translate(e,-1e3)),b.animate({opacity:1,translate:e+","+d},f,g),c.animate({opacity:1,translate:e+","+d},f,g),a.animatable.push(b))},animate:function(a){var b=this.chart,c=this.animationArray;!a&&0<c.length&&(a=c[0],c.shift());c=d[d.getEffect(b.startEffect)];b=b.startDuration;a&&(this.rotate?a.animateWidth(b,c):a.animateHeight(b,c),a.set.show())},legendKeyColor:function(){var a=this.legendColor,b=this.lineAlpha;void 0===a&&(a=this.lineColorR,0===b&&(b=this.fillColorsR)&&(a="object"==typeof b?b[0]:b));return a},legendKeyAlpha:function(){var a=this.legendAlpha;void 0===a&&(a=this.lineAlpha,this.fillAlphas>a&&(a=this.fillAlphas),0===a&&(a=this.bulletAlpha),0===a&&(a=1));return a},createBullet:function(a,b,c){if(!isNaN(b)&&!isNaN(c)&&("none"!=this.bullet||this.customBullet||a.bullet||a.customBullet)){var e=this.chart,h=this.container,f=this.bulletOffset,g=this.bulletSize;isNaN(a.bulletSize)||(g=a.bulletSize);var k=a.values.value,l=this.maxValue,m=this.minValue,n=this.maxBulletSize,q=this.minBulletSize;isNaN(l)||(isNaN(k)||(g=(k-m)/(l-m)*(n-q)+q),m==l&&(g=n));l=g;this.bulletAxis&&(g=a.values.error,isNaN(g)||(k=g),g=this.bulletAxis.stepWidth*k);g<this.minBulletSize&&(g=this.minBulletSize);this.rotate?b=a.isNegative?b-f:b+f:c=a.isNegative?c+f:c-f;q=this.bulletColorR;a.lineColor&&(this.bulletColorSwitched=a.lineColor);this.bulletColorSwitched&&(q=this.bulletColorSwitched);a.isNegative&&void 0!==this.bulletColorNegative&&(q=this.bulletColorNegative);void 0!==a.color&&(q=a.color);var p;"xy"==e.type&&this.valueField&&(p=this.pattern,a.pattern&&(p=a.pattern));f=this.bullet;a.bullet&&(f=a.bullet);var k=this.bulletBorderThickness,m=this.bulletBorderColorR,n=this.bulletBorderAlpha,t=this.bulletAlpha;m||(m=q);this.useLineColorForBulletBorder&&(m=this.lineColorR,this.lineColorSwitched&&(m=this.lineColorSwitched));var r=a.alpha;isNaN(r)||(t=r);p=d.bullet(h,f,g,q,t,k,m,n,l,0,p,e.path);l=this.customBullet;a.customBullet&&(l=a.customBullet);l&&(p&&p.remove(),"function"==typeof l?(l=new l,l.chart=e,a.bulletConfig&&(l.availableSpace=c,l.graph=this,l.graphDataItem=a,l.bulletY=c,a.bulletConfig.minCoord=this.minCoord-c,l.bulletConfig=a.bulletConfig),l.write(h),p&&l.showBullet&&l.set.push(p),a.customBulletGraphics=l.cset,p=l.set):(p=h.set(),l=h.image(l,0,0,g,g),p.push(l),this.centerCustomBullets&&l.translate(-g/2,-g/2)));if(p){(a.url||this.showHandOnHover)&&p.setAttr("cursor","pointer");if("serial"==e.type||"gantt"==e.type)if(-.5>b||b>this.width||c<-g/2||c>this.height)p.remove(),p=null;p&&(this.bulletSet.push(p),p.translate(b,c),this.addListeners(p,a),this.allBullets.push(p));a.bx=b;a.by=c;d.setCN(e,p,this.bcn+"bullet");a.className&&d.setCN(e,p,a.className,!0)}if(p){p.size=g||0;if(e=this.bulletHitAreaSize)h=d.circle(h,e,"#FFFFFF",.001,0),h.translate(b,c),a.hitBullet=h,this.bulletSet.push(h),this.addListeners(h,a);a.bulletGraphics=p}else p={size:0};p.graphDataItem=a;return p}},showBullets:function(){var a=this.allBullets,b;this.bulletsHidden=!1;for(b=0;b<a.length;b++)a[b].show()},hideBullets:function(){var a=this.allBullets,b;this.bulletsHidden=!0;for(b=0;b<a.length;b++)a[b].hide()},showCustomBullets:function(){var a=this.allBullets,b;this.customBulletsHidden=!1;for(b=0;b<a.length;b++){var c=a[b].graphDataItem;c.customBulletGraphics&&c.customBulletGraphics.show()}},hideCustomBullets:function(){var a=this.allBullets,b;this.customBulletsHidden=!0;for(b=0;b<a.length;b++){var c=a[b].graphDataItem;c.customBulletGraphics&&c.customBulletGraphics.hide()}},addListeners:function(a,b){var c=this;a.mouseover(function(a){c.handleRollOver(b,a)}).mouseout(function(a){c.handleRollOut(b,a)}).touchend(function(a){c.handleRollOver(b,a);c.chart.panEventsEnabled&&c.handleClick(b,a)}).touchstart(function(a){c.handleRollOver(b,a)}).click(function(a){c.handleClick(b,a)}).dblclick(function(a){c.handleDoubleClick(b,a)}).contextmenu(function(a){c.handleRightClick(b,a)});var e=c.chart;if(e.accessible&&c.accessibleLabel){var d=e.formatString(c.accessibleLabel,b);e.makeAccessible(a,d)}},handleRollOver:function(a,b){this.handleGraphEvent(b,"rollOverGraph");if(a){var c=this.chart;a.bulletConfig&&(c.isRolledOverBullet=!0);var e={type:"rollOverGraphItem",item:a,index:a.index,graph:this,target:this,chart:this.chart,event:b};this.fire(e);c.fire(e);clearTimeout(c.hoverInt);(c=c.chartCursor)&&c.valueBalloonsEnabled||this.showGraphBalloon(a,"V",!0)}},handleRollOut:function(a,b){if(a){var c=this.chart,e={type:"rollOutGraphItem",item:a,index:a.index,graph:this,target:this,chart:this.chart,event:b};this.fire(e);c.fire(e);c.isRolledOverBullet=!1}this.handleGraphEvent(b,"rollOutGraph");c=this.chart;(c=c.chartCursor)&&c.valueBalloonsEnabled||this.hideBalloon()},handleClick:function(a,b){if(!this.chart.checkTouchMoved()&&this.chart.checkTouchDuration(b)){if(a){var c={type:"clickGraphItem",item:a,index:a.index,graph:this,target:this,chart:this.chart,event:b};this.fire(c);this.chart.fire(c);d.getURL(a.url,this.urlTarget)}this.handleGraphEvent(b,"clickGraph")}},handleGraphEvent:function(a,b){var c={type:b,graph:this,target:this,chart:this.chart,event:a};this.fire(c);this.chart.fire(c)},handleRightClick:function(a,b){if(a){var c={type:"rightClickGraphItem",item:a,index:a.index,graph:this,target:this,chart:this.chart,event:b};this.fire(c);this.chart.fire(c)}},handleDoubleClick:function(a,b){if(a){var c={type:"doubleClickGraphItem",item:a,index:a.index,graph:this,target:this,chart:this.chart,event:b};this.fire(c);this.chart.fire(c)}},zoom:function(a,b){this.start=a;this.end=b;this.draw()},changeOpacity:function(a){var b=this.set;b&&b.setAttr("opacity",a);if(b=this.ownColumns){var c;for(c=0;c<b.length;c++){var e=b[c].set;e&&e.setAttr("opacity",a)}}(b=this.bulletSet)&&b.setAttr("opacity",a)},destroy:function(){d.remove(this.set);d.remove(this.bulletSet);var a=this.timeOuts;if(a){var b;for(b=0;b<a.length;b++)clearTimeout(a[b])}this.timeOuts=[]},createBalloon:function(){var a=this.chart;this.balloon?this.balloon.destroy&&this.balloon.destroy():this.balloon={};var b=this.balloon;d.extend(b,a.balloon,!0);b.chart=a;b.mainSet=a.plotBalloonsSet;b.className=this.id},hideBalloon:function(){var a=this,b=a.chart;b.chartCursor?b.chartCursor.valueBalloonsEnabled||b.hideBalloon():b.hideBalloon();clearTimeout(a.hoverInt);a.hoverInt=setTimeout(function(){a.hideBalloonReal.call(a)},b.hideBalloonTime)},hideBalloonReal:function(){this.balloon&&this.balloon.hide();this.fixBulletSize()},fixBulletSize:function(){if(d.isModern){var a=this.resizedDItem;if(a){var b=a.bulletGraphics;b&&!b.doNotScale&&(b.translate(a.bx,a.by,1),b.setAttr("fill-opacity",this.bulletAlpha),b.setAttr("stroke-opacity",this.bulletBorderAlpha))}this.resizedDItem=null}},showGraphBalloon:function(a,b,c,e,h){var f=this.chart,g=this.balloon,k=0,l=0,m=f.chartCursor,n=!0;m?m.valueBalloonsEnabled||(g=f.balloon,k=this.x,l=this.y,n=!1):(g=f.balloon,k=this.x,l=this.y,n=!1);clearTimeout(this.hoverInt);if(f.chartCursor&&(this.currentDataItem=a,"serial"==f.type&&f.isRolledOverBullet&&f.chartCursor.valueBalloonsEnabled)){this.hideBalloonReal();return}this.resizeBullet(a,e,h);if(g&&g.enabled&&this.showBalloon&&!this.hidden){var m=f.formatString(this.balloonText,a,!0),q=this.balloonFunction;q&&(m=q(a,a.graph));m&&(m=d.cleanFromEmpty(m));m&&""!==m?(e=f.getBalloonColor(this,a),g.drop||(g.pointerOrientation=b),b=a.x,h=a.y,f.rotate&&(b=a.y,h=a.x),b+=k,h+=l,isNaN(b)||isNaN(h)?this.hideBalloonReal():(a=this.width,q=this.height,n&&g.setBounds(k,l,a+k,q+l),g.changeColor(e),g.setPosition(b,h),g.fixPrevious(),g.fixedPosition&&(c=!1),!c&&"radar"!=f.type&&(b<k||b>a+k||h<l-.5||h>q+l)?(g.showBalloon(m),g.hide(0)):(g.followCursor(c),g.showBalloon(m)))):(this.hideBalloonReal(),this.resizeBullet(a,e,h))}else this.hideBalloonReal()},resizeBullet:function(a,b,c){this.fixBulletSize();if(a&&d.isModern&&(1!=b||!isNaN(c))){var e=a.bulletGraphics;e&&!e.doNotScale&&(e.translate(a.bx,a.by,b),isNaN(c)||(e.setAttr("fill-opacity",c),e.setAttr("stroke-opacity",c)),this.resizedDItem=a)}}})})();(function(){var d=window.AmCharts;d.ChartCursor=d.Class({construct:function(a){this.cname="ChartCursor";this.createEvents("changed","zoomed","onHideCursor","onShowCursor","draw","selected","moved","panning","zoomStarted");this.enabled=!0;this.cursorAlpha=1;this.selectionAlpha=.2;this.cursorColor="#CC0000";this.categoryBalloonAlpha=1;this.color="#FFFFFF";this.type="cursor";this.zoomed=!1;this.zoomable=!0;this.pan=!1;this.categoryBalloonDateFormat="MMM DD, YYYY";this.categoryBalloonText="[[category]]";this.categoryBalloonEnabled=this.valueBalloonsEnabled=!0;this.rolledOver=!1;this.cursorPosition="middle";this.bulletsEnabled=this.skipZoomDispatch=!1;this.bulletSize=8;this.selectWithoutZooming=this.oneBalloonOnly=!1;this.graphBulletSize=1.7;this.animationDuration=.3;this.zooming=!1;this.adjustment=0;this.avoidBalloonOverlapping=!0;this.leaveCursor=!1;this.leaveAfterTouch=!0;this.valueZoomable=!1;this.balloonPointerOrientation="horizontal";this.hLineEnabled=this.vLineEnabled=!0;this.vZoomEnabled=this.hZoomEnabled=!1;d.applyTheme(this,a,this.cname)},draw:function(){this.destroy();var a=this.chart;a.panRequired=!0;var b=a.container;this.rotate=a.rotate;this.container=b;this.prevLineHeight=this.prevLineWidth=NaN;b=b.set();b.translate(this.x,this.y);this.set=b;a.cursorSet.push(b);this.createElements();d.isString(this.limitToGraph)&&(this.limitToGraph=d.getObjById(a.graphs,this.limitToGraph),this.fullWidth=!1,this.cursorPosition="middle");this.pointer=this.balloonPointerOrientation.substr(0,1).toUpperCase();this.isHidden=!1;this.hideLines();this.valueLineAxis||(this.valueLineAxis=a.valueAxes[0])},createElements:function(){var a=this.chart,b=a.dx,c=a.dy,e=this.width,h=this.height,f,g,k=this.cursorAlpha,l=this.valueLineAlpha;this.rotate?(f=l,g=k):(g=l,f=k);"xy"==a.type&&(g=k,void 0!==l&&(g=l),f=k);this.vvLine=d.line(this.container,[b,0,0],[c,0,h],this.cursorColor,f,1);d.setCN(a,this.vvLine,"cursor-line");d.setCN(a,this.vvLine,"cursor-line-vertical");this.hhLine=d.line(this.container,[0,e,e+b],[0,0,c],this.cursorColor,g,1);d.setCN(a,this.hhLine,"cursor-line");d.setCN(a,this.hhLine,"cursor-line-horizontal");this.vLine=this.rotate?this.vvLine:this.hhLine;this.set.push(this.vvLine);this.set.push(this.hhLine);this.set.node.style.pointerEvents="none";this.fullLines=this.container.set();a=a.cursorLineSet;a.push(this.fullLines);a.translate(this.x,this.y);a.clipRect(0,0,e,h);this.set.clipRect(0,0,e,h)},update:function(){var a=this.chart,b=a.mouseX-this.x,c=a.mouseY-this.y;this.mouseX=b;this.mouseY=c;this.mouse2X=a.mouse2X-this.x;this.mouse2Y=a.mouse2Y-this.y;var e;if(a.chartData&&0<a.chartData.length){this.mouseIsOver()?(this.hideGraphBalloons=!1,this.rolledOver=e=!0,this.updateDrawing(),this.vvLine&&isNaN(this.fx)&&(a.rotate||!this.limitToGraph)&&this.vvLine.translate(b,0),!this.hhLine||!isNaN(this.fy)||a.rotate&&this.limitToGraph||this.hhLine.translate(0,c),isNaN(this.mouse2X)?this.dispatchMovedEvent(b,c):e=!1):this.forceShow||this.hideCursor();if(this.zooming){if(!isNaN(this.mouse2X)){isNaN(this.mouse2X0)||this.dispatchPanEvent();return}if(this.pan){this.dispatchPanEvent();return}(this.hZoomEnabled||this.vZoomEnabled)&&this.zooming&&this.updateSelection()}e&&this.showCursor()}},updateDrawing:function(){this.drawing&&this.chart.setMouseCursor("crosshair");this.drawingNow&&(d.remove(this.drawingLine),this.drawingLine=d.line(this.container,[this.drawStartX,this.mouseX],[this.drawStartY,this.mouseY],this.cursorColor,1,1))},fixWidth:function(a){if(this.fullWidth&&this.prevLineWidth!=a){var b=this.vvLine,c=0;b&&(b.remove(),c=b.x);b=this.container.set();b.translate(c,0);c=d.rect(this.container,a,this.height,this.cursorColor,this.cursorAlpha,0);d.setCN(this.chart,c,"cursor-fill");c.translate(-a/2,0);b.push(c);this.vvLine=b;this.fullLines.push(b);this.prevLineWidth=a}},fixHeight:function(a){if(this.fullWidth&&this.prevLineHeight!=a){var b=this.hhLine,c=0;b&&(b.remove(),c=b.y);b=this.container.set();b.translate(0,c);c=d.rect(this.container,this.width,a,this.cursorColor,this.cursorAlpha);c.translate(0,-a/2);b.push(c);this.fullLines.push(b);this.hhLine=b;this.prevLineHeight=a}},fixVLine:function(a,b){if(!isNaN(a)){if(isNaN(this.prevLineX)){var c=0,e=this.mouseX;if(this.limitToGraph){var d=this.chart.categoryAxis;d&&(this.chart.rotate||(c="bottom"==d.position?this.height:-this.height),e=a)}this.vvLine.translate(e,c)}else this.prevLineX!=a&&this.vvLine.translate(this.prevLineX,this.prevLineY);this.fx=a;this.prevLineX!=a&&(c=this.animationDuration,this.zooming&&(c=0),this.vvLine.stop(),this.vvLine.animate({translate:a+","+b},c,"easeOutSine"),this.prevLineX=a,this.prevLineY=b)}},fixHLine:function(a,b){if(!isNaN(a)){if(isNaN(this.prevLineY)){var c=0,e=this.mouseY;if(this.limitToGraph){var d=this.chart.categoryAxis;d&&(this.chart.rotate&&(c="right"==d.position?this.width:-this.width),e=a)}this.hhLine.translate(c,e)}else this.prevLineY!=a&&this.hhLine.translate(this.prevLineX,this.prevLineY);this.fy=a;this.prevLineY!=a&&(c=this.animationDuration,this.zooming&&(c=0),this.hhLine.stop(),this.hhLine.animate({translate:b+","+a},c,"easeOutSine"),this.prevLineY=a,this.prevLineX=b)}},hideCursor:function(a){this.forceShow=!1;this.chart.wasTouched&&this.leaveAfterTouch||this.isHidden||this.leaveCursor||(this.hideLines(),this.isHidden=!0,this.index=this.prevLineY=this.prevLineX=this.mouseY0=this.mouseX0=this.fy=this.fx=NaN,a?this.chart.handleCursorHide():this.fire({target:this,chart:this.chart,type:"onHideCursor"}),this.chart.setMouseCursor("auto"))},hideLines:function(){this.vvLine&&this.vvLine.hide();this.hhLine&&this.hhLine.hide();this.fullLines&&this.fullLines.hide();this.isHidden=!0;this.chart.handleCursorHide()},showCursor:function(a){!this.drawing&&this.enabled&&(this.vLineEnabled&&this.vvLine&&this.vvLine.show(),this.hLineEnabled&&this.hhLine&&this.hhLine.show(),this.isHidden=!1,this.updateFullLine(),a||this.fire({target:this,chart:this.chart,type:"onShowCursor"}),this.pan&&this.chart.setMouseCursor("move"))},updateFullLine:function(){this.zooming&&this.fullWidth&&this.selection&&(this.rotate?0<this.selection.height&&this.hhLine.hide():0<this.selection.width&&this.vvLine.hide())},updateSelection:function(){if(!this.pan&&this.enabled){var a=this.mouseX,b=this.mouseY;isNaN(this.fx)||(a=this.fx);isNaN(this.fy)||(b=this.fy);this.clearSelection();var c=this.mouseX0,e=this.mouseY0,h=this.width,f=this.height,a=d.fitToBounds(a,0,h),b=d.fitToBounds(b,0,f),g;a<c&&(g=a,a=c,c=g);b<e&&(g=b,b=e,e=g);this.hZoomEnabled?h=a-c:c=0;this.vZoomEnabled?f=b-e:e=0;isNaN(this.mouse2X)&&0<Math.abs(h)&&0<Math.abs(f)&&(a=this.chart,b=d.rect(this.container,h,f,this.cursorColor,this.selectionAlpha),d.setCN(a,b,"cursor-selection"),b.width=h,b.height=f,b.translate(c,e),this.set.push(b),this.selection=b);this.updateFullLine()}},mouseIsOver:function(){var a=this.mouseX,b=this.mouseY;if(this.justReleased)return this.justReleased=!1,!0;if(this.mouseIsDown)return!0;if(!this.chart.mouseIsOver)return this.handleMouseOut(),!1;if(0<a&&a<this.width&&0<b&&b<this.height)return!0;this.handleMouseOut()},fixPosition:function(){this.prevY=this.prevX=NaN},handleMouseDown:function(){this.update();if(this.mouseIsOver())if(this.mouseIsDown=!0,this.mouseX0=this.mouseX,this.mouseY0=this.mouseY,this.mouse2X0=this.mouse2X,this.mouse2Y0=this.mouse2Y,this.drawing)this.drawStartY=this.mouseY,this.drawStartX=this.mouseX,this.drawingNow=!0;else if(this.dispatchMovedEvent(this.mouseX,this.mouseY),!this.pan&&isNaN(this.mouse2X0)&&(isNaN(this.fx)||(this.mouseX0=this.fx),isNaN(this.fy)||(this.mouseY0=this.fy)),this.hZoomEnabled||this.vZoomEnabled){this.zooming=!0;var a={chart:this.chart,target:this,type:"zoomStarted"};a.x=this.mouseX/this.width;a.y=this.mouseY/this.height;this.index0=a.index=this.index;this.timestamp0=this.timestamp;this.fire(a)}},registerInitialMouse:function(){},handleReleaseOutside:function(){this.mouseIsDown=!1;if(this.drawingNow){this.drawingNow=!1;d.remove(this.drawingLine);var a=this.drawStartX,b=this.drawStartY,c=this.mouseX,e=this.mouseY,h=this.chart;(2<Math.abs(a-c)||2<Math.abs(b-e))&&this.fire({type:"draw",target:this,chart:h,initialX:a,initialY:b,finalX:c,finalY:e})}this.zooming&&(this.zooming=!1,this.selectWithoutZooming?this.dispatchZoomEvent("selected"):(this.hZoomEnabled||this.vZoomEnabled)&&this.dispatchZoomEvent("zoomed"),this.rolledOver&&this.dispatchMovedEvent(this.mouseX,this.mouseY));this.mouse2Y0=this.mouse2X0=this.mouseY0=this.mouseX0=NaN},dispatchZoomEvent:function(a){if(!this.pan){var b=this.selection;if(b&&3<Math.abs(b.width)&&3<Math.abs(b.height)){var c=Math.min(this.index,this.index0),e=Math.max(this.index,this.index0),d=c,f=e,g=this.chart,k=g.chartData,l=g.categoryAxis;l&&l.parseDates&&!l.equalSpacing&&(d=k[c]?k[c].time:Math.min(this.timestamp0,this.timestamp),f=k[e]?g.getEndTime(k[e].time):Math.max(this.timestamp0,this.timestamp));var b={type:a,chart:this.chart,target:this,end:f,start:d,startIndex:c,endIndex:e,selectionHeight:b.height,selectionWidth:b.width,selectionY:b.y,selectionX:b.x},m;this.hZoomEnabled&&4<Math.abs(this.mouseX0-this.mouseX)&&(b.startX=this.mouseX0/this.width,b.endX=this.mouseX/this.width,m=!0);this.vZoomEnabled&&4<Math.abs(this.mouseY0-this.mouseY)&&(b.startY=1-this.mouseY0/this.height,b.endY=1-this.mouseY/this.height,m=!0);m&&(this.prevY=this.prevX=NaN,this.fire(b),"selected"!=a&&this.clearSelection());this.hideCursor()}}},dispatchMovedEvent:function(a,b,c,e){a=Math.round(a);b=Math.round(b);if(!this.isHidden&&(a!=this.prevX||b!=this.prevY||"changed"==c)){c||(c="moved");var d=this.fx,f=this.fy;isNaN(d)&&(d=a);isNaN(f)&&(f=b);var g=!1;this.zooming&&this.pan&&(g=!0);g={hidden:this.isHidden,type:c,chart:this.chart,target:this,x:a,y:b,finalX:d,finalY:f,zooming:this.zooming,panning:g,mostCloseGraph:this.mostCloseGraph,index:this.index,skip:e,hideBalloons:this.hideGraphBalloons};this.rotate?(g.position=b,g.finalPosition=f):(g.position=a,g.finalPosition=d);this.prevX=a;this.prevY=b;e?this.chart.handleCursorMove(g):(this.fire(g),"changed"==c&&this.chart.fire(g))}},dispatchPanEvent:function(){if(this.mouseIsDown){var a=d.roundTo((this.mouseX-this.mouseX0)/this.width,3),b=d.roundTo((this.mouseY-this.mouseY0)/this.height,3),c=d.roundTo((this.mouse2X-this.mouse2X0)/this.width,3),e=d.roundTo((this.mouse2Y-this.mouse2Y0)/this.height,2),h=!1;0!==Math.abs(a)&&0!==Math.abs(b)&&(h=!0);if(this.prevDeltaX==a||this.prevDeltaY==b)h=!1;isNaN(c)||isNaN(e)||(0!==Math.abs(c)&&0!==Math.abs(e)&&(h=!0),this.prevDelta2X!=c&&this.prevDelta2Y!=e)||(h=!1);h&&(this.hideLines(),this.fire({type:"panning",chart:this.chart,target:this,deltaX:a,deltaY:b,delta2X:c,delta2Y:e,index:this.index}),this.prevDeltaX=a,this.prevDeltaY=b,this.prevDelta2X=c,this.prevDelta2Y=e)}},clearSelection:function(){var a=this.selection;a&&(a.width=0,a.height=0,a.remove())},destroy:function(){this.clear();d.remove(this.selection);this.selection=null;clearTimeout(this.syncTO);d.remove(this.set)},clear:function(){},setTimestamp:function(a){this.timestamp=a},setIndex:function(a,b){a!=this.index&&(this.index=a,b||this.isHidden||this.dispatchMovedEvent(this.mouseX,this.mouseY,"changed"))},handleMouseOut:function(){this.enabled&&this.rolledOver&&(this.leaveCursor||this.setIndex(void 0),this.forceShow=!1,this.hideCursor(),this.rolledOver=!1)},showCursorAt:function(a){var b=this.chart.categoryAxis;b&&this.setPosition(b.categoryToCoordinate(a))},setPosition:function(a){var b=this.chart,c=b.categoryAxis;if(c){var e,d,f=c.coordinateToValue(a);c.showBalloonAt(f);this.forceShow=!0;c.stickBalloonToCategory?b.rotate?this.fixHLine(a,0):this.fixVLine(a,0):(this.showCursor(),b.rotate?this.hhLine.translate(0,a):this.vvLine.translate(a,0));b.rotate?e=a:d=a;this.dispatchMovedEvent(d,e);b.rotate?(this.vvLine&&this.vvLine.hide(),this.hhLine&&this.hhLine.show()):(this.hhLine&&this.hhLine.hide(),this.vvLine&&this.vvLine.show());this.updateFullLine();this.isHidden=!1;this.dispatchMovedEvent(d,e,"moved",!0)}},enableDrawing:function(a){this.enabled=!a;this.hideCursor();this.drawing=a},syncWithCursor:function(a,b){clearTimeout(this.syncTO);a&&(a.isHidden?this.hideCursor(!0):this.syncWithCursorReal(a,b))},isZooming:function(a){this.zooming=a},syncWithCursorReal:function(a,b){var c=a.vvLine,e=a.hhLine;this.index=a.index;this.forceShow=!0;this.zooming&&this.pan||this.showCursor(!0);this.hideGraphBalloons=b;this.justReleased=a.justReleased;this.zooming=a.zooming;this.index0=a.index0;this.mouseX0=a.mouseX0;this.mouseY0=a.mouseY0;this.mouse2X0=a.mouse2X0;this.mouse2Y0=a.mouse2Y0;this.timestamp0=a.timestamp0;this.prevDeltaX=a.prevDeltaX;this.prevDeltaY=a.prevDeltaY;this.prevDelta2X=a.prevDelta2X;this.prevDelta2Y=a.prevDelta2Y;this.fx=a.fx;this.fy=a.fy;this.index=a.index;a.zooming&&this.updateSelection();var d=a.mouseX,f=a.mouseY;this.rotate?(d=NaN,this.vvLine&&this.vvLine.hide(),this.hhLine&&e&&(isNaN(a.fy)?this.hhLine.translate(0,a.mouseY):this.fixHLine(a.fy,0))):(f=NaN,this.hhLine&&this.hhLine.hide(),this.vvLine&&c&&(isNaN(a.fx)?this.vvLine.translate(a.mouseX,0):this.fixVLine(a.fx,0)));this.dispatchMovedEvent(d,f,"moved",!0)}})})();(function(){var d=window.AmCharts;d.SimpleChartScrollbar=d.Class({construct:function(a){this.createEvents("zoomed","zoomStarted","zoomEnded");this.backgroundColor="#D4D4D4";this.backgroundAlpha=1;this.selectedBackgroundColor="#EFEFEF";this.scrollDuration=this.selectedBackgroundAlpha=1;this.resizeEnabled=!0;this.hideResizeGrips=!1;this.scrollbarHeight=20;this.updateOnReleaseOnly=!1;9>document.documentMode&&(this.updateOnReleaseOnly=!0);this.dragIconHeight=this.dragIconWidth=35;this.dragIcon="dragIconRoundBig";this.dragCursorHover="cursor: cursor: grab; cursor:-moz-grab; cursor:-webkit-grab;";this.dragCursorDown="cursor: cursor: grab; cursor:-moz-grabbing; cursor:-webkit-grabbing;";this.enabled=!0;this.percentStart=this.offset=0;this.percentEnd=1;d.applyTheme(this,a,"SimpleChartScrollbar")},draw:function(){var a=this;a.destroy();if(a.enabled){var b=a.chart.container,c=a.rotate,e=a.chart;e.panRequired=!0;var h=b.set();a.set=h;e.scrollbarsSet.push(h);var f,g;c?(f=a.scrollbarHeight,g=e.plotAreaHeight):(g=a.scrollbarHeight,f=e.plotAreaWidth);a.width=f;if((a.height=g)&&f){var k=d.rect(b,f,g,a.backgroundColor,a.backgroundAlpha,1,a.backgroundColor,a.backgroundAlpha);d.setCN(e,k,"scrollbar-bg");a.bg=k;h.push(k);k=d.rect(b,f,g,"#000",.005);h.push(k);a.invisibleBg=k;k.click(function(){a.handleBgClick()}).mouseover(function(){a.handleMouseOver()}).mouseout(function(){a.handleMouseOut()}).touchend(function(){a.handleBgClick()});k=d.rect(b,f,g,a.selectedBackgroundColor,a.selectedBackgroundAlpha);d.setCN(e,k,"scrollbar-bg-selected");a.selectedBG=k;h.push(k);f=d.rect(b,f,g,"#000",.005);a.dragger=f;h.push(f);f.mousedown(function(b){a.handleDragStart(b)}).mouseup(function(){a.handleDragStop()}).mouseover(function(){a.handleDraggerOver()}).mouseout(function(){a.handleMouseOut()}).touchstart(function(b){a.handleDragStart(b)}).touchend(function(){a.handleDragStop()});f=e.pathToImages;g=a.dragIcon.replace(/\.[a-z]*$/i,"");c?(k=f+g+"H"+e.extension,f=a.dragIconWidth,c=a.dragIconHeight):(k=f+g+e.extension,c=a.dragIconWidth,f=a.dragIconHeight);g=b.image(k,0,0,c,f);d.setCN(e,g,"scrollbar-grip-left");k=b.image(k,0,0,c,f);d.setCN(e,k,"scrollbar-grip-right");var l=10,m=20;e.panEventsEnabled&&(l=25,m=a.scrollbarHeight);var n=d.rect(b,l,m,"#000",.005),q=d.rect(b,l,m,"#000",.005);q.translate(-(l-c)/2,-(m-f)/2);n.translate(-(l-c)/2,-(m-f)/2);c=b.set([g,q]);b=b.set([k,n]);a.iconLeft=c;h.push(a.iconLeft);a.iconRight=b;h.push(b);c.mousedown(function(){a.leftDragStart()}).mouseup(function(){a.leftDragStop()}).mouseover(function(){a.iconRollOver()}).mouseout(function(){a.iconRollOut()}).touchstart(function(){a.leftDragStart()}).touchend(function(){a.leftDragStop()});b.mousedown(function(){a.rightDragStart()}).mouseup(function(){a.rightDragStop()}).mouseover(function(){a.iconRollOver()}).mouseout(function(){a.iconRollOut()}).touchstart(function(){a.rightDragStart()}).touchend(function(){a.rightDragStop()});d.ifArray(e.chartData)?h.show():h.hide();a.hideDragIcons();a.clipDragger(!1)}h.translate(a.x,a.y);h.node.style.msTouchAction="none";h.node.style.touchAction="none"}},updateScrollbarSize:function(a,b){if(!isNaN(a)&&!isNaN(b)){a=Math.round(a);b=Math.round(b);var c=this.dragger,e,d,f,g,k;this.rotate?(e=0,d=a,f=this.width+1,g=b-a,c.setAttr("height",b-a),c.setAttr("y",d)):(e=a,d=0,f=b-a,g=this.height+1,k=b-a,c.setAttr("x",e),c.setAttr("width",k));this.clipAndUpdate(e,d,f,g)}},update:function(){var a,b=!1,c,e,d=this.x,f=this.y,g=this.dragger,k=this.getDBox();if(k){c=k.x+d;e=k.y+f;var l=k.width,k=k.height,m=this.rotate,n=this.chart,q=this.width,p=this.height,t=n.mouseX,r=n.mouseY;a=this.initialMouse;this.forceClip&&this.clipDragger(!0);if(n.mouseIsOver){this.dragging&&(n=this.initialCoord,m?(a=n+(r-a),0>a&&(a=0),n=p-k,a>n&&(a=n),g.setAttr("y",a)):(a=n+(t-a),0>a&&(a=0),n=q-l,a>n&&(a=n),g.setAttr("x",a)),this.clipDragger(!0));if(this.resizingRight){if(m)if(a=r-e,a+e>p+f&&(a=p-e+f),0>a)this.resizingRight=!1,b=this.resizingLeft=!0;else{if(0===a||isNaN(a))a=.1;g.setAttr("height",a)}else if(a=t-c,a+c>q+d&&(a=q-c+d),0>a)this.resizingRight=!1,b=this.resizingLeft=!0;else{if(0===a||isNaN(a))a=.1;g.setAttr("width",a)}this.clipDragger(!0)}if(this.resizingLeft){if(m)if(c=e,e=r,e<f&&(e=f),isNaN(e)&&(e=f),e>p+f&&(e=p+f),a=!0===b?c-e:k+c-e,0>a)this.resizingRight=!0,this.resizingLeft=!1,g.setAttr("y",c+k-f);else{if(0===a||isNaN(a))a=.1;g.setAttr("y",e-f);g.setAttr("height",a)}else if(e=t,e<d&&(e=d),isNaN(e)&&(e=d),e>q+d&&(e=q+d),a=!0===b?c-e:l+c-e,0>a)this.resizingRight=!0,this.resizingLeft=!1,g.setAttr("x",c+l-d);else{if(0===a||isNaN(a))a=.1;g.setAttr("x",e-d);g.setAttr("width",a)}this.clipDragger(!0)}}}},stopForceClip:function(){this.animating=this.forceClip=!1},clipDragger:function(a){var b=this.getDBox();if(b){var c=b.x,e=b.y,d=b.width,b=b.height,f=!1;if(this.rotate){if(c=0,d=this.width+1,this.clipY!=e||this.clipH!=b)f=!0}else if(e=0,b=this.height+1,this.clipX!=c||this.clipW!=d)f=!0;f&&(this.clipAndUpdate(c,e,d,b),a&&(this.updateOnReleaseOnly||this.dispatchScrollbarEvent()))}},maskGraphs:function(){},clipAndUpdate:function(a,b,c,e){this.clipX=a;this.clipY=b;this.clipW=c;this.clipH=e;this.selectedBG.setAttr("width",c);this.selectedBG.setAttr("height",e);this.selectedBG.translate(a,b);this.updateDragIconPositions();this.maskGraphs(a,b,c,e)},dispatchScrollbarEvent:function(){if(this.skipEvent)this.skipEvent=!1;else{var a=this.chart;a.hideBalloon();var b=this.getDBox(),c=b.x,e=b.y,d=b.width,f=b.height,g,k;this.rotate?(b=e,g=this.height/f,k=1-e/this.height,c=1-(e+f)/this.height):(b=c,g=this.width/d,k=c/this.width,c=(c+d)/this.width);this.fire({type:"zoomed",position:b,chart:a,target:this,multiplier:g,relativeStart:c,relativeEnd:k})}},updateDragIconPositions:function(){var a=this.getDBox(),b=a.x,c=a.y,e=this.iconLeft,d=this.iconRight,f,g,k=this.scrollbarHeight;this.rotate?(f=this.dragIconWidth,g=this.dragIconHeight,e.translate((k-g)/2,c-f/2),d.translate((k-g)/2,c+a.height-f/2)):(f=this.dragIconHeight,g=this.dragIconWidth,e.translate(b-g/2,(k-f)/2),d.translate(b-g/2+a.width,(k-f)/2))},showDragIcons:function(){this.resizeEnabled&&(this.iconLeft.show(),this.iconRight.show())},hideDragIcons:function(){if(!this.resizingLeft&&!this.resizingRight&&!this.dragging){if(this.hideResizeGrips||!this.resizeEnabled)this.iconLeft.hide(),this.iconRight.hide();this.removeCursors()}},removeCursors:function(){this.chart.setMouseCursor("auto")},fireZoomEvent:function(a){this.fire({type:a,chart:this.chart,target:this})},percentZoom:function(a,b){if(this.dragger&&this.enabled){this.dragger.stop();isNaN(a)&&(a=0);isNaN(b)&&(b=1);var c,e,d;this.rotate?(c=this.height,e=c-c*b,d=c-c*a):(c=this.width,d=c*b,e=c*a);this.updateScrollbarSize(e,d);this.clipDragger(!1);this.percentStart=a;this.percentEnd=b}},destroy:function(){this.clear();d.remove(this.set);d.remove(this.iconRight);d.remove(this.iconLeft)},clear:function(){},handleDragStart:function(){if(this.enabled){this.fireZoomEvent("zoomStarted");var a=this.chart;this.dragger.stop();this.removeCursors();d.isModern&&this.dragger.node.setAttribute("style",this.dragCursorDown);this.dragging=!0;var b=this.getDBox();this.rotate?(this.initialCoord=b.y,this.initialMouse=a.mouseY):(this.initialCoord=b.x,this.initialMouse=a.mouseX)}},handleDragStop:function(){this.updateOnReleaseOnly&&(this.update(),this.skipEvent=!1,this.dispatchScrollbarEvent());this.dragging=!1;this.mouseIsOver&&this.removeCursors();d.isModern&&this.dragger.node.setAttribute("style",this.dragCursorHover);this.update();this.fireZoomEvent("zoomEnded")},handleDraggerOver:function(){this.handleMouseOver();d.isModern&&this.dragger.node.setAttribute("style",this.dragCursorHover)},leftDragStart:function(){this.fireZoomEvent("zoomStarted");this.dragger.stop();this.resizingLeft=!0},leftDragStop:function(){this.resizingLeft=!1;this.mouseIsOver||this.removeCursors();this.updateOnRelease();this.fireZoomEvent("zoomEnded")},rightDragStart:function(){this.fireZoomEvent("zoomStarted");this.dragger.stop();this.resizingRight=!0},rightDragStop:function(){this.resizingRight=!1;this.mouseIsOver||this.removeCursors();this.updateOnRelease();this.fireZoomEvent("zoomEnded")},iconRollOut:function(){this.removeCursors()},iconRollOver:function(){this.rotate?this.chart.setMouseCursor("ns-resize"):this.chart.setMouseCursor("ew-resize");this.handleMouseOver()},getDBox:function(){if(this.dragger)return this.dragger.getBBox()},handleBgClick:function(){var a=this;if(!a.resizingRight&&!a.resizingLeft){a.zooming=!0;var b,c,e=a.scrollDuration,h=a.dragger;b=a.getDBox();var f=b.height,g=b.width;c=a.chart;var k=a.y,l=a.x,m=a.rotate;m?(b="y",c=c.mouseY-f/2-k,c=d.fitToBounds(c,0,a.height-f)):(b="x",c=c.mouseX-g/2-l,c=d.fitToBounds(c,0,a.width-g));a.updateOnReleaseOnly?(a.skipEvent=!1,h.setAttr(b,c),a.dispatchScrollbarEvent(),a.clipDragger()):(a.animating=!0,c=Math.round(c),m?h.animate({y:c},e,">"):h.animate({x:c},e,">"),a.forceClip=!0,clearTimeout(a.forceTO),a.forceTO=setTimeout(function(){a.stopForceClip.call(a)},5e3*e))}},updateOnRelease:function(){this.updateOnReleaseOnly&&(this.update(),this.skipEvent=!1,this.dispatchScrollbarEvent())},handleReleaseOutside:function(){if(this.set){if(this.resizingLeft||this.resizingRight||this.dragging)this.updateOnRelease(),this.removeCursors();this.animating=this.mouseIsOver=this.dragging=this.resizingRight=this.resizingLeft=!1;this.hideDragIcons();this.update()}},handleMouseOver:function(){this.mouseIsOver=!0;this.showDragIcons()},handleMouseOut:function(){this.mouseIsOver=!1;this.hideDragIcons();this.removeCursors()}})})();(function(){var d=window.AmCharts;d.ChartScrollbar=d.Class({inherits:d.SimpleChartScrollbar,construct:function(a){this.cname="ChartScrollbar";d.ChartScrollbar.base.construct.call(this,a);this.graphLineColor="#BBBBBB";this.graphLineAlpha=0;this.graphFillColor="#BBBBBB";this.graphFillAlpha=1;this.selectedGraphLineColor="#888888";this.selectedGraphLineAlpha=0;this.selectedGraphFillColor="#888888";this.selectedGraphFillAlpha=1;this.gridCount=0;this.gridColor="#FFFFFF";this.gridAlpha=.7;this.skipEvent=this.autoGridCount=!1;this.color="#FFFFFF";this.scrollbarCreated=!1;this.oppositeAxis=!0;d.applyTheme(this,a,this.cname)},init:function(){var a=this.categoryAxis,b=this.chart,c=this.gridAxis;a||("CategoryAxis"==this.gridAxis.cname?(this.catScrollbar=!0,a=new d.CategoryAxis,a.id="scrollbar"):(a=new d.ValueAxis,a.data=b.chartData,a.id=c.id,a.type=c.type,a.maximumDate=c.maximumDate,a.minimumDate=c.minimumDate,a.minPeriod=c.minPeriod),this.categoryAxis=a);a.chart=b;a.dateFormats=c.dateFormats;a.markPeriodChange=c.markPeriodChange;a.boldPeriodBeginning=c.boldPeriodBeginning;a.labelFunction=c.labelFunction;a.axisItemRenderer=d.RecItem;a.axisRenderer=d.RecAxis;a.guideFillRenderer=d.RecFill;a.inside=!0;a.fontSize=this.fontSize;a.tickLength=0;a.axisAlpha=0;d.isString(this.graph)&&(this.graph=d.getObjById(b.graphs,this.graph));(a=this.graph)&&this.catScrollbar&&(c=this.valueAxis,c||(this.valueAxis=c=new d.ValueAxis,c.visible=!1,c.scrollbar=!0,c.axisItemRenderer=d.RecItem,c.axisRenderer=d.RecAxis,c.guideFillRenderer=d.RecFill,c.labelsEnabled=!1,c.chart=b),b=this.unselectedGraph,b||(b=new d.AmGraph,b.scrollbar=!0,this.unselectedGraph=b,b.negativeBase=a.negativeBase,b.noStepRisers=a.noStepRisers),b=this.selectedGraph,b||(b=new d.AmGraph,b.scrollbar=!0,this.selectedGraph=b,b.negativeBase=a.negativeBase,b.noStepRisers=a.noStepRisers));this.scrollbarCreated=!0},draw:function(){var a=this;d.ChartScrollbar.base.draw.call(a);if(a.enabled){a.scrollbarCreated||a.init();var b=a.chart,c=b.chartData,e=a.categoryAxis,h=a.rotate,f=a.x,g=a.y,k=a.width,l=a.height,m=a.gridAxis,n=a.set;e.setOrientation(!h);e.parseDates=m.parseDates;"ValueAxis"==a.categoryAxis.cname&&(e.rotate=!h);e.equalSpacing=m.equalSpacing;e.minPeriod=m.minPeriod;e.startOnAxis=m.startOnAxis;e.width=k-1;e.height=l;e.gridCount=a.gridCount;e.gridColor=a.gridColor;e.gridAlpha=a.gridAlpha;e.color=a.color;e.tickLength=0;e.axisAlpha=0;e.autoGridCount=a.autoGridCount;e.parseDates&&!e.equalSpacing&&e.timeZoom(b.firstTime,b.lastTime);e.minimum=a.gridAxis.fullMin;e.maximum=a.gridAxis.fullMax;e.strictMinMax=!0;e.zoom(0,c.length-1);if((m=a.graph)&&a.catScrollbar){var q=a.valueAxis,p=m.valueAxis;q.id=p.id;q.rotate=h;q.setOrientation(h);q.width=k;q.height=l;q.dataProvider=c;q.reversed=p.reversed;q.logarithmic=p.logarithmic;q.gridAlpha=0;q.axisAlpha=0;n.push(q.set);h?(q.y=g,q.x=0):(q.x=f,q.y=0);var f=Infinity,g=-Infinity,t;for(t=0;t<c.length;t++){var r=c[t].axes[p.id].graphs[m.id].values,u;for(u in r)if(r.hasOwnProperty(u)&&"percents"!=u&&"total"!=u){var x=r[u];x<f&&(f=x);x>g&&(g=x)}}Infinity!=f&&(q.minimum=f);-Infinity!=g&&(q.maximum=g+.1*(g-f));f==g&&(--q.minimum,q.maximum+=1);void 0!==a.minimum&&(q.minimum=a.minimum);void 0!==a.maximum&&(q.maximum=a.maximum);q.zoom(0,c.length-1);u=a.unselectedGraph;u.id=m.id;u.bcn="scrollbar-graph-";u.rotate=h;u.chart=b;u.data=c;u.valueAxis=q;u.chart=m.chart;u.categoryAxis=a.categoryAxis;u.periodSpan=m.periodSpan;u.valueField=m.valueField;u.openField=m.openField;u.closeField=m.closeField;u.highField=m.highField;u.lowField=m.lowField;u.lineAlpha=a.graphLineAlpha;u.lineColorR=a.graphLineColor;u.fillAlphas=a.graphFillAlpha;u.fillColorsR=a.graphFillColor;u.connect=m.connect;u.hidden=m.hidden;u.width=k;u.height=l;u.pointPosition=m.pointPosition;u.stepDirection=m.stepDirection;u.periodSpan=m.periodSpan;p=a.selectedGraph;p.id=m.id;p.bcn=u.bcn+"selected-";p.rotate=h;p.chart=b;p.data=c;p.valueAxis=q;p.chart=m.chart;p.categoryAxis=e;p.periodSpan=m.periodSpan;p.valueField=m.valueField;p.openField=m.openField;p.closeField=m.closeField;p.highField=m.highField;p.lowField=m.lowField;p.lineAlpha=a.selectedGraphLineAlpha;p.lineColorR=a.selectedGraphLineColor;p.fillAlphas=a.selectedGraphFillAlpha;p.fillColorsR=a.selectedGraphFillColor;p.connect=m.connect;p.hidden=m.hidden;p.width=k;p.height=l;p.pointPosition=m.pointPosition;p.stepDirection=m.stepDirection;p.periodSpan=m.periodSpan;b=a.graphType;b||(b=m.type);u.type=b;p.type=b;c=c.length-1;u.zoom(0,c);p.zoom(0,c);p.set.click(function(){a.handleBackgroundClick()}).mouseover(function(){a.handleMouseOver()}).mouseout(function(){a.handleMouseOut()});u.set.click(function(){a.handleBackgroundClick()}).mouseover(function(){a.handleMouseOver()}).mouseout(function(){a.handleMouseOut()});n.push(u.set);n.push(p.set)}n.push(e.set);n.push(e.labelsSet);a.bg.toBack();a.invisibleBg.toFront();a.dragger.toFront();a.iconLeft.toFront();a.iconRight.toFront()}},timeZoom:function(a,b,c){this.startTime=a;this.endTime=b;this.timeDifference=b-a;this.skipEvent=!d.toBoolean(c);this.zoomScrollbar();this.dispatchScrollbarEvent()},zoom:function(a,b){this.start=a;this.end=b;this.skipEvent=!0;this.zoomScrollbar()},dispatchScrollbarEvent:function(){if(this.categoryAxis&&"ValueAxis"==this.categoryAxis.cname)d.ChartScrollbar.base.dispatchScrollbarEvent.call(this);else if(this.skipEvent)this.skipEvent=!1;else{var a=this.chart.chartData,b,c,e=this.dragger.getBBox();b=e.x;var h=e.y,f=e.width,e=e.height,g=this.chart;this.rotate?(b=h,c=e):c=f;f={type:"zoomed",target:this};f.chart=g;var k=this.categoryAxis,l=this.stepWidth,h=g.minSelectedTime,e=g.maxSelectedTime,m=!1;if(k.parseDates&&!k.equalSpacing){if(a=g.lastTime,g=g.firstTime,k=Math.round(b/l)+g,b=this.dragging?k+this.timeDifference:Math.round((b+c)/l)+g,k>b&&(k=b),0<h&&b-k<h&&(b=Math.round(k+(b-k)/2),m=Math.round(h/2),k=b-m,b+=m,m=!0),0<e&&b-k>e&&(b=Math.round(k+(b-k)/2),m=Math.round(e/2),k=b-m,b+=m,m=!0),b>a&&(b=a),b-h<k&&(k=b-h),k<g&&(k=g),k+h>b&&(b=k+h),k!=this.startTime||b!=this.endTime)this.startTime=k,this.endTime=b,f.start=k,f.end=b,f.startDate=new Date(k),f.endDate=new Date(b),this.fire(f)}else if(k.startOnAxis||(b+=l/2),c-=this.stepWidth/2,h=k.xToIndex(b),b=k.xToIndex(b+c),h!=this.start||this.end!=b)k.startOnAxis&&(this.resizingRight&&h==b&&b++,this.resizingLeft&&h==b&&(0<h?h--:b=1)),this.start=h,this.end=this.dragging?this.start+this.difference:b,f.start=this.start,f.end=this.end,k.parseDates&&(a[this.start]&&(f.startDate=new Date(a[this.start].time)),a[this.end]&&(f.endDate=new Date(a[this.end].time))),this.fire(f);m&&this.zoomScrollbar(!0)}},zoomScrollbar:function(a){if((!(this.dragging||this.resizingLeft||this.resizingRight||this.animating)||a)&&this.dragger&&this.enabled){var b;a=this.chart;var c=a.chartData,e=this.categoryAxis;e.parseDates&&!e.equalSpacing?(c=e.stepWidth,e=a.firstTime,a=c*(this.startTime-e),b=c*(this.endTime-e)):(a=c[this.start].x[e.id],b=c[this.end].x[e.id],c=e.stepWidth,e.startOnAxis||(e=c/2,a-=e,b+=e));this.stepWidth=c;this.updateScrollbarSize(a,b)}},maskGraphs:function(a,b,c,e){var d=this.selectedGraph;d&&d.set.clipRect(a,b,c,e)},handleDragStart:function(){d.ChartScrollbar.base.handleDragStart.call(this);this.difference=this.end-this.start;this.timeDifference=this.endTime-this.startTime;0>this.timeDifference&&(this.timeDifference=0)},handleBackgroundClick:function(){d.ChartScrollbar.base.handleBackgroundClick.call(this);this.dragging||(this.difference=this.end-this.start,this.timeDifference=this.endTime-this.startTime,0>this.timeDifference&&(this.timeDifference=0))}})})();(function(){var d=window.AmCharts;d.AmBalloon=d.Class({construct:function(a){this.cname="AmBalloon";this.enabled=!0;this.fillColor="#FFFFFF";this.fillAlpha=.8;this.borderThickness=2;this.borderColor="#FFFFFF";this.borderAlpha=1;this.cornerRadius=0;this.maxWidth=220;this.horizontalPadding=8;this.verticalPadding=4;this.pointerWidth=6;this.pointerOrientation="V";this.color="#000000";this.adjustBorderColor=!0;this.show=this.follow=this.showBullet=!1;this.bulletSize=3;this.shadowAlpha=.4;this.shadowColor="#000000";this.fadeOutDuration=this.animationDuration=.3;this.fixedPosition=!0;this.offsetY=6;this.offsetX=1;this.textAlign="center";this.disableMouseEvents=!0;this.deltaSignX=this.deltaSignY=1;d.isModern||(this.offsetY*=1.5);this.sdy=this.sdx=0;d.applyTheme(this,a,this.cname)},draw:function(){var a=this.pointToX,b=this.pointToY;d.isModern||(this.drop=!1);var c=this.chart;d.VML&&(this.fadeOutDuration=0);this.xAnim&&c.stopAnim(this.xAnim);this.yAnim&&c.stopAnim(this.yAnim);this.sdy=this.sdx=0;if(!isNaN(a)){var e=this.follow,h=c.container,f=this.set;d.remove(f);this.removeDiv();f=h.set();f.node.style.pointerEvents="none";this.set=f;this.mainSet?(this.mainSet.push(this.set),this.sdx=this.mainSet.x,this.sdy=this.mainSet.y):c.balloonsSet.push(f);if(this.show){var g=this.l,k=this.t,l=this.r,m=this.b,n=this.balloonColor,q=this.fillColor,p=this.borderColor,t=q;void 0!=n&&(this.adjustBorderColor?t=p=n:q=n);var r=this.horizontalPadding,u=this.verticalPadding,x=this.pointerWidth,z=this.pointerOrientation,v=this.cornerRadius,A=c.fontFamily,y=this.fontSize;void 0==y&&(y=c.fontSize);var n=document.createElement("div"),B=c.classNamePrefix;n.className=B+"-balloon-div";this.className&&(n.className=n.className+" "+B+"-balloon-div-"+this.className);B=n.style;this.disableMouseEvents&&(B.pointerEvents="none");B.position="absolute";var D=this.minWidth,C="";isNaN(D)||(C="min-width:"+(D-2*r)+"px; ");n.innerHTML='<div style="text-align:'+this.textAlign+"; "+C+"max-width:"+this.maxWidth+"px; font-size:"+y+"px; color:"+this.color+"; font-family:"+A+'">'+this.text+"</div>";c.chartDiv.appendChild(n);this.textDiv=n;var J=n.offsetWidth,H=n.offsetHeight;n.clientHeight&&(J=n.clientWidth,H=n.clientHeight);A=H+2*u;C=J+2*r;!isNaN(D)&&C<D&&(C=D);window.opera&&(A+=2);var S=!1,y=this.offsetY;c.handDrawn&&(y+=c.handDrawScatter+2);"H"!=z?(D=a-C/2,b<k+A+10&&"down"!=z?(S=!0,e&&(b+=y),y=b+x,this.deltaSignY=-1):(e&&(b-=y),y=b-A-x,this.deltaSignY=1)):(2*x>A&&(x=A/2),y=b-A/2,a<g+(l-g)/2?(D=a+x,this.deltaSignX=-1):(D=a-C-x,this.deltaSignX=1));y+A>=m&&(y=m-A);y<k&&(y=k);D<g&&(D=g);D+C>l&&(D=l-C);var k=y+u,m=D+r,O=this.shadowAlpha,Q=this.shadowColor,r=this.borderThickness,ia=this.bulletSize,I,u=this.fillAlpha,Z=this.borderAlpha;this.showBullet&&(I=d.circle(h,ia,t,u),f.push(I));this.drop?(g=C/1.6,l=0,"V"==z&&(z="down"),"H"==z&&(z="left"),"down"==z&&(D=a+1,y=b-g-g/3),"up"==z&&(l=180,D=a+1,y=b+g+g/3),"left"==z&&(l=270,D=a+g+g/3+2,y=b),"right"==z&&(l=90,D=a-g-g/3+2,y=b),k=y-H/2+1,m=D-J/2-1,q=d.drop(h,g,l,q,u,r,p,Z)):0<v||0===x?(0<O&&(a=d.rect(h,C,A,q,0,r+1,Q,O,v),d.isModern?a.translate(1,1):a.translate(4,4),f.push(a)),q=d.rect(h,C,A,q,u,r,p,Z,v)):(t=[],v=[],"H"!=z?(g=a-D,g>C-x&&(g=C-x),g<x&&(g=x),t=[0,g-x,a-D,g+x,C,C,0,0],v=S?[0,0,b-y,0,0,A,A,0]:[A,A,b-y,A,A,0,0,A]):(z=b-y,z>A-x&&(z=A-x),z<x&&(z=x),v=[0,z-x,b-y,z+x,A,A,0,0],t=a<g+(l-g)/2?[0,0,D<a?0:a-D,0,0,C,C,0]:[C,C,D+C>a?C:a-D,C,C,0,0,C]),0<O&&(a=d.polygon(h,t,v,q,0,r,Q,O),a.translate(1,1),f.push(a)),q=d.polygon(h,t,v,q,u,r,p,Z));this.bg=q;f.push(q);q.toFront();d.setCN(c,q,"balloon-bg");this.className&&d.setCN(c,q,"balloon-bg-"+this.className);h=1*this.deltaSignX;m+=this.sdx;k+=this.sdy;B.left=m+"px";B.top=k+"px";f.translate(D-h,y,1,!0);q=q.getBBox();this.bottom=y+A+1;this.yPos=q.y+y;I&&I.translate(this.pointToX-D+h,b-y);b=this.animationDuration;0<this.animationDuration&&!e&&!isNaN(this.prevX)&&(f.translate(this.prevX,this.prevY,NaN,!0),f.animate({translate:D-h+","+y},b,"easeOutSine"),n&&(B.left=this.prevTX+"px",B.top=this.prevTY+"px",this.xAnim=c.animate({node:n},"left",this.prevTX,m,b,"easeOutSine","px"),this.yAnim=c.animate({node:n},"top",this.prevTY,k,b,"easeOutSine","px")));this.prevX=D-h;this.prevY=y;this.prevTX=m;this.prevTY=k}}},fixPrevious:function(){this.rPrevX=this.prevX;this.rPrevY=this.prevY;this.rPrevTX=this.prevTX;this.rPrevTY=this.prevTY},restorePrevious:function(){this.prevX=this.rPrevX;this.prevY=this.rPrevY;this.prevTX=this.rPrevTX;this.prevTY=this.rPrevTY},followMouse:function(){if(this.follow&&this.show){var a=this.chart.mouseX-this.offsetX*this.deltaSignX-this.sdx,b=this.chart.mouseY-this.sdy;this.pointToX=a;this.pointToY=b;if(a!=this.previousX||b!=this.previousY)if(this.previousX=a,this.previousY=b,0===this.cornerRadius)this.draw();else{var c=this.set;if(c){var e=c.getBBox(),a=a-e.width/2,d=b-e.height-10;a<this.l&&(a=this.l);a>this.r-e.width&&(a=this.r-e.width);d<this.t&&(d=b+10);c.translate(a,d);b=this.textDiv.style;b.left=a+this.horizontalPadding+"px";b.top=d+this.verticalPadding+"px"}}}},changeColor:function(a){this.balloonColor=a},setBounds:function(a,b,c,d){this.l=a;this.t=b;this.r=c;this.b=d;this.destroyTO&&clearTimeout(this.destroyTO)},showBalloon:function(a){if(this.text!=a||this.positionChanged)this.text=a,this.isHiding=!1,this.show=!0,this.destroyTO&&clearTimeout(this.destroyTO),a=this.chart,this.fadeAnim1&&a.stopAnim(this.fadeAnim1),this.fadeAnim2&&a.stopAnim(this.fadeAnim2),this.draw(),this.positionChanged=!1},hide:function(a){var b=this;b.text=void 0;isNaN(a)&&(a=b.fadeOutDuration);var c=b.chart;if(0<a&&!b.isHiding){b.isHiding=!0;b.destroyTO&&clearTimeout(b.destroyTO);b.destroyTO=setTimeout(function(){b.destroy.call(b)},1e3*a);b.follow=!1;b.show=!1;var d=b.set;d&&(d.setAttr("opacity",b.fillAlpha),b.fadeAnim1=d.animate({opacity:0},a,"easeInSine"));b.textDiv&&(b.fadeAnim2=c.animate({node:b.textDiv},"opacity",1,0,a,"easeInSine",""))}else b.show=!1,b.follow=!1,b.destroy()},setPosition:function(a,b){if(a!=this.pointToX||b!=this.pointToY)this.previousX=this.pointToX,this.previousY=this.pointToY,this.pointToX=a,this.pointToY=b,this.positionChanged=!0},followCursor:function(a){var b=this;b.follow=a;clearInterval(b.interval);var c=b.chart.mouseX-b.sdx,d=b.chart.mouseY-b.sdy;!isNaN(c)&&a&&(b.pointToX=c-b.offsetX*b.deltaSignX,b.pointToY=d,b.followMouse(),b.interval=setInterval(function(){b.followMouse.call(b)},40))},removeDiv:function(){if(this.textDiv){var a=this.textDiv.parentNode;a&&a.removeChild(this.textDiv)}},destroy:function(){clearInterval(this.interval);d.remove(this.set);this.removeDiv();this.set=null}})})();(function(){var d=window.AmCharts;d.AmCoordinateChart=d.Class({inherits:d.AmChart,construct:function(a){d.AmCoordinateChart.base.construct.call(this,a);this.theme=a;this.createEvents("rollOverGraphItem","rollOutGraphItem","clickGraphItem","doubleClickGraphItem","rightClickGraphItem","clickGraph","rollOverGraph","rollOutGraph");this.startAlpha=1;this.startDuration=0;this.startEffect="elastic";this.sequencedAnimation=!0;this.colors="#FF6600 #FCD202 #B0DE09 #0D8ECF #2A0CD0 #CD0D74 #CC0000 #00CC00 #0000CC #DDDDDD #999999 #333333 #990000".split(" ");this.balloonDateFormat="MMM DD, YYYY";this.valueAxes=[];this.graphs=[];this.guides=[];this.gridAboveGraphs=!1;d.applyTheme(this,a,"AmCoordinateChart")},initChart:function(){d.AmCoordinateChart.base.initChart.call(this);this.drawGraphs=!0;var a=this.categoryAxis;a&&(this.categoryAxis=d.processObject(a,d.CategoryAxis,this.theme));this.processValueAxes();this.createValueAxes();this.processGraphs();this.processGuides();d.VML&&(this.startAlpha=1);this.setLegendData(this.graphs);this.gridAboveGraphs&&(this.gridSet.toFront(),this.bulletSet.toFront(),this.balloonsSet.toFront())},createValueAxes:function(){if(0===this.valueAxes.length){var a=new d.ValueAxis;this.addValueAxis(a)}},parseData:function(){this.processValueAxes();this.processGraphs()},parseSerialData:function(a){this.chartData=[];if(a)if(0<this.processTimeout){1>this.processCount&&(this.processCount=1);var b=a.length/this.processCount;this.parseCount=Math.ceil(b)-1;for(var c=0;c<b;c++)this.delayParseSerialData(a,c)}else this.parseCount=0,this.parsePartSerialData(a,0,a.length,0);else this.onDataUpdated()},delayParseSerialData:function(a,b){var c=this,d=c.processCount;setTimeout(function(){c.parsePartSerialData.call(c,a,b*d,(b+1)*d,b)},c.processTimeout)},parsePartSerialData:function(a,b,c,e){c>a.length&&(c=a.length);var h=this.graphs,f={},g=this.seriesIdField;g||(g=this.categoryField);var k=!1,l,m=this.categoryAxis,n,q,p;m&&(k=m.parseDates,n=m.forceShowField,p=m.classNameField,q=m.labelColorField,l=m.categoryFunction);var t,r,u={},x;k&&(t=d.extractPeriod(m.minPeriod),r=t.period,t=t.count,x=d.getPeriodDuration(r,t));var z={};this.lookupTable=z;var v,A=this.dataDateFormat,y={};for(v=b;v<c;v++){var B={},D=a[v];b=D[this.categoryField];B.dataContext=D;B.category=l?l(b,D,m):String(b);n&&(B.forceShow=D[n]);p&&(B.className=D[p]);q&&(B.labelColor=D[q]);z[D[g]]=B;if(k&&(m.categoryFunction?b=m.categoryFunction(b,D,m):(!A||b instanceof Date||(b=b.toString()+" |"),b=d.getDate(b,A,m.minPeriod)),b=d.resetDateToMin(b,r,t,m.firstDayOfWeek),B.category=b,B.time=b.getTime(),isNaN(B.time)))continue;var C=this.valueAxes;B.axes={};B.x={};var J;for(J=0;J<C.length;J++){var H=C[J].id;B.axes[H]={};B.axes[H].graphs={};var S;for(S=0;S<h.length;S++){b=h[S];var O=b.id,Q=1.1;isNaN(b.gapPeriod)||(Q=b.gapPeriod);var ia=b.periodValue;if(b.valueAxis.id==H){B.axes[H].graphs[O]={};var I={};I.index=v;var Z=D;b.dataProvider&&(Z=f);I.values=this.processValues(Z,b,ia);!b.connect&&y&&y[O]&&0<Q&&B.time-u[O]>=x*Q&&(y[O].gap=!0);this.processFields(b,I,Z);I.category=B.category;I.serialDataItem=B;I.graph=b;B.axes[H].graphs[O]=I;u[O]=B.time;y[O]=I}}}this.chartData[v]=B}if(this.parseCount==e){for(a=0;a<h.length;a++)b=h[a],b.dataProvider&&this.parseGraphData(b);this.dataChanged=!1;this.dispatchDataUpdated=!0;this.onDataUpdated()}},processValues:function(a,b,c){var e={},h,f=!1;"candlestick"!=b.type&&"ohlc"!=b.type||""===c||(f=!0);for(var g="value error open close low high".split(" "),k=0;k<g.length;k++){var l=g[k];"value"!=l&&"error"!=l&&f&&(c=l.charAt(0).toUpperCase()+l.slice(1));var m=a[b[l+"Field"]+c];null!==m&&(h=Number(m),isNaN(h)||(e[l]=h),"date"==b.valueAxis.type&&void 0!==m&&(h=d.getDate(m,b.chart.dataDateFormat),e[l]=h.getTime()))}return e},parseGraphData:function(a){var b=a.dataProvider,c=a.seriesIdField;c||(c=this.seriesIdField);c||(c=this.categoryField);var d;for(d=0;d<b.length;d++){var h=b[d],f=this.lookupTable[String(h[c])],g=a.valueAxis.id;f&&(g=f.axes[g].graphs[a.id],g.serialDataItem=f,g.values=this.processValues(h,a,a.periodValue),this.processFields(a,g,h))}},addValueAxis:function(a){a.chart=this;this.valueAxes.push(a);this.validateData()},removeValueAxesAndGraphs:function(){var a=this.valueAxes,b;for(b=a.length-1;-1<b;b--)this.removeValueAxis(a[b])},removeValueAxis:function(a){var b=this.graphs,c;for(c=b.length-1;0<=c;c--){var d=b[c];d&&d.valueAxis==a&&this.removeGraph(d)}b=this.valueAxes;for(c=b.length-1;0<=c;c--)b[c]==a&&b.splice(c,1);this.validateData()},addGraph:function(a){this.graphs.push(a);this.chooseGraphColor(a,this.graphs.length-1);this.validateData()},removeGraph:function(a){var b=this.graphs,c;for(c=b.length-1;0<=c;c--)b[c]==a&&(b.splice(c,1),a.destroy());this.validateData()},handleValueAxisZoom:function(){},processValueAxes:function(){var a=this.valueAxes,b;for(b=0;b<a.length;b++){var c=a[b],c=d.processObject(c,d.ValueAxis,this.theme);a[b]=c;c.chart=this;c.init();this.listenTo(c,"axisIntZoomed",this.handleValueAxisZoom);c.id||(c.id="valueAxisAuto"+b+"_"+(new Date).getTime());void 0===c.usePrefixes&&(c.usePrefixes=this.usePrefixes)}},processGuides:function(){var a=this.guides,b=this.categoryAxis;if(a)for(var c=0;c<a.length;c++){var e=a[c];(void 0!==e.category||void 0!==e.date)&&b&&b.addGuide(e);e.id||(e.id="guideAuto"+c+"_"+(new Date).getTime());var h=e.valueAxis;h?(d.isString(h)&&(h=this.getValueAxisById(h)),h?h.addGuide(e):this.valueAxes[0].addGuide(e)):isNaN(e.value)||this.valueAxes[0].addGuide(e)}},processGraphs:function(){var a=this.graphs,b;this.graphsById={};for(b=0;b<a.length;b++){var c=a[b],c=d.processObject(c,d.AmGraph,this.theme);a[b]=c;this.chooseGraphColor(c,b);c.chart=this;c.init();d.isString(c.valueAxis)&&(c.valueAxis=this.getValueAxisById(c.valueAxis));c.valueAxis||(c.valueAxis=this.valueAxes[0]);c.id||(c.id="graphAuto"+b+"_"+(new Date).getTime());this.graphsById[c.id]=c}},formatString:function(a,b,c){var e=b.graph,h=e.valueAxis;h.duration&&b.values.value&&(h=d.formatDuration(b.values.value,h.duration,"",h.durationUnits,h.maxInterval,h.numberFormatter),a=a.split("[[value]]").join(h));a=d.massReplace(a,{"[[title]]":e.title,"[[description]]":b.description});a=c?d.fixNewLines(a):d.fixBrakes(a);return a=d.cleanFromEmpty(a)},getBalloonColor:function(a,b,c){var e=a.lineColor,h=a.balloonColor;c&&(h=e);c=a.fillColorsR;"object"==typeof c?e=c[0]:void 0!==c&&(e=c);b.isNegative&&(c=a.negativeLineColor,a=a.negativeFillColors,"object"==typeof a?c=a[0]:void 0!==a&&(c=a),void 0!==c&&(e=c));void 0!==b.color&&(e=b.color);void 0!==b.lineColor&&(e=b.lineColor);b=b.fillColors;void 0!==b&&(e=b,d.ifArray(b)&&(e=b[0]));void 0===h&&(h=e);return h},getGraphById:function(a){return d.getObjById(this.graphs,a)},getValueAxisById:function(a){return d.getObjById(this.valueAxes,a)},processFields:function(a,b,c){if(a.itemColors){var e=a.itemColors,h=b.index;b.color=h<e.length?e[h]:d.randomColor()}e="lineColor color alpha fillColors description bullet customBullet bulletSize bulletConfig url labelColor dashLength pattern gap className".split(" ");for(h=0;h<e.length;h++){var f=e[h],g=a[f+"Field"];g&&(g=c[g],d.isDefined(g)&&(b[f]=g))}b.dataContext=c},chooseGraphColor:function(a,b){if(a.lineColor)a.lineColorR=a.lineColor;else{var c;c=this.colors.length>b?this.colors[b]:a.lineColorR?a.lineColorR:d.randomColor();a.lineColorR=c}a.fillColorsR=a.fillColors?a.fillColors:a.lineColorR;a.bulletBorderColorR=a.bulletBorderColor?a.bulletBorderColor:a.useLineColorForBulletBorder?a.lineColorR:a.bulletColor;a.bulletColorR=a.bulletColor?a.bulletColor:a.lineColorR;if(c=this.patterns)a.pattern=c[b]},handleLegendEvent:function(a){var b=a.type;a=a.dataItem;if(!this.legend.data&&a){var c=a.hidden,d=a.showBalloon;switch(b){case"clickMarker":this.textClickEnabled&&(d?this.hideGraphsBalloon(a):this.showGraphsBalloon(a));break;case"clickLabel":d?this.hideGraphsBalloon(a):this.showGraphsBalloon(a);break;case"rollOverItem":c||this.highlightGraph(a);break;case"rollOutItem":c||this.unhighlightGraph();break;case"hideItem":this.hideGraph(a);break;case"showItem":this.showGraph(a)}}},highlightGraph:function(a){var b=this.graphs,c,d=.2;this.legend&&(d=this.legend.rollOverGraphAlpha);if(1!=d)for(c=0;c<b.length;c++){var h=b[c];h!=a&&h.changeOpacity(d)}},unhighlightGraph:function(){var a;this.legend&&(a=this.legend.rollOverGraphAlpha);if(1!=a){a=this.graphs;var b;for(b=0;b<a.length;b++)a[b].changeOpacity(1)}},showGraph:function(a){a.switchable&&(a.hidden=!1,this.dataChanged=!0,"xy"!=this.type&&(this.marginsUpdated=!1),this.chartCreated&&this.initChart())},hideGraph:function(a){a.switchable&&(this.dataChanged=!0,"xy"!=this.type&&(this.marginsUpdated=!1),a.hidden=!0,this.chartCreated&&this.initChart())},hideGraphsBalloon:function(a){a.showBalloon=!1;this.updateLegend()},showGraphsBalloon:function(a){a.showBalloon=!0;this.updateLegend()},updateLegend:function(){this.legend&&this.legend.invalidateSize()},resetAnimation:function(){var a=this.graphs;if(a){var b;for(b=0;b<a.length;b++)a[b].animationPlayed=!1}},animateAgain:function(){this.resetAnimation();this.validateNow()}})})();(function(){var d=window.AmCharts;d.TrendLine=d.Class({construct:function(a){this.cname="TrendLine";this.createEvents("click");this.isProtected=!1;this.dashLength=0;this.lineColor="#00CC00";this.lineThickness=this.lineAlpha=1;d.applyTheme(this,a,this.cname)},draw:function(){var a=this;a.destroy();var b=a.chart,c=b.container,e,h,f,g,k=a.categoryAxis,l=a.initialDate,m=a.initialCategory,n=a.finalDate,q=a.finalCategory,p=a.valueAxis,t=a.valueAxisX,r=a.initialXValue,u=a.finalXValue,x=a.initialValue,z=a.finalValue,v=p.recalculateToPercents,A=b.dataDateFormat;k&&(l&&(l=d.getDate(l,A,"fff"),a.initialDate=l,e=k.dateToCoordinate(l)),m&&(e=k.categoryToCoordinate(m)),n&&(n=d.getDate(n,A,"fff"),a.finalDate=n,h=k.dateToCoordinate(n)),q&&(h=k.categoryToCoordinate(q)));t&&!v&&(isNaN(r)||(e=t.getCoordinate(r)),isNaN(u)||(h=t.getCoordinate(u)));p&&!v&&(isNaN(x)||(f=p.getCoordinate(x)),isNaN(z)||(g=p.getCoordinate(z)));if(!(isNaN(e)||isNaN(h)||isNaN(f)||isNaN(f))){b.rotate?(k=[f,g],g=[e,h]):(k=[e,h],g=[f,g]);l=a.lineColor;f=d.line(c,k,g,l,a.lineAlpha,a.lineThickness,a.dashLength);e=k;h=g;q=k[1]-k[0];p=g[1]-g[0];0===q&&(q=.01);0===p&&(p=.01);m=q/Math.abs(q);n=p/Math.abs(p);p=90*Math.PI/180-Math.asin(q/(q*p/Math.abs(q*p)*Math.sqrt(Math.pow(q,2)+Math.pow(p,2))));q=Math.abs(5*Math.cos(p));p=Math.abs(5*Math.sin(p));e.push(k[1]-m*p,k[0]-m*p);h.push(g[1]+n*q,g[0]+n*q);g=d.polygon(c,e,h,l,.005,0);c=c.set([g,f]);c.translate(b.marginLeftReal,b.marginTopReal);b.trendLinesSet.push(c);d.setCN(b,f,"trend-line");d.setCN(b,f,"trend-line-"+a.id);a.line=f;a.set=c;if(f=a.initialImage)f=d.processObject(f,d.Image,a.theme),f.chart=b,f.draw(),f.translate(e[0]+f.offsetX,h[0]+f.offsetY),c.push(f.set);if(f=a.finalImage)f=d.processObject(f,d.Image,a.theme),f.chart=b,f.draw(),f.translate(e[1]+f.offsetX,h[1]+f.offsetY),c.push(f.set);g.mouseup(function(){a.handleLineClick()}).mouseover(function(){a.handleLineOver()}).mouseout(function(){a.handleLineOut()});g.touchend&&g.touchend(function(){a.handleLineClick()});c.clipRect(0,0,b.plotAreaWidth,b.plotAreaHeight)}},handleLineClick:function(){this.fire({type:"click",trendLine:this,chart:this.chart})},handleLineOver:function(){var a=this.rollOverColor;void 0!==a&&this.line.attr({stroke:a});this.balloonText&&(clearTimeout(this.chart.hoverInt),a=this.line.getBBox(),this.chart.showBalloon(this.balloonText,this.lineColor,!0,this.x+a.x+a.width/2,this.y+a.y+a.height/2))},handleLineOut:function(){this.line.attr({stroke:this.lineColor});this.balloonText&&this.chart.hideBalloon()},destroy:function(){d.remove(this.set)}})})();(function(){var d=window.AmCharts;d.Image=d.Class({construct:function(a){this.cname="Image";this.height=this.width=20;this.rotation=this.offsetY=this.offsetX=0;this.balloonColor=this.color="#000000";this.opacity=1;d.applyTheme(this,a,this.cname)},draw:function(){var a=this;a.set&&a.set.remove();var b=a.chart.container;a.set=b.set();var c,d;a.url?(c=b.image(a.url,0,0,a.width,a.height),d=1):a.svgPath&&(c=b.path(a.svgPath),c.setAttr("fill",a.color),c.setAttr("stroke",a.outlineColor),b=c.getBBox(),d=Math.min(a.width/b.width,a.height/b.height));c&&(c.setAttr("opacity",a.opacity),a.set.rotate(a.rotation),c.translate(-a.width/2,-a.height/2,d),a.balloonText&&c.mouseover(function(){a.chart.showBalloon(a.balloonText,a.balloonColor,!0)}).mouseout(function(){a.chart.hideBalloon()}).touchend(function(){a.chart.hideBalloon()}).touchstart(function(){a.chart.showBalloon(a.balloonText,a.balloonColor,!0)}),a.set.push(c))},translate:function(a,b){this.set&&this.set.translate(a,b)}})})();(function(){var d=window.AmCharts;d.circle=function(a,b,c,e,h,f,g,k,l){0>=b&&(b=.001);if(void 0==h||0===h)h=.01;void 0===f&&(f="#000000");void 0===g&&(g=0);e={fill:c,stroke:f,"fill-opacity":e,"stroke-width":h,"stroke-opacity":g};a=isNaN(l)?a.circle(0,0,b).attr(e):a.ellipse(0,0,b,l).attr(e);k&&a.gradient("radialGradient",[c,d.adjustLuminosity(c,-.6)]);return a};d.text=function(a,b,c,e,h,f,g,k){f||(f="middle");"right"==f&&(f="end");"left"==f&&(f="start");isNaN(k)&&(k=1);void 0!==b&&(b=String(b),d.isIE&&!d.isModern&&(b=b.replace("&amp;","&"),b=b.replace("&","&amp;")));c={fill:c,"font-family":e,"font-size":h+"px",opacity:k};!0===g&&(c["font-weight"]="bold");c["text-anchor"]=f;return a.text(b,c)};d.polygon=function(a,b,c,e,h,f,g,k,l,m,n){isNaN(f)&&(f=.01);isNaN(k)&&(k=h);var q=e,p=!1;"object"==typeof q&&1<q.length&&(p=!0,q=q[0]);void 0===g&&(g=q);h={fill:q,stroke:g,"fill-opacity":h,"stroke-width":f,"stroke-opacity":k};void 0!==n&&0<n&&(h["stroke-dasharray"]=n);n=d.dx;f=d.dy;a.handDrawn&&(c=d.makeHD(b,c,a.handDrawScatter),b=c[0],c=c[1]);g=Math.round;m&&(b[t]=d.roundTo(b[t],5),c[t]=d.roundTo(c[t],5),g=Number);k="M"+(g(b[0])+n)+","+(g(c[0])+f);for(var t=1;t<b.length;t++)m&&(b[t]=d.roundTo(b[t],5),c[t]=d.roundTo(c[t],5)),k+=" L"+(g(b[t])+n)+","+(g(c[t])+f);a=a.path(k+" Z").attr(h);p&&a.gradient("linearGradient",e,l);return a};d.rect=function(a,b,c,e,h,f,g,k,l,m,n){if(isNaN(b)||isNaN(c))return a.set();isNaN(f)&&(f=0);void 0===l&&(l=0);void 0===m&&(m=270);isNaN(h)&&(h=0);var q=e,p=!1;"object"==typeof q&&(q=q[0],p=!0);void 0===g&&(g=q);void 0===k&&(k=h);b=Math.round(b);c=Math.round(c);var t=0,r=0;0>b&&(b=Math.abs(b),t=-b);0>c&&(c=Math.abs(c),r=-c);t+=d.dx;r+=d.dy;h={fill:q,stroke:g,"fill-opacity":h,"stroke-opacity":k};void 0!==n&&0<n&&(h["stroke-dasharray"]=n);a=a.rect(t,r,b,c,l,f).attr(h);p&&a.gradient("linearGradient",e,m);return a};d.bullet=function(a,b,c,e,h,f,g,k,l,m,n,q,p){var t;"circle"==b&&(b="round");switch(b){case"round":t=d.circle(a,c/2,e,h,f,g,k);break;case"square":t=d.polygon(a,[-c/2,c/2,c/2,-c/2],[c/2,c/2,-c/2,-c/2],e,h,f,g,k,m-180,void 0,p);break;case"rectangle":t=d.polygon(a,[-c,c,c,-c],[c/2,c/2,-c/2,-c/2],e,h,f,g,k,m-180,void 0,p);break;case"diamond":t=d.polygon(a,[-c/2,0,c/2,0],[0,-c/2,0,c/2],e,h,f,g,k);break;case"triangleUp":t=d.triangle(a,c,0,e,h,f,g,k);break;case"triangleDown":t=d.triangle(a,c,180,e,h,f,g,k);break;case"triangleLeft":t=d.triangle(a,c,270,e,h,f,g,k);break;case"triangleRight":t=d.triangle(a,c,90,e,h,f,g,k);break;case"bubble":t=d.circle(a,c/2,e,h,f,g,k,!0);break;case"line":t=d.line(a,[-c/2,c/2],[0,0],e,h,f,g,k);break;case"yError":t=a.set();t.push(d.line(a,[0,0],[-c/2,c/2],e,h,f));t.push(d.line(a,[-l,l],[-c/2,-c/2],e,h,f));t.push(d.line(a,[-l,l],[c/2,c/2],e,h,f));break;case"xError":t=a.set(),t.push(d.line(a,[-c/2,c/2],[0,0],e,h,f)),t.push(d.line(a,[-c/2,-c/2],[-l,l],e,h,f)),t.push(d.line(a,[c/2,c/2],[-l,l],e,h,f))}t&&t.pattern(n,NaN,q);return t};d.triangle=function(a,b,c,d,h,f,g,k){if(void 0===f||0===f)f=1;void 0===g&&(g="#000");void 0===k&&(k=0);d={fill:d,stroke:g,"fill-opacity":h,"stroke-width":f,"stroke-opacity":k};b/=2;var l;0===c&&(l=" M"+-b+","+b+" L0,"+-b+" L"+b+","+b+" Z");180==c&&(l=" M"+-b+","+-b+" L0,"+b+" L"+b+","+-b+" Z");90==c&&(l=" M"+-b+","+-b+" L"+b+",0 L"+-b+","+b+" Z");270==c&&(l=" M"+-b+",0 L"+b+","+b+" L"+b+","+-b+" Z");return a.path(l).attr(d)};d.line=function(a,b,c,e,h,f,g,k,l,m,n){if(a.handDrawn&&!n)return d.handDrawnLine(a,b,c,e,h,f,g,k,l,m,n);f={fill:"none","stroke-width":f};void 0!==g&&0<g&&(f["stroke-dasharray"]=g);isNaN(h)||(f["stroke-opacity"]=h);e&&(f.stroke=e);e=Math.round;m&&(e=Number,b[0]=d.roundTo(b[0],5),c[0]=d.roundTo(c[0],5));m=d.dx;h=d.dy;g="M"+(e(b[0])+m)+","+(e(c[0])+h);for(k=1;k<b.length;k++)b[k]=d.roundTo(b[k],5),c[k]=d.roundTo(c[k],5),g+=" L"+(e(b[k])+m)+","+(e(c[k])+h);if(d.VML)return a.path(g,void 0,!0).attr(f);l&&(g+=" M0,0 L0,0");return a.path(g).attr(f)};d.makeHD=function(a,b,c){for(var d=[],h=[],f=1;f<a.length;f++)for(var g=Number(a[f-1]),k=Number(b[f-1]),l=Number(a[f]),m=Number(b[f]),n=Math.round(Math.sqrt(Math.pow(l-g,2)+Math.pow(m-k,2))/50)+1,l=(l-g)/n,m=(m-k)/n,q=0;q<=n;q++){var p=k+q*m+Math.random()*c;d.push(g+q*l+Math.random()*c);h.push(p)}return[d,h]};d.handDrawnLine=function(a,b,c,e,h,f,g,k,l,m){var n,q=a.set();for(n=1;n<b.length;n++)for(var p=[b[n-1],b[n]],t=[c[n-1],c[n]],t=d.makeHD(p,t,a.handDrawScatter),p=t[0],t=t[1],r=1;r<p.length;r++)q.push(d.line(a,[p[r-1],p[r]],[t[r-1],t[r]],e,h,f+Math.random()*a.handDrawThickness-a.handDrawThickness/2,g,k,l,m,!0));return q};d.doNothing=function(a){return a};d.drop=function(a,b,c,d,h,f,g,k){var l=1/180*Math.PI,m=c-20,n=Math.sin(m*l)*b,q=Math.cos(m*l)*b,p=Math.sin((m+40)*l)*b,t=Math.cos((m+40)*l)*b,r=.8*b,u=-b/3,x=b/3;0===c&&(u=-u,x=0);180==c&&(x=0);90==c&&(u=0);270==c&&(u=0,x=-x);c={fill:d,stroke:g,"stroke-width":f,"stroke-opacity":k,"fill-opacity":h};b="M"+n+","+q+" A"+b+","+b+",0,1,1,"+p+","+t+(" A"+r+","+r+",0,0,0,"+(Math.sin((m+20)*l)*b+x)+","+(Math.cos((m+20)*l)*b+u));b+=" A"+r+","+r+",0,0,0,"+n+","+q;return a.path(b,void 0,void 0,"1000,1000").attr(c)};d.wedge=function(a,b,c,e,h,f,g,k,l,m,n,q,p,t){var r=Math.round;f=r(f);g=r(g);k=r(k);var u=r(g/f*k),x=d.VML,z=359.5+f/100;359.94<z&&(z=359.94);h>=z&&(h=z);var v=1/180*Math.PI,z=b+Math.sin(e*v)*k,A=c-Math.cos(e*v)*u,y=b+Math.sin(e*v)*f,B=c-Math.cos(e*v)*g,D=b+Math.sin((e+h)*v)*f,C=c-Math.cos((e+h)*v)*g,J=b+Math.sin((e+h)*v)*k,v=c-Math.cos((e+h)*v)*u,H={fill:d.adjustLuminosity(m.fill,-.2),"stroke-opacity":0,"fill-opacity":m["fill-opacity"]},S=0;180<Math.abs(h)&&(S=1);e=a.set();var O;x&&(z=r(10*z),y=r(10*y),D=r(10*D),J=r(10*J),A=r(10*A),B=r(10*B),C=r(10*C),v=r(10*v),b=r(10*b),l=r(10*l),c=r(10*c),f*=10,g*=10,k*=10,u*=10,1>Math.abs(h)&&1>=Math.abs(D-y)&&1>=Math.abs(C-B)&&(O=!0));h="";var Q;q&&(H["fill-opacity"]=0,H["stroke-opacity"]=m["stroke-opacity"]/2,H.stroke=m.stroke);if(0<l){Q=" M"+z+","+(A+l)+" L"+y+","+(B+l);x?(O||(Q+=" A"+(b-f)+","+(l+c-g)+","+(b+f)+","+(l+c+g)+","+y+","+(B+l)+","+D+","+(C+l)),Q+=" L"+J+","+(v+l),0<k&&(O||(Q+=" B"+(b-k)+","+(l+c-u)+","+(b+k)+","+(l+c+u)+","+J+","+(l+v)+","+z+","+(l+A)))):(Q+=" A"+f+","+g+",0,"+S+",1,"+D+","+(C+l)+" L"+J+","+(v+l),0<k&&(Q+=" A"+k+","+u+",0,"+S+",0,"+z+","+(A+l)));Q+=" Z";var ia=l;x&&(ia/=10);for(var I=0;I<ia;I+=10){var Z=a.path(Q,void 0,void 0,"1000,1000").attr(H);e.push(Z);Z.translate(0,-I)}Q=a.path(" M"+z+","+A+" L"+z+","+(A+l)+" L"+y+","+(B+l)+" L"+y+","+B+" L"+z+","+A+" Z",void 0,void 0,"1000,1000").attr(H);l=a.path(" M"+D+","+C+" L"+D+","+(C+l)+" L"+J+","+(v+l)+" L"+J+","+v+" L"+D+","+C+" Z",void 0,void 0,"1000,1000").attr(H);e.push(Q);e.push(l)}x?(O||(h=" A"+r(b-f)+","+r(c-g)+","+r(b+f)+","+r(c+g)+","+r(y)+","+r(B)+","+r(D)+","+r(C)),g=" M"+r(z)+","+r(A)+" L"+r(y)+","+r(B)+h+" L"+r(J)+","+r(v)):g=" M"+z+","+A+" L"+y+","+B+(" A"+f+","+g+",0,"+S+",1,"+D+","+C)+" L"+J+","+v;0<k&&(x?O||(g+=" B"+(b-k)+","+(c-u)+","+(b+k)+","+(c+u)+","+J+","+v+","+z+","+A):g+=" A"+k+","+u+",0,"+S+",0,"+z+","+A);a.handDrawn&&(k=d.line(a,[z,y],[A,B],m.stroke,m.thickness*Math.random()*a.handDrawThickness,m["stroke-opacity"]),e.push(k));a=a.path(g+" Z",void 0,void 0,"1000,1000").attr(m);if(n){k=[];for(u=0;u<n.length;u++)k.push(d.adjustLuminosity(m.fill,n[u]));"radial"!=t||d.isModern||(k=[]);0<k.length&&a.gradient(t+"Gradient",k)}d.isModern&&"radial"==t&&a.grad&&(a.grad.setAttribute("gradientUnits","userSpaceOnUse"),a.grad.setAttribute("r",f),a.grad.setAttribute("cx",b),a.grad.setAttribute("cy",c));a.pattern(q,NaN,p);e.wedge=a;e.push(a);return e};d.rgb2hex=function(a){return(a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):""};d.adjustLuminosity=function(a,b){a&&-1!=a.indexOf("rgb")&&(a=d.rgb2hex(a));a=String(a).replace(/[^0-9a-f]/gi,"");6>a.length&&(a=String(a[0])+String(a[0])+String(a[1])+String(a[1])+String(a[2])+String(a[2]));b=b||0;var c="#",e,h;for(h=0;3>h;h++)e=parseInt(a.substr(2*h,2),16),e=Math.round(Math.min(Math.max(0,e+e*b),255)).toString(16),c+=("00"+e).substr(e.length);return c}})();(function(){var d=window.AmCharts;d.Bezier=d.Class({construct:function(a,b,c,e,h,f,g,k,l,m,n){var q,p;"object"==typeof g&&1<g.length&&(p=!0,q=g,g=g[0]);"object"==typeof k&&(k=k[0]);0===k&&(g="none");f={fill:g,"fill-opacity":k,"stroke-width":f};void 0!==l&&0<l&&(f["stroke-dasharray"]=l);isNaN(h)||(f["stroke-opacity"]=h);e&&(f.stroke=e);e="M"+Math.round(b[0])+","+Math.round(c[0]);h=[];for(l=0;l<b.length;l++)h.push({x:Number(b[l]),y:Number(c[l])});1<h.length&&(b=this.interpolate(h),e+=this.drawBeziers(b));m?e+=m:d.VML||(e+="M0,0 L0,0");this.path=a.path(e).attr(f);this.node=this.path.node;p&&this.path.gradient("linearGradient",q,n)},interpolate:function(a){var b=[];b.push({x:a[0].x,y:a[0].y});var c=a[1].x-a[0].x,e=a[1].y-a[0].y,h=d.bezierX,f=d.bezierY;b.push({x:a[0].x+c/h,y:a[0].y+e/f});var g;for(g=1;g<a.length-1;g++){var k=a[g-1],l=a[g],e=a[g+1];isNaN(e.x)&&(e=l);isNaN(l.x)&&(l=k);isNaN(k.x)&&(k=l);c=e.x-l.x;e=e.y-k.y;k=l.x-k.x;k>c&&(k=c);b.push({x:l.x-k/h,y:l.y-e/f});b.push({x:l.x,y:l.y});b.push({x:l.x+k/h,y:l.y+e/f})}e=a[a.length-1].y-a[a.length-2].y;c=a[a.length-1].x-a[a.length-2].x;b.push({x:a[a.length-1].x-c/h,y:a[a.length-1].y-e/f});b.push({x:a[a.length-1].x,y:a[a.length-1].y});return b},drawBeziers:function(a){var b="",c;for(c=0;c<(a.length-1)/3;c++)b+=this.drawBezierMidpoint(a[3*c],a[3*c+1],a[3*c+2],a[3*c+3]);return b},drawBezierMidpoint:function(a,b,c,d){var h=Math.round,f=this.getPointOnSegment(a,b,.75),g=this.getPointOnSegment(d,c,.75),k=(d.x-a.x)/16,l=(d.y-a.y)/16,m=this.getPointOnSegment(a,b,.375);a=this.getPointOnSegment(f,g,.375);a.x-=k;a.y-=l;b=this.getPointOnSegment(g,f,.375);b.x+=k;b.y+=l;c=this.getPointOnSegment(d,c,.375);k=this.getMiddle(m,a);f=this.getMiddle(f,g);g=this.getMiddle(b,c);m=" Q"+h(m.x)+","+h(m.y)+","+h(k.x)+","+h(k.y);m+=" Q"+h(a.x)+","+h(a.y)+","+h(f.x)+","+h(f.y);m+=" Q"+h(b.x)+","+h(b.y)+","+h(g.x)+","+h(g.y);return m+=" Q"+h(c.x)+","+h(c.y)+","+h(d.x)+","+h(d.y)},getMiddle:function(a,b){return{x:(a.x+b.x)/2,y:(a.y+b.y)/2}},getPointOnSegment:function(a,b,c){return{x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}}})})();(function(){var d=window.AmCharts;d.AmDraw=d.Class({construct:function(a,b,c,e){d.SVG_NS="http://www.w3.org/2000/svg";d.SVG_XLINK="http://www.w3.org/1999/xlink";d.hasSVG=!!document.createElementNS&&!!document.createElementNS(d.SVG_NS,"svg").createSVGRect;1>b&&(b=10);1>c&&(c=10);this.div=a;this.width=b;this.height=c;this.rBin=document.createElement("div");d.hasSVG?(d.SVG=!0,b=this.createSvgElement("svg"),a.appendChild(b),this.container=b,this.addDefs(e),this.R=new d.SVGRenderer(this)):d.isIE&&d.VMLRenderer&&(d.VML=!0,d.vmlStyleSheet||(document.namespaces.add("amvml","urn:schemas-microsoft-com:vml"),31>document.styleSheets.length?(b=document.createStyleSheet(),b.addRule(".amvml","behavior:url(#default#VML); display:inline-block; antialias:true"),d.vmlStyleSheet=b):document.styleSheets[0].addRule(".amvml","behavior:url(#default#VML); display:inline-block; antialias:true")),this.container=a,this.R=new d.VMLRenderer(this,e),this.R.disableSelection(a))},createSvgElement:function(a){return document.createElementNS(d.SVG_NS,a)},circle:function(a,b,c,e){var h=new d.AmDObject("circle",this);h.attr({r:c,cx:a,cy:b});this.addToContainer(h.node,e);return h},ellipse:function(a,b,c,e,h){var f=new d.AmDObject("ellipse",this);f.attr({rx:c,ry:e,cx:a,cy:b});this.addToContainer(f.node,h);return f},setSize:function(a,b){0<a&&0<b&&(this.container.style.width=a+"px",this.container.style.height=b+"px")},rect:function(a,b,c,e,h,f,g){var k=new d.AmDObject("rect",this);d.VML&&(h=Math.round(100*h/Math.min(c,e)),c+=2*f,e+=2*f,k.bw=f,k.node.style.marginLeft=-f,k.node.style.marginTop=-f);1>c&&(c=1);1>e&&(e=1);k.attr({x:a,y:b,width:c,height:e,rx:h,ry:h,"stroke-width":f});this.addToContainer(k.node,g);return k},image:function(a,b,c,e,h,f){var g=new d.AmDObject("image",this);g.attr({x:b,y:c,width:e,height:h});this.R.path(g,a);this.addToContainer(g.node,f);return g},addToContainer:function(a,b){b||(b=this.container);b.appendChild(a)},text:function(a,b,c){return this.R.text(a,b,c)},path:function(a,b,c,e){var h=new d.AmDObject("path",this);e||(e="100,100");h.attr({cs:e});c?h.attr({dd:a}):h.attr({d:a});this.addToContainer(h.node,b);return h},set:function(a){return this.R.set(a)},remove:function(a){if(a){var b=this.rBin;b.appendChild(a);b.innerHTML=""}},renderFix:function(){var a=this.container,b=a.style;b.top="0px";b.left="0px";try{var c=a.getBoundingClientRect(),d=c.left-Math.round(c.left),h=c.top-Math.round(c.top);d&&(b.left=d+"px");h&&(b.top=h+"px")}catch(f){}},update:function(){this.R.update()},addDefs:function(a){if(d.hasSVG){var b=this.createSvgElement("desc"),c=this.container;c.setAttribute("version","1.1");c.style.position="absolute";this.setSize(this.width,this.height);if(a.accessibleTitle){var e=this.createSvgElement("title");e.appendChild(document.createTextNode(a.accessibleTitle));c.appendChild(e)}d.rtl&&(c.setAttribute("direction","rtl"),c.style.left="auto",c.style.right="0px");a&&(a.addCodeCredits&&b.appendChild(document.createTextNode("JavaScript chart by amCharts "+a.version)),c.appendChild(b),a.defs&&(b=this.createSvgElement("defs"),c.appendChild(b),d.parseDefs(a.defs,b),this.defs=b))}}})})();(function(){var d=window.AmCharts;d.AmDObject=d.Class({construct:function(a,b){this.D=b;this.R=b.R;this.node=this.R.create(this,a);this.y=this.x=0;this.scale=1},attr:function(a){this.R.attr(this,a);return this},getAttr:function(a){return this.node.getAttribute(a)},setAttr:function(a,b){this.R.setAttr(this,a,b);return this},clipRect:function(a,b,c,d){this.R.clipRect(this,a,b,c,d)},translate:function(a,b,c,d){d||(a=Math.round(a),b=Math.round(b));this.R.move(this,a,b,c);this.x=a;this.y=b;this.scale=c;this.angle&&this.rotate(this.angle)},rotate:function(a,b){this.R.rotate(this,a,b);this.angle=a},animate:function(a,b,c){for(var e in a)if(a.hasOwnProperty(e)){var h=e,f=a[e];c=d.getEffect(c);this.R.animate(this,h,f,b,c)}},push:function(a){if(a){var b=this.node;b.appendChild(a.node);var c=a.clipPath;c&&b.appendChild(c);(a=a.grad)&&b.appendChild(a)}},text:function(a){this.R.setText(this,a)},remove:function(){this.stop();this.R.remove(this)},clear:function(){var a=this.node;if(a.hasChildNodes())for(;1<=a.childNodes.length;)a.removeChild(a.firstChild)},hide:function(){this.setAttr("visibility","hidden")},show:function(){this.setAttr("visibility","visible")},getBBox:function(){return this.R.getBBox(this)},toFront:function(){var a=this.node;if(a){this.prevNextNode=a.nextSibling;var b=a.parentNode;b&&b.appendChild(a)}},toPrevious:function(){var a=this.node;a&&this.prevNextNode&&(a=a.parentNode)&&a.insertBefore(this.prevNextNode,null)},toBack:function(){var a=this.node;if(a){this.prevNextNode=a.nextSibling;var b=a.parentNode;if(b){var c=b.firstChild;c&&b.insertBefore(a,c)}}},mouseover:function(a){this.R.addListener(this,"mouseover",a);return this},mouseout:function(a){this.R.addListener(this,"mouseout",a);return this},click:function(a){this.R.addListener(this,"click",a);return this},dblclick:function(a){this.R.addListener(this,"dblclick",a);return this},mousedown:function(a){this.R.addListener(this,"mousedown",a);return this},mouseup:function(a){this.R.addListener(this,"mouseup",a);return this},touchmove:function(a){this.R.addListener(this,"touchmove",a);return this},touchstart:function(a){this.R.addListener(this,"touchstart",a);return this},touchend:function(a){this.R.addListener(this,"touchend",a);return this},contextmenu:function(a){this.node.addEventListener?this.node.addEventListener("contextmenu",a,!0):this.R.addListener(this,"contextmenu",a);return this},stop:function(){d.removeFromArray(this.R.animations,this.an_translate);d.removeFromArray(this.R.animations,this.an_y);d.removeFromArray(this.R.animations,this.an_x)},length:function(){return this.node.childNodes.length},gradient:function(a,b,c){this.R.gradient(this,a,b,c)},pattern:function(a,b,c){a&&this.R.pattern(this,a,b,c)}})})();(function(){var d=window.AmCharts;d.VMLRenderer=d.Class({construct:function(a,b){this.chart=b;this.D=a;this.cNames={circle:"oval",ellipse:"oval",rect:"roundrect",path:"shape"};this.styleMap={x:"left",y:"top",width:"width",height:"height","font-family":"fontFamily","font-size":"fontSize",visibility:"visibility"}},create:function(a,b){var c;if("group"==b)c=document.createElement("div"),a.type="div";else if("text"==b)c=document.createElement("div"),a.type="text";else if("image"==b)c=document.createElement("img"),a.type="image";else{a.type="shape";a.shapeType=this.cNames[b];c=document.createElement("amvml:"+this.cNames[b]);var d=document.createElement("amvml:stroke");c.appendChild(d);a.stroke=d;var h=document.createElement("amvml:fill");c.appendChild(h);a.fill=h;h.className="amvml";d.className="amvml";c.className="amvml"}c.style.position="absolute";c.style.top=0;c.style.left=0;return c},path:function(a,b){a.node.setAttribute("src",b)},setAttr:function(a,b,c){if(void 0!==c){var e;8===document.documentMode&&(e=!0);var h=a.node,f=a.type,g=h.style;"r"==b&&(g.width=2*c,g.height=2*c);"oval"==a.shapeType&&("rx"==b&&(g.width=2*c),"ry"==b&&(g.height=2*c));"roundrect"==a.shapeType&&("width"!=b&&"height"!=b||--c);"cursor"==b&&(g.cursor=c);"cx"==b&&(g.left=c-d.removePx(g.width)/2);"cy"==b&&(g.top=c-d.removePx(g.height)/2);var k=this.styleMap[b];"width"==k&&0>c&&(c=0);void 0!==k&&(g[k]=c);"text"==f&&("text-anchor"==b&&(a.anchor=c,k=h.clientWidth,"end"==c&&(g.marginLeft=-k+"px"),"middle"==c&&(g.marginLeft=-(k/2)+"px",g.textAlign="center"),"start"==c&&(g.marginLeft="0px")),"fill"==b&&(g.color=c),"font-weight"==b&&(g.fontWeight=c));if(g=a.children)for(k=0;k<g.length;k++)g[k].setAttr(b,c);if("shape"==f){"cs"==b&&(h.style.width="100px",h.style.height="100px",h.setAttribute("coordsize",c));"d"==b&&h.setAttribute("path",this.svgPathToVml(c));"dd"==b&&h.setAttribute("path",c);f=a.stroke;a=a.fill;"stroke"==b&&(e?f.color=c:f.setAttribute("color",c));"stroke-width"==b&&(e?f.weight=c:f.setAttribute("weight",c));"stroke-opacity"==b&&(e?f.opacity=c:f.setAttribute("opacity",c));"stroke-dasharray"==b&&(g="solid",0<c&&3>c&&(g="dot"),3<=c&&6>=c&&(g="dash"),6<c&&(g="longdash"),e?f.dashstyle=g:f.setAttribute("dashstyle",g));if("fill-opacity"==b||"opacity"==b)0===c?e?a.on=!1:a.setAttribute("on",!1):e?a.opacity=c:a.setAttribute("opacity",c);"fill"==b&&(e?a.color=c:a.setAttribute("color",c));"rx"==b&&(e?h.arcSize=c+"%":h.setAttribute("arcsize",c+"%"))}}},attr:function(a,b){for(var c in b)b.hasOwnProperty(c)&&this.setAttr(a,c,b[c])},text:function(a,b,c){var e=new d.AmDObject("text",this.D),h=e.node;h.style.whiteSpace="pre";h.innerHTML=a;this.D.addToContainer(h,c);this.attr(e,b);return e},getBBox:function(a){return this.getBox(a.node)},getBox:function(a){var b=a.offsetLeft,c=a.offsetTop,d=a.offsetWidth,h=a.offsetHeight,f;if(a.hasChildNodes()){var g,k,l;for(l=0;l<a.childNodes.length;l++){f=this.getBox(a.childNodes[l]);var m=f.x;isNaN(m)||(isNaN(g)?g=m:m<g&&(g=m));var n=f.y;isNaN(n)||(isNaN(k)?k=n:n<k&&(k=n));m=f.width+m;isNaN(m)||(d=Math.max(d,m));f=f.height+n;isNaN(f)||(h=Math.max(h,f))}0>g&&(b+=g);0>k&&(c+=k)}return{x:b,y:c,width:d,height:h}},setText:function(a,b){var c=a.node;c&&(c.innerHTML=b);this.setAttr(a,"text-anchor",a.anchor)},addListener:function(a,b,c){a.node["on"+b]=c},move:function(a,b,c){var e=a.node,h=e.style;"text"==a.type&&(c-=d.removePx(h.fontSize)/2-1);"oval"==a.shapeType&&(b-=d.removePx(h.width)/2,c-=d.removePx(h.height)/2);a=a.bw;isNaN(a)||(b-=a,c-=a);isNaN(b)||isNaN(c)||(e.style.left=b+"px",e.style.top=c+"px")},svgPathToVml:function(a){var b=a.split(" ");a="";var c,d=Math.round,h;for(h=0;h<b.length;h++){var f=b[h],g=f.substring(0,1),f=f.substring(1),k=f.split(","),l=d(k[0])+","+d(k[1]);"M"==g&&(a+=" m "+l);"L"==g&&(a+=" l "+l);"Z"==g&&(a+=" x e");if("Q"==g){var m=c.length,n=c[m-1],q=k[0],p=k[1],l=k[2],t=k[3];c=d(c[m-2]/3+2/3*q);n=d(n/3+2/3*p);q=d(2/3*q+l/3);p=d(2/3*p+t/3);a+=" c "+c+","+n+","+q+","+p+","+l+","+t}"A"==g&&(a+=" wa "+f);"B"==g&&(a+=" at "+f);c=k}return a},animate:function(a,b,c,d,h){var f=a.node,g=this.chart;a.animationFinished=!1;if("translate"==b){b=c.split(",");c=b[1];var k=f.offsetTop;g.animate(a,"left",f.offsetLeft,b[0],d,h,"px");g.animate(a,"top",k,c,d,h,"px")}},clipRect:function(a,b,c,d,h){a=a.node;0===b&&0===c?(a.style.width=d+"px",a.style.height=h+"px",a.style.overflow="hidden"):a.style.clip="rect("+c+"px "+(b+d)+"px "+(c+h)+"px "+b+"px)"},rotate:function(a,b,c){if(0!==Number(b)){var e=a.node;a=e.style;c||(c=this.getBGColor(e.parentNode));a.backgroundColor=c;a.paddingLeft=1;c=b*Math.PI/180;var h=Math.cos(c),f=Math.sin(c),g=d.removePx(a.left),k=d.removePx(a.top),l=e.offsetWidth,e=e.offsetHeight;b/=Math.abs(b);a.left=g+l/2-l/2*Math.cos(c)-b*e/2*Math.sin(c)+3;a.top=k-b*l/2*Math.sin(c)+b*e/2*Math.sin(c);a.cssText=a.cssText+"; filter:progid:DXImageTransform.Microsoft.Matrix(M11='"+h+"', M12='"+-f+"', M21='"+f+"', M22='"+h+"', sizingmethod='auto expand');"}},getBGColor:function(a){var b="#FFFFFF";if(a.style){var c=a.style.backgroundColor;""!==c?b=c:a.parentNode&&(b=this.getBGColor(a.parentNode))}return b},set:function(a){var b=new d.AmDObject("group",this.D);this.D.container.appendChild(b.node);if(a){var c;for(c=0;c<a.length;c++)b.push(a[c])}return b},gradient:function(a,b,c,d){var h="";"radialGradient"==b&&(b="gradientradial",c.reverse());"linearGradient"==b&&(b="gradient");var f;for(f=0;f<c.length;f++)h+=Math.round(100*f/(c.length-1))+"% "+c[f],f<c.length-1&&(h+=",");a=a.fill;90==d?d=0:270==d?d=180:180==d?d=90:0===d&&(d=270);8===document.documentMode?(a.type=b,a.angle=d):(a.setAttribute("type",b),a.setAttribute("angle",d));h&&(a.colors.value=h)},remove:function(a){a.clipPath&&this.D.remove(a.clipPath);this.D.remove(a.node)},disableSelection:function(a){a.onselectstart=function(){return!1};a.style.cursor="default"},pattern:function(a,b,c,e){c=a.node;a=a.fill;var h="none";b.color&&(h=b.color);c.fillColor=h;b=b.url;d.isAbsolute(b)||(b=e+b);8===document.documentMode?(a.type="tile",a.src=b):(a.setAttribute("type","tile"),a.setAttribute("src",b))},update:function(){}})})();(function(){var d=window.AmCharts;d.SVGRenderer=d.Class({construct:function(a){this.D=a;this.animations=[]},create:function(a,b){return document.createElementNS(d.SVG_NS,b)},attr:function(a,b){for(var c in b)b.hasOwnProperty(c)&&this.setAttr(a,c,b[c])},setAttr:function(a,b,c){void 0!==c&&a.node.setAttribute(b,c)},animate:function(a,b,c,e,h){a.animationFinished=!1;var f=a.node;a["an_"+b]&&d.removeFromArray(this.animations,a["an_"+b]);"translate"==b?(f=(f=f.getAttribute("transform"))?String(f).substring(10,f.length-1):"0,0",f=f.split(", ").join(" "),f=f.split(" ").join(","),0===f&&(f="0,0")):f=Number(f.getAttribute(b));c={obj:a,frame:0,attribute:b,from:f,to:c,time:e,effect:h};this.animations.push(c);a["an_"+b]=c},update:function(){var a,b=this.animations;for(a=b.length-1;0<=a;a--){var c=b[a],e=c.time*d.updateRate,h=c.frame+1,f=c.obj,g=c.attribute,k,l,m;h<=e?(c.frame++,"translate"==g?(k=c.from.split(","),g=Number(k[0]),k=Number(k[1]),isNaN(k)&&(k=0),l=c.to.split(","),m=Number(l[0]),l=Number(l[1]),m=0===m-g?m:Math.round(d[c.effect](0,h,g,m-g,e)),c=0===l-k?l:Math.round(d[c.effect](0,h,k,l-k,e)),g="transform",c="translate("+m+","+c+")"):(l=Number(c.from),k=Number(c.to),m=k-l,c=d[c.effect](0,h,l,m,e),isNaN(c)&&(c=k),0===m&&this.animations.splice(a,1)),this.setAttr(f,g,c)):("translate"==g?(l=c.to.split(","),m=Number(l[0]),l=Number(l[1]),f.translate(m,l)):(k=Number(c.to),this.setAttr(f,g,k)),f.animationFinished=!0,this.animations.splice(a,1))}},getBBox:function(a){if(a=a.node)try{return a.getBBox()}catch(b){}return{width:0,height:0,x:0,y:0}},path:function(a,b){a.node.setAttributeNS(d.SVG_XLINK,"xlink:href",b)},clipRect:function(a,b,c,e,h){var f=a.node,g=a.clipPath;g&&this.D.remove(g);var k=f.parentNode;k&&(f=document.createElementNS(d.SVG_NS,"clipPath"),g=d.getUniqueId(),f.setAttribute("id",g),this.D.rect(b,c,e,h,0,0,f),k.appendChild(f),b="#",d.baseHref&&!d.isIE&&(b=this.removeTarget(window.location.href)+b),this.setAttr(a,"clip-path","url("+b+g+")"),this.clipPathC++,a.clipPath=f)},text:function(a,b,c){var e=new d.AmDObject("text",this.D);a=String(a).split("\n");var h=d.removePx(b["font-size"]),f;for(f=0;f<a.length;f++){var g=this.create(null,"tspan");g.appendChild(document.createTextNode(a[f]));g.setAttribute("y",(h+2)*f+Math.round(h/2));g.setAttribute("x",0);e.node.appendChild(g)}e.node.setAttribute("y",Math.round(h/2));this.attr(e,b);this.D.addToContainer(e.node,c);return e},setText:function(a,b){var c=a.node;c&&(c.removeChild(c.firstChild),c.appendChild(document.createTextNode(b)))},move:function(a,b,c,d){isNaN(b)&&(b=0);isNaN(c)&&(c=0);b="translate("+b+","+c+")";d&&(b=b+" scale("+d+")");this.setAttr(a,"transform",b)},rotate:function(a,b){var c=a.node.getAttribute("transform"),d="rotate("+b+")";c&&(d=c+" "+d);this.setAttr(a,"transform",d)},set:function(a){var b=new d.AmDObject("g",this.D);this.D.container.appendChild(b.node);if(a){var c;for(c=0;c<a.length;c++)b.push(a[c])}return b},addListener:function(a,b,c){a.node["on"+b]=c},gradient:function(a,b,c,e){var h=a.node,f=a.grad;f&&this.D.remove(f);b=document.createElementNS(d.SVG_NS,b);f=d.getUniqueId();b.setAttribute("id",f);if(!isNaN(e)){var g=0,k=0,l=0,m=0;90==e?l=100:270==e?m=100:180==e?g=100:0===e&&(k=100);b.setAttribute("x1",g+"%");b.setAttribute("x2",k+"%");b.setAttribute("y1",l+"%");b.setAttribute("y2",m+"%")}for(e=0;e<c.length;e++)g=document.createElementNS(d.SVG_NS,"stop"),k=100*e/(c.length-1),0===e&&(k=0),g.setAttribute("offset",k+"%"),g.setAttribute("stop-color",c[e]),b.appendChild(g);h.parentNode.appendChild(b);c="#";d.baseHref&&!d.isIE&&(c=this.removeTarget(window.location.href)+c);h.setAttribute("fill","url("+c+f+")");a.grad=b},removeTarget:function(a){return a.split("#")[0]},pattern:function(a,b,c,e){var h=a.node;isNaN(c)&&(c=1);var f=a.patternNode;f&&this.D.remove(f);var f=document.createElementNS(d.SVG_NS,"pattern"),g=d.getUniqueId(),k=b;b.url&&(k=b.url);d.isAbsolute(k)||-1!=k.indexOf("data:image")||(k=e+k);e=Number(b.width);isNaN(e)&&(e=4);var l=Number(b.height);isNaN(l)&&(l=4);e/=c;l/=c;c=b.x;isNaN(c)&&(c=0);var m=-Math.random()*Number(b.randomX);isNaN(m)||(c=m);m=b.y;isNaN(m)&&(m=0);var n=-Math.random()*Number(b.randomY);isNaN(n)||(m=n);f.setAttribute("id",g);f.setAttribute("width",e);f.setAttribute("height",l);f.setAttribute("patternUnits","userSpaceOnUse");f.setAttribute("xlink:href",k);b.color&&(n=document.createElementNS(d.SVG_NS,"rect"),n.setAttributeNS(null,"height",e),n.setAttributeNS(null,"width",l),n.setAttributeNS(null,"fill",b.color),f.appendChild(n));this.D.image(k,0,0,e,l,f).translate(c,m);k="#";d.baseHref&&!d.isIE&&(k=this.removeTarget(window.location.href)+k);h.setAttribute("fill","url("+k+g+")");a.patternNode=f;h.parentNode.appendChild(f)},remove:function(a){a.clipPath&&this.D.remove(a.clipPath);a.grad&&this.D.remove(a.grad);a.patternNode&&this.D.remove(a.patternNode);this.D.remove(a.node)}})})();(function(){var d=window.AmCharts;d.AmLegend=d.Class({construct:function(a){this.enabled=!0;this.cname="AmLegend";this.createEvents("rollOverMarker","rollOverItem","rollOutMarker","rollOutItem","showItem","hideItem","clickMarker","rollOverItem","rollOutItem","clickLabel");this.position="bottom";this.borderColor=this.color="#000000";this.borderAlpha=0;this.markerLabelGap=5;this.verticalGap=10;this.align="left";this.horizontalGap=0;this.spacing=10;this.markerDisabledColor="#AAB3B3";this.markerType="square";this.markerSize=16;this.markerBorderThickness=this.markerBorderAlpha=1;this.marginBottom=this.marginTop=0;this.marginLeft=this.marginRight=20;this.autoMargins=!0;this.valueWidth=50;this.switchable=!0;this.switchType="x";this.switchColor="#FFFFFF";this.rollOverColor="#CC0000";this.reversedOrder=!1;this.labelText="[[title]]";this.valueText="[[value]]";this.useMarkerColorForLabels=!1;this.rollOverGraphAlpha=1;this.textClickEnabled=!1;this.equalWidths=!0;this.backgroundColor="#FFFFFF";this.backgroundAlpha=0;this.useGraphSettings=!1;this.showEntries=!0;d.applyTheme(this,a,this.cname)},setData:function(a){this.legendData=a;this.invalidateSize()},invalidateSize:function(){this.destroy();this.entries=[];this.valueLabels=[];var a=this.legendData;this.enabled&&(d.ifArray(a)||d.ifArray(this.data))&&this.drawLegend()},drawLegend:function(){var a=this.chart,b=this.position,c=this.width,e=a.divRealWidth,h=a.divRealHeight,f=this.div,g=this.legendData;this.data&&(g=this.data);isNaN(this.fontSize)&&(this.fontSize=a.fontSize);this.maxColumnsReal=this.maxColumns;if("right"==b||"left"==b)this.maxColumnsReal=1,this.autoMargins&&(this.marginLeft=this.marginRight=10);else if(this.autoMargins){this.marginRight=a.marginRight;this.marginLeft=a.marginLeft;var k=a.autoMarginOffset;"bottom"==b?(this.marginBottom=k,this.marginTop=0):(this.marginTop=k,this.marginBottom=0)}c=void 0!==c?d.toCoordinate(c,e):"right"!=b&&"left"!=b?a.realWidth:0<this.ieW?this.ieW:a.realWidth;"outside"==b?(c=f.offsetWidth,h=f.offsetHeight,f.clientHeight&&(c=f.clientWidth,h=f.clientHeight)):(isNaN(c)||(f.style.width=c+"px"),f.className="amChartsLegend "+a.classNamePrefix+"-legend-div");this.divWidth=c;(b=this.container)?(b.container.innerHTML="",f.appendChild(b.container),b.width=c,b.height=h,b.setSize(c,h),b.addDefs(a)):b=new d.AmDraw(f,c,h,a);this.container=b;this.lx=0;this.ly=8;h=this.markerSize;h>this.fontSize&&(this.ly=h/2-1);0<h&&(this.lx+=h+this.markerLabelGap);this.titleWidth=0;if(h=this.title)h=d.text(this.container,h,this.color,a.fontFamily,this.fontSize,"start",!0),d.setCN(a,h,"legend-title"),h.translate(this.marginLeft,this.marginTop+this.verticalGap+this.ly+1),a=h.getBBox(),this.titleWidth=a.width+15,this.titleHeight=a.height+6;this.index=this.maxLabelWidth=0;if(this.showEntries){for(a=0;a<g.length;a++)this.createEntry(g[a]);for(a=this.index=0;a<g.length;a++)this.createValue(g[a])}this.arrangeEntries();this.updateValues()},arrangeEntries:function(){var a=this.position,b=this.marginLeft+this.titleWidth,c=this.marginRight,e=this.marginTop,h=this.marginBottom,f=this.horizontalGap,g=this.div,k=this.divWidth,l=this.maxColumnsReal,m=this.verticalGap,n=this.spacing,q=k-c-b,p=0,t=0,r=this.container;this.set&&this.set.remove();var u=r.set();this.set=u;var x=r.set();u.push(x);var z=this.entries,v,A;for(A=0;A<z.length;A++){v=z[A].getBBox();var y=v.width;y>p&&(p=y);v=v.height;v>t&&(t=v)}var y=t=0,B=f,D=0,C=0;for(A=0;A<z.length;A++){var J=z[A];this.reversedOrder&&(J=z[z.length-A-1]);v=J.getBBox();var H;this.equalWidths?H=y*(p+n+this.markerLabelGap):(H=B,B=B+v.width+f+n);v.height>C&&(C=v.height);H+v.width>q&&0<A&&0!==y&&(t++,H=y=0,B=H+v.width+f+n,D=D+C+m,C=0);J.translate(H,D);y++;!isNaN(l)&&y>=l&&(y=0,t++,D=D+C+m,B=f,C=0);x.push(J)}v=x.getBBox();l=v.height+2*m-1;"left"==a||"right"==a?(n=v.width+2*f,k=n+b+c,g.style.width=k+"px",this.ieW=k):n=k-b-c-1;c=d.polygon(this.container,[0,n,n,0],[0,0,l,l],this.backgroundColor,this.backgroundAlpha,1,this.borderColor,this.borderAlpha);d.setCN(this.chart,c,"legend-bg");u.push(c);u.translate(b,e);c.toBack();b=f;if("top"==a||"bottom"==a||"absolute"==a||"outside"==a)"center"==this.align?b=f+(n-v.width)/2:"right"==this.align&&(b=f+n-v.width);x.translate(b,m+1);this.titleHeight>l&&(l=this.titleHeight);a=l+e+h+1;0>a&&(a=0);a>this.chart.divRealHeight&&(g.style.top="0px");g.style.height=Math.round(a)+"px";r.setSize(this.divWidth,a)},createEntry:function(a){if(!1!==a.visibleInLegend&&!a.hideFromLegend){var b=this.chart,c=a.markerType;a.legendEntryWidth=this.markerSize;c||(c=this.markerType);var e=a.color,h=a.alpha;a.legendKeyColor&&(e=a.legendKeyColor());a.legendKeyAlpha&&(h=a.legendKeyAlpha());var f;!0===a.hidden&&(f=e=this.markerDisabledColor);var g=a.pattern,k=a.customMarker;k||(k=this.customMarker);var l=this.container,m=this.markerSize,n=0,q=0,p=m/2;if(this.useGraphSettings){c=a.type;this.switchType=void 0;if("line"==c||"step"==c||"smoothedLine"==c||"ohlc"==c)g=l.set(),a.hidden||(e=a.lineColorR,f=a.bulletBorderColorR),n=d.line(l,[0,2*m],[m/2,m/2],e,a.lineAlpha,a.lineThickness,a.dashLength),d.setCN(b,n,"graph-stroke"),g.push(n),a.bullet&&(a.hidden||(e=a.bulletColorR),n=d.bullet(l,a.bullet,a.bulletSize,e,a.bulletAlpha,a.bulletBorderThickness,f,a.bulletBorderAlpha))&&(d.setCN(b,n,"graph-bullet"),n.translate(m+1,m/2),g.push(n)),p=0,n=m,q=m/3;else{var t;a.getGradRotation&&(t=a.getGradRotation(),0===t&&(t=180));n=a.fillColorsR;!0===a.hidden&&(n=e);if(g=this.createMarker("rectangle",n,a.fillAlphas,a.lineThickness,e,a.lineAlpha,t,g,a.dashLength))p=m,g.translate(p,m/2);n=m}d.setCN(b,g,"graph-"+c);d.setCN(b,g,"graph-"+a.id)}else if(k)g=l.image(k,0,0,m,m);else{var r;isNaN(this.gradientRotation)||(r=180+this.gradientRotation);(g=this.createMarker(c,e,h,void 0,void 0,void 0,r,g))&&g.translate(m/2,m/2)}d.setCN(b,g,"legend-marker");this.addListeners(g,a);l=l.set([g]);this.switchable&&a.switchable&&l.setAttr("cursor","pointer");void 0!==a.id&&d.setCN(b,l,"legend-item-"+a.id);d.setCN(b,l,a.className,!0);f=this.switchType;var u;f&&"none"!=f&&0<m&&("x"==f?(u=this.createX(),u.translate(m/2,m/2)):u=this.createV(),u.dItem=a,!0!==a.hidden?"x"==f?u.hide():u.show():"x"!=f&&u.hide(),this.switchable||u.hide(),this.addListeners(u,a),a.legendSwitch=u,l.push(u),d.setCN(b,u,"legend-switch"));f=this.color;a.showBalloon&&this.textClickEnabled&&void 0!==this.selectedColor&&(f=this.selectedColor);this.useMarkerColorForLabels&&(f=e);!0===a.hidden&&(f=this.markerDisabledColor);e=d.massReplace(this.labelText,{"[[title]]":a.title});t=this.fontSize;g&&(m<=t&&(m=m/2+this.ly-t/2+(t+2-m)/2-q,g.translate(p,m),u&&u.translate(u.x,m)),a.legendEntryWidth=g.getBBox().width);var x;e&&(e=d.fixBrakes(e),a.legendTextReal=e,x=this.labelWidth,x=isNaN(x)?d.text(this.container,e,f,b.fontFamily,t,"start"):d.wrappedText(this.container,e,f,b.fontFamily,t,"start",!1,x,0),d.setCN(b,x,"legend-label"),x.translate(this.lx+n,this.ly),l.push(x),b=x.getBBox().width,this.maxLabelWidth<b&&(this.maxLabelWidth=b));this.entries[this.index]=l;a.legendEntry=this.entries[this.index];a.legendMarker=g;a.legendLabel=x;this.index++}},addListeners:function(a,b){var c=this;a&&a.mouseover(function(a){c.rollOverMarker(b,a)}).mouseout(function(a){c.rollOutMarker(b,a)}).click(function(a){c.clickMarker(b,a)})},rollOverMarker:function(a,b){this.switchable&&this.dispatch("rollOverMarker",a,b);this.dispatch("rollOverItem",a,b)},rollOutMarker:function(a,b){this.switchable&&this.dispatch("rollOutMarker",a,b);this.dispatch("rollOutItem",a,b)},clickMarker:function(a,b){this.switchable&&(!0===a.hidden?this.dispatch("showItem",a,b):this.dispatch("hideItem",a,b));this.dispatch("clickMarker",a,b)},rollOverLabel:function(a,b){a.hidden||(this.textClickEnabled&&a.legendLabel&&a.legendLabel.attr({fill:this.rollOverColor}),this.dispatch("rollOverItem",a,b))},rollOutLabel:function(a,b){if(!a.hidden){if(this.textClickEnabled&&a.legendLabel){var c=this.color;void 0!==this.selectedColor&&a.showBalloon&&(c=this.selectedColor);this.useMarkerColorForLabels&&(c=a.lineColor,void 0===c&&(c=a.color));a.legendLabel.attr({fill:c})}this.dispatch("rollOutItem",a,b)}},clickLabel:function(a,b){this.textClickEnabled?a.hidden||this.dispatch("clickLabel",a,b):this.switchable&&(!0===a.hidden?this.dispatch("showItem",a,b):this.dispatch("hideItem",a,b))},dispatch:function(a,b,c){a={type:a,dataItem:b,target:this,event:c,chart:this.chart};this.chart&&this.chart.handleLegendEvent(a);this.fire(a)},createValue:function(a){var b=this,c=b.fontSize,e=b.chart;if(!1!==a.visibleInLegend&&!a.hideFromLegend){var h=b.maxLabelWidth;b.forceWidth&&(h=b.labelWidth);b.equalWidths||(b.valueAlign="left");"left"==b.valueAlign&&(h=a.legendEntry.getBBox().width);var f=h;if(b.valueText&&0<b.valueWidth){var g=b.color;b.useMarkerColorForValues&&(g=a.color,a.legendKeyColor&&(g=a.legendKeyColor()));!0===a.hidden&&(g=b.markerDisabledColor);var k=b.valueText,h=h+b.lx+b.markerLabelGap+b.valueWidth,l="end";"left"==b.valueAlign&&(h-=b.valueWidth,l="start");g=d.text(b.container,k,g,b.chart.fontFamily,c,l);d.setCN(e,g,"legend-value");g.translate(h,b.ly);b.entries[b.index].push(g);f+=b.valueWidth+2*b.markerLabelGap;g.dItem=a;b.valueLabels.push(g)}b.index++;e=b.markerSize;e<c+7&&(e=c+7,d.VML&&(e+=3));c=b.container.rect(a.legendEntryWidth,0,f,e,0,0).attr({stroke:"none",fill:"#fff","fill-opacity":.005});c.dItem=a;b.entries[b.index-1].push(c);c.mouseover(function(c){b.rollOverLabel(a,c)}).mouseout(function(c){b.rollOutLabel(a,c)}).click(function(c){b.clickLabel(a,c)})}},createV:function(){var a=this.markerSize;return d.polygon(this.container,[a/5,a/2,a-a/5,a/2],[a/3,a-a/5,a/5,a/1.7],this.switchColor)},createX:function(){var a=(this.markerSize-4)/2,b={stroke:this.switchColor,"stroke-width":3},c=this.container,e=d.line(c,[-a,a],[-a,a]).attr(b),a=d.line(c,[-a,a],[a,-a]).attr(b);return this.container.set([e,a])},createMarker:function(a,b,c,e,h,f,g,k,l){var m=this.markerSize,n=this.container;h||(h=this.markerBorderColor);h||(h=b);isNaN(e)&&(e=this.markerBorderThickness);isNaN(f)&&(f=this.markerBorderAlpha);return d.bullet(n,a,m,b,c,e,h,f,m,g,k,this.chart.path,l)},validateNow:function(){this.invalidateSize()},updateValues:function(){var a=this.valueLabels,b=this.chart,c,e=this.data;if(a)for(c=0;c<a.length;c++){var h=a[c],f=h.dItem,g=" ";if(e)f.value?h.text(f.value):h.text("");else{var k;if(void 0!==f.type){k=f.currentDataItem;var l=this.periodValueText;f.legendPeriodValueText&&(l=f.legendPeriodValueText);k?(g=this.valueText,f.legendValueText&&(g=f.legendValueText),g=b.formatString(g,k)):l&&b.formatPeriodString&&(l=d.massReplace(l,{"[[title]]":f.title}),g=b.formatPeriodString(l,f))}else g=b.formatString(this.valueText,f);if(l=this.valueFunction){var m=f;k&&(m=k);g=l(m,g)}var n;k?n=b.getBalloonColor(f,k):f.legendKeyColor&&(n=f.legendKeyColor());h.text(g);this.useMarkerColorForValues&&h.setAttr("fill",n);if(this.useMarkerColorForLabels){if(h=f.legendMarker)h.setAttr("fill",n),h.setAttr("stroke",n);(f=f.legendLabel)&&f.setAttr("fill",n)}}}},renderFix:function(){if(!d.VML&&this.enabled){var a=this.container;a&&a.renderFix()}},destroy:function(){this.div.innerHTML="";d.remove(this.set)}})})();(function(){var d=window.AmCharts;d.formatMilliseconds=function(a,b){if(-1!=a.indexOf("fff")){var c=b.getMilliseconds(),d=String(c);10>c&&(d="00"+c);10<=c&&100>c&&(d="0"+c);a=a.replace(/fff/g,d)}return a};d.extractPeriod=function(a){var b=d.stripNumbers(a),c=1;b!=a&&(c=Number(a.slice(0,a.indexOf(b))));return{period:b,count:c}};d.getDate=function(a,b,c){return a instanceof Date?d.newDate(a,c):b&&isNaN(a)?d.stringToDate(a,b):new Date(a)};d.daysInMonth=function(a){return new Date(a.getYear(),a.getMonth()+1,0).getDate()};d.newDate=function(a,b){return b&&-1==b.indexOf("fff")?new Date(a):new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())};d.resetDateToMin=function(a,b,c,e){void 0===e&&(e=1);var h,f,g,k,l,m,n;d.useUTC?(h=a.getUTCFullYear(),f=a.getUTCMonth(),g=a.getUTCDate(),k=a.getUTCHours(),l=a.getUTCMinutes(),m=a.getUTCSeconds(),n=a.getUTCMilliseconds(),a=a.getUTCDay()):(h=a.getFullYear(),f=a.getMonth(),g=a.getDate(),k=a.getHours(),l=a.getMinutes(),m=a.getSeconds(),n=a.getMilliseconds(),a=a.getDay());switch(b){case"YYYY":h=Math.floor(h/c)*c;f=0;g=1;n=m=l=k=0;break;case"MM":f=Math.floor(f/c)*c;g=1;n=m=l=k=0;break;case"WW":g=a>=e?g-a+e:g-(7+a)+e;n=m=l=k=0;break;case"DD":n=m=l=k=0;break;case"hh":k=Math.floor(k/c)*c;n=m=l=0;break;case"mm":l=Math.floor(l/c)*c;n=m=0;break;case"ss":m=Math.floor(m/c)*c;n=0;break;case"fff":n=Math.floor(n/c)*c}d.useUTC?(a=new Date,a.setUTCFullYear(h,f,g),a.setUTCHours(k,l,m,n)):a=new Date(h,f,g,k,l,m,n);return a};d.getPeriodDuration=function(a,b){void 0===b&&(b=1);var c;switch(a){case"YYYY":c=316224e5;break;case"MM":c=26784e5;break;case"WW":c=6048e5;break;case"DD":c=864e5;break;case"hh":c=36e5;break;case"mm":c=6e4;break;case"ss":c=1e3;break;case"fff":c=1}return c*b};d.intervals={s:{nextInterval:"ss",contains:1e3},ss:{nextInterval:"mm",contains:60,count:0},mm:{nextInterval:"hh",contains:60,count:1},hh:{nextInterval:"DD",contains:24,count:2},DD:{nextInterval:"",contains:Infinity,count:3}};d.getMaxInterval=function(a,b){var c=d.intervals;return a>=c[b].contains?(a=Math.round(a/c[b].contains),b=c[b].nextInterval,d.getMaxInterval(a,b)):"ss"==b?c[b].nextInterval:b};d.dayNames="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");d.shortDayNames="Sun Mon Tue Wed Thu Fri Sat".split(" ");d.monthNames="January February March April May June July August September October November December".split(" ");d.shortMonthNames="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");d.getWeekNumber=function(a){a=new Date(a);a.setHours(0,0,0);a.setDate(a.getDate()+4-(a.getDay()||7));var b=new Date(a.getFullYear(),0,1);return Math.ceil(((a-b)/864e5+1)/7)};d.stringToDate=function(a,b){var c={},e=[{pattern:"YYYY",period:"year"},{pattern:"YY",period:"year"},{pattern:"MM",period:"month"},{pattern:"M",period:"month"},{pattern:"DD",period:"date"},{pattern:"D",period:"date"},{pattern:"JJ",period:"hours"},{pattern:"J",period:"hours"},{pattern:"HH",period:"hours"},{pattern:"H",period:"hours"},{pattern:"KK",period:"hours"},{pattern:"K",period:"hours"},{pattern:"LL",period:"hours"},{pattern:"L",period:"hours"},{pattern:"NN",period:"minutes"},{pattern:"N",period:"minutes"},{pattern:"SS",period:"seconds"},{pattern:"S",period:"seconds"},{pattern:"QQQ",period:"milliseconds"},{pattern:"QQ",period:"milliseconds"},{pattern:"Q",period:"milliseconds"}],h=!0,f=b.indexOf("AA");-1!=f&&(a.substr(f,2),"pm"==a.toLowerCase&&(h=!1));var f=b,g,k,l;for(l=0;l<e.length;l++)k=e[l].period,c[k]=0,"date"==k&&(c[k]=1);for(l=0;l<e.length;l++)if(g=e[l].pattern,k=e[l].period,-1!=b.indexOf(g)){var m=d.getFromDateString(g,a,f);b=b.replace(g,"");if("KK"==g||"K"==g||"LL"==g||"L"==g)h||(m+=12);c[k]=m}d.useUTC?(e=new Date,e.setUTCFullYear(c.year,c.month,c.date),e.setUTCHours(c.hours,c.minutes,c.seconds,c.milliseconds)):e=new Date(c.year,c.month,c.date,c.hours,c.minutes,c.seconds,c.milliseconds);return e};d.getFromDateString=function(a,b,c){if(void 0!==b)return c=c.indexOf(a),b=String(b),b=b.substr(c,a.length),"0"==b.charAt(0)&&(b=b.substr(1,b.length-1)),b=Number(b),isNaN(b)&&(b=0),-1!=a.indexOf("M")&&b--,b};d.formatDate=function(a,b,c){c||(c=d);var e,h,f,g,k,l,m,n,q=d.getWeekNumber(a);d.useUTC?(e=a.getUTCFullYear(),h=a.getUTCMonth(),f=a.getUTCDate(),g=a.getUTCDay(),k=a.getUTCHours(),l=a.getUTCMinutes(),m=a.getUTCSeconds(),n=a.getUTCMilliseconds()):(e=a.getFullYear(),h=a.getMonth(),f=a.getDate(),g=a.getDay(),k=a.getHours(),l=a.getMinutes(),m=a.getSeconds(),n=a.getMilliseconds());var p=String(e).substr(2,2),t="0"+g;b=b.replace(/W/g,q);q=k;24==q&&(q=0);var r=q;10>r&&(r="0"+r);b=b.replace(/JJ/g,r);b=b.replace(/J/g,q);r=k;0===r&&(r=24,-1!=b.indexOf("H")&&(f--,0===f&&(e=new Date(a),e.setDate(e.getDate()-1),h=e.getMonth(),f=e.getDate(),e=e.getFullYear())));a=h+1;9>h&&(a="0"+a);q=f;10>f&&(q="0"+f);var u=r;10>u&&(u="0"+u);b=b.replace(/HH/g,u);b=b.replace(/H/g,r);r=k;11<r&&(r-=12);u=r;10>u&&(u="0"+u);b=b.replace(/KK/g,u);b=b.replace(/K/g,r);r=k;0===r&&(r=12);12<r&&(r-=12);u=r;10>u&&(u="0"+u);b=b.replace(/LL/g,u);b=b.replace(/L/g,r);r=l;10>r&&(r="0"+r);b=b.replace(/NN/g,r);b=b.replace(/N/g,l);l=m;10>l&&(l="0"+l);b=b.replace(/SS/g,l);b=b.replace(/S/g,m);m=n;10>m&&(m="00"+m);100>m&&(m="0"+m);l=n;10>l&&(l="00"+l);b=b.replace(/QQQ/g,m);b=b.replace(/QQ/g,l);b=b.replace(/Q/g,n);b=12>k?b.replace(/A/g,c.amString):b.replace(/A/g,c.pmString);b=b.replace(/YYYY/g,"@IIII@");b=b.replace(/YY/g,"@II@");b=b.replace(/MMMM/g,"@XXXX@");b=b.replace(/MMM/g,"@XXX@");b=b.replace(/MM/g,"@XX@");b=b.replace(/M/g,"@X@");b=b.replace(/DD/g,"@RR@");b=b.replace(/D/g,"@R@");b=b.replace(/EEEE/g,"@PPPP@");b=b.replace(/EEE/g,"@PPP@");b=b.replace(/EE/g,"@PP@");b=b.replace(/E/g,"@P@");b=b.replace(/@IIII@/g,e);b=b.replace(/@II@/g,p);b=b.replace(/@XXXX@/g,c.monthNames[h]);b=b.replace(/@XXX@/g,c.shortMonthNames[h]);b=b.replace(/@XX@/g,a);b=b.replace(/@X@/g,h+1);b=b.replace(/@RR@/g,q);b=b.replace(/@R@/g,f);b=b.replace(/@PPPP@/g,c.dayNames[g]);b=b.replace(/@PPP@/g,c.shortDayNames[g]);b=b.replace(/@PP@/g,t);return b=b.replace(/@P@/g,g)};d.changeDate=function(a,b,c,e,h){if(d.useUTC)return d.changeUTCDate(a,b,c,e,h);var f=-1;void 0===e&&(e=!0);void 0===h&&(h=!1);!0===e&&(f=1);switch(b){case"YYYY":a.setFullYear(a.getFullYear()+c*f);e||h||a.setDate(a.getDate()+1);break;case"MM":b=a.getMonth();a.setMonth(a.getMonth()+c*f);a.getMonth()>b+c*f&&a.setDate(a.getDate()-1);e||h||a.setDate(a.getDate()+1);break;case"DD":a.setDate(a.getDate()+c*f);break;case"WW":a.setDate(a.getDate()+c*f*7);break;case"hh":a.setHours(a.getHours()+c*f);break;case"mm":a.setMinutes(a.getMinutes()+c*f);break;case"ss":a.setSeconds(a.getSeconds()+c*f);break;case"fff":a.setMilliseconds(a.getMilliseconds()+c*f)}return a};d.changeUTCDate=function(a,b,c,d,h){var f=-1;void 0===d&&(d=!0);void 0===h&&(h=!1);!0===d&&(f=1);switch(b){case"YYYY":a.setUTCFullYear(a.getUTCFullYear()+c*f);d||h||a.setUTCDate(a.getUTCDate()+1);break;case"MM":b=a.getUTCMonth();a.setUTCMonth(a.getUTCMonth()+c*f);a.getUTCMonth()>b+c*f&&a.setUTCDate(a.getUTCDate()-1);d||h||a.setUTCDate(a.getUTCDate()+1);break;case"DD":a.setUTCDate(a.getUTCDate()+c*f);break;case"WW":a.setUTCDate(a.getUTCDate()+c*f*7);break;case"hh":a.setUTCHours(a.getUTCHours()+c*f);break;case"mm":a.setUTCMinutes(a.getUTCMinutes()+c*f);break;case"ss":a.setUTCSeconds(a.getUTCSeconds()+c*f);break;case"fff":a.setUTCMilliseconds(a.getUTCMilliseconds()+c*f)}return a}})();(function(){var d;window.AmCharts?d=window.AmCharts:(d={},window.AmCharts=d,d.themes={},d.maps={},d.inheriting={},d.charts=[],d.onReadyArray=[],d.useUTC=!1,d.updateRate=60,d.uid=0,d.lang={},d.translations={},d.mapTranslations={},d.windows={},d.initHandlers=[],d.amString="am",d.pmString="pm");d.Class=function(a){var b=function(){arguments[0]!==d.inheriting&&(this.events={},this.construct.apply(this,arguments))};a.inherits?(b.prototype=new a.inherits(d.inheriting),b.base=a.inherits.prototype,delete a.inherits):(b.prototype.createEvents=function(){for(var a=0;a<arguments.length;a++)this.events[arguments[a]]=[]},b.prototype.listenTo=function(a,b,c){this.removeListener(a,b,c);a.events[b].push({handler:c,scope:this})},b.prototype.addListener=function(a,b,c){this.removeListener(this,a,b);a&&this.events[a]&&this.events[a].push({handler:b,scope:c})},b.prototype.removeListener=function(a,b,c){if(a&&a.events&&(a=a.events[b]))for(b=a.length-1;0<=b;b--)a[b].handler===c&&a.splice(b,1)},b.prototype.fire=function(a){for(var b=this.events[a.type],c=0;c<b.length;c++){var d=b[c];d.handler.call(d.scope,a)}});for(var c in a)b.prototype[c]=a[c];return b};d.addChart=function(a){window.requestAnimationFrame?d.animationRequested||(d.animationRequested=!0,window.requestAnimationFrame(d.update)):d.updateInt||(d.updateInt=setInterval(function(){d.update()},Math.round(1e3/d.updateRate)));d.charts.push(a)};d.removeChart=function(a){for(var b=d.charts,c=b.length-1;0<=c;c--)b[c]==a&&b.splice(c,1);0===b.length&&(d.requestAnimation&&(window.cancelAnimationFrame(d.requestAnimation),d.animationRequested=!1),d.updateInt&&(clearInterval(d.updateInt),d.updateInt=NaN))};d.isModern=!0;d.getIEVersion=function(){var a=0,b,c;"Microsoft Internet Explorer"==navigator.appName&&(b=navigator.userAgent,c=/MSIE ([0-9]{1,}[.0-9]{0,})/,null!==c.exec(b)&&(a=parseFloat(RegExp.$1)));return a};d.applyLang=function(a,b){var c=d.translations;b.dayNames=d.extend({},d.dayNames);b.shortDayNames=d.extend({},d.shortDayNames);b.monthNames=d.extend({},d.monthNames);b.shortMonthNames=d.extend({},d.shortMonthNames);b.amString="am";b.pmString="pm";c&&(c=c[a])&&(d.lang=c,b.langObj=c,c.monthNames&&(b.dayNames=d.extend({},c.dayNames),b.shortDayNames=d.extend({},c.shortDayNames),b.monthNames=d.extend({},c.monthNames),b.shortMonthNames=d.extend({},c.shortMonthNames)),c.am&&(b.amString=c.am),c.pm&&(b.pmString=c.pm));d.amString=b.amString;d.pmString=b.pmString};d.IEversion=d.getIEVersion();9>d.IEversion&&0<d.IEversion&&(d.isModern=!1,d.isIE=!0);d.dx=0;d.dy=0;if(document.addEventListener||window.opera)d.isNN=!0,d.isIE=!1,d.dx=.5,d.dy=.5;document.attachEvent&&(d.isNN=!1,d.isIE=!0,d.isModern||(d.dx=0,d.dy=0));window.chrome&&(d.chrome=!0);d.handleMouseUp=function(a){for(var b=d.charts,c=0;c<b.length;c++){var e=b[c];e&&e.handleReleaseOutside&&e.handleReleaseOutside(a)}};d.handleMouseMove=function(a){for(var b=d.charts,c=0;c<b.length;c++){var e=b[c];e&&e.handleMouseMove&&e.handleMouseMove(a)}};d.handleWheel=function(a){for(var b=d.charts,c=0;c<b.length;c++){var e=b[c];if(e&&e.mouseIsOver){(e.mouseWheelScrollEnabled||e.mouseWheelZoomEnabled)&&e.handleWheel&&e.handleWheel(a);break}}};d.resetMouseOver=function(){for(var a=d.charts,b=0;b<a.length;b++){var c=a[b];c&&(c.mouseIsOver=!1)}};d.ready=function(a){d.onReadyArray.push(a)};d.handleLoad=function(){d.isReady=!0;for(var a=d.onReadyArray,b=0;b<a.length;b++){var c=a[b];isNaN(d.processDelay)?c():setTimeout(c,d.processDelay*b)}};d.addInitHandler=function(a,b){d.initHandlers.push({method:a,types:b})};d.callInitHandler=function(a){var b=d.initHandlers;if(d.initHandlers)for(var c=0;c<b.length;c++){var e=b[c];e.types?d.isInArray(e.types,a.type)&&e.method(a):e.method(a)}};d.getUniqueId=function(){d.uid++;return"AmChartsEl-"+d.uid};d.isNN&&(document.addEventListener("mousemove",d.handleMouseMove),document.addEventListener("mouseup",d.handleMouseUp,!0),window.addEventListener("load",d.handleLoad,!0));d.isIE&&(document.attachEvent("onmousemove",d.handleMouseMove),document.attachEvent("onmouseup",d.handleMouseUp),window.attachEvent("onload",d.handleLoad));d.addWheelListeners=function(){d.wheelIsListened||(d.isNN&&(window.addEventListener("DOMMouseScroll",d.handleWheel,!0),document.addEventListener("mousewheel",d.handleWheel,!0)),d.isIE&&document.attachEvent("onmousewheel",d.handleWheel));d.wheelIsListened=!0};d.clear=function(){var a=d.charts;if(a)for(var b=a.length-1;0<=b;b--)a[b].clear();d.updateInt&&clearInterval(d.updateInt);d.requestAnimation&&window.cancelAnimationFrame(d.requestAnimation);d.charts=[];d.isNN&&(document.removeEventListener("mousemove",d.handleMouseMove,!0),document.removeEventListener("mouseup",d.handleMouseUp,!0),window.removeEventListener("load",d.handleLoad,!0),window.removeEventListener("DOMMouseScroll",d.handleWheel,!0),document.removeEventListener("mousewheel",d.handleWheel,!0));d.isIE&&(document.detachEvent("onmousemove",d.handleMouseMove),document.detachEvent("onmouseup",d.handleMouseUp),window.detachEvent("onload",d.handleLoad))};d.makeChart=function(a,b,c){var e=b.type,f=b.theme;d.isString(f)&&(f=d.themes[f],b.theme=f);var g;switch(e){case"serial":g=new d.AmSerialChart(f);break;case"xy":g=new d.AmXYChart(f);break;case"pie":g=new d.AmPieChart(f);break;case"radar":g=new d.AmRadarChart(f);break;case"gauge":g=new d.AmAngularGauge(f);break;case"funnel":g=new d.AmFunnelChart(f);break;case"map":g=new d.AmMap(f);break;case"stock":g=new d.AmStockChart(f);break;case"gantt":g=new d.AmGanttChart(f)}d.extend(g,b);d.isReady?isNaN(c)?g.write(a):setTimeout(function(){d.realWrite(g,a)},c):d.ready(function(){isNaN(c)?g.write(a):setTimeout(function(){d.realWrite(g,a)},c)});return g};d.realWrite=function(a,b){a.write(b)};d.updateCount=0;d.validateAt=Math.round(d.updateRate/10);d.update=function(){var a=d.charts;d.updateCount++;var b=!1;d.updateCount==d.validateAt&&(b=!0,d.updateCount=0);if(a)for(var c=a.length-1;0<=c;c--)a[c].update&&a[c].update(),b&&(a[c].autoResize?a[c].validateSize&&a[c].validateSize():a[c].premeasure&&a[c].premeasure());window.requestAnimationFrame&&(d.requestAnimation=window.requestAnimationFrame(d.update))};"complete"==document.readyState&&d.handleLoad()})();(function(){var d=window.AmCharts;d.toBoolean=function(a,b){if(void 0===a)return b;switch(String(a).toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return!!a}};d.removeFromArray=function(a,b){var c;if(void 0!==b&&void 0!==a)for(c=a.length-1;0<=c;c--)a[c]==b&&a.splice(c,1)};d.getPath=function(){var a=document.getElementsByTagName("script");if(a)for(var b=0;b<a.length;b++){var c=a[b].src;if(-1!==c.search(/\/(amcharts|ammap)\.js/))return c.replace(/\/(amcharts|ammap)\.js.*/,"/")}};d.normalizeUrl=function(a){return""!==a&&-1===a.search(/\/$/)?a+"/":a};d.isAbsolute=function(a){return 0===a.search(/^http[s]?:|^\//)};d.isInArray=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return!0;return!1};d.getDecimals=function(a){var b=0;isNaN(a)||(a=String(a),-1!=a.indexOf("e-")?b=Number(a.split("-")[1]):-1!=a.indexOf(".")&&(b=a.split(".")[1].length));return b};d.wordwrap=function(a,b,c,e){var f,g,h,k;a+="";if(1>b)return a;f=-1;for(a=(k=a.split(/\r\n|\n|\r/)).length;++f<a;k[f]+=h){h=k[f];for(k[f]="";h.length>b;k[f]+=d.trim(h.slice(0,g))+((h=h.slice(g)).length?c:""))g=2==e||(g=h.slice(0,b+1).match(/\S*(\s)?$/))[1]?b:g.input.length-g[0].length||1==e&&b||g.input.length+(g=h.slice(b).match(/^\S*/))[0].length;h=d.trim(h)}return k.join(c)};d.trim=function(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};d.wrappedText=function(a,b,c,e,f,g,h,k){var l=d.text(a,b,c,e,f,g,h);if(l){var m=l.getBBox();if(m.width>k){var n="\n";d.isModern||(n="<br>");k=Math.floor(k/(m.width/b.length));2<k&&(k-=2);b=d.wordwrap(b,k,n,!0);l.remove();l=d.text(a,b,c,e,f,g,h)}}return l};d.getStyle=function(a,b){var c="";if(document.defaultView&&document.defaultView.getComputedStyle)try{c=document.defaultView.getComputedStyle(a,"").getPropertyValue(b)}catch(e){}else a.currentStyle&&(b=b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),c=a.currentStyle[b]);return c};d.removePx=function(a){if(void 0!==a)return Number(a.substring(0,a.length-2))};d.getURL=function(a,b){if(a)if("_self"!=b&&b)if("_top"==b&&window.top)window.top.location.href=a;else if("_parent"==b&&window.parent)window.parent.location.href=a;else if("_blank"==b)window.open(a);else{var c=document.getElementsByName(b)[0];c?c.src=a:(c=d.windows[b])?c.opener&&!c.opener.closed?c.location.href=a:d.windows[b]=window.open(a):d.windows[b]=window.open(a)}else window.location.href=a};d.ifArray=function(a){return a&&"object"==typeof a&&0<a.length?!0:!1};d.callMethod=function(a,b){var c;for(c=0;c<b.length;c++){var e=b[c];if(e){if(e[a])e[a]();var d=e.length;if(0<d){var g;for(g=0;g<d;g++){var h=e[g];if(h&&h[a])h[a]()}}}}};d.toNumber=function(a){return"number"==typeof a?a:Number(String(a).replace(/[^0-9\-.]+/g,""))};d.toColor=function(a){if(""!==a&&void 0!==a)if(-1!=a.indexOf(",")){a=a.split(",");var b;for(b=0;b<a.length;b++){var c=a[b].substring(a[b].length-6,a[b].length);a[b]="#"+c}}else a=a.substring(a.length-6,a.length),a="#"+a;return a};d.toCoordinate=function(a,b,c){var e;void 0!==a&&(a=String(a),c&&c<b&&(b=c),e=Number(a),-1!=a.indexOf("!")&&(e=b-Number(a.substr(1))),-1!=a.indexOf("%")&&(e=b*Number(a.substr(0,a.length-1))/100));return e};d.fitToBounds=function(a,b,c){a<b&&(a=b);a>c&&(a=c);return a};d.isDefined=function(a){return void 0===a?!1:!0};d.stripNumbers=function(a){return a.replace(/[0-9]+/g,"")};d.roundTo=function(a,b){if(0>b)return a;var c=Math.pow(10,b);return Math.round(a*c)/c};d.toFixed=function(a,b){var c=String(Math.round(a*Math.pow(10,b)));if(0<b){var e=c.length;if(e<b){var d;for(d=0;d<b-e;d++)c="0"+c}e=c.substring(0,c.length-b);""===e&&(e=0);return e+"."+c.substring(c.length-b,c.length)}return String(c)};d.formatDuration=function(a,b,c,e,f,g){var h=d.intervals,k=g.decimalSeparator;if(a>=h[b].contains){var l=a-Math.floor(a/h[b].contains)*h[b].contains;"ss"==b?(l=d.formatNumber(l,g),1==l.split(k)[0].length&&(l="0"+l)):l=d.roundTo(l,g.precision);("mm"==b||"hh"==b)&&10>l&&(l="0"+l);c=l+""+e[b]+""+c;a=Math.floor(a/h[b].contains);b=h[b].nextInterval;return d.formatDuration(a,b,c,e,f,g)}"ss"==b&&(a=d.formatNumber(a,g),1==a.split(k)[0].length&&(a="0"+a));("mm"==b||"hh"==b)&&10>a&&(a="0"+a);c=a+""+e[b]+""+c;if(h[f].count>h[b].count)for(a=h[b].count;a<h[f].count;a++)b=h[b].nextInterval,"ss"==b||"mm"==b||"hh"==b?c="00"+e[b]+""+c:"DD"==b&&(c="0"+e[b]+""+c);":"==c.charAt(c.length-1)&&(c=c.substring(0,c.length-1));return c};d.formatNumber=function(a,b,c,e,f){a=d.roundTo(a,b.precision);isNaN(c)&&(c=b.precision);var g=b.decimalSeparator;b=b.thousandsSeparator;var h;h=0>a?"-":"";a=Math.abs(a);var k=String(a),l=!1;-1!=k.indexOf("e")&&(l=!0);0<=c&&!l&&(k=d.toFixed(a,c));var m="";if(l)m=k;else{var k=k.split("."),l=String(k[0]),n;for(n=l.length;0<=n;n-=3)m=n!=l.length?0!==n?l.substring(n-3,n)+b+m:l.substring(n-3,n)+m:l.substring(n-3,n);void 0!==k[1]&&(m=m+g+k[1]);void 0!==c&&0<c&&"0"!=m&&(m=d.addZeroes(m,g,c))}m=h+m;""===h&&!0===e&&0!==a&&(m="+"+m);!0===f&&(m+="%");return m};d.addZeroes=function(a,b,c){a=a.split(b);void 0===a[1]&&0<c&&(a[1]="0");return a[1].length<c?(a[1]+="0",d.addZeroes(a[0]+b+a[1],b,c)):void 0!==a[1]?a[0]+b+a[1]:a[0]};d.scientificToNormal=function(a){var b;a=String(a).split("e");var c;if("-"==a[1].substr(0,1)){b="0.";for(c=0;c<Math.abs(Number(a[1]))-1;c++)b+="0";b+=a[0].split(".").join("")}else{var e=0;b=a[0].split(".");b[1]&&(e=b[1].length);b=a[0].split(".").join("");for(c=0;c<Math.abs(Number(a[1]))-e;c++)b+="0"}return b};d.toScientific=function(a,b){if(0===a)return"0";var c=Math.floor(Math.log(Math.abs(a))*Math.LOG10E),e=String(e).split(".").join(b);return String(e)+"e"+c};d.randomColor=function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).substr(-6)};d.hitTest=function(a,b,c){var e=!1,f=a.x,g=a.x+a.width,h=a.y,k=a.y+a.height,l=d.isInRectangle;e||(e=l(f,h,b));e||(e=l(f,k,b));e||(e=l(g,h,b));e||(e=l(g,k,b));e||!0===c||(e=d.hitTest(b,a,!0));return e};d.isInRectangle=function(a,b,c){return a>=c.x-5&&a<=c.x+c.width+5&&b>=c.y-5&&b<=c.y+c.height+5?!0:!1};d.isPercents=function(a){if(-1!=String(a).indexOf("%"))return!0};d.formatValue=function(a,b,c,e,f,g,h,k){if(b){void 0===f&&(f="");var l;for(l=0;l<c.length;l++){var m=c[l],n=b[m];void 0!==n&&(n=g?d.addPrefix(n,k,h,e):d.formatNumber(n,e),a=a.replace(new RegExp("\\[\\["+f+""+m+"\\]\\]","g"),n))}}return a};d.formatDataContextValue=function(a,b){if(a){var c=a.match(/\[\[.*?\]\]/g),e;for(e=0;e<c.length;e++){var d=c[e],d=d.substr(2,d.length-4);void 0!==b[d]&&(a=a.replace(new RegExp("\\[\\["+d+"\\]\\]","g"),b[d]))}}return a};d.massReplace=function(a,b){for(var c in b)if(b.hasOwnProperty(c)){var e=b[c];void 0===e&&(e="");a=a.replace(c,e)}return a};d.cleanFromEmpty=function(a){return a.replace(/\[\[[^\]]*\]\]/g,"")};d.addPrefix=function(a,b,c,e,f){var g=d.formatNumber(a,e),h="",k,l,m;if(0===a)return"0";0>a&&(h="-");a=Math.abs(a);if(1<a)for(k=b.length-1;-1<k;k--){if(a>=b[k].number&&(l=a/b[k].number,m=Number(e.precision),1>m&&(m=1),c=d.roundTo(l,m),m=d.formatNumber(c,{precision:-1,decimalSeparator:e.decimalSeparator,thousandsSeparator:e.thousandsSeparator}),!f||l==c)){g=h+""+m+""+b[k].prefix;break}}else for(k=0;k<c.length;k++)if(a<=c[k].number){l=a/c[k].number;m=Math.abs(Math.floor(Math.log(l)*Math.LOG10E));l=d.roundTo(l,m);g=h+""+l+""+c[k].prefix;break}return g};d.remove=function(a){a&&a.remove()};d.getEffect=function(a){">"==a&&(a="easeOutSine");"<"==a&&(a="easeInSine");"elastic"==a&&(a="easeOutElastic");return a};d.getObjById=function(a,b){var c,e;for(e=0;e<a.length;e++){var d=a[e];if(d.id==b){c=d;break}}return c};d.applyTheme=function(a,b,c){b||(b=d.theme);try{b=JSON.parse(JSON.stringify(b))}catch(e){}b&&b[c]&&d.extend(a,b[c])};d.isString=function(a){return"string"==typeof a?!0:!1};d.extend=function(a,b,c){var e;a||(a={});for(e in b)c?a.hasOwnProperty(e)||(a[e]=b[e]):a[e]=b[e];return a};d.copyProperties=function(a,b){for(var c in a)a.hasOwnProperty(c)&&"events"!=c&&void 0!==a[c]&&"function"!=typeof a[c]&&"cname"!=c&&(b[c]=a[c])};d.processObject=function(a,b,c,e){if(!1===a instanceof b&&(a=e?d.extend(new b(c),a):d.extend(a,new b(c),!0),a.listeners))for(var f in a.listeners)b=a.listeners[f],a.addListener(b.event,b.method);return a};d.fixNewLines=function(a){var b=RegExp("\\n","g");a&&(a=a.replace(b,"<br />"));return a};d.fixBrakes=function(a){if(d.isModern){var b=RegExp("<br>","g");a&&(a=a.replace(b,"\n"))}else a=d.fixNewLines(a);return a};d.deleteObject=function(a,b){if(a){if(void 0===b||null===b)b=20;if(0!==b)if("[object Array]"===Object.prototype.toString.call(a))for(var c=0;c<a.length;c++)d.deleteObject(a[c],b-1),a[c]=null;else if(a&&!a.tagName)try{for(c in a.theme=null,a)a[c]&&("object"==typeof a[c]&&d.deleteObject(a[c],b-1),"function"!=typeof a[c]&&(a[c]=null))}catch(e){}}};d.bounce=function(a,b,c,e,d){return(b/=d)<1/2.75?7.5625*e*b*b+c:b<2/2.75?e*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?e*(7.5625*(b-=2.25/2.75)*b+.9375)+c:e*(7.5625*(b-=2.625/2.75)*b+.984375)+c};d.easeInOutQuad=function(a,b,c,e,d){b/=d/2;if(1>b)return e/2*b*b+c;b--;return-e/2*(b*(b-2)-1)+c};d.easeInSine=function(a,b,c,e,d){return-e*Math.cos(b/d*(Math.PI/2))+e+c};d.easeOutSine=function(a,b,c,e,d){return e*Math.sin(b/d*(Math.PI/2))+c};d.easeOutElastic=function(a,b,c,e,d){a=1.70158;var g=0,h=e;if(0===b)return c;if(1==(b/=d))return c+e;g||(g=.3*d);h<Math.abs(e)?(h=e,a=g/4):a=g/(2*Math.PI)*Math.asin(e/h);return h*Math.pow(2,-10*b)*Math.sin(2*(b*d-a)*Math.PI/g)+e+c};d.fixStepE=function(a){a=a.toExponential(0).split("e");var b=Number(a[1]);9==Number(a[0])&&b++;return d.generateNumber(1,b)};d.generateNumber=function(a,b){var c="",e;e=0>b?Math.abs(b)-1:Math.abs(b);var d;for(d=0;d<e;d++)c+="0";return 0>b?Number("0."+c+String(a)):Number(String(a)+c)};d.setCN=function(a,b,c,e){if(a.addClassNames&&b&&(b=b.node)&&c){var d=b.getAttribute("class");a=a.classNamePrefix+"-";e&&(a="");d?b.setAttribute("class",d+" "+a+c):b.setAttribute("class",a+c)}};d.removeCN=function(a,b,c){b&&(b=b.node)&&c&&(b=b.classList)&&b.remove(a.classNamePrefix+"-"+c)};d.parseDefs=function(a,b){for(var c in a){var e=typeof a[c];if(0<a[c].length&&"object"==e)for(var f=0;f<a[c].length;f++)e=document.createElementNS(d.SVG_NS,c),b.appendChild(e),d.parseDefs(a[c][f],e);else"object"==e?(e=document.createElementNS(d.SVG_NS,c),b.appendChild(e),d.parseDefs(a[c],e)):b.setAttribute(c,a[c])}}})();(function(){var d=window.AmCharts;d.AmDraw=d.Class({construct:function(a,b,c,e){d.SVG_NS="http://www.w3.org/2000/svg";d.SVG_XLINK="http://www.w3.org/1999/xlink";d.hasSVG=!!document.createElementNS&&!!document.createElementNS(d.SVG_NS,"svg").createSVGRect;1>b&&(b=10);1>c&&(c=10);this.div=a;this.width=b;this.height=c;this.rBin=document.createElement("div");d.hasSVG?(d.SVG=!0,b=this.createSvgElement("svg"),a.appendChild(b),this.container=b,this.addDefs(e),this.R=new d.SVGRenderer(this)):d.isIE&&d.VMLRenderer&&(d.VML=!0,d.vmlStyleSheet||(document.namespaces.add("amvml","urn:schemas-microsoft-com:vml"),31>document.styleSheets.length?(b=document.createStyleSheet(),b.addRule(".amvml","behavior:url(#default#VML); display:inline-block; antialias:true"),d.vmlStyleSheet=b):document.styleSheets[0].addRule(".amvml","behavior:url(#default#VML); display:inline-block; antialias:true")),this.container=a,this.R=new d.VMLRenderer(this,e),this.R.disableSelection(a))},createSvgElement:function(a){return document.createElementNS(d.SVG_NS,a)},circle:function(a,b,c,e){var f=new d.AmDObject("circle",this);f.attr({r:c,cx:a,cy:b});this.addToContainer(f.node,e);return f},ellipse:function(a,b,c,e,f){var g=new d.AmDObject("ellipse",this);g.attr({rx:c,ry:e,cx:a,cy:b});this.addToContainer(g.node,f);return g},setSize:function(a,b){0<a&&0<b&&(this.container.style.width=a+"px",this.container.style.height=b+"px")},rect:function(a,b,c,e,f,g,h){var k=new d.AmDObject("rect",this);d.VML&&(f=Math.round(100*f/Math.min(c,e)),c+=2*g,e+=2*g,k.bw=g,k.node.style.marginLeft=-g,k.node.style.marginTop=-g);1>c&&(c=1);1>e&&(e=1);k.attr({x:a,y:b,width:c,height:e,rx:f,ry:f,"stroke-width":g});this.addToContainer(k.node,h);return k},image:function(a,b,c,e,f,g){var h=new d.AmDObject("image",this);h.attr({x:b,y:c,width:e,height:f});this.R.path(h,a);this.addToContainer(h.node,g);return h},addToContainer:function(a,b){b||(b=this.container);b.appendChild(a)},text:function(a,b,c){return this.R.text(a,b,c)},path:function(a,b,c,e){var f=new d.AmDObject("path",this);e||(e="100,100");f.attr({cs:e});c?f.attr({dd:a}):f.attr({d:a});this.addToContainer(f.node,b);return f},set:function(a){return this.R.set(a)},remove:function(a){if(a){var b=this.rBin;b.appendChild(a);b.innerHTML=""}},renderFix:function(){var a=this.container,b=a.style;b.top="0px";b.left="0px";try{var c=a.getBoundingClientRect(),e=c.left-Math.round(c.left),d=c.top-Math.round(c.top);e&&(b.left=e+"px");d&&(b.top=d+"px")}catch(g){}},update:function(){this.R.update()},addDefs:function(a){if(d.hasSVG){var b=this.createSvgElement("desc"),c=this.container;c.setAttribute("version","1.1");c.style.position="absolute";this.setSize(this.width,this.height);if(a.accessibleTitle){var e=this.createSvgElement("text");c.appendChild(e);e.innerHTML=a.accessibleTitle;e.style.opacity=0}d.rtl&&(c.setAttribute("direction","rtl"),c.style.left="auto",c.style.right="0px");a&&(c.appendChild(b),a.defs&&(b=this.createSvgElement("defs"),c.appendChild(b),d.parseDefs(a.defs,b),this.defs=b))}}})})();(function(){var d=window.AmCharts;d.AmDObject=d.Class({construct:function(a,b){this.D=b;this.R=b.R;this.node=this.R.create(this,a);this.y=this.x=0;this.scale=1},attr:function(a){this.R.attr(this,a);return this},getAttr:function(a){return this.node.getAttribute(a)},setAttr:function(a,b){this.R.setAttr(this,a,b);return this},clipRect:function(a,b,c,e){this.R.clipRect(this,a,b,c,e)},translate:function(a,b,c,e){e||(a=Math.round(a),b=Math.round(b));this.R.move(this,a,b,c);this.x=a;this.y=b;this.scale=c;this.angle&&this.rotate(this.angle)},rotate:function(a,b){this.R.rotate(this,a,b);this.angle=a},animate:function(a,b,c){for(var e in a)if(a.hasOwnProperty(e)){var f=e,g=a[e];c=d.getEffect(c);this.R.animate(this,f,g,b,c)}},push:function(a){if(a){var b=this.node;b.appendChild(a.node);var c=a.clipPath;c&&b.appendChild(c);(a=a.grad)&&b.appendChild(a)}},text:function(a){this.R.setText(this,a)},remove:function(){this.stop();this.R.remove(this)},clear:function(){var a=this.node;if(a.hasChildNodes())for(;1<=a.childNodes.length;)a.removeChild(a.firstChild)},hide:function(){this.setAttr("visibility","hidden")},show:function(){this.setAttr("visibility","visible")},getBBox:function(){return this.R.getBBox(this)},toFront:function(){var a=this.node;if(a){this.prevNextNode=a.nextSibling;var b=a.parentNode;b&&b.appendChild(a)}},toPrevious:function(){var a=this.node;a&&this.prevNextNode&&(a=a.parentNode)&&a.insertBefore(this.prevNextNode,null)},toBack:function(){var a=this.node;if(a){this.prevNextNode=a.nextSibling;var b=a.parentNode;if(b){var c=b.firstChild;c&&b.insertBefore(a,c)}}},mouseover:function(a){this.R.addListener(this,"mouseover",a);return this},mouseout:function(a){this.R.addListener(this,"mouseout",a);return this},click:function(a){this.R.addListener(this,"click",a);return this},dblclick:function(a){this.R.addListener(this,"dblclick",a);return this},mousedown:function(a){this.R.addListener(this,"mousedown",a);return this},mouseup:function(a){this.R.addListener(this,"mouseup",a);return this},touchmove:function(a){this.R.addListener(this,"touchmove",a);return this},touchstart:function(a){this.R.addListener(this,"touchstart",a);return this},touchend:function(a){this.R.addListener(this,"touchend",a);return this},keyup:function(a){this.R.addListener(this,"keyup",a);return this},focus:function(a){this.R.addListener(this,"focus",a);return this},blur:function(a){this.R.addListener(this,"blur",a);return this},contextmenu:function(a){this.node.addEventListener?this.node.addEventListener("contextmenu",a,!0):this.R.addListener(this,"contextmenu",a);return this},stop:function(){d.removeFromArray(this.R.animations,this.an_translate);d.removeFromArray(this.R.animations,this.an_y);d.removeFromArray(this.R.animations,this.an_x)},length:function(){return this.node.childNodes.length},gradient:function(a,b,c){this.R.gradient(this,a,b,c)},pattern:function(a,b,c){a&&this.R.pattern(this,a,b,c)}})})();(function(){var d=window.AmCharts;d.SVGRenderer=d.Class({construct:function(a){this.D=a;this.animations=[]},create:function(a,b){return document.createElementNS(d.SVG_NS,b)},attr:function(a,b){for(var c in b)b.hasOwnProperty(c)&&this.setAttr(a,c,b[c])},setAttr:function(a,b,c){void 0!==c&&a.node.setAttribute(b,c)},animate:function(a,b,c,e,f){a.animationFinished=!1;var g=a.node;a["an_"+b]&&d.removeFromArray(this.animations,a["an_"+b]);"translate"==b?(g=(g=g.getAttribute("transform"))?String(g).substring(10,g.length-1):"0,0",g=g.split(", ").join(" "),g=g.split(" ").join(","),0===g&&(g="0,0")):g=Number(g.getAttribute(b));c={obj:a,frame:0,attribute:b,from:g,to:c,time:e,effect:f};this.animations.push(c);a["an_"+b]=c},update:function(){var a,b=this.animations;for(a=b.length-1;0<=a;a--){var c=b[a],e=c.time*d.updateRate,f=c.frame+1,g=c.obj,h=c.attribute,k,l,m;if(f<=e){c.frame++;if("translate"==h){k=c.from.split(",");h=Number(k[0]);k=Number(k[1]);isNaN(k)&&(k=0);l=c.to.split(",");m=Number(l[0]);l=Number(l[1]);m=0===m-h?m:Math.round(d[c.effect](0,f,h,m-h,e));c=0===l-k?l:Math.round(d[c.effect](0,f,k,l-k,e));h="transform";if(isNaN(m)||isNaN(c))continue;c="translate("+m+","+c+")"}else l=Number(c.from),k=Number(c.to),m=k-l,c=d[c.effect](0,f,l,m,e),isNaN(c)&&(c=k),0===m&&this.animations.splice(a,1);this.setAttr(g,h,c)}else"translate"==h?(l=c.to.split(","),m=Number(l[0]),l=Number(l[1]),g.translate(m,l)):(k=Number(c.to),this.setAttr(g,h,k)),g.animationFinished=!0,this.animations.splice(a,1)}},getBBox:function(a){if(a=a.node)try{return a.getBBox()}catch(b){}return{width:0,height:0,x:0,y:0}},path:function(a,b){a.node.setAttributeNS(d.SVG_XLINK,"xlink:href",b)},clipRect:function(a,b,c,e,f){var g=a.node,h=a.clipPath;h&&this.D.remove(h);var k=g.parentNode;k&&(g=document.createElementNS(d.SVG_NS,"clipPath"),h=d.getUniqueId(),g.setAttribute("id",h),this.D.rect(b,c,e,f,0,0,g),k.appendChild(g),b="#",d.baseHref&&!d.isIE&&(b=this.removeTarget(window.location.href)+b),this.setAttr(a,"clip-path","url("+b+h+")"),this.clipPathC++,a.clipPath=g)},text:function(a,b,c){var e=new d.AmDObject("text",this.D);a=String(a).split("\n");var f=d.removePx(b["font-size"]),g;for(g=0;g<a.length;g++){var h=this.create(null,"tspan");h.appendChild(document.createTextNode(a[g]));h.setAttribute("y",(f+2)*g+Math.round(f/2));h.setAttribute("x",0);e.node.appendChild(h)}e.node.setAttribute("y",Math.round(f/2));this.attr(e,b);this.D.addToContainer(e.node,c);return e},setText:function(a,b){var c=a.node;c&&(c.removeChild(c.firstChild),c.appendChild(document.createTextNode(b)))},move:function(a,b,c,e){isNaN(b)&&(b=0);isNaN(c)&&(c=0);b="translate("+b+","+c+")";e&&(b=b+" scale("+e+")");this.setAttr(a,"transform",b)},rotate:function(a,b){var c=a.node.getAttribute("transform"),e="rotate("+b+")";c&&(e=c+" "+e);this.setAttr(a,"transform",e)},set:function(a){var b=new d.AmDObject("g",this.D);this.D.container.appendChild(b.node);if(a){var c;for(c=0;c<a.length;c++)b.push(a[c])}return b},addListener:function(a,b,c){a.node["on"+b]=c},gradient:function(a,b,c,e){var f=a.node,g=a.grad;g&&this.D.remove(g);b=document.createElementNS(d.SVG_NS,b);g=d.getUniqueId();b.setAttribute("id",g);if(!isNaN(e)){var h=0,k=0,l=0,m=0;90==e?l=100:270==e?m=100:180==e?h=100:0===e&&(k=100);b.setAttribute("x1",h+"%");b.setAttribute("x2",k+"%");b.setAttribute("y1",l+"%");b.setAttribute("y2",m+"%")}for(e=0;e<c.length;e++)h=document.createElementNS(d.SVG_NS,"stop"),k=100*e/(c.length-1),0===e&&(k=0),h.setAttribute("offset",k+"%"),h.setAttribute("stop-color",c[e]),b.appendChild(h);f.parentNode.appendChild(b);c="#";d.baseHref&&!d.isIE&&(c=this.removeTarget(window.location.href)+c);f.setAttribute("fill","url("+c+g+")");a.grad=b},removeTarget:function(a){return a.split("#")[0]},pattern:function(a,b,c,e){var f=a.node;isNaN(c)&&(c=1);var g=a.patternNode;g&&this.D.remove(g);var g=document.createElementNS(d.SVG_NS,"pattern"),h=d.getUniqueId(),k=b;b.url&&(k=b.url);d.isAbsolute(k)||-1!=k.indexOf("data:image")||(k=e+k);e=Number(b.width);isNaN(e)&&(e=4);var l=Number(b.height);isNaN(l)&&(l=4);e/=c;l/=c;c=b.x;isNaN(c)&&(c=0);var m=-Math.random()*Number(b.randomX);isNaN(m)||(c=m);m=b.y;isNaN(m)&&(m=0);var n=-Math.random()*Number(b.randomY);isNaN(n)||(m=n);g.setAttribute("id",h);g.setAttribute("width",e);g.setAttribute("height",l);g.setAttribute("patternUnits","userSpaceOnUse");g.setAttribute("xlink:href",k);b.color&&(n=document.createElementNS(d.SVG_NS,"rect"),n.setAttributeNS(null,"height",e),n.setAttributeNS(null,"width",l),n.setAttributeNS(null,"fill",b.color),g.appendChild(n));this.D.image(k,0,0,e,l,g).translate(c,m);k="#";d.baseHref&&!d.isIE&&(k=this.removeTarget(window.location.href)+k);f.setAttribute("fill","url("+k+h+")");a.patternNode=g;f.parentNode.appendChild(g)},remove:function(a){a.clipPath&&this.D.remove(a.clipPath);a.grad&&this.D.remove(a.grad);a.patternNode&&this.D.remove(a.patternNode);this.D.remove(a.node)}})})();(function(){var d=window.AmCharts;d.AmChart=d.Class({construct:function(a){this.svgIcons=this.tapToActivate=!0;this.theme=a;this.classNamePrefix="amcharts";this.addClassNames=!1;this.version="3.21.1";d.addChart(this);this.createEvents("buildStarted","dataUpdated","init","rendered","drawn","failed","resized","animationFinished");this.height=this.width="100%";this.dataChanged=!0;this.chartCreated=!1;this.previousWidth=this.previousHeight=0;this.backgroundColor="#FFFFFF";this.borderAlpha=this.backgroundAlpha=0;this.color=this.borderColor="#000000";this.fontFamily="Verdana";this.fontSize=11;this.usePrefixes=!1;this.autoResize=!0;this.autoDisplay=!1;this.addCodeCredits=this.accessible=!0;this.touchStartTime=this.touchClickDuration=0;this.precision=-1;this.percentPrecision=2;this.decimalSeparator=".";this.thousandsSeparator=",";this.labels=[];this.allLabels=[];this.titles=[];this.marginRight=this.marginLeft=this.autoMarginOffset=0;this.timeOuts=[];this.creditsPosition="top-left";var b=document.createElement("div"),c=b.style;c.overflow="hidden";c.position="relative";c.textAlign="left";this.chartDiv=b;b=document.createElement("div");c=b.style;c.overflow="hidden";c.position="relative";c.textAlign="left";this.legendDiv=b;this.titleHeight=0;this.hideBalloonTime=150;this.handDrawScatter=2;this.cssScale=this.handDrawThickness=1;this.cssAngle=0;this.prefixesOfBigNumbers=[{number:1e3,prefix:"k"},{number:1e6,prefix:"M"},{number:1e9,prefix:"G"},{number:1e12,prefix:"T"},{number:1e15,prefix:"P"},{number:1e18,prefix:"E"},{number:1e21,prefix:"Z"},{number:1e24,prefix:"Y"}];this.prefixesOfSmallNumbers=[{number:1e-24,prefix:"y"},{number:1e-21,prefix:"z"},{number:1e-18,prefix:"a"},{number:1e-15,prefix:"f"},{number:1e-12,prefix:"p"},{number:1e-9,prefix:"n"},{number:1e-6,prefix:"μ"},{number:.001,prefix:"m"}];this.panEventsEnabled=!0;this.product="amcharts";this.animations=[];this.balloon=new d.AmBalloon(this.theme);this.balloon.chart=this;this.processTimeout=0;this.processCount=1e3;this.animatable=[];this.langObj={};d.applyTheme(this,a,"AmChart")},drawChart:function(){0<this.realWidth&&0<this.realHeight&&(this.drawBackground(),this.redrawLabels(),this.drawTitles(),this.brr(),this.renderFix(),this.chartDiv&&(this.boundingRect=this.chartDiv.getBoundingClientRect()))},makeAccessible:function(a,b,c){this.accessible&&a&&(c&&a.setAttr("role",c),a.setAttr("aria-label",b))},drawBackground:function(){d.remove(this.background);var a=this.container,b=this.backgroundColor,c=this.backgroundAlpha,e=this.set;d.isModern||0!==c||(c=.001);var f=this.updateWidth();this.realWidth=f;var g=this.updateHeight();this.realHeight=g;b=d.polygon(a,[0,f-1,f-1,0],[0,0,g-1,g-1],b,c,1,this.borderColor,this.borderAlpha);d.setCN(this,b,"bg");this.background=b;e.push(b);if(b=this.backgroundImage)a=a.image(b,0,0,f,g),d.setCN(this,b,"bg-image"),this.bgImg=a,e.push(a)},drawTitles:function(a){var b=this.titles;this.titleHeight=0;if(d.ifArray(b)){var c=20,e;for(e=0;e<b.length;e++){var f=b[e],f=d.processObject(f,d.Title,this.theme);if(!1!==f.enabled){var g=f.color;void 0===g&&(g=this.color);var h=f.size;isNaN(h)&&(h=this.fontSize+2);isNaN(f.alpha);var k=this.marginLeft,l=!0;void 0!==f.bold&&(l=f.bold);g=d.wrappedText(this.container,f.text,g,this.fontFamily,h,"middle",l,this.realWidth-35);g.translate(k+(this.realWidth-this.marginRight-k)/2,c);g.node.style.pointerEvents="none";f.sprite=g;void 0!==f.tabIndex&&g.setAttr("tabindex",f.tabIndex);d.setCN(this,g,"title");f.id&&d.setCN(this,g,"title-"+f.id);g.attr({opacity:f.alpha});c+=g.getBBox().height+5;a?g.remove():this.freeLabelsSet.push(g)}}this.titleHeight=c-10}},write:function(a){var b=this;if(b.listeners)for(var c=0;c<b.listeners.length;c++){var e=b.listeners[c];b.addListener(e.event,e.method)}b.fire({type:"buildStarted",chart:b});b.afterWriteTO&&clearTimeout(b.afterWriteTO);0<b.processTimeout?b.afterWriteTO=setTimeout(function(){b.afterWrite.call(b,a)},b.processTimeout):b.afterWrite(a)},afterWrite:function(a){var b;if(b="object"!=typeof a?document.getElementById(a):a){for(;b.firstChild;)b.removeChild(b.firstChild);this.div=b;b.style.overflow="hidden";b.style.textAlign="left";a=this.chartDiv;var c=this.legendDiv,e=this.legend,f=c.style,g=a.style;this.measure();this.previousHeight=this.divRealHeight;this.previousWidth=this.divRealWidth;var h,k=document.createElement("div");h=k.style;h.position="relative";this.containerDiv=k;k.className=this.classNamePrefix+"-main-div";a.className=this.classNamePrefix+"-chart-div";b.appendChild(k);(b=this.exportConfig)&&d.AmExport&&!this.AmExport&&(this.AmExport=new d.AmExport(this,b));this.amExport&&d.AmExport&&(this.AmExport=d.extend(this.amExport,new d.AmExport(this),!0));this.AmExport&&this.AmExport.init&&this.AmExport.init();if(e){e=this.addLegend(e,e.divId);if(e.enabled)switch(f.left=null,f.top=null,f.right=null,g.left=null,g.right=null,g.top=null,f.position="relative",g.position="relative",h.width="100%",h.height="100%",e.position){case"bottom":k.appendChild(a);k.appendChild(c);break;case"top":k.appendChild(c);k.appendChild(a);break;case"absolute":f.position="absolute";g.position="absolute";void 0!==e.left&&(f.left=e.left+"px");void 0!==e.right&&(f.right=e.right+"px");void 0!==e.top&&(f.top=e.top+"px");void 0!==e.bottom&&(f.bottom=e.bottom+"px");e.marginLeft=0;e.marginRight=0;k.appendChild(a);k.appendChild(c);break;case"right":f.position="relative";g.position="absolute";k.appendChild(a);k.appendChild(c);break;case"left":f.position="absolute";g.position="relative";k.appendChild(a);k.appendChild(c);break;case"outside":k.appendChild(a)}else k.appendChild(a);this.prevLegendPosition=e.position}else k.appendChild(a);this.listenersAdded||(this.addListeners(),this.listenersAdded=!0);(this.mouseWheelScrollEnabled||this.mouseWheelZoomEnabled)&&d.addWheelListeners();this.initChart()}},createLabelsSet:function(){d.remove(this.labelsSet);this.labelsSet=this.container.set();this.freeLabelsSet.push(this.labelsSet)},initChart:function(){this.balloon=d.processObject(this.balloon,d.AmBalloon,this.theme);window.AmCharts_path&&(this.path=window.AmCharts_path);void 0===this.path&&(this.path=d.getPath());void 0===this.path&&(this.path="amcharts/");this.path=d.normalizeUrl(this.path);void 0===this.pathToImages&&(this.pathToImages=this.path+"images/");this.initHC||(d.callInitHandler(this),this.initHC=!0);d.applyLang(this.language,this);var a=this.numberFormatter;a&&(isNaN(a.precision)||(this.precision=a.precision),void 0!==a.thousandsSeparator&&(this.thousandsSeparator=a.thousandsSeparator),void 0!==a.decimalSeparator&&(this.decimalSeparator=a.decimalSeparator));(a=this.percentFormatter)&&!isNaN(a.precision)&&(this.percentPrecision=a.precision);this.nf={precision:this.precision,thousandsSeparator:this.thousandsSeparator,decimalSeparator:this.decimalSeparator};this.pf={precision:this.percentPrecision,thousandsSeparator:this.thousandsSeparator,decimalSeparator:this.decimalSeparator};this.destroy();(a=this.container)?(a.container.innerHTML="",a.width=this.realWidth,a.height=this.realHeight,a.addDefs(this),this.chartDiv.appendChild(a.container)):a=new d.AmDraw(this.chartDiv,this.realWidth,this.realHeight,this);this.container=a;this.extension=".png";this.svgIcons&&d.SVG&&(this.extension=".svg");this.checkDisplay();this.checkTransform(this.div);a.chart=this;d.VML||d.SVG?(a.handDrawn=this.handDrawn,a.handDrawScatter=this.handDrawScatter,a.handDrawThickness=this.handDrawThickness,d.remove(this.set),this.set=a.set(),d.remove(this.gridSet),this.gridSet=a.set(),d.remove(this.cursorLineSet),this.cursorLineSet=a.set(),d.remove(this.graphsBehindSet),this.graphsBehindSet=a.set(),d.remove(this.bulletBehindSet),this.bulletBehindSet=a.set(),d.remove(this.columnSet),this.columnSet=a.set(),d.remove(this.graphsSet),this.graphsSet=a.set(),d.remove(this.trendLinesSet),this.trendLinesSet=a.set(),d.remove(this.axesSet),this.axesSet=a.set(),d.remove(this.cursorSet),this.cursorSet=a.set(),d.remove(this.scrollbarsSet),this.scrollbarsSet=a.set(),d.remove(this.bulletSet),this.bulletSet=a.set(),d.remove(this.freeLabelsSet),this.freeLabelsSet=a.set(),d.remove(this.axesLabelsSet),this.axesLabelsSet=a.set(),d.remove(this.balloonsSet),this.balloonsSet=a.set(),d.remove(this.plotBalloonsSet),this.plotBalloonsSet=a.set(),d.remove(this.zoomButtonSet),this.zoomButtonSet=a.set(),d.remove(this.zbSet),this.zbSet=null,d.remove(this.linkSet),this.linkSet=a.set()):this.fire({type:"failed",chart:this})},premeasure:function(){var a=this.div;if(a){try{this.boundingRect=this.chartDiv.getBoundingClientRect()}catch(e){}var b=a.offsetWidth,c=a.offsetHeight;a.clientHeight&&(b=a.clientWidth,c=a.clientHeight);if(b!=this.mw||c!=this.mh)this.mw=b,this.mh=c,this.measure()}},measure:function(){var a=this.div;if(a){var b=this.chartDiv,c=a.offsetWidth,e=a.offsetHeight,f=this.container;a.clientHeight&&(c=a.clientWidth,e=a.clientHeight);var e=Math.round(e),c=Math.round(c),a=Math.round(d.toCoordinate(this.width,c)),g=Math.round(d.toCoordinate(this.height,e));(c!=this.previousWidth||e!=this.previousHeight)&&0<a&&0<g&&(b.style.width=a+"px",b.style.height=g+"px",b.style.padding=0,f&&f.setSize(a,g),this.balloon=d.processObject(this.balloon,d.AmBalloon,this.theme));this.balloon&&this.balloon.setBounds&&this.balloon.setBounds(2,2,a-2,g);this.updateWidth();this.balloon.chart=this;this.realWidth=a;this.realHeight=g;this.divRealWidth=c;this.divRealHeight=e}},checkDisplay:function(){if(this.autoDisplay&&this.container){var a=d.rect(this.container,10,10),b=a.getBBox();0===b.width&&0===b.height&&(this.divRealHeight=this.divRealWidth=this.realHeight=this.realWidth=0,this.previousWidth=this.previousHeight=NaN);a.remove()}},checkTransform:function(a){if(this.autoTransform&&window.getComputedStyle&&a){if(a.style){var b=window.getComputedStyle(a,null);if(b&&(b=b.getPropertyValue("-webkit-transform")||b.getPropertyValue("-moz-transform")||b.getPropertyValue("-ms-transform")||b.getPropertyValue("-o-transform")||b.getPropertyValue("transform"))&&"none"!==b){var c=b.split("(")[1].split(")")[0].split(","),b=c[0],c=c[1],b=Math.sqrt(b*b+c*c);isNaN(b)||(this.cssScale*=b)}}a.parentNode&&this.checkTransform(a.parentNode)}},destroy:function(){this.chartDiv.innerHTML="";this.clearTimeOuts();this.legend&&this.legend.destroy()},clearTimeOuts:function(){var a=this.timeOuts;if(a){var b;for(b=0;b<a.length;b++)clearTimeout(a[b])}this.timeOuts=[]},clear:function(a){try{document.removeEventListener("touchstart",this.docfn1,!0),document.removeEventListener("touchend",this.docfn2,!0)}catch(b){}d.callMethod("clear",[this.chartScrollbar,this.scrollbarV,this.scrollbarH,this.chartCursor]);this.chartCursor=this.scrollbarH=this.scrollbarV=this.chartScrollbar=null;this.clearTimeOuts();this.container&&(this.container.remove(this.chartDiv),this.container.remove(this.legendDiv));a||d.removeChart(this);if(a=this.div)for(;a.firstChild;)a.removeChild(a.firstChild);this.legend&&this.legend.destroy();this.AmExport&&this.AmExport.clear&&this.AmExport.clear()},setMouseCursor:function(a){"auto"==a&&d.isNN&&(a="default");this.chartDiv.style.cursor=a;this.legendDiv.style.cursor=a},redrawLabels:function(){this.labels=[];var a=this.allLabels;this.createLabelsSet();var b;for(b=0;b<a.length;b++)this.drawLabel(a[b])},drawLabel:function(a){var b=this;if(b.container&&!1!==a.enabled){a=d.processObject(a,d.Label,b.theme);var c=a.y,e=a.text,f=a.align,g=a.size,h=a.color,k=a.rotation,l=a.alpha,m=a.bold,n=d.toCoordinate(a.x,b.realWidth),c=d.toCoordinate(c,b.realHeight);n||(n=0);c||(c=0);void 0===h&&(h=b.color);isNaN(g)&&(g=b.fontSize);f||(f="start");"left"==f&&(f="start");"right"==f&&(f="end");"center"==f&&(f="middle",k?c=b.realHeight-c+c/2:n=b.realWidth/2-n);void 0===l&&(l=1);void 0===k&&(k=0);c+=g/2;e=d.text(b.container,e,h,b.fontFamily,g,f,m,l);e.translate(n,c);void 0!==a.tabIndex&&e.setAttr("tabindex",a.tabIndex);d.setCN(b,e,"label");a.id&&d.setCN(b,e,"label-"+a.id);0!==k&&e.rotate(k);a.url?(e.setAttr("cursor","pointer"),e.click(function(){d.getURL(a.url,b.urlTarget)})):e.node.style.pointerEvents="none";b.labelsSet.push(e);b.labels.push(e)}},addLabel:function(a,b,c,e,d,g,h,k,l,m){a={x:a,y:b,text:c,align:e,size:d,color:g,alpha:k,rotation:h,bold:l,url:m,enabled:!0};this.container&&this.drawLabel(a);this.allLabels.push(a)},clearLabels:function(){var a=this.labels,b;for(b=a.length-1;0<=b;b--)a[b].remove();this.labels=[];this.allLabels=[]},updateHeight:function(){var a=this.divRealHeight,b=this.legend;if(b){var c=this.legendDiv.offsetHeight,b=b.position;if("top"==b||"bottom"==b){a-=c;if(0>a||isNaN(a))a=0;this.chartDiv.style.height=a+"px"}}return a},updateWidth:function(){var a=this.divRealWidth,b=this.divRealHeight,c=this.legend;if(c){var e=this.legendDiv,d=e.offsetWidth;isNaN(c.width)||(d=c.width);c.ieW&&(d=c.ieW);var g=e.offsetHeight,e=e.style,h=this.chartDiv.style,k=c.position;if(("right"==k||"left"==k)&&void 0===c.divId){a-=d;if(0>a||isNaN(a))a=0;h.width=a+"px";this.balloon&&this.balloon.setBounds&&this.balloon.setBounds(2,2,a-2,this.realHeight);"left"==k?(h.left=d+"px",e.left="0px"):(h.left="0px",e.left=a+"px");b>g&&(e.top=(b-g)/2+"px")}}return a},getTitleHeight:function(){this.drawTitles(!0);return this.titleHeight},addTitle:function(a,b,c,e,d){isNaN(b)&&(b=this.fontSize+2);a={text:a,size:b,color:c,alpha:e,bold:d,enabled:!0};this.titles.push(a);return a},handleWheel:function(a){var b=0;a||(a=window.event);a.wheelDelta?b=a.wheelDelta/120:a.detail&&(b=-a.detail/3);b&&this.handleWheelReal(b,a.shiftKey);a.preventDefault&&a.preventDefault()},handleWheelReal:function(){},handleDocTouchStart:function(){this.handleMouseMove();this.tmx=this.mouseX;this.tmy=this.mouseY;this.touchStartTime=(new Date).getTime()},handleDocTouchEnd:function(){-.5<this.tmx&&this.tmx<this.divRealWidth+1&&0<this.tmy&&this.tmy<this.divRealHeight?(this.handleMouseMove(),4>Math.abs(this.mouseX-this.tmx)&&4>Math.abs(this.mouseY-this.tmy)?(this.tapped=!0,this.panRequired&&this.panEventsEnabled&&this.chartDiv&&(this.chartDiv.style.msTouchAction="none",this.chartDiv.style.touchAction="none")):this.mouseIsOver||this.resetTouchStyle()):(this.tapped=!1,this.resetTouchStyle())},resetTouchStyle:function(){this.panEventsEnabled&&this.chartDiv&&(this.chartDiv.style.msTouchAction="auto",this.chartDiv.style.touchAction="auto")},checkTouchDuration:function(a){var b=this,c=(new Date).getTime();if(a)if(a.touches)b.isTouchEvent=!0;else if(!b.isTouchEvent)return!0;if(c-b.touchStartTime>b.touchClickDuration)return!0;setTimeout(function(){b.resetTouchDuration()},300)},resetTouchDuration:function(){this.isTouchEvent=!1},checkTouchMoved:function(){if(4<Math.abs(this.mouseX-this.tmx)||4<Math.abs(this.mouseY-this.tmy))return!0},addListeners:function(){var a=this,b=a.chartDiv;document.addEventListener?("ontouchstart"in document.documentElement&&(b.addEventListener("touchstart",function(b){a.handleTouchStart.call(a,b)},!0),b.addEventListener("touchmove",function(b){a.handleMouseMove.call(a,b)},!0),b.addEventListener("touchend",function(b){a.handleTouchEnd.call(a,b)},!0),a.docfn1=function(b){a.handleDocTouchStart.call(a,b)},a.docfn2=function(b){a.handleDocTouchEnd.call(a,b)},document.addEventListener("touchstart",a.docfn1,!0),document.addEventListener("touchend",a.docfn2,!0)),b.addEventListener("mousedown",function(b){a.mouseIsOver=!0;a.handleMouseMove.call(a,b);a.handleMouseDown.call(a,b);a.handleDocTouchStart.call(a,b)},!0),b.addEventListener("mouseover",function(b){a.handleMouseOver.call(a,b)},!0),b.addEventListener("mouseout",function(b){a.handleMouseOut.call(a,b)},!0),b.addEventListener("mouseup",function(b){a.handleDocTouchEnd.call(a,b)},!0)):(b.attachEvent("onmousedown",function(b){a.handleMouseDown.call(a,b)}),b.attachEvent("onmouseover",function(b){a.handleMouseOver.call(a,b)}),b.attachEvent("onmouseout",function(b){a.handleMouseOut.call(a,b)}))},dispDUpd:function(){this.skipEvents||(this.dispatchDataUpdated&&(this.dispatchDataUpdated=!1,this.fire({type:"dataUpdated",chart:this})),this.chartCreated||(this.chartCreated=!0,this.fire({type:"init",chart:this})),this.chartRendered||(this.fire({type:"rendered",chart:this}),this.chartRendered=!0),this.fire({type:"drawn",chart:this}));this.skipEvents=!1},validateSize:function(){var a=this;a.premeasure();a.checkDisplay();a.cssScale=1;a.cssAngle=0;a.checkTransform(a.div);if(a.divRealWidth!=a.previousWidth||a.divRealHeight!=a.previousHeight){var b=a.legend;if(0<a.realWidth&&0<a.realHeight){a.sizeChanged=!0;if(b){a.legendInitTO&&clearTimeout(a.legendInitTO);var c=setTimeout(function(){b.invalidateSize()},10);a.timeOuts.push(c);a.legendInitTO=c}a.marginsUpdated=!1;clearTimeout(a.initTO);c=setTimeout(function(){a.initChart()},10);a.timeOuts.push(c);a.initTO=c}a.renderFix();b&&b.renderFix&&b.renderFix();clearTimeout(a.resizedTO);a.resizedTO=setTimeout(function(){a.fire({type:"resized",chart:a})},10);a.previousHeight=a.divRealHeight;a.previousWidth=a.divRealWidth}},invalidateSize:function(){this.previousHeight=this.previousWidth=NaN;this.invalidateSizeReal()},invalidateSizeReal:function(){var a=this;a.marginsUpdated=!1;clearTimeout(a.validateTO);var b=setTimeout(function(){a.validateSize()},5);a.timeOuts.push(b);a.validateTO=b},validateData:function(a){this.chartCreated&&(this.dataChanged=!0,this.marginsUpdated=!1,this.initChart(a))},validateNow:function(a,b){this.initTO&&clearTimeout(this.initTO);a&&(this.dataChanged=!0,this.marginsUpdated=!1);this.skipEvents=b;this.chartRendered=!1;var c=this.legend;c&&c.position!=this.prevLegendPosition&&(this.previousWidth=this.mw=0,c.invalidateSize&&(c.invalidateSize(),this.validateSize()));this.write(this.div)},showItem:function(a){a.hidden=!1;this.initChart()},hideItem:function(a){a.hidden=!0;this.initChart()},hideBalloon:function(){var a=this;clearTimeout(a.hoverInt);clearTimeout(a.balloonTO);a.hoverInt=setTimeout(function(){a.hideBalloonReal.call(a)},a.hideBalloonTime)},cleanChart:function(){},hideBalloonReal:function(){var a=this.balloon;a&&a.hide&&a.hide()},showBalloon:function(a,b,c,e,d){var g=this;clearTimeout(g.balloonTO);clearTimeout(g.hoverInt);g.balloonTO=setTimeout(function(){g.showBalloonReal.call(g,a,b,c,e,d)},1)},showBalloonReal:function(a,b,c,e,d){this.handleMouseMove();var g=this.balloon;g.enabled&&(g.followCursor(!1),g.changeColor(b),!c||g.fixedPosition?(g.setPosition(e,d),isNaN(e)||isNaN(d)?g.followCursor(!0):g.followCursor(!1)):g.followCursor(!0),a&&g.showBalloon(a))},handleMouseOver:function(){this.outTO&&clearTimeout(this.outTO);d.resetMouseOver();this.mouseIsOver=!0},handleMouseOut:function(){var a=this;d.resetMouseOver();a.outTO&&clearTimeout(a.outTO);a.outTO=setTimeout(function(){a.handleMouseOutReal()},10)},handleMouseOutReal:function(){this.mouseIsOver=!1},handleMouseMove:function(a){a||(a=window.event);this.mouse2Y=this.mouse2X=NaN;var b,c,e,d;if(a){if(a.touches){var g=a.touches.item(1);g&&this.panEventsEnabled&&this.boundingRect&&(e=g.clientX-this.boundingRect.left,d=g.clientY-this.boundingRect.top);a=a.touches.item(0);if(!a)return}else this.wasTouched=!1;this.boundingRect&&a.clientX&&(b=a.clientX-this.boundingRect.left,c=a.clientY-this.boundingRect.top);isNaN(e)?this.mouseX=b:(this.mouseX=Math.min(b,e),this.mouse2X=Math.max(b,e));isNaN(d)?this.mouseY=c:(this.mouseY=Math.min(c,d),this.mouse2Y=Math.max(c,d));this.autoTransform&&(this.mouseX/=this.cssScale,this.mouseY/=this.cssScale)}},handleTouchStart:function(a){this.hideBalloonReal();a&&(a.touches&&this.tapToActivate&&!this.tapped||!this.panRequired)||(this.handleMouseMove(a),this.handleMouseDown(a))},handleTouchEnd:function(a){this.wasTouched=!0;this.handleMouseMove(a);d.resetMouseOver();this.handleReleaseOutside(a)},handleReleaseOutside:function(){this.handleDocTouchEnd.call(this)},handleMouseDown:function(a){d.resetMouseOver();this.mouseIsOver=!0;a&&a.preventDefault&&(this.panEventsEnabled?a.preventDefault():a.touches||a.preventDefault())},addLegend:function(a,b){a=d.processObject(a,d.AmLegend,this.theme);a.divId=b;a.ieW=0;var c;c="object"!=typeof b&&b?document.getElementById(b):b;this.legend=a;a.chart=this;c?(a.div=c,a.position="outside",a.autoMargins=!1):a.div=this.legendDiv;return a},removeLegend:function(){this.legend=void 0;this.previousWidth=0;this.legendDiv.innerHTML=""},handleResize:function(){(d.isPercents(this.width)||d.isPercents(this.height))&&this.invalidateSizeReal();this.renderFix()},renderFix:function(){if(!d.VML){var a=this.container;a&&a.renderFix()}},getSVG:function(){if(d.hasSVG)return this.container},animate:function(a,b,c,e,f,g,h){a["an_"+b]&&d.removeFromArray(this.animations,a["an_"+b]);c={obj:a,frame:0,attribute:b,from:c,to:e,time:f,effect:g,suffix:h};a["an_"+b]=c;this.animations.push(c);return c},setLegendData:function(a){var b=this.legend;b&&b.setData(a)},stopAnim:function(a){d.removeFromArray(this.animations,a)},updateAnimations:function(){var a;this.container&&this.container.update();if(this.animations)for(a=this.animations.length-1;0<=a;a--){var b=this.animations[a],c=d.updateRate*b.time,e=b.frame+1,f=b.obj,g=b.attribute;if(e<=c){b.frame++;var h=Number(b.from),k=Number(b.to)-h,c=d[b.effect](0,e,h,k,c);0===k?(this.animations.splice(a,1),f.node.style[g]=Number(b.to)+b.suffix):f.node.style[g]=c+b.suffix}else f.node.style[g]=Number(b.to)+b.suffix,f.animationFinished=!0,this.animations.splice(a,1)}},update:function(){this.updateAnimations();var a=this.animatable;if(0<a.length){for(var b=!0,c=a.length-1;0<=c;c--){var e=a[c];e&&(e.animationFinished?a.splice(c,1):b=!1)}b&&(this.fire({type:"animationFinished",chart:this}),this.animatable=[])}},inIframe:function(){try{return window.self!==window.top}catch(a){return!0}},brr:function(){if(!this.hideCredits){var a="amcharts.com",b=window.location.hostname.split("."),c;2<=b.length&&(c=b[b.length-2]+"."+b[b.length-1]);this.amLink&&(b=this.amLink.parentNode)&&b.removeChild(this.amLink);b=this.creditsPosition;if(c!=a||!0===this.inIframe()){var a="http://www."+a,e=c=0,d=this.realWidth,g=this.realHeight,h=this.type;if("serial"==h||"xy"==h||"gantt"==h)c=this.marginLeftReal,e=this.marginTopReal,d=c+this.plotAreaWidth,g=e+this.plotAreaHeight;var h=a+"/javascript-charts/",k="JavaScript charts",l="";"ammap"==this.product&&(h=a+"/javascript-maps/",k="Interactive JavaScript maps",l="");a=document.createElement("a");l=document.createTextNode(l);a.setAttribute("href",h);a.setAttribute("title",k);this.urlTarget&&a.setAttribute("target",this.urlTarget);a.appendChild(l);this.chartDiv.appendChild(a);this.amLink=a;h=a.style;h.position="absolute";h.textDecoration="none";h.color=this.color;h.fontFamily=this.fontFamily;h.fontSize="11px";h.opacity=.7;h.display="block";var k=a.offsetWidth,a=a.offsetHeight,l=5+c,m=e+5;"bottom-left"==b&&(l=5+c,m=g-a-3);"bottom-right"==b&&(l=d-k-5,m=g-a-3);"top-right"==b&&(l=d-k-5,m=e+5);h.left=l+"px";h.top=m+"px"}}}});d.Slice=d.Class({construct:function(){}});d.SerialDataItem=d.Class({construct:function(){}});d.GraphDataItem=d.Class({construct:function(){}});d.Guide=d.Class({construct:function(a){this.cname="Guide";d.applyTheme(this,a,this.cname)}});d.Title=d.Class({construct:function(a){this.cname="Title";d.applyTheme(this,a,this.cname)}});d.Label=d.Class({construct:function(a){this.cname="Label";d.applyTheme(this,a,this.cname)}})})();(function(){var d=window.AmCharts;d.AmBalloon=d.Class({construct:function(a){this.cname="AmBalloon";this.enabled=!0;this.fillColor="#FFFFFF";this.fillAlpha=.8;this.borderThickness=2;this.borderColor="#FFFFFF";this.borderAlpha=1;this.cornerRadius=0;this.maxWidth=220;this.horizontalPadding=8;this.verticalPadding=4;this.pointerWidth=6;this.pointerOrientation="V";this.color="#000000";this.adjustBorderColor=!0;this.show=this.follow=this.showBullet=!1;this.bulletSize=3;this.shadowAlpha=.4;this.shadowColor="#000000";this.fadeOutDuration=this.animationDuration=.3;this.fixedPosition=!0;this.offsetY=6;this.offsetX=1;this.textAlign="center";this.disableMouseEvents=!0;this.deltaSignX=this.deltaSignY=1;d.isModern||(this.offsetY*=1.5);this.sdy=this.sdx=0;d.applyTheme(this,a,this.cname)},draw:function(){var a=this.pointToX,b=this.pointToY;d.isModern||(this.drop=!1);var c=this.chart;d.VML&&(this.fadeOutDuration=0);this.xAnim&&c.stopAnim(this.xAnim);this.yAnim&&c.stopAnim(this.yAnim);this.sdy=this.sdx=0;if(!isNaN(a)){var e=this.follow,f=c.container,g=this.set;d.remove(g);this.removeDiv();g=f.set();g.node.style.pointerEvents="none";this.set=g;this.mainSet?(this.mainSet.push(this.set),this.sdx=this.mainSet.x,this.sdy=this.mainSet.y):c.balloonsSet.push(g);if(this.show){var h=this.l,k=this.t,l=this.r,m=this.b,n=this.balloonColor,p=this.fillColor,t=this.borderColor,r=p;void 0!=n&&(this.adjustBorderColor?r=t=n:p=n);var q=this.horizontalPadding,y=this.verticalPadding,B=this.pointerWidth,u=this.pointerOrientation,w=this.cornerRadius,v=c.fontFamily,A=this.fontSize;void 0==A&&(A=c.fontSize);var n=document.createElement("div"),C=c.classNamePrefix;n.className=C+"-balloon-div";this.className&&(n.className=n.className+" "+C+"-balloon-div-"+this.className);C=n.style;this.disableMouseEvents&&(C.pointerEvents="none");C.position="absolute";var x=this.minWidth,z="";isNaN(x)||(z="min-width:"+(x-2*q)+"px; ");n.innerHTML='<div style="text-align:'+this.textAlign+"; "+z+"max-width:"+this.maxWidth+"px; font-size:"+A+"px; color:"+this.color+"; font-family:"+v+'">'+this.text+"</div>";c.chartDiv.appendChild(n);this.textDiv=n;var F=n.offsetWidth,E=n.offsetHeight;n.clientHeight&&(F=n.clientWidth,E=n.clientHeight);v=E+2*y;z=F+2*q;!isNaN(x)&&z<x&&(z=x);window.opera&&(v+=2);var H=!1,A=this.offsetY;c.handDrawn&&(A+=c.handDrawScatter+2);"H"!=u?(x=a-z/2,b<k+v+10&&"down"!=u?(H=!0,e&&(b+=A),A=b+B,this.deltaSignY=-1):(e&&(b-=A),A=b-v-B,this.deltaSignY=1)):(2*B>v&&(B=v/2),A=b-v/2,a<h+(l-h)/2?(x=a+B,this.deltaSignX=-1):(x=a-z-B,this.deltaSignX=1));A+v>=m&&(A=m-v);A<k&&(A=k);x<h&&(x=h);x+z>l&&(x=l-z);var k=A+y,m=x+q,G=this.shadowAlpha,D=this.shadowColor,q=this.borderThickness,K=this.bulletSize,J,y=this.fillAlpha,L=this.borderAlpha;this.showBullet&&(J=d.circle(f,K,r,y),g.push(J));this.drop?(h=z/1.6,l=0,"V"==u&&(u="down"),"H"==u&&(u="left"),"down"==u&&(x=a+1,A=b-h-h/3),"up"==u&&(l=180,x=a+1,A=b+h+h/3),"left"==u&&(l=270,x=a+h+h/3+2,A=b),"right"==u&&(l=90,x=a-h-h/3+2,A=b),k=A-E/2+1,m=x-F/2-1,p=d.drop(f,h,l,p,y,q,t,L)):0<w||0===B?(0<G&&(a=d.rect(f,z,v,p,0,q+1,D,G,w),d.isModern?a.translate(1,1):a.translate(4,4),g.push(a)),p=d.rect(f,z,v,p,y,q,t,L,w)):(r=[],w=[],"H"!=u?(h=a-x,h>z-B&&(h=z-B),h<B&&(h=B),r=[0,h-B,a-x,h+B,z,z,0,0],w=H?[0,0,b-A,0,0,v,v,0]:[v,v,b-A,v,v,0,0,v]):(u=b-A,u>v-B&&(u=v-B),u<B&&(u=B),w=[0,u-B,b-A,u+B,v,v,0,0],r=a<h+(l-h)/2?[0,0,x<a?0:a-x,0,0,z,z,0]:[z,z,x+z>a?z:a-x,z,z,0,0,z]),0<G&&(a=d.polygon(f,r,w,p,0,q,D,G),a.translate(1,1),g.push(a)),p=d.polygon(f,r,w,p,y,q,t,L));this.bg=p;g.push(p);p.toFront();d.setCN(c,p,"balloon-bg");this.className&&d.setCN(c,p,"balloon-bg-"+this.className);f=1*this.deltaSignX;m+=this.sdx;k+=this.sdy;C.left=m+"px";C.top=k+"px";g.translate(x-f,A,1,!0);p=p.getBBox();this.bottom=A+v+1;this.yPos=p.y+A;J&&J.translate(this.pointToX-x+f,b-A);b=this.animationDuration;0<this.animationDuration&&!e&&!isNaN(this.prevX)&&(g.translate(this.prevX,this.prevY,NaN,!0),g.animate({translate:x-f+","+A},b,"easeOutSine"),n&&(C.left=this.prevTX+"px",C.top=this.prevTY+"px",this.xAnim=c.animate({node:n},"left",this.prevTX,m,b,"easeOutSine","px"),this.yAnim=c.animate({node:n},"top",this.prevTY,k,b,"easeOutSine","px")));this.prevX=x-f;this.prevY=A;this.prevTX=m;this.prevTY=k}}},fixPrevious:function(){this.rPrevX=this.prevX;this.rPrevY=this.prevY;this.rPrevTX=this.prevTX;this.rPrevTY=this.prevTY},restorePrevious:function(){this.prevX=this.rPrevX;this.prevY=this.rPrevY;this.prevTX=this.rPrevTX;this.prevTY=this.rPrevTY},followMouse:function(){if(this.follow&&this.show){var a=this.chart.mouseX-this.offsetX*this.deltaSignX-this.sdx,b=this.chart.mouseY-this.sdy;this.pointToX=a;this.pointToY=b;if(a!=this.previousX||b!=this.previousY)if(this.previousX=a,this.previousY=b,0===this.cornerRadius)this.draw();else{var c=this.set;if(c){var e=c.getBBox(),a=a-e.width/2,d=b-e.height-10;a<this.l&&(a=this.l);a>this.r-e.width&&(a=this.r-e.width);d<this.t&&(d=b+10);c.translate(a,d);b=this.textDiv.style;b.left=a+this.horizontalPadding+"px";b.top=d+this.verticalPadding+"px"}}}},changeColor:function(a){this.balloonColor=a},setBounds:function(a,b,c,e){this.l=a;this.t=b;this.r=c;this.b=e;this.destroyTO&&clearTimeout(this.destroyTO)},showBalloon:function(a){if(this.text!=a||this.positionChanged)this.text=a,this.isHiding=!1,this.show=!0,this.destroyTO&&clearTimeout(this.destroyTO),a=this.chart,this.fadeAnim1&&a.stopAnim(this.fadeAnim1),this.fadeAnim2&&a.stopAnim(this.fadeAnim2),this.draw(),this.positionChanged=!1},hide:function(a){var b=this;b.text=void 0;isNaN(a)&&(a=b.fadeOutDuration);var c=b.chart;if(0<a&&!b.isHiding){b.isHiding=!0;b.destroyTO&&clearTimeout(b.destroyTO);b.destroyTO=setTimeout(function(){b.destroy.call(b)},1e3*a);b.follow=!1;b.show=!1;var e=b.set;e&&(e.setAttr("opacity",b.fillAlpha),b.fadeAnim1=e.animate({opacity:0},a,"easeInSine"));b.textDiv&&(b.fadeAnim2=c.animate({node:b.textDiv},"opacity",1,0,a,"easeInSine",""))}else b.show=!1,b.follow=!1,b.destroy()},setPosition:function(a,b){if(a!=this.pointToX||b!=this.pointToY)this.previousX=this.pointToX,this.previousY=this.pointToY,this.pointToX=a,this.pointToY=b,this.positionChanged=!0},followCursor:function(a){var b=this;b.follow=a;clearInterval(b.interval);var c=b.chart.mouseX-b.sdx,e=b.chart.mouseY-b.sdy;!isNaN(c)&&a&&(b.pointToX=c-b.offsetX*b.deltaSignX,b.pointToY=e,b.followMouse(),b.interval=setInterval(function(){b.followMouse.call(b)},40))},removeDiv:function(){if(this.textDiv){var a=this.textDiv.parentNode;a&&a.removeChild(this.textDiv)}},destroy:function(){clearInterval(this.interval);d.remove(this.set);this.removeDiv();this.set=null}})})();(function(){var d=window.AmCharts;d.circle=function(a,b,c,e,f,g,h,k,l){0>=b&&(b=.001);if(void 0==f||0===f)f=.01;void 0===g&&(g="#000000");void 0===h&&(h=0);e={fill:c,stroke:g,"fill-opacity":e,"stroke-width":f,"stroke-opacity":h};a=isNaN(l)?a.circle(0,0,b).attr(e):a.ellipse(0,0,b,l).attr(e);k&&a.gradient("radialGradient",[c,d.adjustLuminosity(c,-.6)]);return a};d.text=function(a,b,c,e,f,g,h,k){g||(g="middle");"right"==g&&(g="end");"left"==g&&(g="start");isNaN(k)&&(k=1);void 0!==b&&(b=String(b),d.isIE&&!d.isModern&&(b=b.replace("&amp;","&"),b=b.replace("&","&amp;")));c={fill:c,"font-family":e,"font-size":f+"px",opacity:k};!0===h&&(c["font-weight"]="bold");c["text-anchor"]=g;return a.text(b,c)};d.polygon=function(a,b,c,e,f,g,h,k,l,m,n){isNaN(g)&&(g=.01);isNaN(k)&&(k=f);var p=e,t=!1;"object"==typeof p&&1<p.length&&(t=!0,p=p[0]);void 0===h&&(h=p);f={fill:p,stroke:h,"fill-opacity":f,"stroke-width":g,"stroke-opacity":k};void 0!==n&&0<n&&(f["stroke-dasharray"]=n);n=d.dx;g=d.dy;a.handDrawn&&(c=d.makeHD(b,c,a.handDrawScatter),b=c[0],c=c[1]);h=Math.round;m&&(b[r]=d.roundTo(b[r],5),c[r]=d.roundTo(c[r],5),h=Number);k="M"+(h(b[0])+n)+","+(h(c[0])+g);for(var r=1;r<b.length;r++)m&&(b[r]=d.roundTo(b[r],5),c[r]=d.roundTo(c[r],5)),k+=" L"+(h(b[r])+n)+","+(h(c[r])+g);a=a.path(k+" Z").attr(f);t&&a.gradient("linearGradient",e,l);return a};d.rect=function(a,b,c,e,f,g,h,k,l,m,n){if(isNaN(b)||isNaN(c))return a.set();isNaN(g)&&(g=0);void 0===l&&(l=0);void 0===m&&(m=270);isNaN(f)&&(f=0);var p=e,t=!1;"object"==typeof p&&(p=p[0],t=!0);void 0===h&&(h=p);void 0===k&&(k=f);b=Math.round(b);c=Math.round(c);var r=0,q=0;0>b&&(b=Math.abs(b),r=-b);0>c&&(c=Math.abs(c),q=-c);r+=d.dx;q+=d.dy;f={fill:p,stroke:h,"fill-opacity":f,"stroke-opacity":k};void 0!==n&&0<n&&(f["stroke-dasharray"]=n);a=a.rect(r,q,b,c,l,g).attr(f);t&&a.gradient("linearGradient",e,m);return a};d.bullet=function(a,b,c,e,f,g,h,k,l,m,n,p,t){var r;"circle"==b&&(b="round");switch(b){case"round":r=d.circle(a,c/2,e,f,g,h,k);break;case"square":r=d.polygon(a,[-c/2,c/2,c/2,-c/2],[c/2,c/2,-c/2,-c/2],e,f,g,h,k,m-180,void 0,t);break;case"rectangle":r=d.polygon(a,[-c,c,c,-c],[c/2,c/2,-c/2,-c/2],e,f,g,h,k,m-180,void 0,t);break;case"diamond":r=d.polygon(a,[-c/2,0,c/2,0],[0,-c/2,0,c/2],e,f,g,h,k);break;case"triangleUp":r=d.triangle(a,c,0,e,f,g,h,k);break;case"triangleDown":r=d.triangle(a,c,180,e,f,g,h,k);break;case"triangleLeft":r=d.triangle(a,c,270,e,f,g,h,k);break;case"triangleRight":r=d.triangle(a,c,90,e,f,g,h,k);break;case"bubble":r=d.circle(a,c/2,e,f,g,h,k,!0);break;case"line":r=d.line(a,[-c/2,c/2],[0,0],e,f,g,h,k);break;case"yError":r=a.set();r.push(d.line(a,[0,0],[-c/2,c/2],e,f,g));r.push(d.line(a,[-l,l],[-c/2,-c/2],e,f,g));r.push(d.line(a,[-l,l],[c/2,c/2],e,f,g));break;case"xError":r=a.set(),r.push(d.line(a,[-c/2,c/2],[0,0],e,f,g)),r.push(d.line(a,[-c/2,-c/2],[-l,l],e,f,g)),r.push(d.line(a,[c/2,c/2],[-l,l],e,f,g))}r&&r.pattern(n,NaN,p);return r};d.triangle=function(a,b,c,e,d,g,h,k){if(void 0===g||0===g)g=1;void 0===h&&(h="#000");void 0===k&&(k=0);e={fill:e,stroke:h,"fill-opacity":d,"stroke-width":g,"stroke-opacity":k};b/=2;var l;0===c&&(l=" M"+-b+","+b+" L0,"+-b+" L"+b+","+b+" Z");180==c&&(l=" M"+-b+","+-b+" L0,"+b+" L"+b+","+-b+" Z");90==c&&(l=" M"+-b+","+-b+" L"+b+",0 L"+-b+","+b+" Z");270==c&&(l=" M"+-b+",0 L"+b+","+b+" L"+b+","+-b+" Z");return a.path(l).attr(e)};d.line=function(a,b,c,e,f,g,h,k,l,m,n){if(a.handDrawn&&!n)return d.handDrawnLine(a,b,c,e,f,g,h,k,l,m,n);g={fill:"none","stroke-width":g};void 0!==h&&0<h&&(g["stroke-dasharray"]=h);isNaN(f)||(g["stroke-opacity"]=f);e&&(g.stroke=e);e=Math.round;m&&(e=Number,b[0]=d.roundTo(b[0],5),c[0]=d.roundTo(c[0],5));m=d.dx;f=d.dy;h="M"+(e(b[0])+m)+","+(e(c[0])+f);for(k=1;k<b.length;k++)b[k]=d.roundTo(b[k],5),c[k]=d.roundTo(c[k],5),h+=" L"+(e(b[k])+m)+","+(e(c[k])+f);if(d.VML)return a.path(h,void 0,!0).attr(g);l&&(h+=" M0,0 L0,0");return a.path(h).attr(g)};d.makeHD=function(a,b,c){for(var e=[],d=[],g=1;g<a.length;g++)for(var h=Number(a[g-1]),k=Number(b[g-1]),l=Number(a[g]),m=Number(b[g]),n=Math.round(Math.sqrt(Math.pow(l-h,2)+Math.pow(m-k,2))/50)+1,l=(l-h)/n,m=(m-k)/n,p=0;p<=n;p++){var t=k+p*m+Math.random()*c;e.push(h+p*l+Math.random()*c);d.push(t)}return[e,d]};d.handDrawnLine=function(a,b,c,e,f,g,h,k,l,m){var n,p=a.set();for(n=1;n<b.length;n++)for(var t=[b[n-1],b[n]],r=[c[n-1],c[n]],r=d.makeHD(t,r,a.handDrawScatter),t=r[0],r=r[1],q=1;q<t.length;q++)p.push(d.line(a,[t[q-1],t[q]],[r[q-1],r[q]],e,f,g+Math.random()*a.handDrawThickness-a.handDrawThickness/2,h,k,l,m,!0));return p};d.doNothing=function(a){return a};d.drop=function(a,b,c,e,d,g,h,k){var l=1/180*Math.PI,m=c-20,n=Math.sin(m*l)*b,p=Math.cos(m*l)*b,t=Math.sin((m+40)*l)*b,r=Math.cos((m+40)*l)*b,q=.8*b,y=-b/3,B=b/3;0===c&&(y=-y,B=0);180==c&&(B=0);90==c&&(y=0);270==c&&(y=0,B=-B);c={fill:e,stroke:h,"stroke-width":g,"stroke-opacity":k,"fill-opacity":d};b="M"+n+","+p+" A"+b+","+b+",0,1,1,"+t+","+r+(" A"+q+","+q+",0,0,0,"+(Math.sin((m+20)*l)*b+B)+","+(Math.cos((m+20)*l)*b+y));b+=" A"+q+","+q+",0,0,0,"+n+","+p;return a.path(b,void 0,void 0,"1000,1000").attr(c)};d.wedge=function(a,b,c,e,f,g,h,k,l,m,n,p,t,r){var q=Math.round;g=q(g);h=q(h);k=q(k);var y=q(h/g*k),B=d.VML,u=359.5+g/100;359.94<u&&(u=359.94);f>=u&&(f=u);var w=1/180*Math.PI,u=b+Math.sin(e*w)*k,v=c-Math.cos(e*w)*y,A=b+Math.sin(e*w)*g,C=c-Math.cos(e*w)*h,x=b+Math.sin((e+f)*w)*g,z=c-Math.cos((e+f)*w)*h,F=b+Math.sin((e+f)*w)*k,w=c-Math.cos((e+f)*w)*y,E={fill:d.adjustLuminosity(m.fill,-.2),"stroke-opacity":0,"fill-opacity":m["fill-opacity"]},H=0;180<Math.abs(f)&&(H=1);e=a.set();var G;B&&(u=q(10*u),A=q(10*A),x=q(10*x),F=q(10*F),v=q(10*v),C=q(10*C),z=q(10*z),w=q(10*w),b=q(10*b),l=q(10*l),c=q(10*c),g*=10,h*=10,k*=10,y*=10,1>Math.abs(f)&&1>=Math.abs(x-A)&&1>=Math.abs(z-C)&&(G=!0));f="";var D;p&&(E["fill-opacity"]=0,E["stroke-opacity"]=m["stroke-opacity"]/2,E.stroke=m.stroke);if(0<l){D=" M"+u+","+(v+l)+" L"+A+","+(C+l);B?(G||(D+=" A"+(b-g)+","+(l+c-h)+","+(b+g)+","+(l+c+h)+","+A+","+(C+l)+","+x+","+(z+l)),D+=" L"+F+","+(w+l),0<k&&(G||(D+=" B"+(b-k)+","+(l+c-y)+","+(b+k)+","+(l+c+y)+","+F+","+(l+w)+","+u+","+(l+v)))):(D+=" A"+g+","+h+",0,"+H+",1,"+x+","+(z+l)+" L"+F+","+(w+l),0<k&&(D+=" A"+k+","+y+",0,"+H+",0,"+u+","+(v+l)));D+=" Z";var K=l;B&&(K/=10);for(var J=0;J<K;J+=10){var L=a.path(D,void 0,void 0,"1000,1000").attr(E);e.push(L);L.translate(0,-J)}D=a.path(" M"+u+","+v+" L"+u+","+(v+l)+" L"+A+","+(C+l)+" L"+A+","+C+" L"+u+","+v+" Z",void 0,void 0,"1000,1000").attr(E);l=a.path(" M"+x+","+z+" L"+x+","+(z+l)+" L"+F+","+(w+l)+" L"+F+","+w+" L"+x+","+z+" Z",void 0,void 0,"1000,1000").attr(E);e.push(D);e.push(l)}B?(G||(f=" A"+q(b-g)+","+q(c-h)+","+q(b+g)+","+q(c+h)+","+q(A)+","+q(C)+","+q(x)+","+q(z)),h=" M"+q(u)+","+q(v)+" L"+q(A)+","+q(C)+f+" L"+q(F)+","+q(w)):h=" M"+u+","+v+" L"+A+","+C+(" A"+g+","+h+",0,"+H+",1,"+x+","+z)+" L"+F+","+w;0<k&&(B?G||(h+=" B"+(b-k)+","+(c-y)+","+(b+k)+","+(c+y)+","+F+","+w+","+u+","+v):h+=" A"+k+","+y+",0,"+H+",0,"+u+","+v);a.handDrawn&&(k=d.line(a,[u,A],[v,C],m.stroke,m.thickness*Math.random()*a.handDrawThickness,m["stroke-opacity"]),e.push(k));a=a.path(h+" Z",void 0,void 0,"1000,1000").attr(m);if(n){k=[];for(y=0;y<n.length;y++)k.push(d.adjustLuminosity(m.fill,n[y]));"radial"!=r||d.isModern||(k=[]);0<k.length&&a.gradient(r+"Gradient",k)}d.isModern&&"radial"==r&&a.grad&&(a.grad.setAttribute("gradientUnits","userSpaceOnUse"),a.grad.setAttribute("r",g),a.grad.setAttribute("cx",b),a.grad.setAttribute("cy",c));a.pattern(p,NaN,t);e.wedge=a;e.push(a);return e};d.rgb2hex=function(a){return(a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):""};d.adjustLuminosity=function(a,b){a&&-1!=a.indexOf("rgb")&&(a=d.rgb2hex(a));a=String(a).replace(/[^0-9a-f]/gi,"");6>a.length&&(a=String(a[0])+String(a[0])+String(a[1])+String(a[1])+String(a[2])+String(a[2]));b=b||0;var c="#",e,f;for(f=0;3>f;f++)e=parseInt(a.substr(2*f,2),16),e=Math.round(Math.min(Math.max(0,e+e*b),255)).toString(16),c+=("00"+e).substr(e.length);return c}})();(function(){var d=window.AmCharts;d.AmLegend=d.Class({construct:function(a){this.enabled=!0;this.cname="AmLegend";this.createEvents("rollOverMarker","rollOverItem","rollOutMarker","rollOutItem","showItem","hideItem","clickMarker","clickLabel");this.position="bottom";this.borderColor=this.color="#000000";this.borderAlpha=0;this.markerLabelGap=5;this.verticalGap=10;this.align="left";this.horizontalGap=0;this.spacing=10;this.markerDisabledColor="#AAB3B3";this.markerType="square";this.markerSize=16;this.markerBorderThickness=this.markerBorderAlpha=1;this.marginBottom=this.marginTop=0;this.marginLeft=this.marginRight=20;this.autoMargins=!0;this.valueWidth=50;this.switchable=!0;this.switchType="x";this.switchColor="#FFFFFF";this.rollOverColor="#CC0000";this.reversedOrder=!1;this.labelText="[[title]]";this.valueText="[[value]]";this.accessibleLabel="[[title]]";this.useMarkerColorForLabels=!1;this.rollOverGraphAlpha=1;this.textClickEnabled=!1;this.equalWidths=!0;this.backgroundColor="#FFFFFF";this.backgroundAlpha=0;this.useGraphSettings=!1;this.showEntries=!0;this.labelDx=0;d.applyTheme(this,a,this.cname)},setData:function(a){this.legendData=a;this.invalidateSize()},invalidateSize:function(){this.destroy();this.entries=[];this.valueLabels=[];var a=this.legendData;this.enabled&&(d.ifArray(a)||d.ifArray(this.data))&&this.drawLegend()},drawLegend:function(){var a=this.chart,b=this.position,c=this.width,e=a.divRealWidth,f=a.divRealHeight,g=this.div,h=this.legendData;this.data&&(h=this.combineLegend?this.legendData.concat(this.data):this.data);isNaN(this.fontSize)&&(this.fontSize=a.fontSize);this.maxColumnsReal=this.maxColumns;if("right"==b||"left"==b)this.maxColumnsReal=1,this.autoMargins&&(this.marginLeft=this.marginRight=10);else if(this.autoMargins){this.marginRight=a.marginRight;this.marginLeft=a.marginLeft;var k=a.autoMarginOffset;"bottom"==b?(this.marginBottom=k,this.marginTop=0):(this.marginTop=k,this.marginBottom=0)}c=void 0!==c?d.toCoordinate(c,e):"right"!=b&&"left"!=b?a.realWidth:0<this.ieW?this.ieW:a.realWidth;"outside"==b?(c=g.offsetWidth,f=g.offsetHeight,g.clientHeight&&(c=g.clientWidth,f=g.clientHeight)):(isNaN(c)||(g.style.width=c+"px"),g.className="amChartsLegend "+a.classNamePrefix+"-legend-div");this.divWidth=c;(b=this.container)?(b.container.innerHTML="",g.appendChild(b.container),b.width=c,b.height=f,b.setSize(c,f),b.addDefs(a)):b=new d.AmDraw(g,c,f,a);this.container=b;this.lx=0;this.ly=8;f=this.markerSize;f>this.fontSize&&(this.ly=f/2-1);0<f&&(this.lx+=f+this.markerLabelGap);this.titleWidth=0;if(f=this.title)f=d.text(this.container,f,this.color,a.fontFamily,this.fontSize,"start",!0),d.setCN(a,f,"legend-title"),f.translate(this.marginLeft,this.marginTop+this.verticalGap+this.ly+1),a=f.getBBox(),this.titleWidth=a.width+15,this.titleHeight=a.height+6;this.index=this.maxLabelWidth=0;if(this.showEntries){for(a=0;a<h.length;a++)this.createEntry(h[a]);for(a=this.index=0;a<h.length;a++)this.createValue(h[a])}this.arrangeEntries();this.updateValues()},arrangeEntries:function(){var a=this.position,b=this.marginLeft+this.titleWidth,c=this.marginRight,e=this.marginTop,f=this.marginBottom,g=this.horizontalGap,h=this.div,k=this.divWidth,l=this.maxColumnsReal,m=this.verticalGap,n=this.spacing,p=k-c-b,t=0,r=0,q=this.container;this.set&&this.set.remove();var y=q.set();this.set=y;var B=q.set();y.push(B);var u=this.entries,w,v;for(v=0;v<u.length;v++){w=u[v].getBBox();var A=w.width;A>t&&(t=A);w=w.height;w>r&&(r=w)}var A=r=0,C=g,x=0,z=0;for(v=0;v<u.length;v++){var F=u[v];this.reversedOrder&&(F=u[u.length-v-1]);w=F.getBBox();var E;this.equalWidths?E=A*(t+n+this.markerLabelGap):(E=C,C=C+w.width+g+n);E+w.width>p&&0<v&&0!==A&&(r++,E=A=0,C=E+w.width+g+n,x=x+z+m,z=0);w.height>z&&(z=w.height);F.translate(E,x);A++;!isNaN(l)&&A>=l&&(A=0,r++,x=x+z+m,C=g,z=0);B.push(F)}w=B.getBBox();l=w.height+2*m-1;"left"==a||"right"==a?(n=w.width+2*g,k=n+b+c,h.style.width=k+"px",this.ieW=k):n=k-b-c-1;c=d.polygon(this.container,[0,n,n,0],[0,0,l,l],this.backgroundColor,this.backgroundAlpha,1,this.borderColor,this.borderAlpha);d.setCN(this.chart,c,"legend-bg");y.push(c);y.translate(b,e);c.toBack();b=g;if("top"==a||"bottom"==a||"absolute"==a||"outside"==a)"center"==this.align?b=g+(n-w.width)/2:"right"==this.align&&(b=g+n-w.width);B.translate(b,m+1);this.titleHeight>l&&(l=this.titleHeight);e=l+e+f+1;0>e&&(e=0);"absolute"!=a&&"outside"!=a&&e>this.chart.divRealHeight&&(h.style.top="0px");h.style.height=Math.round(e)+"px";q.setSize(this.divWidth,e)},createEntry:function(a){if(!1!==a.visibleInLegend&&!a.hideFromLegend){var b=this,c=b.chart,e=b.useGraphSettings,f=a.markerType;f&&(e=!1);a.legendEntryWidth=b.markerSize;f||(f=b.markerType);var g=a.color,h=a.alpha;a.legendKeyColor&&(g=a.legendKeyColor());a.legendKeyAlpha&&(h=a.legendKeyAlpha());var k;!0===a.hidden&&(k=g=b.markerDisabledColor);var l=a.pattern,m,n=a.customMarker;n||(n=b.customMarker);var p=b.container,t=b.markerSize,r=0,q=0,y=t/2;if(e){e=a.type;b.switchType=void 0;if("line"==e||"step"==e||"smoothedLine"==e||"ohlc"==e)m=p.set(),a.hidden||(g=a.lineColorR,k=a.bulletBorderColorR),r=d.line(p,[0,2*t],[t/2,t/2],g,a.lineAlpha,a.lineThickness,a.dashLength),d.setCN(c,r,"graph-stroke"),m.push(r),a.bullet&&(a.hidden||(g=a.bulletColorR),r=d.bullet(p,a.bullet,a.bulletSize,g,a.bulletAlpha,a.bulletBorderThickness,k,a.bulletBorderAlpha))&&(d.setCN(c,r,"graph-bullet"),r.translate(t+1,t/2),m.push(r)),y=0,r=t,q=t/3;else{a.getGradRotation&&(m=a.getGradRotation(),0===m&&(m=180));r=a.fillColorsR;!0===a.hidden&&(r=g);if(m=b.createMarker("rectangle",r,a.fillAlphas,a.lineThickness,g,a.lineAlpha,m,l,a.dashLength))y=t,m.translate(y,t/2);r=t}d.setCN(c,m,"graph-"+e);d.setCN(c,m,"graph-"+a.id)}else if(n)m=p.image(n,0,0,t,t);else{var B;isNaN(b.gradientRotation)||(B=180+b.gradientRotation);(m=b.createMarker(f,g,h,void 0,void 0,void 0,B,l))&&m.translate(t/2,t/2)}d.setCN(c,m,"legend-marker");b.addListeners(m,a);p=p.set([m]);b.switchable&&a.switchable&&p.setAttr("cursor","pointer");void 0!==a.id&&d.setCN(c,p,"legend-item-"+a.id);d.setCN(c,p,a.className,!0);k=b.switchType;var u;k&&"none"!=k&&0<t&&("x"==k?(u=b.createX(),u.translate(t/2,t/2)):u=b.createV(),u.dItem=a,!0!==a.hidden?"x"==k?u.hide():u.show():"x"!=k&&u.hide(),b.switchable||u.hide(),b.addListeners(u,a),a.legendSwitch=u,p.push(u),d.setCN(c,u,"legend-switch"));k=b.color;a.showBalloon&&b.textClickEnabled&&void 0!==b.selectedColor&&(k=b.selectedColor);b.useMarkerColorForLabels&&!l&&(k=g);!0===a.hidden&&(k=b.markerDisabledColor);g=d.massReplace(b.labelText,{"[[title]]":a.title});void 0!==b.tabIndex&&(p.setAttr("tabindex",b.tabIndex),p.setAttr("role","menuitem"),p.keyup(function(c){13==c.keyCode&&b.clickMarker(a,c)}));c.accessible&&b.accessibleLabel&&(l=d.massReplace(b.accessibleLabel,{"[[title]]":a.title}),c.makeAccessible(p,l));l=b.fontSize;m&&(t<=l&&(t=t/2+b.ly-l/2+(l+2-t)/2-q,m.translate(y,t),u&&u.translate(u.x,t)),a.legendEntryWidth=m.getBBox().width);var w;g&&(g=d.fixBrakes(g),a.legendTextReal=g,w=b.labelWidth,w=isNaN(w)?d.text(b.container,g,k,c.fontFamily,l,"start"):d.wrappedText(b.container,g,k,c.fontFamily,l,"start",!1,w,0),d.setCN(c,w,"legend-label"),w.translate(b.lx+r,b.ly),p.push(w),b.labelDx=r,c=w.getBBox().width,b.maxLabelWidth<c&&(b.maxLabelWidth=c));b.entries[b.index]=p;a.legendEntry=b.entries[b.index];a.legendMarker=m;a.legendLabel=w;b.index++}},addListeners:function(a,b){var c=this;a&&a.mouseover(function(a){c.rollOverMarker(b,a)}).mouseout(function(a){c.rollOutMarker(b,a)}).click(function(a){c.clickMarker(b,a)})},rollOverMarker:function(a,b){this.switchable&&this.dispatch("rollOverMarker",a,b);this.dispatch("rollOverItem",a,b)},rollOutMarker:function(a,b){this.switchable&&this.dispatch("rollOutMarker",a,b);this.dispatch("rollOutItem",a,b)},clickMarker:function(a,b){this.switchable&&(!0===a.hidden?this.dispatch("showItem",a,b):this.dispatch("hideItem",a,b));this.dispatch("clickMarker",a,b)},rollOverLabel:function(a,b){a.hidden||this.textClickEnabled&&a.legendLabel&&a.legendLabel.attr({fill:this.rollOverColor});this.dispatch("rollOverItem",a,b)},rollOutLabel:function(a,b){if(!a.hidden&&this.textClickEnabled&&a.legendLabel){var c=this.color;void 0!==this.selectedColor&&a.showBalloon&&(c=this.selectedColor);this.useMarkerColorForLabels&&(c=a.lineColor,void 0===c&&(c=a.color));a.legendLabel.attr({fill:c})}this.dispatch("rollOutItem",a,b)},clickLabel:function(a,b){this.textClickEnabled?a.hidden||this.dispatch("clickLabel",a,b):this.switchable&&(!0===a.hidden?this.dispatch("showItem",a,b):this.dispatch("hideItem",a,b))},dispatch:function(a,b,c){a={type:a,dataItem:b,target:this,event:c,chart:this.chart};this.chart&&this.chart.handleLegendEvent(a);this.fire(a)},createValue:function(a){var b=this,c=b.fontSize,e=b.chart;if(!1!==a.visibleInLegend&&!a.hideFromLegend){var f=b.maxLabelWidth;b.forceWidth&&(f=b.labelWidth);b.equalWidths||(b.valueAlign="left");"left"==b.valueAlign&&a.legendLabel&&(f=a.legendLabel.getBBox().width);var g=f;if(b.valueText&&0<b.valueWidth){var h=b.color;b.useMarkerColorForValues&&(h=a.color,a.legendKeyColor&&(h=a.legendKeyColor()));!0===a.hidden&&(h=b.markerDisabledColor);var k=b.valueText,f=f+b.lx+b.labelDx+b.markerLabelGap+b.valueWidth,l="end";"left"==b.valueAlign&&(f-=b.valueWidth,l="start");h=d.text(b.container,k,h,b.chart.fontFamily,c,l);d.setCN(e,h,"legend-value");h.translate(f,b.ly);b.entries[b.index].push(h);g+=b.valueWidth+2*b.markerLabelGap;h.dItem=a;b.valueLabels.push(h)}b.index++;e=b.markerSize;e<c+7&&(e=c+7,d.VML&&(e+=3));c=b.container.rect(a.legendEntryWidth,0,g,e,0,0).attr({stroke:"none",fill:"#fff","fill-opacity":.005});c.dItem=a;b.entries[b.index-1].push(c);c.mouseover(function(c){b.rollOverLabel(a,c)}).mouseout(function(c){b.rollOutLabel(a,c)}).click(function(c){b.clickLabel(a,c)})}},createV:function(){var a=this.markerSize;return d.polygon(this.container,[a/5,a/2,a-a/5,a/2],[a/3,a-a/5,a/5,a/1.7],this.switchColor)},createX:function(){var a=(this.markerSize-4)/2,b={stroke:this.switchColor,"stroke-width":3},c=this.container,e=d.line(c,[-a,a],[-a,a]).attr(b),a=d.line(c,[-a,a],[a,-a]).attr(b);return this.container.set([e,a])},createMarker:function(a,b,c,e,f,g,h,k,l){var m=this.markerSize,n=this.container;f||(f=this.markerBorderColor);f||(f=b);isNaN(e)&&(e=this.markerBorderThickness);isNaN(g)&&(g=this.markerBorderAlpha);return d.bullet(n,a,m,b,c,e,f,g,m,h,k,this.chart.path,l)},validateNow:function(){this.invalidateSize()},updateValues:function(){var a=this.valueLabels,b=this.chart,c,e=this.data;if(a)for(c=0;c<a.length;c++){var f=a[c],g=f.dItem;g.periodDataItem=void 0;g.periodPercentDataItem=void 0;var h=" ";if(e)g.value?f.text(g.value):f.text("");else{var k=null;if(void 0!==g.type){var k=g.currentDataItem,l=this.periodValueText;g.legendPeriodValueText&&(l=g.legendPeriodValueText);g.legendPeriodValueTextR&&(l=g.legendPeriodValueTextR);k?(h=this.valueText,g.legendValueText&&(h=g.legendValueText),h=b.formatString(h,k)):l&&b.formatPeriodString&&(l=d.massReplace(l,{"[[title]]":g.title}),h=b.formatPeriodString(l,g))}else h=b.formatString(this.valueText,g);l=g;k&&(l=k);var m=this.valueFunction;m&&(h=m(l,h,b.periodDataItem));var n;this.useMarkerColorForLabels&&!k&&g.lastDataItem&&(k=g.lastDataItem);k?n=b.getBalloonColor(g,k):g.legendKeyColor&&(n=g.legendKeyColor());g.legendColorFunction&&(n=g.legendColorFunction(l,h,g.periodDataItem,g.periodPercentDataItem));f.text(h);if(!g.pattern&&(this.useMarkerColorForValues&&f.setAttr("fill",n),this.useMarkerColorForLabels)){if(f=g.legendMarker)f.setAttr("fill",n),f.setAttr("stroke",n);(g=g.legendLabel)&&g.setAttr("fill",n)}}}},renderFix:function(){if(!d.VML&&this.enabled){var a=this.container;a&&a.renderFix()}},destroy:function(){this.div.innerHTML="";d.remove(this.set)}})})();(function(){var d=window.AmCharts;d.AmMap=d.Class({inherits:d.AmChart,construct:function(a){this.cname="AmMap";this.type="map";this.theme=a;this.svgNotSupported="This browser doesn't support SVG. Use Chrome, Firefox, Internet Explorer 9 or later.";this.createEvents("rollOverMapObject","rollOutMapObject","clickMapObject","mouseDownMapObject","selectedObjectChanged","homeButtonClicked","zoomCompleted","dragCompleted","positionChanged","writeDevInfo","click","descriptionClosed");this.zoomDuration=.6;this.zoomControl=new d.ZoomControl(a);this.fitMapToContainer=!0;this.mouseWheelZoomEnabled=this.backgroundZoomsToTop=!1;this.allowClickOnSelectedObject=this.useHandCursorOnClickableOjects=this.showBalloonOnSelectedObject=!0;this.showObjectsAfterZoom=this.wheelBusy=!1;this.zoomOnDoubleClick=this.useObjectColorForBalloon=!0;this.allowMultipleDescriptionWindows=!1;this.dragMap=this.centerMap=this.linesAboveImages=!0;this.colorSteps=5;this.forceNormalize=!1;this.showAreasInList=!0;this.showLinesInList=this.showImagesInList=!1;this.areasProcessor=new d.AreasProcessor(this);this.areasSettings=new d.AreasSettings(a);this.imagesProcessor=new d.ImagesProcessor(this);this.imagesSettings=new d.ImagesSettings(a);this.linesProcessor=new d.LinesProcessor(this);this.linesSettings=new d.LinesSettings(a);this.initialTouchZoom=1;this.showDescriptionOnHover=!1;d.AmMap.base.construct.call(this,a);this.creditsPosition="bottom-left";this.product="ammap";this.areasClasses={};this.updatableImages=[];d.applyTheme(this,a,this.cname)},initChart:function(){this.zoomInstantly=!0;var a=this.container;this.panRequired=!0;if(this.sizeChanged&&d.hasSVG&&this.chartCreated){this.updatableImages=[];this.freeLabelsSet&&this.freeLabelsSet.remove();this.freeLabelsSet=a.set();this.container.setSize(this.realWidth,this.realHeight);this.resizeMap();this.drawBackground();this.redrawLabels();this.drawTitles();this.processObjects(!0);this.rescaleObjects();this.zoomControl.init(this,a);this.drawBg();var b=this.smallMap;b&&b.init(this,a);(b=this.valueLegend)&&b.init(this,a);this.sizeChanged=!1;this.zoomToLongLat(this.zLevelTemp,this.zLongTemp,this.zLatTemp,!0);this.previousWidth=this.realWidth;this.previousHeight=this.realHeight;this.updateSmallMap();this.linkSet.toFront();this.zoomControl.update&&this.zoomControl.update()}else(d.AmMap.base.initChart.call(this),d.hasSVG)?(this.dataChanged&&(this.parseData(),this.dispatchDataUpdated=!0,this.dataChanged=!1,a=this.legend)&&(a.position="absolute",a.invalidateSize()),this.createDescriptionsDiv(),this.svgAreas=[],this.svgAreasById={},this.drawChart()):(this.chartDiv.style.textAlign="",this.chartDiv.setAttribute("class","ammapAlert"),this.chartDiv.innerHTML=this.svgNotSupported,this.fire({type:"failed",chart:this}))},storeTemp:function(){if(d.hasSVG&&0<this.realWidth&&0<this.realHeight){var a=this.mapContainer.getBBox();0<a.width&&0<a.height&&(a=this.zoomLongitude(),isNaN(a)||(this.zLongTemp=a),a=this.zoomLatitude(),isNaN(a)||(this.zLatTemp=a),a=this.zoomLevel(),isNaN(a)||(this.zLevelTemp=a))}},invalidateSize:function(){this.storeTemp();d.AmMap.base.invalidateSize.call(this)},validateSize:function(){this.storeTemp();d.AmMap.base.validateSize.call(this)},handleWheelReal:function(a){if(!this.wheelBusy){this.stopAnimation();var b=this.zoomLevel(),c=this.zoomControl,e=c.zoomFactor;this.wheelBusy=!0;a=d.fitToBounds(0<a?b*e:b/e,c.minZoomLevel,c.maxZoomLevel);e=this.mouseX/this.mapWidth;c=this.mouseY/this.mapHeight;e=(this.zoomX()-e)*(a/b)+e;b=(this.zoomY()-c)*(a/b)+c;this.zoomTo(a,e,b)}},addLegend:function(a,b){a.position="absolute";a.autoMargins=!1;a.valueWidth=0;a.switchable=!1;d.AmMap.base.addLegend.call(this,a,b);void 0===a.enabled&&(a.enabled=!0);return a},handleLegendEvent:function(){},createDescriptionsDiv:function(){if(!this.descriptionsDiv){var a=document.createElement("div"),b=a.style;b.position="absolute";b.left="0px";b.top="0px";this.descriptionsDiv=a}this.containerDiv.appendChild(this.descriptionsDiv)},drawChart:function(){d.AmMap.base.drawChart.call(this);var a=this.dataProvider;this.dataProvider=a=d.extend(a,new d.MapData,!0);this.areasSettings=d.processObject(this.areasSettings,d.AreasSettings,this.theme);this.imagesSettings=d.processObject(this.imagesSettings,d.ImagesSettings,this.theme);this.linesSettings=d.processObject(this.linesSettings,d.LinesSettings,this.theme);var b=this.container;this.mapContainer&&this.mapContainer.remove();this.mapContainer=b.set();this.graphsSet.push(this.mapContainer);var c;a.map&&(c=d.maps[a.map]);a.mapVar&&(c=a.mapVar);c?(this.svgData=c.svg,this.getBounds(),this.buildEverything()):(a=a.mapURL)&&this.loadXml(a);this.balloonsSet.toFront()},drawBg:function(){var a=this;a.background.click(function(){a.handleBackgroundClick()});a.background.mouseover(function(){a.rollOutMapObject(a.previouslyHovered)})},buildEverything:function(){if(0<this.realWidth&&0<this.realHeight){var a=this.container,b=this.dataProvider;this.projection||(this.projection=b.projection,this.projection||(this.projection="equirectangular"));this.updatableImages=[];var c=this.projection;c&&(this.projectionFunction=d[c]);this.projectionFunction||(this.projectionFunction=d.equirectangular);this.dpProjectionFunction=d[b.projection];this.dpProjectionFunction||(this.dpProjectionFunction=d.equirectangular);this.zoomControl=d.processObject(this.zoomControl,d.ZoomControl,this.theme);this.zoomControl.init(this,a);this.drawBg();this.buildSVGMap();this.projectionFunction&&c!=b.projection||this.forceNormalize?(this.normalizeMap(),this.changeProjection()):this.fixMapPosition();if(c=this.smallMap)c=d.processObject(c,d.SmallMap,this.theme),c.init(this,a),this.smallMap=c;isNaN(b.zoomX)&&isNaN(b.zoomY)&&isNaN(b.zoomLatitude)&&isNaN(b.zoomLongitude)&&(this.centerMap?(c=this.xyToCoordinates(this.mapWidth/2,this.mapHeight/2),b.zoomLongitudeC=c.longitude,b.zoomLatitudeC=c.latitude):(b.zoomX=0,b.zoomY=0),this.zoomInstantly=!0);this.selectObject(this.dataProvider);this.processAreas();if(b=this.valueLegend)this.valueLegend=b=d.processObject(b,d.ValueLegend,this.theme),b.init(this,a);this.objectList&&(a=this.objectList=d.processObject(this.objectList,d.ObjectList))&&(this.clearObjectList(),a.init(this));this.dispDUpd();this.updateSmallMap();this.linkSet.toFront()}else this.cleanChart()},hideGroup:function(a){this.showHideGroup(a,!1)},showGroup:function(a){this.showHideGroup(a,!0)},showHideGroup:function(a,b){this.showHideReal(this.imagesProcessor.allObjects,a,b);this.showHideReal(this.areasProcessor.allObjects,a,b);this.showHideReal(this.linesProcessor.allObjects,a,b)},showHideReal:function(a,b,c){var e;for(e=0;e<a.length;e++){var d=a[e];if(d.groupId==b){var g=d.displayObject;g&&(c?(d.hidden=!1,g.show()):(d.hidden=!0,g.hide()))}}},makeObjectAccessible:function(a){if(a.accessibleLabel){var b=this.formatString(a.accessibleLabel,a);a.displayObject&&this.makeAccessible(a.displayObject,b,"menuitem")}},update:function(){if(d.hasSVG){d.AmMap.base.update.call(this);this.zoomControl&&this.zoomControl.update&&this.zoomControl.update();for(var a=0,b=this.updatableImages.length;a<b;a++)this.updatableImages[a].update()}},animateMap:function(){var a=this;a.totalFrames=a.zoomDuration*d.updateRate;a.totalFrames+=1;a.frame=0;a.tweenPercent=0;a.balloon.hide(0);setTimeout(function(){a.updateSize.call(a)},1e3/d.updateRate)},updateSize:function(){var a=this,b=a.totalFrames;a.preventHover=!0;a.frame<=b?(a.frame++,b=d.easeOutSine(0,a.frame,0,1,b),1<=b?(b=1,a.preventHover=!1,a.wheelBusy=!1):window.requestAnimationFrame?window.requestAnimationFrame(function(){a.updateSize.call(a)}):setTimeout(function(){a.updateSize.call(a)},1e3/d.updateRate),.8<b&&(a.preventHover=!1)):(b=1,a.preventHover=!1,a.wheelBusy=!1);a.tweenPercent=b;a.rescaleMapAndObjects()},rescaleMapAndObjects:function(){var a=this.initialScale,b=this.initialX,c=this.initialY,e=this.tweenPercent,a=a+(this.finalScale-a)*e;this.mapContainer.translate(b+(this.finalX-b)*e,c+(this.finalY-c)*e,a,!0);if(this.areasSettings.adjustOutlineThickness){for(var b=this.svgAreas,d=0;d<b.length;d++)(c=b[d])&&c.setAttr("stroke-width",this.areasSettings.outlineThickness/a/this.mapScale);if(b=this.dataProvider.areas)for(d=0;d<b.length;d++){var c=b[d],g=c.displayObject;g&&g.setAttr("stroke-width",c.outlineThicknessReal/a/this.mapScale)}}this.rescaleObjects();this.positionChanged();this.updateSmallMap();1==e&&this.fire({type:"zoomCompleted",chart:this})},updateSmallMap:function(){this.smallMap&&this.smallMap.update()},rescaleObjects:function(){var a=this.mapContainer.scale,b=this.imagesProcessor.objectsToResize,c;for(c=0;c<b.length;c++){var d=b[c].image,f=b[c].scale,g=b[c].mapImage;isNaN(g.selectedScaleReal)||g!=this.selectedObject||(g.tempScale=f,f*=g.selectedScaleReal);d.translate(d.x,d.y,f/a,!0)}b=this.imagesProcessor.labelsToReposition;for(c=0;c<b.length;c++)d=b[c],d.imageLabel&&this.imagesProcessor.positionLabel(d.imageLabel,d,d.labelPositionReal);b=this.linesProcessor;if(d=b.linesToResize)for(c=0;c<d.length;c++)f=d[c],f.line.setAttr("stroke-width",f.thickness/a);b=b.objectsToResize;for(c=0;c<b.length;c++)d=b[c],d.translate(d.x,d.y,1/a,!0)},handleTouchEnd:function(a){this.initialDistance=NaN;this.mouseIsDown=this.isDragging=!1;d.AmMap.base.handleTouchEnd.call(this,a)},handleMouseDown:function(a){d.resetMouseOver();this.mouseIsDown=this.mouseIsOver=!0;this.balloon.hide(0);a&&this.mouseIsOver&&a.preventDefault&&this.panEventsEnabled&&a.preventDefault();if(this.chartCreated&&!this.preventHover&&(this.initialTouchZoom=this.zoomLevel(),this.dragMap&&(this.stopAnimation(),this.mapContainerClickX=this.mapContainer.x,this.mapContainerClickY=this.mapContainer.y),a||(a=window.event),a.shiftKey&&!0===this.developerMode&&this.getDevInfo(),a&&a.touches)){var b=this.mouseX,c=this.mouseY,e=a.touches.item(1);e&&this.panEventsEnabled&&this.boundingRect&&(a=e.clientX-this.boundingRect.left,e=e.clientY-this.boundingRect.top,this.middleXP=(b+(a-b)/2)/this.realWidth,this.middleYP=(c+(e-c)/2)/this.realHeight,this.initialDistance=Math.sqrt(Math.pow(a-b,2)+Math.pow(e-c,2)))}},stopDrag:function(){this.isDragging=!1},handleReleaseOutside:function(){if(d.isModern){var a=this;d.AmMap.base.handleReleaseOutside.call(a);a.mouseIsDown=!1;setTimeout(function(){a.resetPinch.call(a)},100);if(!a.preventHover){a.stopDrag();var b=a.zoomControl;b&&b.draggerUp&&b.draggerUp();a.mapWasDragged=!1;var b=a.mapContainer,c=a.mapContainerClickX,e=a.mapContainerClickY;isNaN(c)||isNaN(e)||!(3<Math.abs(b.x-c)||3<Math.abs(b.y-e))||(a.mapWasDragged=!0,b={type:"dragCompleted",zoomX:a.zoomX(),zoomY:a.zoomY(),zoomLevel:a.zoomLevel(),chart:a},a.fire(b));(a.mouseIsOver&&!a.mapWasDragged&&!a.skipClick||a.wasTouched&&3>Math.abs(a.mouseX-a.tmx)&&3>Math.abs(a.mouseY-a.tmy))&&a.fire({type:"click",x:a.mouseX,y:a.mouseY,chart:a});a.mapContainerClickX=NaN;a.mapContainerClickY=NaN;a.objectWasClicked=!1;a.zoomOnDoubleClick&&a.mouseIsOver&&(b=(new Date).getTime(),200>b-a.previousClickTime&&40<b-a.previousClickTime&&a.doDoubleClickZoom(),a.previousClickTime=b)}a.wasTouched=!1}},resetPinch:function(){this.mapWasPinched=!1},handleMouseMove:function(a){var b=this;d.AmMap.base.handleMouseMove.call(b,a);if(!a||!a.touches||!b.tapToActivate||b.tapped){b.panEventsEnabled&&b.mouseIsOver&&a&&a.preventDefault&&a.preventDefault();var c=b.previuosMouseX,e=b.previuosMouseY,f=b.mouseX,g=b.mouseY,h=b.zoomControl;isNaN(c)&&(c=f);isNaN(e)&&(e=g);b.mouse2X=NaN;b.mouse2Y=NaN;a&&a.touches&&(a=a.touches.item(1))&&b.panEventsEnabled&&b.boundingRect&&(b.mouse2X=a.clientX-b.boundingRect.left,b.mouse2Y=a.clientY-b.boundingRect.top);if(a=b.mapContainer){var k=b.mouse2X,l=b.mouse2Y;b.pinchTO&&clearTimeout(b.pinchTO);b.pinchTO=setTimeout(function(){b.resetPinch.call(b)},1e3);var m=b.realHeight,n=b.realWidth,p=b.mapWidth,t=b.mapHeight;b.mouseIsDown&&b.dragMap&&(3<Math.abs(b.previuosMouseX-b.mouseX)||3<Math.abs(b.previuosMouseY-b.mouseY))&&(b.isDragging=!0);if(!isNaN(k)){b.stopDrag();var r=Math.sqrt(Math.pow(k-f,2)+Math.pow(l-g,2)),q=b.initialDistance;isNaN(q)&&(q=Math.sqrt(Math.pow(k-f,2)+Math.pow(l-g,2)));if(!isNaN(q)){var k=b.initialTouchZoom*r/q,k=d.fitToBounds(k,h.minZoomLevel,h.maxZoomLevel),h=b.zoomLevel(),q=b.middleXP,l=b.middleYP,r=m/t,y=n/p,q=(b.zoomX()-q*y)*(k/h)+q*y,l=(b.zoomY()-l*r)*(k/h)+l*r;.1<Math.abs(k-h)&&(b.zoomTo(k,q,l,!0),b.mapWasPinched=!0,clearTimeout(b.pinchTO))}}k=a.scale;b.isDragging&&(b.balloon.hide(0),b.positionChanged(),c=a.x+(f-c),e=a.y+(g-e),b.preventDragOut&&(t=-t*k+m/2-b.diffY*b.mapScale*k,m=m/2-b.diffY*b.mapScale*k,c=d.fitToBounds(c,-p*k+n/2,n/2),e=d.fitToBounds(e,t,m)),isNaN(c)||isNaN(e)||(a.translate(c,e,k,!0),b.updateSmallMap()));b.previuosMouseX=f;b.previuosMouseY=g}}},selectObject:function(a,b){var c=this;a||(a=c.dataProvider);a.isOver=!1;var e=a.linkToObject;d.isString(e)&&(e=c.getObjectById(e));a.useTargetsZoomValues&&e&&(a.zoomX=e.zoomX,a.zoomY=e.zoomY,a.zoomLatitude=e.zoomLatitude,a.zoomLongitude=e.zoomLongitude,a.zoomLevel=e.zoomLevel);var f=c.selectedObject;f&&c.returnInitialColor(f);c.selectedObject=a;var g=!1,h,k;"MapArea"==a.objectType&&(a.autoZoomReal&&(g=!0),h=c.areasSettings.selectedOutlineColor,k=c.areasSettings.selectedOutlineThickness);if(e&&!g&&(d.isString(e)&&(e=c.getObjectById(e)),isNaN(a.zoomLevel)&&isNaN(a.zoomX)&&isNaN(a.zoomY))){if(c.extendMapData(e))return;c.selectObject(e);return}c.allowMultipleDescriptionWindows||c.closeAllDescriptions();clearTimeout(c.selectedObjectTimeOut);clearTimeout(c.processObjectsTimeOut);e=c.zoomDuration;!g&&isNaN(a.zoomLevel)&&isNaN(a.zoomX)&&isNaN(a.zoomY)?(c.showDescriptionAndGetUrl(),b||c.processObjects()):(c.selectedObjectTimeOut=setTimeout(function(){c.showDescriptionAndGetUrl.call(c)},1e3*e+200),c.showObjectsAfterZoom)?b||(c.processObjectsTimeOut=setTimeout(function(){c.processObjects.call(c)},1e3*e+200)):b||c.processObjects();e=a.displayObject;g=a.selectedColorReal;if("MapImage"==a.objectType){h=c.imagesSettings.selectedOutlineColor;k=c.imagesSettings.selectedOutlineThickness;var e=a.image,l=a.selectedScaleReal;if(!isNaN(l)&&1!=l){var m=a.scale;isNaN(a.tempScale)||(m=a.tempScale);isNaN(m)&&(m=1);a.tempScale=m;var n=a.displayObject;n.translate(n.x,n.y,m*l,!0)}}if(e){if(d.removeCN(c,e,"selected-object"),d.setCN(c,e,"selected-object"),a.bringForwardOnHover&&a.displayObject.toFront(),c.outlinesToFront(),!a.preserveOriginalAttributes){e.setAttr("stroke",a.outlineColorReal);void 0!==g&&e.setAttr("fill",g);void 0!==h&&e.setAttr("stroke",h);void 0!==k&&e.setAttr("stroke-width",k);"MapLine"==a.objectType&&((l=a.lineSvg)&&l.setAttr("stroke",g),l=a.arrowSvg)&&(l.setAttr("fill",g),l.setAttr("stroke",g));if(l=a.imageLabel)m=a.selectedLabelColorReal,void 0!==m&&l.setAttr("fill",m);a.selectable||(e.setAttr("cursor","default"),l&&l.setAttr("cursor","default"))}}else c.returnInitialColorReal(a);if(e=a.groupId)for(l=a.groupArray,l||(l=c.getGroupById(e),a.groupArray=l),m=0;m<l.length;m++)if(n=l[m],n.isOver=!1,e=n.displayObject,"MapImage"==n.objectType&&(e=n.image),e){var p=n.selectedColorReal;void 0!==p&&e.setAttr("fill",p);void 0!==h&&e.setAttr("stroke",h);void 0!==k&&e.setAttr("stroke-width",k);"MapLine"==n.objectType&&((e=n.lineSvg)&&e.setAttr("stroke",g),e=n.arrowSvg)&&(e.setAttr("fill",g),e.setAttr("stroke",g))}c.rescaleObjects();c.zoomToSelectedObject();f!=a&&c.fire({type:"selectedObjectChanged",chart:c})},returnInitialColor:function(a,b){this.returnInitialColorReal(a);b&&(a.isFirst=!1);if(this.selectedObject.bringForwardOnHover){var c=this.selectedObject.displayObject;c&&c.toFront()}if(c=a.groupId){var c=this.getGroupById(c),d;for(d=0;d<c.length;d++)this.returnInitialColorReal(c[d]),b&&(c[d].isFirst=!1)}this.outlinesToFront()},outlinesToFront:function(){if(this.outlines)for(var a=0;a<this.outlines.length;a++)this.outlines[a].toFront()},closeAllDescriptions:function(){this.descriptionsDiv.innerHTML=""},fireClosed:function(){this.fire({type:"descriptionClosed",chart:this})},returnInitialColorReal:function(a){a.isOver=!1;var b=a.displayObject;if(b){d.removeCN(this,b,"selected-object");b.toPrevious();if("MapImage"==a.objectType){var c=a.tempScale;isNaN(c)||b.translate(b.x,b.y,c,!0);a.tempScale=NaN;b=a.image}c=a.colorReal;if("MapLine"==a.objectType){var e=a.lineSvg;e&&e.setAttr("stroke",c);if(e=a.arrowSvg){var f=a.arrowColor;void 0===f&&(f=c);e.setAttr("fill",f);e.setAttr("stroke",f)}}var e=a.alphaReal,f=a.outlineAlphaReal,g=a.outlineThicknessReal,h=a.outlineColorReal;if(a.showAsSelected){var c=a.selectedColorReal,k,l;"MapImage"==a.objectType&&(k=this.imagesSettings.selectedOutlineColor,l=this.imagesSettings.selectedOutlineThickness);"MapArea"==a.objectType&&(k=this.areasSettings.selectedOutlineColor,l=this.areasSettings.selectedOutlineThickness);void 0!==k&&(h=k);void 0!==l&&(g=l)}"bubble"==a.type&&(c=void 0);void 0!==c&&b.setAttr("fill",c);if(k=a.image)k.setAttr("fill",c),k.setAttr("stroke",h),k.setAttr("stroke-width",g),k.setAttr("fill-opacity",e),k.setAttr("stroke-opacity",f);"MapArea"==a.objectType&&(c=1,this.areasSettings.adjustOutlineThickness&&(c=this.zoomLevel()*this.mapScale),b.setAttr("stroke",h),b.setAttr("stroke-width",g/c),b.setAttr("fill-opacity",e),b.setAttr("stroke-opacity",f));(c=a.pattern)&&b.pattern(c,this.mapScale,this.path);(b=a.imageLabel)&&!a.labelInactive&&(a.showAsSelected&&void 0!==a.selectedLabelColor?b.setAttr("fill",a.selectedLabelColor):b.setAttr("fill",a.labelColorReal))}},zoomToRectangle:function(a,b,c,e){var f=this.realWidth,g=this.realHeight,h=this.mapSet.scale,k=this.zoomControl,f=d.fitToBounds(c/f>e/g?.8*f/(c*h):.8*g/(e*h),k.minZoomLevel,k.maxZoomLevel);this.zoomToMapXY(f,(a+c/2)*h,(b+e/2)*h)},zoomToLatLongRectangle:function(a,b,c,e){var f=this.dataProvider,g=this.zoomControl,h=Math.abs(c-a),k=Math.abs(b-e),l=Math.abs(f.rightLongitude-f.leftLongitude),f=Math.abs(f.topLatitude-f.bottomLatitude),g=d.fitToBounds(h/l>k/f?.8*l/h:.8*f/k,g.minZoomLevel,g.maxZoomLevel);this.zoomToLongLat(g,a+(c-a)/2,e+(b-e)/2)},getGroupById:function(a){var b=[];this.getGroup(this.imagesProcessor.allObjects,a,b);this.getGroup(this.linesProcessor.allObjects,a,b);this.getGroup(this.areasProcessor.allObjects,a,b);return b},zoomToGroup:function(a){a="object"==typeof a?a:this.getGroupById(a);var b,c,d,f,g;for(g=0;g<a.length;g++){var h=a[g].displayObject;if(h){var k=h.getBBox(),h=k.y,l=k.y+k.height,m=k.x,k=k.x+k.width;if(h<b||isNaN(b))b=h;if(l>f||isNaN(f))f=l;if(m<c||isNaN(c))c=m;if(k>d||isNaN(d))d=k}}c+=this.diffX;d+=this.diffX;f+=this.diffY;b+=this.diffY;this.zoomToRectangle(c,b,d-c,f-b)},getGroup:function(a,b,c){if(a){var d;for(d=0;d<a.length;d++){var f=a[d];f.groupId==b&&c.push(f)}}},zoomToStageXY:function(a,b,c,e){if(!this.objectWasClicked){var f=this.zoomControl;a=d.fitToBounds(a,f.minZoomLevel,f.maxZoomLevel);var f=this.zoomLevel(),g=this.mapSet.getBBox();b=this.xyToCoordinates((b-this.mapContainer.x)/f-g.x*this.mapScale,(c-this.mapContainer.y)/f-g.y*this.mapScale);this.zoomToLongLat(a,b.longitude,b.latitude,e)}},zoomToLongLat:function(a,b,c,d){b=this.coordinatesToXY(b,c);this.zoomToMapXY(a,b.x,b.y,d)},zoomToMapXY:function(a,b,c,d){var f=this.mapWidth,g=this.mapHeight;this.zoomTo(a,-(b/f)*a+this.realWidth/f/2,-(c/g)*a+this.realHeight/g/2,d)},zoomToObject:function(a){if(a){var b=a.zoomLatitude,c=a.zoomLongitude;isNaN(a.zoomLatitudeC)||(b=a.zoomLatitudeC);isNaN(a.zoomLongitudeC)||(c=a.zoomLongitudeC);var e=a.zoomLevel,f=this.zoomInstantly,g=a.zoomX,h=a.zoomY,k=this.realWidth,l=this.realHeight;isNaN(e)||(isNaN(b)||isNaN(c)?this.zoomTo(e,g,h,f):this.zoomToLongLat(e,c,b,f));this.zoomInstantly=!1;"MapImage"==a.objectType&&isNaN(a.zoomX)&&isNaN(a.zoomY)&&isNaN(a.zoomLatitude)&&isNaN(a.zoomLongitude)&&!isNaN(a.latitude)&&!isNaN(a.longitude)&&this.zoomToLongLat(a.zoomLevel,a.longitude,a.latitude);"MapArea"==a.objectType&&(f=a.displayObject.getBBox(),g=this.mapScale,b=(f.x+this.diffX)*g,c=(f.y+this.diffY)*g,e=f.width*g,f=f.height*g,k=a.autoZoomReal&&isNaN(a.zoomLevel)?e/k>f/l?.8*k/e:.8*l/f:a.zoomLevel,l=this.zoomControl,k=d.fitToBounds(k,l.minZoomLevel,l.maxZoomLevel),isNaN(a.zoomX)&&isNaN(a.zoomY)&&isNaN(a.zoomLatitude)&&isNaN(a.zoomLongitude)&&this.zoomToMapXY(k,b+e/2,c+f/2));this.zoomControl.update()}},zoomToSelectedObject:function(){this.zoomToObject(this.selectedObject)},zoomTo:function(a,b,c,e){var f=this.zoomControl;a=d.fitToBounds(a,f.minZoomLevel,f.maxZoomLevel);f=this.zoomLevel();isNaN(b)&&(b=this.realWidth/this.mapWidth,b=(this.zoomX()-.5*b)*(a/f)+.5*b);isNaN(c)&&(c=this.realHeight/this.mapHeight,c=(this.zoomY()-.5*c)*(a/f)+.5*c);this.stopAnimation();isNaN(a)||(f=this.mapContainer,this.initialX=f.x,this.initialY=f.y,this.initialScale=f.scale,this.finalX=this.mapWidth*b,this.finalY=this.mapHeight*c,this.finalScale=a,this.finalX!=this.initialX||this.finalY!=this.initialY||this.finalScale!=this.initialScale?e?(this.tweenPercent=1,this.rescaleMapAndObjects(),this.wheelBusy=!1):this.animateMap():this.wheelBusy=!1)},loadXml:function(a){var b;window.XMLHttpRequest&&(b=new XMLHttpRequest);b.overrideMimeType&&b.overrideMimeType("text/xml");b.open("GET",a,!1);b.send();this.parseXMLObject(b.responseXML);this.svgData&&this.buildEverything()},stopAnimation:function(){this.frame=this.totalFrames},processObjects:function(a){var b=this.selectedObject;if(0<b.images.length||0<b.areas.length||0<b.lines.length||b==this.dataProvider||a){a=this.container;var c=this.stageImagesContainer;c&&c.remove();this.stageImagesContainer=c=a.set();this.trendLinesSet.push(c);var d=this.stageLinesContainer;d&&d.remove();this.stageLinesContainer=d=a.set();this.trendLinesSet.push(d);var f=this.mapImagesContainer;f&&f.remove();this.mapImagesContainer=f=a.set();this.mapContainer.push(f);var g=this.mapLinesContainer;g&&g.remove();this.mapLinesContainer=g=a.set();this.mapContainer.push(g);this.linesAboveImages?(f.toFront(),c.toFront(),g.toFront(),d.toFront()):(g.toFront(),d.toFront(),f.toFront(),c.toFront());b&&(this.imagesProcessor.reset(),this.linesProcessor.reset(),this.linesAboveImages?(this.imagesProcessor.process(b),this.linesProcessor.process(b)):(this.linesProcessor.process(b),this.imagesProcessor.process(b)));this.rescaleObjects()}},processAreas:function(){this.areasProcessor.process(this.dataProvider)},buildSVGMap:function(){d.remove(this.mapSet);var a=this.svgData.g.path,b=this.container,c=b.set();this.svgAreas=[];this.svgAreasById={};void 0===a.length&&(a=[a]);var e;for(e=0;e<a.length;e++){var f=a[e],g=f.d,h=f.title;f.titleTr&&(h=f.titleTr);var k=b.path(g);k.id=f.id;if(this.areasSettings.preserveOriginalAttributes){k.customAttr={};for(var l in f)"d"!=l&&"id"!=l&&"title"!=l&&(k.customAttr[l]=f[l])}f.outline&&(k.outline=!0);k.path=g;this.svgAreasById[f.id]={area:k,title:h,className:f["class"]};this.svgAreas.push(k);c.push(k)}this.mapSet=c;this.mapContainer.push(c);this.resizeMap()},centerAlign:function(){},setProjection:function(a){this.projection=a;this.chartCreated=!1;this.buildEverything()},addObjectEventListeners:function(a,b){var c=this;a.mousedown(function(a){c.mouseDownMapObject(b,a)}).mouseup(function(a){c.clickMapObject(b,a)}).mouseover(function(a){c.balloonX=NaN;c.rollOverMapObject(b,!0,a)}).mouseout(function(a){c.balloonX=NaN;c.rollOutMapObject(b,a)}).touchend(function(a){4>Math.abs(c.mouseX-c.tmx)&&4>Math.abs(c.mouseY-c.tmy)&&(c.tapped=!0);c.tapToActivate&&!c.tapped||c.mapWasDragged||c.mapWasPinched||(c.balloonX=NaN,c.rollOverMapObject(b,!0,a),c.clickMapObject(b,a))}).touchstart(function(a){c.tmx=c.mouseX;c.tmy=c.mouseY;c.mouseDownMapObject(b,a)}).keyup(function(a){13==a.keyCode&&c.clickMapObject(b,a)})},checkIfSelected:function(a){var b=this.selectedObject;if(b==a)return!0;if(b=b.groupId){var b=this.getGroupById(b),c;for(c=0;c<b.length;c++)if(b[c]==a)return!0}return!1},clearMap:function(){this.chartDiv.innerHTML="";this.clearObjectList()},clearObjectList:function(){var a=this.objectList;a&&a.div&&(a.div.innerHTML="")},checkIfLast:function(a){if(a){var b=a.parentNode;if(b&&b.lastChild==a)return!0}return!1},showAsRolledOver:function(a){var b=a.displayObject;if(!a.showAsSelected&&b&&!a.isOver){b.node.onmouseout=function(){};b.node.onmouseover=function(){};b.node.onclick=function(){};!a.isFirst&&a.bringForwardOnHover&&(b.toFront(),a.isFirst=!0);var c=a.rollOverColorReal,e;a.preserveOriginalAttributes&&(c=void 0);"bubble"==a.type&&(c=void 0);void 0==c&&(isNaN(a.rollOverBrightnessReal)||(c=d.adjustLuminosity(a.colorReal,a.rollOverBrightnessReal/100)));if(void 0!=c)if("MapImage"==a.objectType)(e=a.image)&&e.setAttr("fill",c);else if("MapLine"==a.objectType){if((e=a.lineSvg)&&e.setAttr("stroke",c),e=a.arrowSvg)e.setAttr("fill",c),e.setAttr("stroke",c)}else b.setAttr("fill",c);(c=a.imageLabel)&&!a.labelInactive&&(e=a.labelRollOverColorReal,void 0!=e&&c.setAttr("fill",e));c=a.rollOverOutlineColorReal;void 0!=c&&("MapImage"==a.objectType?(e=a.image)&&e.setAttr("stroke",c):b.setAttr("stroke",c));"MapImage"==a.objectType?(c=this.imagesSettings.rollOverOutlineThickness,(e=a.image)&&(isNaN(c)||e.setAttr("stroke-width",c))):(c=this.areasSettings.rollOverOutlineThickness,isNaN(c)||b.setAttr("stroke-width",c));if("MapArea"==a.objectType){c=this.areasSettings;e=a.rollOverAlphaReal;isNaN(e)||b.setAttr("fill-opacity",e);e=c.rollOverOutlineAlpha;isNaN(e)||b.setAttr("stroke-opacity",e);e=1;this.areasSettings.adjustOutlineThickness&&(e=this.zoomLevel()*this.mapScale);var f=c.rollOverOutlineThickness;isNaN(f)||b.setAttr("stroke-width",f/e);(c=c.rollOverPattern)&&b.pattern(c,this.mapScale,this.path)}"MapImage"==a.objectType&&(c=a.rollOverScaleReal,isNaN(c)||1==c||(e=b.scale,isNaN(e)&&(e=1),a.tempScale=e,b.translate(b.x,b.y,e*c,!0)));this.useHandCursorOnClickableOjects&&this.checkIfClickable(a)&&b.setAttr("cursor","pointer");a.mouseEnabled&&this.addObjectEventListeners(b,a);a.isOver=!0}this.outlinesToFront()},rollOverMapObject:function(a,b,c){if(this.chartCreated){this.handleMouseMove();var d=this.previouslyHovered;d&&d!=a?(!1===this.checkIfSelected(d)&&(this.returnInitialColor(d,!0),this.previouslyHovered=null),this.balloon.hide(0)):clearTimeout(this.hoverInt);if(!this.preventHover){if(!1===this.checkIfSelected(a)){if(d=a.groupId){var d=this.getGroupById(d),f;for(f=0;f<d.length;f++)d[f]!=a&&this.showAsRolledOver(d[f])}this.showAsRolledOver(a)}else(d=a.displayObject)&&(this.allowClickOnSelectedObject?d.setAttr("cursor","pointer"):d.setAttr("cursor","default"));this.showDescriptionOnHover?this.showDescription(a):!this.showBalloonOnSelectedObject&&this.checkIfSelected(a)||!1===b||(f=this.balloon,this.balloon.fixedPosition=!1,b=a.colorReal,d="",void 0!==b&&this.useObjectColorForBalloon||(b=f.fillColor),(f=a.balloonTextReal)&&(d=this.formatString(f,a)),this.balloonLabelFunction&&(d=this.balloonLabelFunction(a,this)),d&&""!==d&&this.showBalloon(d,b,!1,this.balloonX,this.balloonY));this.fire({type:"rollOverMapObject",mapObject:a,chart:this,event:c});this.previouslyHovered=a}}},longitudeToX:function(a){return(this.longitudeToCoordinate(a)+this.diffX*this.mapScale)*this.zoomLevel()+this.mapContainer.x},latitudeToY:function(a){return(this.latitudeToCoordinate(a)+this.diffY*this.mapScale)*this.zoomLevel()+this.mapContainer.y},latitudeToStageY:function(a){return this.latitudeToCoordinate(a)*this.zoomLevel()+this.mapContainer.y+this.diffY*this.mapScale},longitudeToStageX:function(a){return this.longitudeToCoordinate(a)*this.zoomLevel()+this.mapContainer.x+this.diffX*this.mapScale},stageXToLongitude:function(a){a=(a-this.mapContainer.x)/this.zoomLevel();return this.coordinateToLongitude(a)},stageYToLatitude:function(a){a=(a-this.mapContainer.y)/this.zoomLevel();return this.coordinateToLatitude(a)},rollOutMapObject:function(a,b){this.hideBalloon();a&&this.chartCreated&&a.isOver&&(this.checkIfSelected(a)||this.returnInitialColor(a),this.fire({type:"rollOutMapObject",mapObject:a,chart:this,event:b}))},formatString:function(a,b){var c=this.nf,e=this.pf,f=b.title;b.titleTr&&(f=b.titleTr);void 0==f&&(f="");var g=b.value,g=isNaN(g)?"":d.formatNumber(g,c),c=b.percents,c=isNaN(c)?"":d.formatNumber(c,e),e=b.description;void 0==e&&(e="");var h=b.customData;void 0==h&&(h="");return a=d.massReplace(a,{"[[title]]":f,"[[value]]":g,"[[percent]]":c,"[[description]]":e,"[[customData]]":h})},mouseDownMapObject:function(a,b){this.fire({type:"mouseDownMapObject",mapObject:a,chart:this,event:b})},clickMapObject:function(a,b){var c=this;b&&(b.touches||isNaN(a.zoomLevel)&&isNaN(a.zoomX)&&isNaN(a.zoomY)||c.hideBalloon());if(c.chartCreated&&!c.preventHover&&c.checkTouchDuration(b)&&!c.mapWasDragged&&c.checkIfClickable(a)&&!c.mapWasPinched){c.selectObject(a);var d=c.zoomLevel(),f=c.mapSet.getBBox(),d=c.xyToCoordinates((c.mouseX-c.mapContainer.x)/d-f.x*c.mapScale,(c.mouseY-c.mapContainer.y)/d-f.y*c.mapScale);c.clickLatitude=d.latitude;c.clickLongitude=d.longitude;b&&b.touches&&setTimeout(function(){c.showBalloonAfterZoom.call(c)},1e3*c.zoomDuration);c.fire({type:"clickMapObject",mapObject:a,chart:c,event:b});c.objectWasClicked=!0}},showBalloonAfterZoom:function(){var a=this.clickLongitude,b=this.clickLatitude,c=this.selectedObject;"MapImage"!=c.objectType||isNaN(c.longitude)||(a=c.longitude,b=c.latitude);a=this.coordinatesToStageXY(a,b);this.balloonX=a.x;this.balloonY=a.y;this.rollOverMapObject(this.selectedObject,!0)},checkIfClickable:function(a){var b=this.allowClickOnSelectedObject;return this.selectedObject==a&&b?!0:this.selectedObject!=a||b?!0===a.selectable||"MapArea"==a.objectType&&a.autoZoomReal||a.url||a.linkToObject||0<a.images.length||0<a.lines.length||!isNaN(a.zoomLevel)||!isNaN(a.zoomX)||!isNaN(a.zoomY)||a.description?!0:!1:!1},resizeMap:function(){var a=this.mapSet;if(a){var b=1,c=a.getBBox(),d=this.realWidth,f=this.realHeight,g=c.width,c=c.height;0<g&&0<c&&(this.fitMapToContainer&&(b=g/d>c/f?d/g:f/c),a.translate(0,0,b,!0),this.mapScale=b,this.mapHeight=c*b,this.mapWidth=g*b)}},zoomIn:function(){var a=this.zoomLevel()*this.zoomControl.zoomFactor;this.zoomTo(a)},zoomOut:function(){var a=this.zoomLevel()/this.zoomControl.zoomFactor;this.zoomTo(a)},moveLeft:function(){var a=this.zoomX()+this.zoomControl.panStepSize;this.zoomTo(this.zoomLevel(),a,this.zoomY())},moveRight:function(){var a=this.zoomX()-this.zoomControl.panStepSize;this.zoomTo(this.zoomLevel(),a,this.zoomY())},moveUp:function(){var a=this.zoomY()+this.zoomControl.panStepSize;this.zoomTo(this.zoomLevel(),this.zoomX(),a)},moveDown:function(){var a=this.zoomY()-this.zoomControl.panStepSize;this.zoomTo(this.zoomLevel(),this.zoomX(),a)},zoomX:function(){return this.mapSet?Math.round(1e4*this.mapContainer.x/this.mapWidth)/1e4:NaN},zoomY:function(){return this.mapSet?Math.round(1e4*this.mapContainer.y/this.mapHeight)/1e4:NaN},goHome:function(){this.selectObject(this.dataProvider);this.fire({type:"homeButtonClicked",chart:this})},zoomLevel:function(){return Math.round(1e5*this.mapContainer.scale)/1e5},showDescriptionAndGetUrl:function(){var a=this.selectedObject;if(a){this.showDescription();var b=a.url;if(b)d.getURL(b,a.urlTarget);else if(b=a.linkToObject){if(d.isString(b)){var c=this.getObjectById(b);if(c){this.selectObject(c);return}}b&&a.passZoomValuesToTarget&&(b.zoomLatitude=this.zoomLatitude(),b.zoomLongitude=this.zoomLongitude(),b.zoomLevel=this.zoomLevel());this.extendMapData(b)||this.selectObject(b)}}},extendMapData:function(a){var b=a.objectType;if("MapImage"!=b&&"MapArea"!=b&&"MapLine"!=b)return d.extend(a,new d.MapData,!0),this.dataProvider=a,this.zoomInstantly=!0,this.validateData(),!0},showDescription:function(a){a||(a=this.selectedObject);this.allowMultipleDescriptionWindows||this.closeAllDescriptions();if(a.description){var b=a.descriptionWindow;b&&b.close();b=new d.DescriptionWindow;a.descriptionWindow=b;var c=a.descriptionWindowWidth,e=a.descriptionWindowHeight,f=a.descriptionWindowLeft,g=a.descriptionWindowTop,h=a.descriptionWindowRight,k=a.descriptionWindowBottom;isNaN(h)||(f=this.realWidth-h);isNaN(k)||(g=this.realHeight-k);var l=a.descriptionWindowX;isNaN(l)||(f=l);l=a.descriptionWindowY;isNaN(l)||(g=l);isNaN(f)&&(f=this.mouseX,f=f>this.realWidth/2?f-c-20:f+20);isNaN(g)&&(g=this.mouseY);b.maxHeight=e;l=a.title;a.titleTr&&(l=a.titleTr);b.show(this,this.descriptionsDiv,a.description,l);a=b.div.style;a.position="absolute";a.width=c+"px";a.maxHeight=e+"px";isNaN(k)||(g-=b.div.offsetHeight);isNaN(h)||(f-=b.div.offsetWidth);a.left=f+"px";a.top=g+"px"}},parseXMLObject:function(a){var b={root:{}};this.parseXMLNode(b,"root",a);this.svgData=b.root.svg;this.getBounds()},getBounds:function(){var a=this.dataProvider;try{var b=this.svgData.defs["amcharts:ammap"];a.leftLongitude=Number(b.leftLongitude);a.rightLongitude=Number(b.rightLongitude);a.topLatitude=Number(b.topLatitude);a.bottomLatitude=Number(b.bottomLatitude);a.projection=b.projection;var c=b.wrappedLongitudes;c&&(a.rightLongitude+=360);a.wrappedLongitudes=c}catch(d){}},recalcLongitude:function(a){return this.dataProvider.wrappedLongitudes?a<this.dataProvider.leftLongitude?Number(a)+360:a:a},latitudeToCoordinate:function(a){var b,c=this.dataProvider;if(this.mapSet){b=c.topLatitude;var d=c.bottomLatitude;"mercator"==c.projection&&(a=this.mercatorLatitudeToCoordinate(a),b=this.mercatorLatitudeToCoordinate(b),d=this.mercatorLatitudeToCoordinate(d));b=(a-b)/(d-b)*this.mapHeight}return b},longitudeToCoordinate:function(a){a=this.recalcLongitude(a);var b,c=this.dataProvider;this.mapSet&&(b=c.leftLongitude,b=(a-b)/(c.rightLongitude-b)*this.mapWidth);return b},mercatorLatitudeToCoordinate:function(a){89.5<a&&(a=89.5);-89.5>a&&(a=-89.5);a=d.degreesToRadians(a);return d.radiansToDegrees(.5*Math.log((1+Math.sin(a))/(1-Math.sin(a)))/2)},zoomLatitude:function(){if(this.mapContainer){var a=this.mapSet.getBBox(),b=(-this.mapContainer.x+this.previousWidth/2)/this.zoomLevel()-a.x*this.mapScale,a=(-this.mapContainer.y+this.previousHeight/2)/this.zoomLevel()-a.y*this.mapScale;return this.xyToCoordinates(b,a).latitude}},zoomLongitude:function(){if(this.mapContainer){var a=this.mapSet.getBBox(),b=(-this.mapContainer.x+this.previousWidth/2)/this.zoomLevel()-a.x*this.mapScale,a=(-this.mapContainer.y+this.previousHeight/2)/this.zoomLevel()-a.y*this.mapScale;return this.xyToCoordinates(b,a).longitude}},getAreaCenterLatitude:function(a){a=a.displayObject.getBBox();var b=this.mapScale,c=this.mapSet.getBBox();return this.xyToCoordinates((a.x+a.width/2+this.diffX)*b-c.x*b,(a.y+a.height/2+this.diffY)*b-c.y*b).latitude},getAreaCenterLongitude:function(a){a=a.displayObject.getBBox();var b=this.mapScale,c=this.mapSet.getBBox();return this.xyToCoordinates((a.x+a.width/2+this.diffX)*b-c.x*b,(a.y+a.height/2+this.diffY)*b-c.y*b).longitude},milesToPixels:function(a){var b=this.dataProvider;return this.mapWidth/(b.rightLongitude-b.leftLongitude)*a/69.172},kilometersToPixels:function(a){var b=this.dataProvider;return this.mapWidth/(b.rightLongitude-b.leftLongitude)*a/111.325},handleBackgroundClick:function(){if(this.backgroundZoomsToTop&&!this.mapWasDragged){var a=this.dataProvider;if(this.checkIfClickable(a))this.clickMapObject(a);else{var b=a.zoomX,c=a.zoomY,d=a.zoomLongitude,f=a.zoomLatitude,a=a.zoomLevel;isNaN(b)||isNaN(c)||this.zoomTo(a,b,c);isNaN(d)||isNaN(f)||this.zoomToLongLat(a,d,f,!0)}}},parseXMLNode:function(a,b,c,d){void 0===d&&(d="");var f,g,h;if(c){var k=c.childNodes.length;for(f=0;f<k;f++){g=c.childNodes[f];var l=g.nodeName,m=g.nodeValue?this.trim(g.nodeValue):"",n=!1;g.attributes&&0<g.attributes.length&&(n=!0);if(0!==g.childNodes.length||""!==m||!1!==n)if(3==g.nodeType||4==g.nodeType){if(""!==m){g=0;for(h in a[b])a[b].hasOwnProperty(h)&&g++;g?a[b]["#text"]=m:a[b]=m}}else if(1==g.nodeType){var p;void 0!==a[b][l]?void 0===a[b][l].length?(p=a[b][l],a[b][l]=[],a[b][l].push(p),a[b][l].push({}),p=a[b][l][1]):"object"==typeof a[b][l]&&(a[b][l].push({}),p=a[b][l][a[b][l].length-1]):(a[b][l]={},p=a[b][l]);if(g.attributes&&g.attributes.length)for(m=0;m<g.attributes.length;m++)p[g.attributes[m].name]=g.attributes[m].value;void 0!==a[b][l].length?this.parseXMLNode(a[b][l],a[b][l].length-1,g,d+"  "):this.parseXMLNode(a[b],l,g,d+"  ")}}g=0;c="";for(h in a[b])"#text"==h?c=a[b][h]:g++;0===g&&void 0===a[b].length&&(a[b]=c)}},doDoubleClickZoom:function(){if(!this.mapWasDragged){var a=this.zoomLevel()*this.zoomControl.zoomFactor;this.zoomToStageXY(a,this.mouseX,this.mouseY)}},getDevInfo:function(){var a=this.zoomLevel(),b=this.mapSet.getBBox(),b=this.xyToCoordinates((this.mouseX-this.mapContainer.x)/a-b.x*this.mapScale,(this.mouseY-this.mapContainer.y)/a-b.y*this.mapScale),a={chart:this,type:"writeDevInfo",zoomLevel:a,zoomX:this.zoomX(),zoomY:this.zoomY(),zoomLatitude:this.zoomLatitude(),zoomLongitude:this.zoomLongitude(),latitude:b.latitude,longitude:b.longitude,left:this.mouseX,top:this.mouseY,right:this.realWidth-this.mouseX,bottom:this.realHeight-this.mouseY,percentLeft:Math.round(this.mouseX/this.realWidth*100)+"%",percentTop:Math.round(this.mouseY/this.realHeight*100)+"%",percentRight:Math.round((this.realWidth-this.mouseX)/this.realWidth*100)+"%",percentBottom:Math.round((this.realHeight-this.mouseY)/this.realHeight*100)+"%"},b="zoomLevel:"+a.zoomLevel+", zoomLongitude:"+a.zoomLongitude+", zoomLatitude:"+a.zoomLatitude+"\n",b=b+("zoomX:"+a.zoomX+", zoomY:"+a.zoomY+"\n"),b=b+("latitude:"+a.latitude+", longitude:"+a.longitude+"\n"),b=b+("left:"+a.left+", top:"+a.top+"\n"),b=b+("right:"+a.right+", bottom:"+a.bottom+"\n"),b=b+("left:"+a.percentLeft+", top:"+a.percentTop+"\n"),b=b+("right:"+a.percentRight+", bottom:"+a.percentBottom+"\n");a.str=b;this.fire(a);return a},getXY:function(a,b,c){void 0!==a&&(-1!=String(a).indexOf("%")?(a=Number(a.split("%").join("")),c&&(a=100-a),a=Number(a)*b/100):c&&(a=b-a));return a},getObjectById:function(a){var b=this.dataProvider;if(b.areas){var c=this.getObject(a,b.areas);if(c)return c}if(c=this.getObject(a,b.images))return c;if(a=this.getObject(a,b.lines))return a},getObject:function(a,b){if(b){var c;for(c=0;c<b.length;c++){var d=b[c];if(d.id==a)return d;if(d.areas){var f=this.getObject(a,d.areas);if(f)return f}if(f=this.getObject(a,d.images))return f;if(d=this.getObject(a,d.lines))return d}}},parseData:function(){var a=this.dataProvider;this.processObject(a.areas,a,"area");this.processObject(a.images,a,"image");this.processObject(a.lines,a,"line")},processObject:function(a,b,c){if(a){var e;for(e=0;e<a.length;e++){var f=a[e];f.parentObject=b;"area"==c&&d.extend(f,new d.MapArea(this.theme),!0);"image"==c&&(f=d.extend(f,new d.MapImage(this.theme),!0));"line"==c&&(f=d.extend(f,new d.MapLine(this.theme),!0));a[e]=f;f.areas&&this.processObject(f.areas,f,"area");f.images&&this.processObject(f.images,f,"image");f.lines&&this.processObject(f.lines,f,"line")}}},positionChanged:function(){var a={type:"positionChanged",zoomX:this.zoomX(),zoomY:this.zoomY(),zoomLevel:this.zoomLevel(),chart:this};this.fire(a)},getX:function(a,b){return this.getXY(a,this.realWidth,b)},getY:function(a,b){return this.getXY(a,this.realHeight,b)},trim:function(a){if(a){var b;for(b=0;b<a.length;b++)if(-1===" \n\r\t\f\v            ​\u2028\u2029　".indexOf(a.charAt(b))){a=a.substring(b);break}for(b=a.length-1;0<=b;b--)if(-1===" \n\r\t\f\v            ​\u2028\u2029　".indexOf(a.charAt(b))){a=a.substring(0,b+1);break}return-1===" \n\r\t\f\v            ​\u2028\u2029　".indexOf(a.charAt(0))?a:""}},destroy:function(){d.AmMap.base.destroy.call(this)},x2c:function(a){var b=this.dataProvider.leftLongitude;return Math.round(this.unscaledMapWidth*(a-b)/(this.dataProvider.rightLongitude-b)*100)/100},y2c:function(a){var b=this.dataProvider.topLatitude;return Math.round(this.unscaledMapHeight*(a-b)/(this.dataProvider.bottomLatitude-b)*100)/100},normalize:function(a){if(!a.pathsArray){var b;if(a.normalized)b=a.normalized;else{var c=d.normalizePath(a.node);b=a.node.getAttribute("d");a.normalized=b;c.maxX>this.maxMapX&&(this.maxMapX=c.maxX);c.minX<this.minMapX&&(this.minMapX=c.minX);c.maxY>this.maxMapY&&(this.maxMapY=c.maxY);c.minY<this.minMapY&&(this.minMapY=c.minY)}a.node.setAttribute("d",b)}},redraw:function(a){var b=a.normalized,b=b.split(" Z").join(""),b=b.split("M");a.pathsArray=[];for(var c=0;c<b.length;c++){var d=b[c];if(d){for(var d=d.split("L"),f=[],g=0;g<d.length;g++)if(d[g]){var h=d[g].split(" "),h=this.xyToCoordinates(Number(h[1]),Number(h[2]),this.dpProjectionFunction,this.sourceMapWidth,this.sourceMapHeight);f.push([h.longitude,h.latitude])}a.pathsArray.push(f)}}b="";for(c=0;c<a.pathsArray.length;c++)b+=this.redrawArea(a.pathsArray[c]);a.node.setAttribute("d",b);a.path=b},redrawArea:function(a){for(var b=!1,c="",e=0;e<a.length;e++){var f=a[e][0],g=a[e][1],h=d.degreesToRadians(a[e][0]),k=d.degreesToRadians(a[e][1]),k=this.projectionFunction(h,k),h=d.roundTo(this.x2c(d.radiansToDegrees(k[0])),3),k=d.roundTo(this.y2c(d.radiansToDegrees(k[1])),3);h<this.minMapXX&&(this.minMapXX=h,this.leftLongLat={longitude:f,latitude:g});h>this.maxMapXX&&(this.maxMapXX=h,this.rightLongLat={longitude:f,latitude:g});k<this.minMapYY&&(this.minMapYY=k,this.topLongLat={longitude:f,latitude:g});k>this.maxMapYY&&(this.maxMapYY=k,this.bottomLongLat={longitude:f,latitude:g});b?c+=" L ":(c+=" M ",b=!0);c+=h+" "+k}return c+" Z "},normalizeMap:function(){var a=d.degreesToRadians(this.dataProvider.leftLongitude),b=d.degreesToRadians(this.dataProvider.rightLongitude),c=d.degreesToRadians(this.dataProvider.topLatitude),e=d.degreesToRadians(this.dataProvider.bottomLatitude),f=a+(b-a)/2,g=c+(e-c)/2,h=this.dpProjectionFunction(f,c)[1],k=this.dpProjectionFunction(f,e)[1],l=this.dpProjectionFunction(a,g)[0],m=this.dpProjectionFunction(b,g)[0],c=d.equirectangular(f,c),e=d.equirectangular(f,e),h=(c[1]-e[1])/(h-k),a=d.equirectangular(a,g),b=d.equirectangular(b,g),l=(a[0]-b[0])/(l-m);this.minMapX=Infinity;this.maxMapX=-Infinity;this.minMapY=Infinity;this.maxMapY=-Infinity;for(m=0;m<this.svgAreas.length;m++)this.normalize(this.svgAreas[m]);if(this.dataProvider.wrappedLongitudes)for(m=0;m<this.svgAreas.length;m++)this.svgAreas[m].translate(-this.minMapX,-this.minMapY);this.sourceMapHeight=Math.abs(this.maxMapY-this.minMapY);this.sourceMapWidth=Math.abs(this.maxMapX-this.minMapX);this.unscaledMapWidth=this.sourceMapWidth*l;this.unscaledMapHeight=this.sourceMapHeight*h;this.diffY=this.diffX=0},fixMapPosition:function(){var a=d.degreesToRadians(this.dataProvider.leftLongitude),b=d.degreesToRadians(this.dataProvider.rightLongitude),c=d.degreesToRadians(this.dataProvider.topLatitude),e=d.degreesToRadians(this.dataProvider.bottomLatitude),f=a+(b-a)/2,g=c+(e-c)/2,h=this.dpProjectionFunction(f,c)[1],k=this.dpProjectionFunction(f,e)[1],l=this.dpProjectionFunction(a,g)[0],m=this.dpProjectionFunction(b,g)[0];this.sourceMapHeight=this.mapHeight/this.mapScale;this.sourceMapWidth=this.mapWidth/this.mapScale;this.unscaledMapWidth=(a-b)/(l-m)*this.sourceMapWidth;this.unscaledMapHeight=(c-e)/(h-k)*this.sourceMapHeight;b=this.coordinatesToXY(d.radiansToDegrees(f),d.radiansToDegrees(c));a=this.coordinatesToXY(d.radiansToDegrees(a),d.radiansToDegrees(g));c=g=Infinity;for(e=0;e<this.svgAreas.length;e++)f=this.svgAreas[e].getBBox(),f.y<g&&(g=f.y),f.x<c&&(c=f.x);this.diffY=b.y/this.mapScale-g;this.diffX=a.x/this.mapScale-c;for(e=0;e<this.svgAreas.length;e++)this.svgAreas[e].translate(this.diffX,this.diffY)},changeProjection:function(){this.minMapXX=Infinity;this.maxMapXX=-Infinity;this.minMapYY=Infinity;this.maxMapYY=-Infinity;this.projectionChanged=!1;for(var a=0;a<this.svgAreas.length;a++)this.redraw(this.svgAreas[a]);this.projectionChanged=!0;this.resizeMap()},coordinatesToXY:function(a,b){var c,e;c=!1;this.dataProvider&&(c=this.dataProvider.wrappedLongitudes)&&(a=this.recalcLongitude(a));this.projectionFunction?(e=this.projectionFunction(d.degreesToRadians(a),d.degreesToRadians(b)),c=this.mapScale*d.roundTo(this.x2c(d.radiansToDegrees(e[0])),3),e=this.mapScale*d.roundTo(this.y2c(d.radiansToDegrees(e[1])),3)):(c=this.longitudeToCoordinate(a),e=this.latitudeToCoordinate(b));return{x:c,y:e}},coordinatesToStageXY:function(a,b){var c=this.coordinatesToXY(a,b),d=c.x*this.zoomLevel()+this.mapContainer.x,c=c.y*this.zoomLevel()+this.mapContainer.y;return{x:d,y:c}},stageXYToCoordinates:function(a,b){var c=this.mapSet.getBBox(),d=(a-this.mapContainer.x)/this.zoomLevel()-c.x*this.mapScale,c=(b-this.mapContainer.y)/this.zoomLevel()-c.y*this.mapScale;return this.xyToCoordinates(d,c)},xyToCoordinates:function(a,b,c,e,f){var g;isNaN(e)&&(e=this.mapWidth);isNaN(f)&&(f=this.mapHeight);c||(c=this.projectionFunction);if(g=c.invert){var h=this.dataProvider.leftLongitude,k=this.dataProvider.rightLongitude,l=this.dataProvider.topLatitude,m=this.dataProvider.bottomLatitude,n=h+(k-h)/2,p=l+(m-l)/2,l=d.radiansToDegrees(c(d.degreesToRadians(n),d.degreesToRadians(l))[1]),m=d.radiansToDegrees(c(d.degreesToRadians(n),d.degreesToRadians(m))[1]),h=d.radiansToDegrees(c(d.degreesToRadians(h),d.degreesToRadians(p))[0]),k=d.radiansToDegrees(c(d.degreesToRadians(k),d.degreesToRadians(p))[0]);this.projectionChanged&&(l=d.radiansToDegrees(c(d.degreesToRadians(this.topLongLat.longitude),d.degreesToRadians(this.topLongLat.latitude))[1]),m=d.radiansToDegrees(c(d.degreesToRadians(this.bottomLongLat.longitude),d.degreesToRadians(this.bottomLongLat.latitude))[1]),h=d.radiansToDegrees(c(d.degreesToRadians(this.leftLongLat.longitude),d.degreesToRadians(this.leftLongLat.latitude))[0]),k=d.radiansToDegrees(c(d.degreesToRadians(this.rightLongLat.longitude),d.degreesToRadians(this.rightLongLat.latitude))[0]));a=d.degreesToRadians(a/e*(k-h)+h);b=d.degreesToRadians(b/f*(m-l)+l);b=g(a,b);g=d.radiansToDegrees(b[0]);b=d.radiansToDegrees(b[1])}else g=this.coordinateToLongitude(a),b=this.coordinateToLatitude(b);return{longitude:d.roundTo(g,4),latitude:d.roundTo(b,4)}},coordinateToLatitude:function(a,b){var c;void 0===b&&(b=this.mapHeight);if(this.mapSet){var e=this.dataProvider,f=e.bottomLatitude;c=e.topLatitude;"mercator"==e.projection?(e=this.mercatorLatitudeToCoordinate(f),c=this.mercatorLatitudeToCoordinate(c),c=2*d.degreesToRadians(a*(e-c)/b+c),c=d.radiansToDegrees(2*Math.atan(Math.exp(c))-.5*Math.PI)):c=a/b*(f-c)+c}return Math.round(1e6*c)/1e6},coordinateToLongitude:function(a,b){var c,d=this.dataProvider;void 0===b&&(b=this.mapWidth);this.mapSet&&(c=a/b*(d.rightLongitude-d.leftLongitude)+d.leftLongitude);return Math.round(1e6*c)/1e6}})})();(function(){var d=window.AmCharts;d.ZoomControl=d.Class({construct:function(a){this.cname="ZoomControl";this.panStepSize=.1;this.zoomFactor=2;this.maxZoomLevel=64;this.minZoomLevel=1;this.panControlEnabled=!1;this.zoomControlEnabled=!0;this.buttonRollOverColor="#DADADA";this.buttonFillColor="#FFFFFF";this.buttonFillAlpha=1;this.buttonBorderColor="#000000";this.buttonBorderAlpha=.1;this.buttonIconAlpha=this.buttonBorderThickness=1;this.gridColor=this.buttonIconColor="#000000";this.homeIconFile="homeIcon.gif";this.gridBackgroundColor="#000000";this.draggerAlpha=this.gridAlpha=this.gridBackgroundAlpha=0;this.draggerSize=this.buttonSize=31;this.iconSize=11;this.homeButtonEnabled=!0;this.buttonCornerRadius=2;this.gridHeight=5;this.roundButtons=!0;this.top=this.left=10;d.applyTheme(this,a,this.cname)},init:function(a,b){var c=this;c.chart=a;d.remove(c.set);var e=b.set();d.setCN(a,e,"zoom-control");var f=c.buttonSize,g=c.zoomControlEnabled,h=c.panControlEnabled,k=c.buttonFillColor,l=c.buttonFillAlpha,m=c.buttonBorderThickness,n=c.buttonBorderColor,p=c.buttonBorderAlpha,t=c.buttonCornerRadius,r=c.buttonRollOverColor,q=c.gridHeight,y=c.zoomFactor,B=c.minZoomLevel,u=c.maxZoomLevel,w=c.buttonIconAlpha,v=c.buttonIconColor,A=c.roundButtons,C=a.svgIcons,x=a.getX(c.left),z=a.getY(c.top);isNaN(c.right)||(x=a.getX(c.right,!0),x=h?x-3*f:x-f);isNaN(c.bottom)||(z=a.getY(c.bottom,!0),g&&(z-=q+3*f),z=h?z-3*f:c.homeButtonEnabled?z-.5*f:z+f);e.translate(x,z);c.previousDY=NaN;var F,x=f/4-1;if(g){F=b.set();d.setCN(a,F,"zoom-control-zoom");e.push(F);c.set=e;c.zoomSet=F;5<q&&(g=d.rect(b,f+6,q+2*f+6,c.gridBackgroundColor,c.gridBackgroundAlpha,0,"#000000",0,4),d.setCN(a,g,"zoom-bg"),g.translate(-3,-3),g.mouseup(function(){c.handleBgUp()}).touchend(function(){c.handleBgUp()}),F.push(g));var E=f;A&&(E=f/1.5);c.draggerSize=E;var H=Math.log(u/B)/Math.log(y)+1;1e3<H&&(H=1e3);var g=q/H,G,D=b.set();D.translate((f-E)/2+1,1,NaN,!0);F.push(D);for(G=1;G<H;G++)z=f+G*g,z=d.line(b,[1,E-2],[z,z],c.gridColor,c.gridAlpha,1),d.setCN(a,z,"zoom-grid"),D.push(z);z=new d.SimpleButton;z.setDownHandler(c.draggerDown,c);z.setClickHandler(c.draggerUp,c);z.init(b,E,g,k,l,m,n,p,t,r);d.setCN(a,z.set,"zoom-dragger");F.push(z.set);z.set.setAttr("opacity",c.draggerAlpha);c.dragger=z.set;c.previousY=NaN;z=new d.SimpleButton;C?(E=b.set(),H=d.line(b,[-x,x],[0,0],v,w,1),G=d.line(b,[0,0],[-x,x],v,w,1),E.push(H),E.push(G),z.svgIcon=E):z.setIcon(a.pathToImages+"plus.gif",c.iconSize);z.setClickHandler(a.zoomIn,a);z.init(b,f,f,k,l,m,n,p,t,r,w,v,A);d.setCN(a,z.set,"zoom-in");F.push(z.set);z=new d.SimpleButton;C?z.svgIcon=d.line(b,[-x,x],[0,0],v,w,1):z.setIcon(a.pathToImages+"minus.gif",c.iconSize);z.setClickHandler(a.zoomOut,a);z.init(b,f,f,k,l,m,n,p,t,r,w,v,A);z.set.translate(0,q+f);d.setCN(a,z.set,"zoom-out");F.push(z.set);q-=g;u=Math.log(u/100)/Math.log(y);c.realStepSize=q/(u-Math.log(B/100)/Math.log(y));c.realGridHeight=q;c.stepMax=u}h&&(h=b.set(),d.setCN(a,h,"zoom-control-pan"),e.push(h),F&&F.translate(f,4*f),y=new d.SimpleButton,C?y.svgIcon=d.line(b,[x/5,-x+x/5,x/5],[-x,0,x],v,w,1):y.setIcon(a.pathToImages+"panLeft.gif",c.iconSize),y.setClickHandler(a.moveLeft,a),y.init(b,f,f,k,l,m,n,p,t,r,w,v,A),y.set.translate(0,f),d.setCN(a,y.set,"pan-left"),h.push(y.set),y=new d.SimpleButton,C?y.svgIcon=d.line(b,[-x/5,x-x/5,-x/5],[-x,0,x],v,w,1):y.setIcon(a.pathToImages+"panRight.gif",c.iconSize),y.setClickHandler(a.moveRight,a),y.init(b,f,f,k,l,m,n,p,t,r,w,v,A),y.set.translate(2*f,f),d.setCN(a,y.set,"pan-right"),h.push(y.set),y=new d.SimpleButton,C?y.svgIcon=d.line(b,[-x,0,x],[x/5,-x+x/5,x/5],v,w,1):y.setIcon(a.pathToImages+"panUp.gif",c.iconSize),y.setClickHandler(a.moveUp,a),y.init(b,f,f,k,l,m,n,p,t,r,w,v,A),y.set.translate(f,0),d.setCN(a,y.set,"pan-up"),h.push(y.set),y=new d.SimpleButton,C?y.svgIcon=d.line(b,[-x,0,x],[-x/5,x-x/5,-x/5],v,w,1):y.setIcon(a.pathToImages+"panDown.gif",c.iconSize),y.setClickHandler(a.moveDown,a),y.init(b,f,f,k,l,m,n,p,t,r,w,v,A),y.set.translate(f,2*f),d.setCN(a,y.set,"pan-down"),h.push(y.set),e.push(h));c.homeButtonEnabled&&(h=new d.SimpleButton,C?h.svgIcon=d.polygon(b,[-x,0,x,x-1,x-1,2,2,-2,-2,-x+1,-x+1],[0,-x,0,0,x-1,x-1,2,2,x-1,x-1,0],v,w,1,v,w):h.setIcon(a.pathToImages+c.homeIconFile,c.iconSize),h.setClickHandler(a.goHome,a),c.panControlEnabled&&(p=l=0),h.init(b,f,f,k,l,m,n,p,t,r,w,v,A),c.panControlEnabled?h.set.translate(f,f):F&&F.translate(0,1.5*f),d.setCN(a,h.set,"pan-home"),e.push(h.set));c.update()},draggerDown:function(){this.chart.stopDrag();this.isDragging=!0},draggerUp:function(){this.isDragging=!1},handleBgUp:function(){var a=this.chart;a.zoomTo(100*Math.pow(this.zoomFactor,this.stepMax-(a.mouseY-this.zoomSet.y-this.set.y-this.buttonSize-this.realStepSize/2)/this.realStepSize))},update:function(){var a;a=this.zoomFactor;var b=this.realStepSize,c=this.stepMax,e=this.dragger,f=this.buttonSize,g,h=this.chart;h&&(this.isDragging?(h.stopDrag(),g=e.y+(h.mouseY-this.previousY),g=d.fitToBounds(g,f,this.realGridHeight+f),h.zoomTo(100*Math.pow(a,c-(g-f)/b),NaN,NaN,!0)):(a=Math.log(h.zoomLevel()/100)/Math.log(a),g=(c-a)*b+f),this.previousY=h.mouseY,this.previousDY!=g&&e&&(e.translate((this.buttonSize-this.draggerSize)/2,g),this.previousDY=g))}})})();(function(){var d=window.AmCharts;d.SimpleButton=d.Class({construct:function(){},init:function(a,b,c,e,f,g,h,k,l,m,n,p,t){var r=this;r.rollOverColor=m;r.color=e;r.container=a;m=a.set();r.set=m;t?(b/=2,e=d.circle(a,b,e,f,g,h,k),e.translate(b,b)):e=d.rect(a,b,c,e,f,g,h,k,l);m.push(e);f=r.iconPath;var q;f&&(q=r.iconSize,g=(b-q)/2,t&&(g=(2*b-q)/2),q=a.image(f,g,(c-q)/2,q,q));r.svgIcon&&(q=r.svgIcon,t?q.translate(b,b):q.translate(b/2,b/2));m.setAttr("cursor","pointer");q&&(m.push(q),q.setAttr("opacity",n),q.node.style.pointerEvents="none");e.mousedown(function(){r.handleDown()}).touchstart(function(){r.handleDown()}).mouseup(function(){r.handleUp()}).touchend(function(){r.handleUp()}).mouseover(function(){r.handleOver()}).mouseout(function(){r.handleOut()});r.bg=e},setIcon:function(a,b){this.iconPath=a;this.iconSize=b},setClickHandler:function(a,b){this.clickHandler=a;this.scope=b},setDownHandler:function(a,b){this.downHandler=a;this.scope=b},handleUp:function(){var a=this.clickHandler;a&&a.call(this.scope)},handleDown:function(){var a=this.downHandler;a&&a.call(this.scope)},handleOver:function(){this.container.chart.skipClick=!0;this.bg.setAttr("fill",this.rollOverColor)},handleOut:function(){this.container.chart.skipClick=!1;this.bg.setAttr("fill",this.color)}})})();(function(){var d=window.AmCharts;d.SmallMap=d.Class({construct:function(a){this.cname="SmallMap";this.mapColor="#e6e6e6";this.rectangleColor="#FFFFFF";this.top=this.right=10;this.minimizeButtonWidth=23;this.backgroundColor="#9A9A9A";this.backgroundAlpha=1;this.borderColor="#FFFFFF";this.iconColor="#000000";this.borderThickness=3;this.borderAlpha=1;this.size=.2;this.enabled=!0;d.applyTheme(this,a,this.cname)},init:function(a,b){var c=this;if(c.enabled){c.chart=a;c.container=b;c.width=a.realWidth*c.size;c.height=a.realHeight*c.size;d.remove(c.mapSet);d.remove(c.allSet);d.remove(c.set);var e=b.set();c.set=e;d.setCN(a,e,"small-map");var f=b.set();c.allSet=f;e.push(f);c.buildSVGMap();var g=c.borderThickness,h=c.borderColor,k=d.rect(b,c.width+g,c.height+g,c.backgroundColor,c.backgroundAlpha,g,h,c.borderAlpha);d.setCN(a,k,"small-map-bg");k.translate(-g/2,-g/2);f.push(k);k.toBack();var l,m,k=c.minimizeButtonWidth,n=new d.SimpleButton,p=k/2;a.svgIcons?n.svgIcon=d.line(b,[-p/2,0,p/2],[-p/4,p/4,-p/4],c.iconColor,1,1):n.setIcon(a.pathToImages+"arrowDown.gif",k);n.setClickHandler(c.minimize,c);n.init(b,k,k,h,1,1,h,1);d.setCN(a,n.set,"small-map-down");n=n.set;c.downButtonSet=n;e.push(n);var t=new d.SimpleButton;a.svgIcons?t.svgIcon=d.line(b,[-p/2,0,p/2],[p/4,-p/4,p/4],c.iconColor,1,1):t.setIcon(a.pathToImages+"arrowUp.gif",k);t.setClickHandler(c.maximize,c);t.init(b,k,k,h,1,1,h,1);d.setCN(a,t.set,"small-map-up");h=t.set;c.upButtonSet=h;h.hide();e.push(h);var r,q;isNaN(c.top)||(l=a.getY(c.top)+g,q=0);isNaN(c.bottom)||(l=a.getY(c.bottom,!0)-c.height-g,q=c.height-k+g/2);isNaN(c.left)||(m=a.getX(c.left)+g,r=-g/2);isNaN(c.right)||(m=a.getX(c.right,!0)-c.width-g,r=c.width-k+g/2);g=b.set();g.clipRect(1,1,c.width,c.height);f.push(g);c.rectangleC=g;e.translate(m,l);n.translate(r,q);h.translate(r,q);f.mouseup(function(){c.handleMouseUp()});c.drawRectangle()}else d.remove(c.allSet),d.remove(c.downButtonSet),d.remove(c.upButtonSet)},minimize:function(){this.downButtonSet.hide();this.upButtonSet.show();this.allSet.hide()},maximize:function(){this.downButtonSet.show();this.upButtonSet.hide();this.allSet.show()},buildSVGMap:function(){var a=this.chart,b={fill:this.mapColor,stroke:this.mapColor,"stroke-opacity":1},c=this.container,e=c.set();d.setCN(a,e,"small-map-image");var f;for(f=0;f<a.svgAreas.length;f++){var g=c.path(a.svgAreas[f].path).attr(b);e.push(g)}this.allSet.push(e);b=e.getBBox();c=this.size*a.mapScale;f=-b.x*c;var g=-b.y*c,h=0,k=0;a.centerMap&&(h=(this.width-b.width*c)/2,k=(this.height-b.height*c)/2);this.mapWidth=b.width*c;this.mapHeight=b.height*c;f+=h;g+=k;this.dx=h;this.dy=k;e.translate(f,g,c);this.mapSet=e;this.mapX=f;this.mapY=g},update:function(){var a=this.chart;if(a){var b=a.zoomLevel(),c=this.width,d=this.height,f=c/(a.realWidth*b),g=a.mapContainer.getBBox(),c=c/b,d=d/b,h=this.rectangle;h.translate(-(a.mapContainer.x+g.x*b)*f+this.dx,-(a.mapContainer.y+g.y*b)*f+this.dy);0<c&&0<d&&(h.setAttr("width",Math.ceil(c+1)),h.setAttr("height",Math.ceil(d+1)));this.rWidth=c;this.rHeight=d}},drawRectangle:function(){var a=this.rectangle;d.remove(a);a=d.rect(this.container,10,10,"#000",0,1,this.rectangleColor,1);d.setCN(this.chart,a,"small-map-rectangle");this.rectangleC.push(a);this.rectangle=a},handleMouseUp:function(){var a=this.chart,b=a.zoomLevel();a.zoomToMapXY(b,(a.mouseX-this.set.x-this.mapX)/this.size+a.diffX*a.mapScale,(a.mouseY-this.set.y-this.mapY)/this.size+a.diffY*a.mapScale)}})})();(function(){var d=window.AmCharts;d.AreasProcessor=d.Class({construct:function(a){this.chart=a},process:function(a){this.updateAllAreas();this.allObjects=[];a=a.areas;var b=this.chart;b.outlines=[];var c=a.length,d,f,g=0,h=!1,k=!1,l=0;for(d=0;d<c;d++)if(f=a[d],f=f.value,!isNaN(f)){if(!1===h||h<f)h=f;if(!1===k||k>f)k=f;g+=Math.abs(f);l++}this.minValue=k;this.maxValue=h;isNaN(b.minValue)||(this.minValue=b.minValue);isNaN(b.maxValue)||(this.maxValue=b.maxValue);b.maxValueReal=h;b.minValueReal=k;for(d=0;d<c;d++)f=a[d],isNaN(f.value)?f.percents=void 0:(f.percents=(f.value-k)/g*100,k==h&&(f.percents=100));for(d=0;d<c;d++)f=a[d],this.createArea(f);b.outlinesToFront()},updateAllAreas:function(){var a=this.chart,b=a.areasSettings,c=b.unlistedAreasColor,e=b.unlistedAreasAlpha,f=b.unlistedAreasOutlineColor,g=b.unlistedAreasOutlineAlpha,h=a.svgAreas,k=a.dataProvider,l=k.areas,m={},n;for(n=0;n<l.length;n++)m[l[n].id]=l[n];for(n=0;n<h.length;n++){l=h[n];if(b.preserveOriginalAttributes){if(l.customAttr)for(var p in l.customAttr)l.setAttr(p,l.customAttr[p])}else{void 0!=c&&l.setAttr("fill",c);isNaN(e)||l.setAttr("fill-opacity",e);void 0!=f&&l.setAttr("stroke",f);isNaN(g)||l.setAttr("stroke-opacity",g);var t=b.outlineThickness;b.adjustOutlineThickness&&(t=t/a.zoomLevel()/a.mapScale);l.setAttr("stroke-width",t)}d.setCN(a,l,"map-area-unlisted");k.getAreasFromMap&&!m[l.id]&&(t=new d.MapArea(a.theme),t.parentObject=k,t.id=l.id,t.outline=l.outline,k.areas.push(t))}},createArea:function(a){var b=this.chart,c=b.svgAreasById[a.id],e=b.areasSettings;if(c&&c.className){var f=b.areasClasses[c.className];f&&(e=d.processObject(f,d.AreasSettings,b.theme))}var g=e.color,h=e.alpha,k=e.outlineThickness,l=e.rollOverColor,m=e.selectedColor,n=e.rollOverAlpha,p=e.rollOverBrightness,t=e.outlineColor,r=e.outlineAlpha,q=e.balloonText,y=e.selectable,B=e.pattern,u=e.rollOverOutlineColor,w=e.bringForwardOnHover,v=e.preserveOriginalAttributes;this.allObjects.push(a);a.chart=b;a.baseSettings=e;a.autoZoomReal=void 0==a.autoZoom?e.autoZoom:a.autoZoom;f=a.color;void 0==f&&(f=g);var A=a.alpha;isNaN(A)&&(A=h);h=a.rollOverAlpha;isNaN(h)&&(h=n);isNaN(h)&&(h=A);n=a.rollOverColor;void 0==n&&(n=l);l=a.pattern;void 0==l&&(l=B);B=a.selectedColor;void 0==B&&(B=m);m=a.balloonText;void 0===m&&(m=q);void 0==e.colorSolid||isNaN(a.value)||(q=Math.floor((a.value-this.minValue)/((this.maxValue-this.minValue)/b.colorSteps)),q==b.colorSteps&&q--,q*=1/(b.colorSteps-1),this.maxValue==this.minValue&&(q=1),a.colorReal=d.getColorFade(f,e.colorSolid,q));void 0!=a.color&&(a.colorReal=a.color);void 0==a.selectable&&(a.selectable=y);void 0==a.colorReal&&(a.colorReal=g);g=a.outlineColor;void 0==g&&(g=t);t=a.outlineAlpha;isNaN(t)&&(t=r);r=a.outlineThickness;isNaN(r)&&(r=k);k=a.rollOverOutlineColor;void 0==k&&(k=u);u=a.rollOverBrightness;void 0==u&&(u=p);void 0==a.bringForwardOnHover&&(a.bringForwardOnHover=w);void 0==a.preserveOriginalAttributes&&(a.preserveOriginalAttributes=v);isNaN(e.selectedBrightness)||(B=d.adjustLuminosity(a.colorReal,e.selectedBrightness/100));a.alphaReal=A;a.rollOverColorReal=n;a.rollOverAlphaReal=h;a.balloonTextReal=m;a.selectedColorReal=B;a.outlineColorReal=g;a.outlineAlphaReal=t;a.rollOverOutlineColorReal=k;a.outlineThicknessReal=r;a.patternReal=l;a.rollOverBrightnessReal=u;a.accessibleLabel||(a.accessibleLabel=e.accessibleLabel);d.processDescriptionWindow(e,a);if(c&&(p=c.area,w=c.title,a.enTitle=c.title,w&&!a.title&&(a.title=w),(c=b.language)?(w=d.mapTranslations)&&(c=w[c])&&c[a.enTitle]&&(a.titleTr=c[a.enTitle]):a.titleTr=void 0,p)){c=a.tabIndex;void 0===c&&(c=e.tabIndex);void 0!==c&&p.setAttr("tabindex",c);a.displayObject=p;a.outline&&(A=0,a.alphaReal=0,a.rollOverAlphaReal=0,a.mouseEnabled=!1,b.outlines.push(p),p.node.setAttribute("pointer-events","none"));a.mouseEnabled&&b.addObjectEventListeners(p,a);var C;void 0!=f&&(C=f);void 0!=a.colorReal&&(C=a.showAsSelected||b.selectedObject==a?a.selectedColorReal:a.colorReal);p.node.setAttribute("class","");d.setCN(b,p,"map-area");d.setCN(b,p,"map-area-"+p.id);e.adjustOutlineThickness&&(r=r/b.zoomLevel()/b.mapScale);a.preserveOriginalAttributes||(p.setAttr("fill",C),p.setAttr("stroke",g),p.setAttr("stroke-opacity",t),p.setAttr("stroke-width",r),p.setAttr("fill-opacity",A));b.makeObjectAccessible(a);l&&p.pattern(l,b.mapScale,b.path);a.hidden&&p.hide()}}})})();(function(){var d=window.AmCharts;d.AreasSettings=d.Class({construct:function(a){this.cname="AreasSettings";this.alpha=1;this.autoZoom=!1;this.balloonText="[[title]]";this.color="#FFCC00";this.colorSolid="#990000";this.unlistedAreasAlpha=1;this.unlistedAreasColor="#DDDDDD";this.outlineColor="#FFFFFF";this.outlineThickness=this.outlineAlpha=1;this.selectedColor=this.rollOverOutlineColor="#CC0000";this.unlistedAreasOutlineColor="#FFFFFF";this.unlistedAreasOutlineAlpha=1;this.descriptionWindowWidth=250;this.bringForwardOnHover=this.adjustOutlineThickness=!0;this.accessibleLabel="[[title]] [[value]] [[description]]";d.applyTheme(this,a,this.cname)}})})();(function(){var d=window.AmCharts;d.ImagesProcessor=d.Class({construct:function(a){this.chart=a;this.reset()},process:function(a){var b=a.images,c;for(c=0;c<b.length;c++){var d=b[c];this.createImage(d,c);d.parentArray=b}this.counter=c;a.parentObject&&a.remainVisible&&this.process(a.parentObject)},createImage:function(a,b){a=d.processObject(a,d.MapImage);a.arrays=[];isNaN(b)&&(this.counter++,b=this.counter);var c=this.chart,e=c.container,f=c.mapImagesContainer,g=c.stageImagesContainer,h=c.imagesSettings;a.remove&&a.remove();var k=h.color,l=h.alpha,m=h.rollOverColor,n=h.rollOverOutlineColor,p=h.selectedColor,t=h.balloonText,r=h.outlineColor,q=h.outlineAlpha,y=h.outlineThickness,B=h.selectedScale,u=h.rollOverScale,w=h.selectable,v=h.labelPosition,A=h.labelColor,C=h.labelFontSize,x=h.bringForwardOnHover,z=h.labelRollOverColor,F=h.rollOverBrightness,E=h.selectedLabelColor;a.index=b;a.chart=c;a.baseSettings=c.imagesSettings;var H=e.set();a.displayObject=H;var G=a.color;void 0==G&&(G=k);k=a.alpha;isNaN(k)&&(k=l);void 0==a.bringForwardOnHover&&(a.bringForwardOnHover=x);l=a.outlineAlpha;isNaN(l)&&(l=q);q=a.rollOverColor;void 0==q&&(q=m);m=a.selectedColor;void 0==m&&(m=p);p=a.balloonText;void 0===p&&(p=t);t=a.outlineColor;void 0==t&&(t=r);a.outlineColorReal=t;r=a.outlineThickness;isNaN(r)&&(r=y);(y=a.labelPosition)||(y=v);v=a.labelColor;void 0==v&&(v=A);A=a.labelRollOverColor;void 0==A&&(A=z);z=a.selectedLabelColor;void 0==z&&(z=E);E=a.labelFontSize;isNaN(E)&&(E=C);C=a.selectedScale;isNaN(C)&&(C=B);B=a.rollOverScale;isNaN(B)&&(B=u);u=a.rollOverBrightness;void 0==u&&(u=F);void 0==a.selectable&&(a.selectable=w);a.colorReal=G;isNaN(h.selectedBrightness)||(m=d.adjustLuminosity(a.colorReal,h.selectedBrightness/100));a.alphaReal=k;a.rollOverColorReal=q;a.balloonTextReal=p;a.selectedColorReal=m;a.labelColorReal=v;a.labelRollOverColorReal=A;a.selectedLabelColorReal=z;a.labelFontSizeReal=E;a.labelPositionReal=y;a.selectedScaleReal=C;a.rollOverScaleReal=B;a.rollOverOutlineColorReal=n;a.rollOverBrightnessReal=u;a.accessibleLabel||(a.accessibleLabel=h.accessibleLabel);d.processDescriptionWindow(h,a);a.centeredReal=void 0==a.centered?h.centered:a.centered;n=a.type;u=a.imageURL;B=a.svgPath;C=a.width;E=a.height;w=a.scale;isNaN(a.percentWidth)||(C=a.percentWidth/100*c.realWidth);isNaN(a.percentHeight)||(E=a.percentHeight/100*c.realHeight);var D;u||n||B||(n="circle",C=1,l=k=0);q=F=0;h=a.selectedColorReal;if(n){isNaN(C)&&(C=10);isNaN(E)&&(E=10);"kilometers"==a.widthAndHeightUnits&&(C=c.kilometersToPixels(a.width),E=c.kilometersToPixels(a.height));"miles"==a.widthAndHeightUnits&&(C=c.milesToPixels(a.width),E=c.milesToPixels(a.height));if("circle"==n||"bubble"==n)E=C;D=this.createPredefinedImage(G,t,r,n,C,E);q=F=0;a.centeredReal?(isNaN(a.right)||(F=C*w),isNaN(a.bottom)||(q=E*w)):(F=C*w/2,q=E*w/2);D.translate(F,q,w,!0)}else u?(isNaN(C)&&(C=10),isNaN(E)&&(E=10),D=e.image(u,0,0,C,E),D.node.setAttribute("preserveAspectRatio","none"),D.setAttr("opacity",k),a.centeredReal&&(F=isNaN(a.right)?-C/2:C/2,q=isNaN(a.bottom)?-E/2:E/2,D.translate(F,q,NaN,!0))):B&&(D=e.path(B),u=D.getBBox(),a.centeredReal?(F=-u.x*w-u.width*w/2,isNaN(a.right)||(F=-F),q=-u.y*w-u.height*w/2,isNaN(a.bottom)||(q=-q)):F=q=0,D.translate(F,q,w,!0),D.x=F,D.y=q);D&&(H.push(D),a.image=D,D.setAttr("stroke-opacity",l),D.setAttr("stroke-width",r),D.setAttr("stroke",t),D.setAttr("fill-opacity",k),"bubble"!=n&&D.setAttr("fill",G),d.setCN(c,D,"map-image"),void 0!=a.id&&d.setCN(c,D,"map-image-"+a.id));G=a.labelColorReal;!a.showAsSelected&&c.selectedObject!=a||void 0==h||(D.setAttr("fill",h),G=a.selectedLabelColorReal);D=null;void 0!==a.label&&(D=d.text(e,a.label,G,c.fontFamily,a.labelFontSizeReal,a.labelAlign),d.setCN(c,D,"map-image-label"),void 0!==a.id&&d.setCN(c,D,"map-image-label-"+a.id),G=a.labelBackgroundAlpha,(k=a.labelBackgroundColor)&&0<G&&(l=D.getBBox(),e=d.rect(e,l.width+16,l.height+10,k,G),d.setCN(c,e,"map-image-label-background"),void 0!=a.id&&d.setCN(c,e,"map-image-label-background-"+a.id),H.push(e),a.labelBG=e),a.imageLabel=D,H.push(D),d.setCN(c,H,"map-image-container"),void 0!=a.id&&d.setCN(c,H,"map-image-container-"+a.id),this.labelsToReposition.push(a),a.arrays.push({arr:this.labelsToReposition,el:a}));e=isNaN(a.latitude)||isNaN(a.longitude)?!0:!1;a.lineId&&(D=this.chart.getObjectById(a.lineId))&&0<D.longitudes.length&&(e=!1);e?g.push(H):f.push(H);H&&(H.rotation=a.rotation,isNaN(a.rotation)||H.rotate(a.rotation),a.arrays.push({arr:this.allSvgObjects,el:H}),this.allSvgObjects.push(H));this.allObjects.push(a);c.makeObjectAccessible(a);f=a.tabIndex;void 0===f&&(f=c.imagesSettings.tabIndex);void 0!==f&&H.setAttr("tabindex",f);a.arrays.push({arr:this.allObjects,el:a});isNaN(a.longitude)||isNaN(a.latitude)||!a.fixedSize||(a.objToResize={image:H,mapImage:a,scale:1},this.objectsToResize.push(a.objToResize),a.arrays.push({arr:this.objectsToResize,el:a.objToResize}));this.updateSizeAndPosition(a);a.mouseEnabled&&c.addObjectEventListeners(H,a);a.hidden&&H.hide();d.removeFromArray(c.updatableImages,a);a.animateAlongLine&&(c.updatableImages.push(a),a.delayAnimateAlong());return a},updateSizeAndPosition:function(a){var b=this.chart,c=a.displayObject,e=b.getX(a.left),f=b.getY(a.top),g,h=a.image.getBBox();isNaN(a.right)||(e=b.getX(a.right,!0)-h.width*a.scale);isNaN(a.bottom)||(f=b.getY(a.bottom,!0)-h.height*a.scale);var k=a.longitude,l=a.latitude,m=a.positionOnLine,h=a.imageLabel,n=this.chart.zoomLevel(),p,t;a.lineId&&(a.line=this.chart.getObjectById(a.lineId));if(a.line&&a.line.getCoordinates){a.line.chart=b;var r=a.line.getCoordinates(m,a.lineSegment);r&&(k=b.coordinateToLongitude(r.x),l=b.coordinateToLatitude(r.y),p=r.x,t=r.y,a.animateAngle&&(g=d.radiansToDegrees(r.angle)))}isNaN(g)||c.rotate(g+a.extraAngle);if(!isNaN(e)&&!isNaN(f))c.translate(e,f,NaN,!0);else if(!isNaN(l)&&!isNaN(k))if(f=b.coordinatesToXY(k,l),e=f.x,f=f.y,isNaN(p)||(e=p),isNaN(t)||(f=t),a.fixedSize){p=a.positionScale;isNaN(p)?p=0:(--p,p*=1-2*Math.abs(m-.5));if(m=a.objectToResize)m.scale=1+p;c.translate(e,f,1/n+p,!0)}else c.translate(e,f,NaN,!0);this.positionLabel(h,a,a.labelPositionReal)},positionLabel:function(a,b,c){if(a){var d=b.image,f=0,g=0,h=0,k=0;d&&(k=d.getBBox(),g=d.y+k.y,f=d.x+k.x,h=k.width,k=k.height,b.svgPath&&(h*=b.scale,k*=b.scale));var d=a.getBBox(),l=d.width,m=d.height;"right"==c&&(f+=h+l/2+5,g+=k/2-2);"left"==c&&(f+=-l/2-5,g+=k/2-2);"top"==c&&(g-=m/2+3,f+=h/2);"bottom"==c&&(g+=k+m/2,f+=h/2);"middle"==c&&(f+=h/2,g+=k/2);a.translate(f+b.labelShiftX,g+b.labelShiftY,NaN,!0);a=b.labelFontSizeReal;b.labelBG&&b.labelBG.translate(f-d.width/2+b.labelShiftX-9,g-a/2+b.labelShiftY-4,NaN,!0)}},createPredefinedImage:function(a,b,c,e,f,g){var h=this.chart.container,k;switch(e){case"circle":k=d.circle(h,f/2,a,1,c,b,1);break;case"rectangle":k=d.polygon(h,[-f/2,f/2,f/2,-f/2],[g/2,g/2,-g/2,-g/2],a,1,c,b,1,0,!0);break;case"bubble":k=d.circle(h,f/2,a,1,c,b,1,!0);break;case"hexagon":f/=Math.sqrt(3),k=d.polygon(h,[.866*f,0*f,-.866*f,-.866*f,0*f,.866*f],[.5*f,1*f,.5*f,-.5*f,-1*f,-.5*f],a,1,c,b,1)}return k},reset:function(){this.objectsToResize=[];this.allSvgObjects=[];this.allObjects=[];this.allLabels=[];this.labelsToReposition=[]}})})();(function(){var d=window.AmCharts;d.ImagesSettings=d.Class({construct:function(a){this.cname="ImagesSettings";this.balloonText="[[title]]";this.alpha=1;this.borderAlpha=0;this.borderThickness=1;this.labelPosition="right";this.labelColor="#000000";this.labelFontSize=11;this.color="#000000";this.labelRollOverColor="#00CC00";this.centered=!0;this.rollOverScale=this.selectedScale=1;this.descriptionWindowWidth=250;this.bringForwardOnHover=!0;this.outlineColor="transparent";this.adjustAnimationSpeed=!1;this.baseAnimationDistance=500;this.pauseDuration=0;this.easingFunction=d.easeInOutQuad;this.animationDuration=3;this.positionScale=1;this.accessibleLabel="[[title]] [[description]]";d.applyTheme(this,a,this.cname)}})})();(function(){var d=window.AmCharts;d.LinesProcessor=d.Class({construct:function(a){this.chart=a;this.reset()},process:function(a){var b=a.lines,c;for(c=0;c<b.length;c++){var d=b[c];this.createLine(d,c);d.parentArray=b}this.counter=c;a.parentObject&&a.remainVisible&&this.process(a.parentObject)},createLine:function(a,b){a=d.processObject(a,d.MapLine);isNaN(b)&&(this.counter++,b=this.counter);a.index=b;a.remove&&a.remove();var c=this.chart,e=c.linesSettings,f=this.objectsToResize,g=c.mapLinesContainer,h=c.stageLinesContainer,k=e.thickness,l=e.dashLength,m=e.arrow,n=e.arrowSize,p=e.arrowColor,t=e.arrowAlpha,r=e.color,q=e.alpha,y=e.rollOverColor,B=e.selectedColor,u=e.rollOverAlpha,w=e.balloonText,v=e.bringForwardOnHover,A=e.arc,C=e.rollOverBrightness,x=c.container;a.chart=c;a.baseSettings=e;var z=x.set();a.displayObject=z;var F=a.tabIndex;void 0===F&&(F=e.tabIndex);void 0!==F&&z.setAttr("tabindex",F);this.allSvgObjects.push(z);a.arrays.push({arr:this.allSvgObjects,el:z});this.allObjects.push(a);a.arrays.push({arr:this.allObjects,el:a});a.mouseEnabled&&c.addObjectEventListeners(z,a);if(a.remainVisible||c.selectedObject==a.parentObject){F=a.thickness;isNaN(F)&&(F=k);k=a.dashLength;isNaN(k)&&(k=l);l=a.color;void 0==l&&(l=r);r=a.alpha;isNaN(r)&&(r=q);q=a.rollOverAlpha;isNaN(q)&&(q=u);isNaN(q)&&(q=r);u=a.rollOverColor;void 0==u&&(u=y);y=a.selectedColor;void 0==y&&(y=B);B=a.balloonText;void 0===B&&(B=w);w=a.arc;isNaN(w)&&(w=A);A=a.arrow;if(!A||"none"==A&&"none"!=m)A=m;m=a.arrowColor;void 0==m&&(m=p);void 0==m&&(m=l);p=a.arrowAlpha;isNaN(p)&&(p=t);isNaN(p)&&(p=r);t=a.arrowSize;isNaN(t)&&(t=n);n=a.rollOverBrightness;void 0==n&&(n=C);a.colorReal=l;a.arrowColor=m;isNaN(e.selectedBrightness)||(y=d.adjustLuminosity(a.colorReal,e.selectedBrightness/100));a.alphaReal=r;a.rollOverColorReal=u;a.rollOverAlphaReal=q;a.balloonTextReal=B;a.selectedColorReal=y;a.thicknessReal=F;a.rollOverBrightnessReal=n;a.accessibleLabel||(a.accessibleLabel=e.accessibleLabel);void 0===a.shiftArrow&&(a.shiftArrow=e.shiftArrow);void 0==a.bringForwardOnHover&&(a.bringForwardOnHover=v);d.processDescriptionWindow(e,a);v=this.processCoordinates(a.x,c.realWidth);C=this.processCoordinates(a.y,c.realHeight);n=a.longitudes;e=a.latitudes;q=n.length;if(0<q)for(v=[],C=[],u=0;u<q;u++)B=c.coordinatesToXY(n[u],e[u]),v.push(B.x),C.push(B.y);if(0<v.length){a.segments=v.length;d.dx=0;d.dy=0;var E,H,G,q=10*(1-Math.abs(w));10<=q&&(q=NaN);1>q&&(q=1);a.arcRadius=[];a.distances=[];n=c.mapContainer.scale;if(isNaN(q)){for(q=0;q<v.length-1;q++)H=Math.sqrt(Math.pow(v[q+1]-v[q],2)+Math.pow(C[q+1]-C[q],2)),a.distances[q]=H;q=d.line(x,v,C,l,1,F/n,k,!1,!1,!0);l=d.line(x,v,C,l,.001,5/n,k,!1,!1,!0);q.setAttr("stroke-linecap","round")}else{u=1;0>w&&(u=0);B={fill:"none",stroke:l,"stroke-opacity":1,"stroke-width":F/n,"fill-opacity":0,"stroke-linecap":"round"};void 0!==k&&0<k&&(B["stroke-dasharray"]=k);for(var k="",D=0;D<v.length-1;D++){var K=v[D],J=v[D+1],L=C[D],O=C[D+1];H=Math.sqrt(Math.pow(J-K,2)+Math.pow(O-L,2));G=H/2*q;E=270+180*Math.acos(H/2/G)/Math.PI;isNaN(E)&&(E=270);if(K<J){var P=K,K=J,J=P,P=L,L=O,O=P;E=-E}0<w&&(E=-E);k+="M"+K+","+L+"A"+G+","+G+",0,0,"+u+","+J+","+O;a.arcRadius[D]=G;a.distances[D]=H}q=x.path(k).attr(B);l=x.path(k).attr({"fill-opacity":0,stroke:l,"stroke-width":5/n,"stroke-opacity":.001,fill:"none"})}d.setCN(c,q,"map-line");void 0!=a.id&&d.setCN(c,q,"map-line-"+a.id);d.dx=.5;d.dy=.5;z.push(q);z.push(l);q.setAttr("opacity",r);if("none"!=A){var I,M,N;if("end"==A||"both"==A)u=v[v.length-1],D=C[C.length-1],1<v.length?(B=v[v.length-2],I=C[C.length-2]):(B=u,I=D),I=180*Math.atan((D-I)/(u-B))/Math.PI,isNaN(E)||(I+=E),M=u,N=D,I=0>u-B?I-90:I+90;r=[-t/2-.5,-.5,t/2-.5];k=[t,-.5,t];a.shiftArrow&&"middle"!=A&&(k=[0,1.2*-t,0]);"both"==A&&(t=d.polygon(x,r,k,m,p,1,m,p,void 0,!0),z.push(t),t.translate(M,N,1/n,!0),isNaN(I)||t.rotate(I),d.setCN(c,q,"map-line-arrow"),void 0!=a.id&&d.setCN(c,q,"map-line-arrow-"+a.id),a.fixedSize&&f.push(t));if("start"==A||"both"==A)t=v[0],N=C[0],1<v.length?(u=v[1],M=C[1]):(u=t,M=N),I=180*Math.atan((N-M)/(t-u))/Math.PI,isNaN(E)||(I-=E),M=t,I=0>t-u?I-90:I+90;"middle"==A&&(u=v[v.length-1],D=C[C.length-1],1<v.length?(B=v[v.length-2],I=C[C.length-2]):(B=u,I=D),M=B+(u-B)/2,N=I+(D-I)/2,I=180*Math.atan((D-I)/(u-B))/Math.PI,isNaN(E)||(E=H/2,G-=Math.sqrt(G*G-E*E),0>w&&(G=-G),E=Math.sin(I/180*Math.PI),-1==E&&(E=1),M-=E*G,N+=Math.cos(I/180*Math.PI)*G),I=0>u-B?I-90:I+90);t=d.polygon(x,r,k,m,p,1,m,p,void 0,!0);d.setCN(c,q,"map-line-arrow");void 0!=a.id&&d.setCN(c,q,"map-line-arrow-"+a.id);z.push(t);t.translate(M,N,1/n,!0);isNaN(I)||t.rotate(I);a.fixedSize&&(f.push(t),a.arrays.push({arr:f,el:t}));a.arrowSvg=t}a.fixedSize&&q&&(f={line:q,thickness:F},this.linesToResize.push(f),a.arrays.push({arr:this.linesToResize,el:f}),f={line:l,thickness:5},this.linesToResize.push(f),a.arrays.push({arr:this.linesToResize,el:f}));a.lineSvg=q;a.showAsSelected&&!isNaN(y)&&q.setAttr("stroke",y);0<e.length?g.push(z):h.push(z);a.hidden&&z.hide();c.makeObjectAccessible(a)}}},processCoordinates:function(a,b){var c=[],d;for(d=0;d<a.length;d++){var f=a[d],g=Number(f);isNaN(g)&&(g=Number(f.replace("%",""))*b/100);isNaN(g)||c.push(g)}return c},reset:function(){this.objectsToResize=[];this.allSvgObjects=[];this.allObjects=[];this.linesToResize=[]}})})();(function(){var d=window.AmCharts;d.LinesSettings=d.Class({construct:function(a){this.cname="LinesSettings";this.balloonText="[[title]]";this.thickness=1;this.dashLength=0;this.arrowSize=10;this.arrowAlpha=1;this.arrow="none";this.color="#990000";this.descriptionWindowWidth=250;this.bringForwardOnHover=!0;d.applyTheme(this,a,this.cname)}})})();(function(){var d=window.AmCharts;d.MapObject=d.Class({construct:function(a){this.fixedSize=this.mouseEnabled=!0;this.images=[];this.lines=[];this.areas=[];this.remainVisible=!0;this.passZoomValuesToTarget=!1;this.objectType=this.cname;d.applyTheme(this,a,"MapObject");this.arrays=[]},deleteObject:function(){this.remove();this.parentArray&&d.removeFromArray(this.parentArray,this);if(this.arrays)for(var a=0;a<this.arrays.length;a++)d.removeFromArray(this.arrays[a].arr,this.arrays[a].el);this.arrays=[]}})})();(function(){var d=window.AmCharts;d.MapArea=d.Class({inherits:d.MapObject,construct:function(a){this.cname="MapArea";d.MapArea.base.construct.call(this,a);d.applyTheme(this,a,this.cname)},validate:function(){this.chart.areasProcessor.createArea(this)}})})();(function(){var d=window.AmCharts;d.MapLine=d.Class({inherits:d.MapObject,construct:function(a){this.cname="MapLine";this.longitudes=[];this.latitudes=[];this.x=[];this.y=[];this.segments=0;this.arrow="none";d.MapLine.base.construct.call(this,a);d.applyTheme(this,a,this.cname)},validate:function(){this.chart.linesProcessor.createLine(this)},remove:function(){var a=this.displayObject;a&&a.remove()},getCoordinates:function(a,b){isNaN(b)&&(b=0);isNaN(this.arc)||this.isValid||(this.isValid=!0,this.validate());if(!isNaN(a)){var c,e,f,g,h,k;if(1<this.longitudes.length){e=this.chart.coordinatesToXY(this.longitudes[b],this.latitudes[b]);var l=this.chart.coordinatesToXY(this.longitudes[b+1],this.latitudes[b+1]);c=e.x;f=l.x;e=e.y;g=l.y}else 1<this.x.length&&(c=this.x[b],f=this.x[b+1],e=this.y[b],g=this.y[b+1]);l=Math.sqrt(Math.pow(f-c,2)+Math.pow(g-e,2));c<f&&!isNaN(this.arc)&&0!==this.arc&&(a=1-a);h=c+(f-c)*a;k=e+(g-e)*a;var m=Math.atan2(g-e,f-c);if(!isNaN(this.arc)&&0!==this.arc&&this.arcRadius){var n=0;c<f&&(n=c,c=f,f=n,n=e,e=g,g=n,n=Math.PI);k=this.arcRadius[b];0>this.arc&&(l=-l);h=c+(f-c)/2+Math.sqrt(k*k-l/2*(l/2))*(e-g)/l;var p=e+(g-e)/2+Math.sqrt(k*k-l/2*(l/2))*(f-c)/l;c=180*Math.atan2(e-p,c-h)/Math.PI;f=180*Math.atan2(g-p,f-h)/Math.PI;180<f-c&&(f-=360);m=d.degreesToRadians(c+(f-c)*a);h+=k*Math.cos(m);k=p+k*Math.sin(m);m=0<this.arc?m+Math.PI/2:m-Math.PI/2;m+=n}this.distance=l;return{x:h,y:k,angle:m}}},fixToStage:function(){if(0<this.latitudes.length){this.y=[];for(var a=0;a<this.latitudes.length;a++){var b=this.chart.coordinatesToStageXY(this.longitudes[a],this.latitudes[a]);this.y.push(b.y);this.x.push(b.x)}this.latitudes=[];this.longitudes=[]}this.validate()},fixToMap:function(){if(0<this.y.length){this.latitudes=[];for(var a=0;a<this.y.length;a++){var b=this.chart.stageXYToCoordinates(this.x[a],this.y[a]);this.latitudes.push(b.latitude);this.longitudes.push(b.longitude)}this.y=[];this.x=[]}this.validate()}})})();(function(){var d=window.AmCharts;d.MapImage=d.Class({inherits:d.MapObject,construct:function(a){this.cname="MapImage";this.scale=1;this.widthAndHeightUnits="pixels";this.labelShiftY=this.labelShiftX=0;this.positionOnLine=.5;this.direction=1;this.lineSegment=this.extraAngle=0;this.animateAngle=!0;this.createEvents("animationStart","animationEnd");d.MapImage.base.construct.call(this,a);d.applyTheme(this,a,this.cname);this.delayCounter=0},validate:function(){this.chart.imagesProcessor.createImage(this)},updatePosition:function(){this.chart.imagesProcessor.updateSizeAndPosition(this)},remove:function(){var a=this.displayObject;a&&a.remove();(a=this.imageLabel)&&a.remove()},animateTo:function(a,b,c,d){isNaN(c)||(this.animationDuration=c);d&&(this.easingFunction=d);this.finalX=a;this.finalY=b;isNaN(this.longitude)||(this.initialX=this.longitude);isNaN(this.left)||(this.initialX=this.left);isNaN(this.right)||(this.initialX=this.right);isNaN(this.latitude)||(this.initialY=this.latitude);isNaN(this.top)||(this.initialY=this.top);isNaN(this.bottom)||(this.initialY=this.bottom);this.animatingAlong=!1;this.animate()},animateAlong:function(a,b,c){1==this.positionOnLine&&this.flipDirection&&(this.direction=-1,this.extraAngle=180);isNaN(b)||(this.animationDuration=b);c&&(this.easingFunction=c);a&&(this.line=this.chart.getObjectById(a));this.animateAlongLine=this.line;this.animatingAlong=!0;this.animate()},animate:function(){var a=this.chart.imagesSettings,b=this.animationDuration;isNaN(b)&&(b=a.animationDuration);this.totalFrames=b*d.updateRate;b=1;this.line&&a.adjustAnimationSpeed&&(this.line.distances&&(b=this.line.distances[this.lineSegment]*this.chart.zoomLevel(),b=Math.abs(b/a.baseAnimationDistance)),this.totalFrames=Math.round(b*this.totalFrames));this.frame=0;this.fire({type:"animationStart",chart:this.chart,image:this,lineSegment:this.lineSegment,direction:this.direction})},update:function(){var a=this.totalFrames;this.frame++;this.delayCounter--;0===this.delayCounter&&this.animateAlong();if(!(0<this.delayCounter))if(this.frame<=a){this.updatePosition();var b=this.chart.imagesSettings,c=this.easingFunction;c||(c=b.easingFunction);a=c(0,this.frame,0,1,a);-1==this.direction&&(a=1-a);this.animatingAlong?this.positionOnLine=a:(b=this.initialX+(this.finalX-this.initialX)*a,isNaN(this.longitude)||(this.longitude=b),isNaN(this.left)||(this.left=b),isNaN(this.right)||(this.right=b),a=this.initialY+(this.finalY-this.initialY)*a,isNaN(this.latitude)||(this.latitude=a),isNaN(this.top)||(this.top=a),isNaN(this.bottom)||(this.bottom=a))}else this.frame==a+1&&(this.fire({type:"animationEnd",chart:this.chart,image:this,lineSegment:this.lineSegment,direction:this.direction}),this.line&&this.animatingAlong&&(1==this.direction?this.lineSegment<this.line.segments-2?(this.lineSegment++,this.delayAnimateAlong(),this.positionOnLine=0):this.flipDirection?(this.direction=-1,this.extraAngle=180,this.delayAnimateAlong()):this.loop&&(this.delayAnimateAlong(),this.lineSegment=0):0<this.lineSegment?(this.lineSegment--,this.delayAnimateAlong(),this.positionOnLine=0):this.loop&&this.flipDirection?(this.direction=1,this.extraAngle=0,this.delayAnimateAlong()):this.loop&&this.delayAnimateAlong()))},delayAnimateAlong:function(){this.animateAlongLine&&(this.delayCounter=this.chart.imagesSettings.pauseDuration*d.updateRate)},fixToStage:function(){if(!isNaN(this.longitude)){var a=this.chart.coordinatesToStageXY(this.longitude,this.latitude);this.left=a.x;this.top=a.y;this.latitude=this.longitude=void 0}this.validate()},fixToMap:function(){if(!isNaN(this.left)){var a=this.chart.stageXYToCoordinates(this.left,this.top);this.longitude=a.longitude;this.latitude=a.latitude;this.top=this.left=void 0}this.validate()}})})();(function(){var d=window.AmCharts;d.degreesToRadians=function(a){return a/180*Math.PI};d.radiansToDegrees=function(a){return a/Math.PI*180};d.getColorFade=function(a,b,c){var e=d.hex2RGB(b);b=e[0];var f=e[1],e=e[2],g=d.hex2RGB(a);a=g[0];var h=g[1],g=g[2];a+=Math.round((b-a)*c);h+=Math.round((f-h)*c);g+=Math.round((e-g)*c);return"rgb("+a+","+h+","+g+")"};d.hex2RGB=function(a){return[parseInt(a.substring(1,3),16),parseInt(a.substring(3,5),16),parseInt(a.substring(5,7),16)]};d.processDescriptionWindow=function(a,b){isNaN(b.descriptionWindowX)&&(b.descriptionWindowX=a.descriptionWindowX);isNaN(b.descriptionWindowY)&&(b.descriptionWindowY=a.descriptionWindowY);isNaN(b.descriptionWindowLeft)&&(b.descriptionWindowLeft=a.descriptionWindowLeft);isNaN(b.descriptionWindowRight)&&(b.descriptionWindowRight=a.descriptionWindowRight);isNaN(b.descriptionWindowTop)&&(b.descriptionWindowTop=a.descriptionWindowTop);isNaN(b.descriptionWindowBottom)&&(b.descriptionWindowBottom=a.descriptionWindowBottom);isNaN(b.descriptionWindowWidth)&&(b.descriptionWindowWidth=a.descriptionWindowWidth);isNaN(b.descriptionWindowHeight)&&(b.descriptionWindowHeight=a.descriptionWindowHeight)};d.normalizePath=function(a){for(var b="",c=d.parsePath(a.getAttribute("d")),e,f,g=Infinity,h=-Infinity,k=Infinity,l=-Infinity,m=0;m<c.length;m++){var n=c[m],p=n.letter,t=n.x,n=n.y;"h"==p&&(p="L",t+=e,n=f);"H"==p&&(p="L",n=f);"v"==p&&(p="L",t=e,n+=f);"V"==p&&(p="L",t=e);if("m"===p||"l"===p)p=p.toUpperCase(),t+=e,n+=f;t=d.roundTo(t,3);n=d.roundTo(n,3);e=t;f=n;t>h&&(h=t);t<g&&(g=t);n>l&&(l=n);n<k&&(k=n);b="z"==p.toLowerCase()?b+"Z ":b+(p+" "+t+" "+n+" ")}a.setAttribute("d",b);return{minX:g,maxX:h,minY:k,maxY:l}};d.mercatorLatitudeToRadians=function(a){return Math.log(Math.tan(Math.PI/4+d.degreesToRadians(a)/2))};d.parsePath=function(a){a=a.match(/([MmLlHhVvZz]{1}[0-9.,\-\s]*)/g);for(var b=[],c=0;c<a.length;c++){var d=a[c].match(/([MmLlHhVvZz]{1})|([0-9.\-]+)/g),f={letter:d[0]};switch(d[0]){case"Z":case"Z":case"z":break;case"V":case"v":f.y=Number(d[1]);break;case"H":case"h":f.x=Number(d[1]);break;default:f.x=Number(d[1]),f.y=Number(d[2])}b.push(f)}return b};d.acos=function(a){return 1<a?0:-1>a?Math.PI:Math.acos(a)};d.asin=function(a){return 1<a?Math.PI/2:-1>a?-Math.PI/2:Math.asin(a)};d.sinci=function(a){return a?a/Math.sin(a):1};d.asqrt=function(a){return 0<a?Math.sqrt(a):0};d.winkel3=function(a,b){var c=d.aitoff(a,b);return[(c[0]+a/Math.PI*2)/2,(c[1]+b)/2]};d.winkel3.invert=function(a,b){var c=a,e=b,f=25,g=Math.PI/2;do{var h=Math.cos(e),k=Math.sin(e),l=Math.sin(2*e),m=k*k,n=h*h,p=Math.sin(c),t=Math.cos(c/2),r=Math.sin(c/2),q=r*r,y=1-n*t*t,B=y?d.acos(h*t)*Math.sqrt(u=1/y):u=0,u,y=.5*(2*B*h*r+c/g)-a,w=.5*(B*k+e)-b,v=.5*u*(n*q+B*h*t*m)+.5/g,A=u*(p*l/4-B*k*r),k=.125*u*(l*r-B*k*n*p),m=.5*u*(m*t+B*q*h)+.5,h=A*k-m*v,A=(w*A-y*m)/h,y=(y*k-w*v)/h,c=c-A,e=e-y}while((1e-6<Math.abs(A)||1e-6<Math.abs(y))&&0<--f);return[c,e]};d.aitoff=function(a,b){var c=Math.cos(b),e=d.sinci(d.acos(c*Math.cos(a/=2)));return[2*c*Math.sin(a)*e,Math.sin(b)*e]};d.orthographic=function(a,b){return[Math.cos(b)*Math.sin(a),Math.sin(b)]};d.equirectangular=function(a,b){return[a,b]};d.equirectangular.invert=function(a,b){return[a,b]};d.eckert5=function(a,b){var c=Math.PI;return[a*(1+Math.cos(b))/Math.sqrt(2+c),2*b/Math.sqrt(2+c)]};d.eckert5.invert=function(a,b){var c=Math.sqrt(2+Math.PI),d=b*c/2;return[c*a/(1+Math.cos(d)),d]};d.eckert6=function(a,b){for(var c=Math.PI,d=(1+c/2)*Math.sin(b),f=0,g=Infinity;10>f&&1e-5<Math.abs(g);f++)b-=g=(b+Math.sin(b)-d)/(1+Math.cos(b));d=Math.sqrt(2+c);return[a*(1+Math.cos(b))/d,2*b/d]};d.eckert6.invert=function(a,b){var c=1+Math.PI/2,e=Math.sqrt(c/2);return[2*a*e/(1+Math.cos(b*=e)),d.asin((b+Math.sin(b))/c)]};d.mercator=function(a,b){b>=Math.PI/2-.02&&(b=Math.PI/2-.02);b<=-Math.PI/2+.02&&(b=-Math.PI/2+.02);return[a,Math.log(Math.tan(Math.PI/4+b/2))]};d.mercator.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-Math.PI/2]};d.miller=function(a,b){return[a,1.25*Math.log(Math.tan(Math.PI/4+.4*b))]};d.miller.invert=function(a,b){return[a,2.5*Math.atan(Math.exp(.8*b))-.625*Math.PI]};d.eckert3=function(a,b){var c=Math.PI,d=Math.sqrt(c*(4+c));return[2/d*a*(1+Math.sqrt(1-4*b*b/(c*c))),4/d*b]};d.eckert3.invert=function(a,b){var c=Math.PI,e=Math.sqrt(c*(4+c))/2;return[a*e/(1+d.asqrt(1-b*b*(4+c)/(4*c))),b*e/2]}})();(function(){var d=window.AmCharts;d.MapData=d.Class({inherits:d.MapObject,construct:function(){this.cname="MapData";d.MapData.base.construct.call(this);this.projection="mercator";this.topLatitude=90;this.bottomLatitude=-90;this.leftLongitude=-180;this.rightLongitude=180;this.zoomLevel=1;this.getAreasFromMap=!1}})})();(function(){var d=window.AmCharts;d.DescriptionWindow=d.Class({construct:function(){},show:function(a,b,c,d){var f=this;f.chart=a;var g=document.createElement("div");g.style.position="absolute";var h=a.classNamePrefix+"-description-";g.className="ammapDescriptionWindow "+h+"div";f.div=g;b.appendChild(g);var k=".gif";a.svgIcons&&(k=".svg");var l=document.createElement("img");l.className="ammapDescriptionWindowCloseButton "+h+"close-img";l.src=a.pathToImages+"xIcon"+k;l.style.cssFloat="right";l.style.cursor="pointer";l.onclick=function(){f.close()};l.onmouseover=function(){l.src=a.pathToImages+"xIconH"+k};l.onmouseout=function(){l.src=a.pathToImages+"xIcon"+k};g.appendChild(l);b=document.createElement("div");b.className="ammapDescriptionTitle "+h+"title-div";b.onmousedown=function(){f.div.style.zIndex=1e3};g.appendChild(b);b.innerHTML=d;d=b.offsetHeight;b=document.createElement("div");b.className="ammapDescriptionText "+h+"text-div";b.style.maxHeight=f.maxHeight-d-20+"px";g.appendChild(b);b.innerHTML=c},close:function(){try{this.div.parentNode.removeChild(this.div),this.chart.fireClosed()}catch(a){}}})})();(function(){var d=window.AmCharts;d.ValueLegend=d.Class({construct:function(a){this.cname="ValueLegend";this.enabled=!0;this.showAsGradient=!1;this.minValue=0;this.height=12;this.width=200;this.bottom=this.left=10;this.borderColor="#FFFFFF";this.borderAlpha=this.borderThickness=1;this.color="#000000";this.fontSize=11;d.applyTheme(this,a,this.cname)},init:function(a,b){if(this.enabled){var c=a.areasSettings.color,e=a.areasSettings.colorSolid,f=a.colorSteps;d.remove(this.set);var g=b.set();this.set=g;d.setCN(a,g,"value-legend");var h=0,k=this.minValue,l=this.fontSize,m=a.fontFamily,n=this.color,p={precision:a.precision,decimalSeparator:a.decimalSeparator,thousandsSeparator:a.thousandsSeparator};void 0==k&&(k=d.formatNumber(a.minValueReal,p));void 0!==k&&(h=d.text(b,k,n,m,l,"left"),h.translate(0,l/2-1),d.setCN(a,h,"value-legend-min-label"),g.push(h),h=h.getBBox().height);k=this.maxValue;void 0===k&&(k=d.formatNumber(a.maxValueReal,p));void 0!==k&&(h=d.text(b,k,n,m,l,"right"),h.translate(this.width,l/2-1),d.setCN(a,h,"value-legend-max-label"),g.push(h),h=h.getBBox().height);if(this.showAsGradient)c=d.rect(b,this.width,this.height,[c,e],1,this.borderThickness,this.borderColor,1,0,0),d.setCN(a,c,"value-legend-gradient"),c.translate(0,h),g.push(c);else for(l=this.width/f,m=0;m<f;m++)n=d.getColorFade(c,e,1*m/(f-1)),n=d.rect(b,l,this.height,n,1,this.borderThickness,this.borderColor,1),d.setCN(a,n,"value-legend-color"),d.setCN(a,n,"value-legend-color-"+m),n.translate(l*m,h),g.push(n);e=c=0;f=g.getBBox();h=a.getY(this.bottom,!0);l=a.getY(this.top);m=a.getX(this.right,!0);n=a.getX(this.left);isNaN(l)||(c=l);isNaN(h)||(c=h-f.height);isNaN(n)||(e=n);isNaN(m)||(e=m-f.width);g.translate(e,c)}else d.remove(this.set)}})})();(function(){var d=window.AmCharts;d.ObjectList=d.Class({construct:function(a){this.divId=a},init:function(a){this.chart=a;var b=this.divId;this.container&&(b=this.container);this.div="object"!=typeof b?document.getElementById(b):b;b=document.createElement("div");b.className="ammapObjectList "+a.classNamePrefix+"-object-list-div";this.div.appendChild(b);this.addObjects(a.dataProvider,b)},addObjects:function(a,b){var c=this.chart,d=document.createElement("ul");d.className=c.classNamePrefix+"-object-list-ul";var f;if(a.areas)for(f=0;f<a.areas.length;f++){var g=a.areas[f];void 0===g.showInList&&(g.showInList=c.showAreasInList);this.addObject(g,d)}if(a.images)for(f=0;f<a.images.length;f++)g=a.images[f],void 0===g.showInList&&(g.showInList=c.showImagesInList),this.addObject(g,d);if(a.lines)for(f=0;f<a.lines.length;f++)g=a.lines[f],void 0===g.showInList&&(g.showInList=c.showLinesInList),this.addObject(g,d);0<d.childNodes.length&&b.appendChild(d)},addObject:function(a,b){var c=this;if(a.showInList&&void 0!==a.title){var d=c.chart,f=document.createElement("li");f.className=d.classNamePrefix+"-object-list-li";var g=a.titleTr;g||(g=a.title);var g=document.createTextNode(g),h=document.createElement("a");h.className=d.classNamePrefix+"-object-list-a";h.appendChild(g);f.appendChild(h);b.appendChild(f);this.addObjects(a,f);h.onmouseover=function(){c.chart.rollOverMapObject(a,!1)};h.onmouseout=function(){c.chart.rollOutMapObject(a)};h.onclick=function(){c.chart.clickMapObject(a)}}}})})();(function(){var e=window.AmCharts;e.AmRectangularChart=e.Class({inherits:e.AmCoordinateChart,construct:function(a){e.AmRectangularChart.base.construct.call(this,a);this.theme=a;this.createEvents("zoomed","changed");this.marginRight=this.marginBottom=this.marginTop=this.marginLeft=20;this.depth3D=this.angle=0;this.plotAreaFillColors="#FFFFFF";this.plotAreaFillAlphas=0;this.plotAreaBorderColor="#000000";this.plotAreaBorderAlpha=0;this.maxZoomFactor=20;this.zoomOutButtonImageSize=19;this.zoomOutButtonImage="lens";this.zoomOutText="Show all";this.zoomOutButtonColor="#e5e5e5";this.zoomOutButtonAlpha=0;this.zoomOutButtonRollOverAlpha=1;this.zoomOutButtonPadding=8;this.trendLines=[];this.autoMargins=!0;this.marginsUpdated=!1;this.autoMarginOffset=10;e.applyTheme(this,a,"AmRectangularChart")},initChart:function(){e.AmRectangularChart.base.initChart.call(this);this.updateDxy();!this.marginsUpdated&&this.autoMargins&&(this.resetMargins(),this.drawGraphs=!1);this.processScrollbars();this.updateMargins();this.updatePlotArea();this.updateScrollbars();this.updateTrendLines();this.updateChartCursor();this.updateValueAxes();this.scrollbarOnly||this.updateGraphs()},drawChart:function(){e.AmRectangularChart.base.drawChart.call(this);this.drawPlotArea();if(e.ifArray(this.chartData)){var a=this.chartCursor;a&&a.draw()}},resetMargins:function(){var a={},b;if("xy"==this.type){var c=this.xAxes,d=this.yAxes;for(b=0;b<c.length;b++){var g=c[b];g.ignoreAxisWidth||(g.setOrientation(!0),g.fixAxisPosition(),a[g.position]=!0)}for(b=0;b<d.length;b++)c=d[b],c.ignoreAxisWidth||(c.setOrientation(!1),c.fixAxisPosition(),a[c.position]=!0)}else{d=this.valueAxes;for(b=0;b<d.length;b++)c=d[b],c.ignoreAxisWidth||(c.setOrientation(this.rotate),c.fixAxisPosition(),a[c.position]=!0);(b=this.categoryAxis)&&!b.ignoreAxisWidth&&(b.setOrientation(!this.rotate),b.fixAxisPosition(),b.fixAxisPosition(),a[b.position]=!0)}a.left&&(this.marginLeft=0);a.right&&(this.marginRight=0);a.top&&(this.marginTop=0);a.bottom&&(this.marginBottom=0);this.fixMargins=a},measureMargins:function(){var a=this.valueAxes,b,c=this.autoMarginOffset,d=this.fixMargins,g=this.realWidth,h=this.realHeight,f=c,e=c,l=g;b=h;var m;for(m=0;m<a.length;m++)a[m].handleSynchronization(),b=this.getAxisBounds(a[m],f,l,e,b),f=Math.round(b.l),l=Math.round(b.r),e=Math.round(b.t),b=Math.round(b.b);if(a=this.categoryAxis)b=this.getAxisBounds(a,f,l,e,b),f=Math.round(b.l),l=Math.round(b.r),e=Math.round(b.t),b=Math.round(b.b);d.left&&f<c&&(this.marginLeft=Math.round(-f+c),!isNaN(this.minMarginLeft)&&this.marginLeft<this.minMarginLeft&&(this.marginLeft=this.minMarginLeft));d.right&&l>=g-c&&(this.marginRight=Math.round(l-g+c),!isNaN(this.minMarginRight)&&this.marginRight<this.minMarginRight&&(this.marginRight=this.minMarginRight));d.top&&e<c+this.titleHeight&&(this.marginTop=Math.round(this.marginTop-e+c+this.titleHeight),!isNaN(this.minMarginTop)&&this.marginTop<this.minMarginTop&&(this.marginTop=this.minMarginTop));d.bottom&&b>h-c&&(this.marginBottom=Math.round(this.marginBottom+b-h+c),!isNaN(this.minMarginBottom)&&this.marginBottom<this.minMarginBottom&&(this.marginBottom=this.minMarginBottom));this.initChart()},getAxisBounds:function(a,b,c,d,g){if(!a.ignoreAxisWidth){var e=a.labelsSet,f=a.tickLength;a.inside&&(f=0);if(e)switch(e=a.getBBox(),a.position){case"top":a=e.y;d>a&&(d=a);break;case"bottom":a=e.y+e.height;g<a&&(g=a);break;case"right":a=e.x+e.width+f+3;c<a&&(c=a);break;case"left":a=e.x-f,b>a&&(b=a)}}return{l:b,t:d,r:c,b:g}},drawZoomOutButton:function(){var a=this;if(!a.zbSet){var b=a.container.set();a.zoomButtonSet.push(b);var c=a.color,d=a.fontSize,g=a.zoomOutButtonImageSize,h=a.zoomOutButtonImage.replace(/\.[a-z]*$/i,""),f=e.lang.zoomOutText||a.zoomOutText,k=a.zoomOutButtonColor,l=a.zoomOutButtonAlpha,m=a.zoomOutButtonFontSize,p=a.zoomOutButtonPadding;isNaN(m)||(d=m);(m=a.zoomOutButtonFontColor)&&(c=m);var m=a.zoomOutButton,n;m&&(m.fontSize&&(d=m.fontSize),m.color&&(c=m.color),m.backgroundColor&&(k=m.backgroundColor),isNaN(m.backgroundAlpha)||(a.zoomOutButtonRollOverAlpha=m.backgroundAlpha));var r=m=0;void 0!==a.pathToImages&&h&&(n=a.container.image(a.pathToImages+h+a.extension,0,0,g,g),e.setCN(a,n,"zoom-out-image"),b.push(n),n=n.getBBox(),m=n.width+5);void 0!==f&&(c=e.text(a.container,f,c,a.fontFamily,d,"start"),e.setCN(a,c,"zoom-out-label"),d=c.getBBox(),r=n?n.height/2-3:d.height/2,c.translate(m,r),b.push(c));n=b.getBBox();c=1;e.isModern||(c=0);k=e.rect(a.container,n.width+2*p+5,n.height+2*p-2,k,1,1,k,c);k.setAttr("opacity",l);k.translate(-p,-p);e.setCN(a,k,"zoom-out-bg");b.push(k);k.toBack();a.zbBG=k;n=k.getBBox();b.translate(a.marginLeftReal+a.plotAreaWidth-n.width+p,a.marginTopReal+p);b.hide();b.mouseover(function(){a.rollOverZB()}).mouseout(function(){a.rollOutZB()}).click(function(){a.clickZB()}).touchstart(function(){a.rollOverZB()}).touchend(function(){a.rollOutZB();a.clickZB()});for(l=0;l<b.length;l++)b[l].attr({cursor:"pointer"});a.zbSet=b}},rollOverZB:function(){this.rolledOverZB=!0;this.zbBG.setAttr("opacity",this.zoomOutButtonRollOverAlpha)},rollOutZB:function(){this.rolledOverZB=!1;this.zbBG.setAttr("opacity",this.zoomOutButtonAlpha)},clickZB:function(){this.rolledOverZB=!1;this.zoomOut()},zoomOut:function(){this.zoomOutValueAxes()},drawPlotArea:function(){var a=this.dx,b=this.dy,c=this.marginLeftReal,d=this.marginTopReal,g=this.plotAreaWidth-1,h=this.plotAreaHeight-1,f=this.plotAreaFillColors,k=this.plotAreaFillAlphas,l=this.plotAreaBorderColor,m=this.plotAreaBorderAlpha;"object"==typeof k&&(k=k[0]);f=e.polygon(this.container,[0,g,g,0,0],[0,0,h,h,0],f,k,1,l,m,this.plotAreaGradientAngle);e.setCN(this,f,"plot-area");f.translate(c+a,d+b);this.set.push(f);0!==a&&0!==b&&(f=this.plotAreaFillColors,"object"==typeof f&&(f=f[0]),f=e.adjustLuminosity(f,-.15),g=e.polygon(this.container,[0,a,g+a,g,0],[0,b,b,0,0],f,k,1,l,m),e.setCN(this,g,"plot-area-bottom"),g.translate(c,d+h),this.set.push(g),a=e.polygon(this.container,[0,0,a,a,0],[0,h,h+b,b,0],f,k,1,l,m),e.setCN(this,a,"plot-area-left"),a.translate(c,d),this.set.push(a));(c=this.bbset)&&this.scrollbarOnly&&c.remove()},updatePlotArea:function(){var a=this.updateWidth(),b=this.updateHeight(),c=this.container;this.realWidth=a;this.realWidth=b;c&&this.container.setSize(a,b);var c=this.marginLeftReal,d=this.marginTopReal,a=a-c-this.marginRightReal-this.dx,b=b-d-this.marginBottomReal;1>a&&(a=1);1>b&&(b=1);this.plotAreaWidth=Math.round(a);this.plotAreaHeight=Math.round(b);this.plotBalloonsSet.translate(c,d)},updateDxy:function(){this.dx=Math.round(this.depth3D*Math.cos(this.angle*Math.PI/180));this.dy=Math.round(-this.depth3D*Math.sin(this.angle*Math.PI/180));this.d3x=Math.round(this.columnSpacing3D*Math.cos(this.angle*Math.PI/180));this.d3y=Math.round(-this.columnSpacing3D*Math.sin(this.angle*Math.PI/180))},updateMargins:function(){var a=this.getTitleHeight();this.titleHeight=a;this.marginTopReal=this.marginTop-this.dy;this.fixMargins&&!this.fixMargins.top&&(this.marginTopReal+=a);this.marginBottomReal=this.marginBottom;this.marginLeftReal=this.marginLeft;this.marginRightReal=this.marginRight},updateValueAxes:function(){var a=this.valueAxes,b;for(b=0;b<a.length;b++){var c=a[b];this.setAxisRenderers(c);this.updateObjectSize(c)}},setAxisRenderers:function(a){a.axisRenderer=e.RecAxis;a.guideFillRenderer=e.RecFill;a.axisItemRenderer=e.RecItem;a.marginsChanged=!0},updateGraphs:function(){var a=this.graphs,b;for(b=0;b<a.length;b++){var c=a[b];c.index=b;c.rotate=this.rotate;this.updateObjectSize(c)}},updateObjectSize:function(a){a.width=this.plotAreaWidth-1;a.height=this.plotAreaHeight-1;a.x=this.marginLeftReal;a.y=this.marginTopReal;a.dx=this.dx;a.dy=this.dy},updateChartCursor:function(){var a=this.chartCursor;a&&(a=e.processObject(a,e.ChartCursor,this.theme),this.updateObjectSize(a),this.addChartCursor(a),a.chart=this)},processScrollbars:function(){var a=this.chartScrollbar;a&&(a=e.processObject(a,e.ChartScrollbar,this.theme),this.addChartScrollbar(a))},updateScrollbars:function(){},removeChartCursor:function(){e.callMethod("destroy",[this.chartCursor]);this.chartCursor=null},zoomTrendLines:function(){var a=this.trendLines,b;for(b=0;b<a.length;b++){var c=a[b];c.valueAxis.recalculateToPercents?c.set&&c.set.hide():(c.x=this.marginLeftReal,c.y=this.marginTopReal,c.draw())}},handleCursorValueZoom:function(){},addTrendLine:function(a){this.trendLines.push(a)},zoomOutValueAxes:function(){for(var a=this.valueAxes,b=0;b<a.length;b++)a[b].zoomOut()},removeTrendLine:function(a){var b=this.trendLines,c;for(c=b.length-1;0<=c;c--)b[c]==a&&b.splice(c,1)},adjustMargins:function(a,b){var c=a.position,d=a.scrollbarHeight+a.offset;a.enabled&&("top"==c?b?this.marginLeftReal+=d:this.marginTopReal+=d:b?this.marginRightReal+=d:this.marginBottomReal+=d)},getScrollbarPosition:function(a,b,c){var d="bottom",g="top";a.oppositeAxis||(g=d,d="top");a.position=b?"bottom"==c||"left"==c?d:g:"top"==c||"right"==c?d:g},updateChartScrollbar:function(a,b){if(a){a.rotate=b;var c=this.marginTopReal,d=this.marginLeftReal,g=a.scrollbarHeight,e=this.dx,f=this.dy,k=a.offset;"top"==a.position?b?(a.y=c,a.x=d-g-k):(a.y=c-g+f-k,a.x=d+e):b?(a.y=c+f,a.x=d+this.plotAreaWidth+e+k):(a.y=c+this.plotAreaHeight+k,a.x=this.marginLeftReal)}},showZB:function(a){var b=this.zbSet;a&&(b=this.zoomOutText,""!==b&&b&&this.drawZoomOutButton());if(b=this.zbSet)this.zoomButtonSet.push(b),a?b.show():b.hide(),this.rollOutZB()},handleReleaseOutside:function(a){e.AmRectangularChart.base.handleReleaseOutside.call(this,a);(a=this.chartCursor)&&a.handleReleaseOutside&&a.handleReleaseOutside()},handleMouseDown:function(a){e.AmRectangularChart.base.handleMouseDown.call(this,a);var b=this.chartCursor;b&&b.handleMouseDown&&!this.rolledOverZB&&b.handleMouseDown(a)},update:function(){e.AmRectangularChart.base.update.call(this);this.chartCursor&&this.chartCursor.update&&this.chartCursor.update()},handleScrollbarValueZoom:function(a){this.relativeZoomValueAxes(a.target.valueAxes,a.relativeStart,a.relativeEnd);this.zoomAxesAndGraphs()},zoomValueScrollbar:function(a){if(a&&a.enabled){var b=a.valueAxes[0],c=b.relativeStart,d=b.relativeEnd;b.reversed&&(d=1-c,c=1-b.relativeEnd);a.percentZoom(c,d)}},zoomAxesAndGraphs:function(){if(!this.scrollbarOnly){var a=this.valueAxes,b;for(b=0;b<a.length;b++)a[b].zoom(this.start,this.end);a=this.graphs;for(b=0;b<a.length;b++)a[b].zoom(this.start,this.end);(b=this.chartCursor)&&b.clearSelection();this.zoomTrendLines()}},handleValueAxisZoomReal:function(a,b){var c=a.relativeStart,d=a.relativeEnd;if(c>d)var g=c,c=d,d=g;this.relativeZoomValueAxes(b,c,d);this.updateAfterValueZoom()},updateAfterValueZoom:function(){this.zoomAxesAndGraphs();this.zoomScrollbar()},relativeZoomValueAxes:function(a,b,c){b=e.fitToBounds(b,0,1);c=e.fitToBounds(c,0,1);if(b>c){var d=b;b=c;c=d}var d=1/this.maxZoomFactor,g=e.getDecimals(d)+4;c-b<d&&(c=b+(c-b)/2,b=c-d/2,c+=d/2);b=e.roundTo(b,g);c=e.roundTo(c,g);d=!1;if(a){for(g=0;g<a.length;g++){var h=a[g].zoomToRelativeValues(b,c,!0);h&&(d=h)}this.showZB()}return d},addChartCursor:function(a){e.callMethod("destroy",[this.chartCursor]);a&&(this.listenTo(a,"moved",this.handleCursorMove),this.listenTo(a,"zoomed",this.handleCursorZoom),this.listenTo(a,"zoomStarted",this.handleCursorZoomStarted),this.listenTo(a,"panning",this.handleCursorPanning),this.listenTo(a,"onHideCursor",this.handleCursorHide));this.chartCursor=a},handleCursorChange:function(){},handleCursorMove:function(a){var b,c=this.valueAxes;for(b=0;b<c.length;b++)a.panning||c[b].showBalloon(a.x,a.y)},handleCursorZoom:function(a){if(this.skipZoomed)this.skipZoomed=!1;else{var b=this.startX0,c=this.endX0,d=this.endY0,g=this.startY0,e=a.startX,f=a.endX,k=a.startY,l=a.endY;this.startX0=this.endX0=this.startY0=this.endY0=NaN;this.handleCursorZoomReal(b+e*(c-b),b+f*(c-b),g+k*(d-g),g+l*(d-g),a)}},handleCursorHide:function(){var a,b=this.valueAxes;for(a=0;a<b.length;a++)b[a].hideBalloon();b=this.graphs;for(a=0;a<b.length;a++)b[a].hideBalloonReal()}})})();(function(){var e=window.AmCharts;e.AmSerialChart=e.Class({inherits:e.AmRectangularChart,construct:function(a){this.type="serial";e.AmSerialChart.base.construct.call(this,a);this.cname="AmSerialChart";this.theme=a;this.columnSpacing=5;this.columnSpacing3D=0;this.columnWidth=.8;var b=new e.CategoryAxis(a);b.chart=this;this.categoryAxis=b;this.zoomOutOnDataUpdate=!0;this.mouseWheelZoomEnabled=this.mouseWheelScrollEnabled=this.rotate=this.skipZoom=!1;this.minSelectedTime=0;e.applyTheme(this,a,this.cname)},initChart:function(){e.AmSerialChart.base.initChart.call(this);this.updateCategoryAxis(this.categoryAxis,this.rotate,"categoryAxis");if(this.dataChanged)this.parseData();else this.onDataUpdated();this.drawGraphs=!0},onDataUpdated:function(){var a=this.countColumns(),b=this.chartData,c=this.graphs,d;for(d=0;d<c.length;d++){var g=c[d];g.data=b;g.columnCount=a}0<b.length&&(this.firstTime=this.getStartTime(b[0].time),this.lastTime=this.getEndTime(b[b.length-1].time));this.drawChart();this.autoMargins&&!this.marginsUpdated?(this.marginsUpdated=!0,this.measureMargins()):this.dispDUpd()},handleWheelReal:function(a,b){if(!this.wheelBusy){var c=this.categoryAxis,d=c.parseDates,g=c.minDuration(),e=c=1;this.mouseWheelZoomEnabled?b||(c=-1):b&&(c=-1);var f=this.chartCursor;if(f){var k=f.mouseX,f=f.mouseY;c!=e&&(k=this.rotate?f/this.plotAreaHeight:k/this.plotAreaWidth,c*=k,e*=1-k)}var l=this.chartData.length,k=this.lastTime,f=this.firstTime;0>a?d?(l=this.endTime-this.startTime,d=this.startTime+c*g,g=this.endTime+e*g,0<e&&0<c&&g>=k&&(g=k,d=k-l),this.zoomToDates(new Date(d),new Date(g))):(0<e&&0<c&&this.end>=l-1&&(c=e=0),d=this.start+c,g=this.end+e,this.zoomToIndexes(d,g)):d?(l=this.endTime-this.startTime,d=this.startTime-c*g,g=this.endTime-e*g,0<e&&0<c&&d<=f&&(d=f,g=f+l),this.zoomToDates(new Date(d),new Date(g))):(0<e&&0<c&&1>this.start&&(c=e=0),d=this.start-c,g=this.end-e,this.zoomToIndexes(d,g))}},validateData:function(a){this.marginsUpdated=!1;this.zoomOutOnDataUpdate&&!a&&(this.endTime=this.end=this.startTime=this.start=NaN);e.AmSerialChart.base.validateData.call(this)},drawChart:function(){if(0<this.realWidth&&0<this.realHeight){e.AmSerialChart.base.drawChart.call(this);var a=this.chartData;if(e.ifArray(a)){var b=this.chartScrollbar;!b||!this.marginsUpdated&&this.autoMargins||b.draw();(b=this.valueScrollbar)&&b.draw();var a=a.length-1,c,b=this.categoryAxis;if(b.parseDates&&!b.equalSpacing){if(b=this.startTime,c=this.endTime,isNaN(b)||isNaN(c))b=this.firstTime,c=this.lastTime}else if(b=this.start,c=this.end,isNaN(b)||isNaN(c))b=0,c=a;this.endTime=this.startTime=this.end=this.start=void 0;this.zoom(b,c)}}else this.cleanChart()},cleanChart:function(){e.callMethod("destroy",[this.valueAxes,this.graphs,this.categoryAxis,this.chartScrollbar,this.chartCursor,this.valueScrollbar])},updateCategoryAxis:function(a,b,c){a.chart=this;a.id=c;a.rotate=b;a.setOrientation(!this.rotate);a.init();this.setAxisRenderers(a);this.updateObjectSize(a)},updateValueAxes:function(){e.AmSerialChart.base.updateValueAxes.call(this);var a=this.valueAxes,b;for(b=0;b<a.length;b++){var c=a[b],d=this.rotate;c.rotate=d;c.setOrientation(d);d=this.categoryAxis;if(!d.startOnAxis||d.parseDates)c.expandMinMax=!0}},getStartTime:function(a){var b=this.categoryAxis;return e.resetDateToMin(new Date(a),b.minPeriod,1,b.firstDayOfWeek).getTime()},getEndTime:function(a){var b=e.extractPeriod(this.categoryAxis.minPeriod);return e.changeDate(new Date(a),b.period,b.count,!0).getTime()-1},updateMargins:function(){e.AmSerialChart.base.updateMargins.call(this);var a=this.chartScrollbar;a&&(this.getScrollbarPosition(a,this.rotate,this.categoryAxis.position),this.adjustMargins(a,this.rotate));if(a=this.valueScrollbar)this.getScrollbarPosition(a,!this.rotate,this.valueAxes[0].position),this.adjustMargins(a,!this.rotate)},updateScrollbars:function(){e.AmSerialChart.base.updateScrollbars.call(this);this.updateChartScrollbar(this.chartScrollbar,this.rotate);this.updateChartScrollbar(this.valueScrollbar,!this.rotate)},zoom:function(a,b){var c=this.categoryAxis;c.parseDates&&!c.equalSpacing?this.timeZoom(a,b):this.indexZoom(a,b);isNaN(a)&&this.zoomOutValueAxes();this.updateLegendValues()},timeZoom:function(a,b){var c=this.maxSelectedTime;isNaN(c)||(b!=this.endTime&&b-a>c&&(a=b-c),a!=this.startTime&&b-a>c&&(b=a+c));var d=this.minSelectedTime;if(0<d&&b-a<d){var g=Math.round(a+(b-a)/2),d=Math.round(d/2);a=g-d;b=g+d}d=this.chartData;g=this.categoryAxis;if(e.ifArray(d)&&(a!=this.startTime||b!=this.endTime)){var h=g.minDuration(),f=this.firstTime,k=this.lastTime;a||(a=f,isNaN(c)||(a=k-c));b||(b=k);a>k&&(a=k);b<f&&(b=f);a<f&&(a=f);b>k&&(b=k);b<a&&(b=a+h);b-a<h/5&&(b<k?b=a+h/5:a=b-h/5);this.startTime=a;this.endTime=b;c=d.length-1;h=this.getClosestIndex(d,"time",a,!0,0,c);d=this.getClosestIndex(d,"time",b,!1,h,c);g.timeZoom(a,b);g.zoom(h,d);this.start=e.fitToBounds(h,0,c);this.end=e.fitToBounds(d,0,c);this.zoomAxesAndGraphs();this.zoomScrollbar();this.fixCursor();this.showZB();this.updateColumnsDepth();this.dispatchTimeZoomEvent()}},showZB:function(){var a,b=this.categoryAxis;b&&b.parseDates&&!b.equalSpacing&&(this.startTime>this.firstTime&&(a=!0),this.endTime<this.lastTime&&(a=!0));0<this.start&&(a=!0);this.end<this.chartData.length-1&&(a=!0);if(b=this.valueAxes)b=b[0],0!==b.relativeStart&&(a=!0),1!=b.relativeEnd&&(a=!0);e.AmSerialChart.base.showZB.call(this,a)},updateAfterValueZoom:function(){e.AmSerialChart.base.updateAfterValueZoom.call(this);this.updateColumnsDepth()},indexZoom:function(a,b){var c=this.maxSelectedSeries;isNaN(c)||(b!=this.end&&b-a>c&&(a=b-c),a!=this.start&&b-a>c&&(b=a+c));if(a!=this.start||b!=this.end){var d=this.chartData.length-1;isNaN(a)&&(a=0,isNaN(c)||(a=d-c));isNaN(b)&&(b=d);b<a&&(b=a);b>d&&(b=d);a>d&&(a=d-1);0>a&&(a=0);this.start=a;this.end=b;this.categoryAxis.zoom(a,b);this.zoomAxesAndGraphs();this.zoomScrollbar();this.fixCursor();0!==a||b!=this.chartData.length-1?this.showZB(!0):this.showZB(!1);this.updateColumnsDepth();this.dispatchIndexZoomEvent()}},updateGraphs:function(){e.AmSerialChart.base.updateGraphs.call(this);var a=this.graphs,b;for(b=0;b<a.length;b++){var c=a[b];c.columnWidthReal=this.columnWidth;c.categoryAxis=this.categoryAxis;e.isString(c.fillToGraph)&&(c.fillToGraph=this.graphsById[c.fillToGraph])}},zoomAxesAndGraphs:function(){e.AmSerialChart.base.zoomAxesAndGraphs.call(this);this.updateColumnsDepth()},updateColumnsDepth:function(){if(0!==this.depth3D||0!==this.angle){var a,b=this.graphs,c;this.columnsArray=[];for(a=0;a<b.length;a++){c=b[a];var d=c.columnsArray;if(d){var g;for(g=0;g<d.length;g++)this.columnsArray.push(d[g])}}this.columnsArray.sort(this.compareDepth);if(0<this.columnsArray.length){b=this.columnsSet;d=this.container.set();this.columnSet.push(d);for(a=0;a<this.columnsArray.length;a++)d.push(this.columnsArray[a].column.set);c&&d.translate(c.x,c.y);this.columnsSet=d;e.remove(b)}}},compareDepth:function(a,b){return a.depth>b.depth?1:-1},zoomScrollbar:function(){var a=this.chartScrollbar,b=this.categoryAxis;if(a){if(!this.zoomedByScrollbar){var c=a.dragger;c&&c.stop()}this.zoomedByScrollbar=!1;b.parseDates&&!b.equalSpacing?a.timeZoom(this.startTime,this.endTime):a.zoom(this.start,this.end)}this.zoomValueScrollbar(this.valueScrollbar)},updateTrendLines:function(){var a=this.trendLines,b;for(b=0;b<a.length;b++){var c=a[b],c=e.processObject(c,e.TrendLine,this.theme);a[b]=c;c.chart=this;c.id||(c.id="trendLineAuto"+b+"_"+(new Date).getTime());e.isString(c.valueAxis)&&(c.valueAxis=this.getValueAxisById(c.valueAxis));c.valueAxis||(c.valueAxis=this.valueAxes[0]);c.categoryAxis=this.categoryAxis}},countColumns:function(){var a=0,b=this.valueAxes.length,c=this.graphs.length,d,e,h=!1,f,k;for(k=0;k<b;k++){e=this.valueAxes[k];var l=e.stackType;if("100%"==l||"regular"==l)for(h=!1,f=0;f<c;f++)d=this.graphs[f],d.tcc=1,d.valueAxis==e&&"column"==d.type&&(!h&&d.stackable&&(a++,h=!0),(!d.stackable&&d.clustered||d.newStack)&&a++,d.columnIndex=a-1,d.clustered||(d.columnIndex=0));if("none"==l||"3d"==l){h=!1;for(f=0;f<c;f++)d=this.graphs[f],d.valueAxis==e&&"column"==d.type&&(d.clustered?(d.tcc=1,d.newStack&&(a=0),d.hidden||(d.columnIndex=a,a++)):d.hidden||(h=!0,d.tcc=1,d.columnIndex=0));h&&0===a&&(a=1)}if("3d"==l){e=1;for(k=0;k<c;k++)d=this.graphs[k],d.newStack&&e++,d.depthCount=e,d.tcc=a;a=e}}return a},parseData:function(){e.AmSerialChart.base.parseData.call(this);this.parseSerialData(this.dataProvider)},getCategoryIndexByValue:function(a){var b=this.chartData,c;for(c=0;c<b.length;c++)if(b[c].category==a)return c},handleScrollbarZoom:function(a){this.zoomedByScrollbar=!0;this.zoom(a.start,a.end)},dispatchTimeZoomEvent:function(){if(this.drawGraphs&&(this.prevStartTime!=this.startTime||this.prevEndTime!=this.endTime)){var a={type:"zoomed"};a.startDate=new Date(this.startTime);a.endDate=new Date(this.endTime);a.startIndex=this.start;a.endIndex=this.end;this.startIndex=this.start;this.endIndex=this.end;this.startDate=a.startDate;this.endDate=a.endDate;this.prevStartTime=this.startTime;this.prevEndTime=this.endTime;var b=this.categoryAxis,c=e.extractPeriod(b.minPeriod).period,b=b.dateFormatsObject[c];a.startValue=e.formatDate(a.startDate,b,this);a.endValue=e.formatDate(a.endDate,b,this);a.chart=this;a.target=this;this.fire(a)}},dispatchIndexZoomEvent:function(){if(this.drawGraphs&&(this.prevStartIndex!=this.start||this.prevEndIndex!=this.end)){this.startIndex=this.start;this.endIndex=this.end;var a=this.chartData;if(e.ifArray(a)&&!isNaN(this.start)&&!isNaN(this.end)){var b={chart:this,target:this,type:"zoomed"};b.startIndex=this.start;b.endIndex=this.end;b.startValue=a[this.start].category;b.endValue=a[this.end].category;this.categoryAxis.parseDates&&(this.startTime=a[this.start].time,this.endTime=a[this.end].time,b.startDate=new Date(this.startTime),b.endDate=new Date(this.endTime));this.prevStartIndex=this.start;this.prevEndIndex=this.end;this.fire(b)}}},updateLegendValues:function(){this.legend&&this.legend.updateValues()},getClosestIndex:function(a,b,c,d,e,h){0>e&&(e=0);h>a.length-1&&(h=a.length-1);var f=e+Math.round((h-e)/2),k=a[f][b];return c==k?f:1>=h-e?d?e:Math.abs(a[e][b]-c)<Math.abs(a[h][b]-c)?e:h:c==k?f:c<k?this.getClosestIndex(a,b,c,d,e,f):this.getClosestIndex(a,b,c,d,f,h)},zoomToIndexes:function(a,b){var c=this.chartData;if(c){var d=c.length;0<d&&(0>a&&(a=0),b>d-1&&(b=d-1),d=this.categoryAxis,d.parseDates&&!d.equalSpacing?this.zoom(c[a].time,this.getEndTime(c[b].time)):this.zoom(a,b))}},zoomToDates:function(a,b){var c=this.chartData;if(c)if(this.categoryAxis.equalSpacing){var d=this.getClosestIndex(c,"time",a.getTime(),!0,0,c.length);b=e.resetDateToMin(b,this.categoryAxis.minPeriod,1);c=this.getClosestIndex(c,"time",b.getTime(),!1,0,c.length);this.zoom(d,c)}else this.zoom(a.getTime(),b.getTime())},zoomToCategoryValues:function(a,b){this.chartData&&this.zoom(this.getCategoryIndexByValue(a),this.getCategoryIndexByValue(b))},formatPeriodString:function(a,b){if(b){var c=["value","open","low","high","close"],d="value open low high close average sum count".split(" "),g=b.valueAxis,h=this.chartData,f=b.numberFormatter;f||(f=this.nf);for(var k=0;k<c.length;k++){for(var l=c[k],m=0,p=0,n,r,w,z,u,q=0,D=0,v,t,x,B,A,G=this.start;G<=this.end;G++){var y=h[G];if(y&&(y=y.axes[g.id].graphs[b.id])){if(y.values){var C=y.values[l];if(this.rotate){if(0>y.x||y.x>y.graph.height)C=NaN}else if(0>y.x||y.x>y.graph.width)C=NaN;if(!isNaN(C)){isNaN(n)&&(n=C);r=C;if(isNaN(w)||w>C)w=C;if(isNaN(z)||z<C)z=C;u=e.getDecimals(m);var F=e.getDecimals(C),m=m+C,m=e.roundTo(m,Math.max(u,F));p++;u=m/p}}if(y.percents&&(y=y.percents[l],!isNaN(y))){isNaN(v)&&(v=y);t=y;if(isNaN(x)||x>y)x=y;if(isNaN(B)||B<y)B=y;A=e.getDecimals(q);C=e.getDecimals(y);q+=y;q=e.roundTo(q,Math.max(A,C));D++;A=q/D}}}q={open:v,close:t,high:B,low:x,average:A,sum:q,count:D};a=e.formatValue(a,{open:n,close:r,high:z,low:w,average:u,sum:m,count:p},d,f,l+"\\.",this.usePrefixes,this.prefixesOfSmallNumbers,this.prefixesOfBigNumbers);a=e.formatValue(a,q,d,this.pf,"percents\\."+l+"\\.")}}return a=e.cleanFromEmpty(a)},formatString:function(a,b,c){if(b){var d=b.graph;if(void 0!==a){if(-1!=a.indexOf("[[category]]")){var g=b.serialDataItem.category;if(this.categoryAxis.parseDates){var h=this.balloonDateFormat,f=this.chartCursor;f&&f.categoryBalloonDateFormat&&(h=f.categoryBalloonDateFormat);h=e.formatDate(g,h,this);-1!=h.indexOf("fff")&&(h=e.formatMilliseconds(h,g));g=h}a=a.replace(/\[\[category\]\]/g,String(g))}g=d.numberFormatter;g||(g=this.nf);h=b.graph.valueAxis;(f=h.duration)&&!isNaN(b.values.value)&&(f=e.formatDuration(b.values.value,f,"",h.durationUnits,h.maxInterval,g),a=a.replace(RegExp("\\[\\[value\\]\\]","g"),f));"date"==h.type&&(h=e.formatDate(new Date(b.values.value),d.dateFormat,this),f=RegExp("\\[\\[value\\]\\]","g"),a=a.replace(f,h),h=e.formatDate(new Date(b.values.open),d.dateFormat,this),f=RegExp("\\[\\[open\\]\\]","g"),a=a.replace(f,h));d="value open low high close total".split(" ");h=this.pf;a=e.formatValue(a,b.percents,d,h,"percents\\.");a=e.formatValue(a,b.values,d,g,"",this.usePrefixes,this.prefixesOfSmallNumbers,this.prefixesOfBigNumbers);a=e.formatValue(a,b.values,["percents"],h);-1!=a.indexOf("[[")&&(a=e.formatDataContextValue(a,b.dataContext));-1!=a.indexOf("[[")&&b.graph.customData&&(a=e.formatDataContextValue(a,b.graph.customData));a=e.AmSerialChart.base.formatString.call(this,a,b,c)}return a}},updateChartCursor:function(){e.AmSerialChart.base.updateChartCursor.call(this);var a=this.chartCursor,b=this.categoryAxis;if(a){var c=a.categoryBalloonAlpha,d=a.categoryBalloonColor,g=a.color;void 0===d&&(d=a.cursorColor);var h=a.valueZoomable,f=a.zoomable,k=a.valueLineEnabled;this.rotate?(a.vLineEnabled=k,a.hZoomEnabled=h,a.vZoomEnabled=f):(a.hLineEnabled=k,a.vZoomEnabled=h,a.hZoomEnabled=f);if(a.valueLineBalloonEnabled)for(k=0;k<this.valueAxes.length;k++)h=this.valueAxes[k],(f=h.balloon)||(f={}),f=e.extend(f,this.balloon,!0),f.fillColor=d,f.balloonColor=d,f.fillAlpha=c,f.borderColor=d,f.color=g,h.balloon=f;else for(f=0;f<this.valueAxes.length;f++)h=this.valueAxes[f],h.balloon&&(h.balloon=null);b&&(b.balloonTextFunction=a.categoryBalloonFunction,a.categoryLineAxis=b,b.balloonText=a.categoryBalloonText,a.categoryBalloonEnabled&&((f=b.balloon)||(f={}),f=e.extend(f,this.balloon,!0),f.fillColor=d,f.balloonColor=d,f.fillAlpha=c,f.borderColor=d,f.color=g,b.balloon=f),b.balloon&&(b.balloon.enabled=a.categoryBalloonEnabled))}},addChartScrollbar:function(a){e.callMethod("destroy",[this.chartScrollbar]);a&&(a.chart=this,this.listenTo(a,"zoomed",this.handleScrollbarZoom));this.rotate?void 0===a.width&&(a.width=a.scrollbarHeight):void 0===a.height&&(a.height=a.scrollbarHeight);a.gridAxis=this.categoryAxis;this.chartScrollbar=a},addValueScrollbar:function(a){e.callMethod("destroy",[this.valueScrollbar]);a&&(a.chart=this,this.listenTo(a,"zoomed",this.handleScrollbarValueZoom),this.listenTo(a,"zoomStarted",this.handleCursorZoomStarted));var b=a.scrollbarHeight;this.rotate?void 0===a.height&&(a.height=b):void 0===a.width&&(a.width=b);a.gridAxis||(a.gridAxis=this.valueAxes[0]);a.valueAxes=this.valueAxes;this.valueScrollbar=a},removeChartScrollbar:function(){e.callMethod("destroy",[this.chartScrollbar]);this.chartScrollbar=null},removeValueScrollbar:function(){e.callMethod("destroy",[this.valueScrollbar]);this.valueScrollbar=null},handleReleaseOutside:function(a){e.AmSerialChart.base.handleReleaseOutside.call(this,a);e.callMethod("handleReleaseOutside",[this.chartScrollbar,this.valueScrollbar])},update:function(){e.AmSerialChart.base.update.call(this);this.chartScrollbar&&this.chartScrollbar.update&&this.chartScrollbar.update();this.valueScrollbar&&this.valueScrollbar.update&&this.valueScrollbar.update()},processScrollbars:function(){e.AmSerialChart.base.processScrollbars.call(this);var a=this.valueScrollbar;a&&(a=e.processObject(a,e.ChartScrollbar,this.theme),a.id="valueScrollbar",this.addValueScrollbar(a))},handleValueAxisZoom:function(a){this.handleValueAxisZoomReal(a,this.valueAxes)},zoomOut:function(){e.AmSerialChart.base.zoomOut.call(this);this.zoom()},getNextItem:function(a){var b=a.index,c=this.chartData,d=a.graph;if(b+1<c.length)for(b+=1;b<c.length;b++)if(a=c[b])if(a=a.axes[d.valueAxis.id].graphs[d.id],!isNaN(a.y))return a},handleCursorZoomReal:function(a,b,c,d,e){var h=e.target,f,k;this.rotate?(isNaN(a)||isNaN(b)||this.relativeZoomValueAxes(this.valueAxes,a,b)&&this.updateAfterValueZoom(),h.vZoomEnabled&&(f=e.start,k=e.end)):(isNaN(c)||isNaN(d)||this.relativeZoomValueAxes(this.valueAxes,c,d)&&this.updateAfterValueZoom(),h.hZoomEnabled&&(f=e.start,k=e.end));isNaN(f)||isNaN(k)||(a=this.categoryAxis,a.parseDates&&!a.equalSpacing?this.zoomToDates(new Date(f),new Date(k)):this.zoomToIndexes(f,k))},handleCursorZoomStarted:function(){var a=this.valueAxes;if(a){var a=a[0],b=a.relativeStart,c=a.relativeEnd;a.reversed&&(b=1-a.relativeEnd,c=1-a.relativeStart);this.rotate?(this.startX0=b,this.endX0=c):(this.startY0=b,this.endY0=c)}this.categoryAxis&&(this.start0=this.start,this.end0=this.end,this.startTime0=this.startTime,this.endTime0=this.endTime)},fixCursor:function(){this.chartCursor&&this.chartCursor.fixPosition();this.prevCursorItem=null},handleCursorMove:function(a){e.AmSerialChart.base.handleCursorMove.call(this,a);var b=a.target,c=this.categoryAxis;if(a.panning)this.handleCursorHide(a);else if(this.chartData&&!b.isHidden){var d=this.graphs;if(d){var g;g=c.xToIndex(this.rotate?a.y:a.x);if(g=this.chartData[g]){var h,f,k,l;if(b.oneBalloonOnly&&b.valueBalloonsEnabled){var m=Infinity;for(h=0;h<d.length;h++)if(f=d[h],f.balloon.enabled&&f.showBalloon&&!f.hidden){k=f.valueAxis.id;k=g.axes[k].graphs[f.id];k=k.y;"top"==f.showBalloonAt&&(k=0);"bottom"==f.showBalloonAt&&(k=this.height);var p=b.mouseX,n=b.mouseY;k=this.rotate?Math.abs(p-k):Math.abs(n-k);k<m&&(m=k,l=f)}b.mostCloseGraph=l}if(this.prevCursorItem!=g||l!=this.prevMostCloseGraph){m=[];for(h=0;h<d.length;h++)f=d[h],k=f.valueAxis.id,k=g.axes[k].graphs[f.id],b.showNextAvailable&&isNaN(k.y)&&(k=this.getNextItem(k)),l&&f!=l?(f.showGraphBalloon(k,b.pointer,!1,b.graphBulletSize,b.graphBulletAlpha),f.balloon.hide(0)):b.valueBalloonsEnabled?(f.balloon.showBullet=b.bulletsEnabled,f.balloon.bulletSize=b.bulletSize/2,a.hideBalloons||(f.showGraphBalloon(k,b.pointer,!1,b.graphBulletSize,b.graphBulletAlpha),f.balloon.set&&m.push({balloon:f.balloon,y:f.balloon.pointToY}))):(f.currentDataItem=k,f.resizeBullet(k,b.graphBulletSize,b.graphBulletAlpha));b.avoidBalloonOverlapping&&this.arrangeBalloons(m);this.prevCursorItem=g}this.prevMostCloseGraph=l}}c.showBalloon(a.x,a.y,b.categoryBalloonDateFormat,a.skip);this.updateLegendValues()}},handleCursorHide:function(a){e.AmSerialChart.base.handleCursorHide.call(this,a);a=this.categoryAxis;this.prevCursorItem=null;this.updateLegendValues();a&&a.hideBalloon();a=this.graphs;var b;for(b=0;b<a.length;b++)a[b].currentDataItem=null},handleCursorPanning:function(a){var b=a.target,c,d=a.deltaX,g=a.deltaY,h=a.delta2X,f=a.delta2Y;a=!1;if(this.rotate){isNaN(h)&&(h=d,a=!0);var k=this.endX0;c=this.startX0;var l=k-c,k=k-l*h,m=l;a||(m=0);a=e.fitToBounds(c-l*d,0,1-m)}else isNaN(f)&&(f=g,a=!0),k=this.endY0,c=this.startY0,l=k-c,k+=l*g,m=l,a||(m=0),a=e.fitToBounds(c+l*f,0,1-m);c=e.fitToBounds(k,m,1);var p;b.valueZoomable&&(p=this.relativeZoomValueAxes(this.valueAxes,a,c));var n;c=this.categoryAxis;this.rotate&&(d=g,h=f);a=!1;isNaN(h)&&(h=d,a=!0);if(b.zoomable&&(0<Math.abs(d)||0<Math.abs(h)))if(c.parseDates&&!c.equalSpacing){if(f=this.startTime0,g=this.endTime0,c=g-f,h*=c,l=this.firstTime,k=this.lastTime,m=c,a||(m=0),a=Math.round(e.fitToBounds(f-c*d,l,k-m)),h=Math.round(e.fitToBounds(g-h,l+m,k)),this.startTime!=a||this.endTime!=h)n={chart:this,target:b,type:"zoomed",start:a,end:h},this.skipZoomed=!0,b.fire(n),this.zoom(a,h),n=!0}else if(f=this.start0,g=this.end0,c=g-f,d=Math.round(c*d),h=Math.round(c*h),l=this.chartData.length-1,a||(c=0),a=e.fitToBounds(f-d,0,l-c),c=e.fitToBounds(g-h,c,l),this.start!=a||this.end!=c)this.skipZoomed=!0,b.fire({chart:this,target:b,type:"zoomed",start:a,end:c}),this.zoom(a,c),n=!0;!n&&p&&this.updateAfterValueZoom()},arrangeBalloons:function(a){var b=this.plotAreaHeight;a.sort(this.compareY);var c,d,e,h=this.plotAreaWidth,f=a.length;for(c=0;c<f;c++)d=a[c].balloon,d.setBounds(0,0,h,b),d.restorePrevious(),d.draw(),b=d.yPos-3;a.reverse();for(c=0;c<f;c++){d=a[c].balloon;var b=d.bottom,k=d.bottom-d.yPos;0<c&&b-k<e+3&&(d.setBounds(0,e+3,h,e+k+3),d.restorePrevious(),d.draw());d.set&&d.set.show();e=d.bottom}},compareY:function(a,b){return a.y<b.y?1:-1}})})();(function(){var e=window.AmCharts;e.Cuboid=e.Class({construct:function(a,b,c,d,e,h,f,k,l,m,p,n,r,w,z,u,q){this.set=a.set();this.container=a;this.h=Math.round(c);this.w=Math.round(b);this.dx=d;this.dy=e;this.colors=h;this.alpha=f;this.bwidth=k;this.bcolor=l;this.balpha=m;this.dashLength=w;this.topRadius=u;this.pattern=z;this.rotate=r;this.bcn=q;r?0>b&&0===p&&(p=180):0>c&&270==p&&(p=90);this.gradientRotation=p;0===d&&0===e&&(this.cornerRadius=n);this.draw()},draw:function(){var a=this.set;a.clear();var b=this.container,c=b.chart,d=this.w,g=this.h,h=this.dx,f=this.dy,k=this.colors,l=this.alpha,m=this.bwidth,p=this.bcolor,n=this.balpha,r=this.gradientRotation,w=this.cornerRadius,z=this.dashLength,u=this.pattern,q=this.topRadius,D=this.bcn,v=k,t=k;"object"==typeof k&&(v=k[0],t=k[k.length-1]);var x,B,A,G,y,C,F,L,M,Q=l;u&&(l=0);var E,H,I,J,K=this.rotate;if(0<Math.abs(h)||0<Math.abs(f))if(isNaN(q))F=t,t=e.adjustLuminosity(v,-.2),t=e.adjustLuminosity(v,-.2),x=e.polygon(b,[0,h,d+h,d,0],[0,f,f,0,0],t,l,1,p,0,r),0<n&&(M=e.line(b,[0,h,d+h],[0,f,f],p,n,m,z)),B=e.polygon(b,[0,0,d,d,0],[0,g,g,0,0],t,l,1,p,0,r),B.translate(h,f),0<n&&(A=e.line(b,[h,h],[f,f+g],p,n,m,z)),G=e.polygon(b,[0,0,h,h,0],[0,g,g+f,f,0],t,l,1,p,0,r),y=e.polygon(b,[d,d,d+h,d+h,d],[0,g,g+f,f,0],t,l,1,p,0,r),0<n&&(C=e.line(b,[d,d+h,d+h,d],[0,f,g+f,g],p,n,m,z)),t=e.adjustLuminosity(F,.2),F=e.polygon(b,[0,h,d+h,d,0],[g,g+f,g+f,g,g],t,l,1,p,0,r),0<n&&(L=e.line(b,[0,h,d+h],[g,g+f,g+f],p,n,m,z));else{var N,O,P;K?(N=g/2,t=h/2,P=g/2,O=d+h/2,H=Math.abs(g/2),E=Math.abs(h/2)):(t=d/2,N=f/2,O=d/2,P=g+f/2+1,E=Math.abs(d/2),H=Math.abs(f/2));I=E*q;J=H*q;.1<E&&.1<E&&(x=e.circle(b,E,v,l,m,p,n,!1,H),x.translate(t,N));.1<I&&.1<I&&(F=e.circle(b,I,e.adjustLuminosity(v,.5),l,m,p,n,!1,J),F.translate(O,P))}l=Q;1>Math.abs(g)&&(g=0);1>Math.abs(d)&&(d=0);!isNaN(q)&&(0<Math.abs(h)||0<Math.abs(f))?(k=[v],k={fill:k,stroke:p,"stroke-width":m,"stroke-opacity":n,"fill-opacity":l},K?(l="M0,0 L"+d+","+(g/2-g/2*q),m=" B",0<d&&(m=" A"),e.VML?(l+=m+Math.round(d-I)+","+Math.round(g/2-J)+","+Math.round(d+I)+","+Math.round(g/2+J)+","+d+",0,"+d+","+g,l=l+(" L0,"+g)+(m+Math.round(-E)+","+Math.round(g/2-H)+","+Math.round(E)+","+Math.round(g/2+H)+",0,"+g+",0,0")):(l+="A"+I+","+J+",0,0,0,"+d+","+(g-g/2*(1-q))+"L0,"+g,l+="A"+E+","+H+",0,0,1,0,0"),E=90):(m=d/2-d/2*q,l="M0,0 L"+m+","+g,e.VML?(l="M0,0 L"+m+","+g,m=" B",0>g&&(m=" A"),l+=m+Math.round(d/2-I)+","+Math.round(g-J)+","+Math.round(d/2+I)+","+Math.round(g+J)+",0,"+g+","+d+","+g,l+=" L"+d+",0",l+=m+Math.round(d/2+E)+","+Math.round(H)+","+Math.round(d/2-E)+","+Math.round(-H)+","+d+",0,0,0"):(l+="A"+I+","+J+",0,0,0,"+(d-d/2*(1-q))+","+g+"L"+d+",0",l+="A"+E+","+H+",0,0,1,0,0"),E=180),b=b.path(l).attr(k),b.gradient("linearGradient",[v,e.adjustLuminosity(v,-.3),e.adjustLuminosity(v,-.3),v],E),K?b.translate(h/2,0):b.translate(0,f/2)):b=0===g?e.line(b,[0,d],[0,0],p,n,m,z):0===d?e.line(b,[0,0],[0,g],p,n,m,z):0<w?e.rect(b,d,g,k,l,m,p,n,w,r,z):e.polygon(b,[0,0,d,d,0],[0,g,g,0,0],k,l,m,p,n,r,!1,z);d=isNaN(q)?0>g?[x,M,B,A,G,y,C,F,L,b]:[F,L,B,A,G,y,x,M,C,b]:K?0<d?[x,b,F]:[F,b,x]:0>g?[x,b,F]:[F,b,x];e.setCN(c,b,D+"front");e.setCN(c,B,D+"back");e.setCN(c,F,D+"top");e.setCN(c,x,D+"bottom");e.setCN(c,G,D+"left");e.setCN(c,y,D+"right");for(x=0;x<d.length;x++)if(B=d[x])a.push(B),e.setCN(c,B,D+"element");u&&b.pattern(u,NaN,c.path)},width:function(a){isNaN(a)&&(a=0);this.w=Math.round(a);this.draw()},height:function(a){isNaN(a)&&(a=0);this.h=Math.round(a);this.draw()},animateHeight:function(a,b){var c=this;c.animationFinished=!1;c.easing=b;c.totalFrames=a*e.updateRate;c.rh=c.h;c.frame=0;c.height(1);setTimeout(function(){c.updateHeight.call(c)},1e3/e.updateRate)},updateHeight:function(){var a=this;a.frame++;var b=a.totalFrames;a.frame<=b?(b=a.easing(0,a.frame,1,a.rh-1,b),a.height(b),window.requestAnimationFrame?window.requestAnimationFrame(function(){a.updateHeight.call(a)}):setTimeout(function(){a.updateHeight.call(a)},1e3/e.updateRate)):(a.height(a.rh),a.animationFinished=!0)},animateWidth:function(a,b){var c=this;c.animationFinished=!1;c.easing=b;c.totalFrames=a*e.updateRate;c.rw=c.w;c.frame=0;c.width(1);setTimeout(function(){c.updateWidth.call(c)},1e3/e.updateRate)},updateWidth:function(){var a=this;a.frame++;var b=a.totalFrames;a.frame<=b?(b=a.easing(0,a.frame,1,a.rw-1,b),a.width(b),window.requestAnimationFrame?window.requestAnimationFrame(function(){a.updateWidth.call(a)}):setTimeout(function(){a.updateWidth.call(a)},1e3/e.updateRate)):(a.width(a.rw),a.animationFinished=!0)}})})();(function(){var e=window.AmCharts;e.CategoryAxis=e.Class({inherits:e.AxisBase,construct:function(a){this.cname="CategoryAxis";e.CategoryAxis.base.construct.call(this,a);this.minPeriod="DD";this.equalSpacing=this.parseDates=!1;this.position="bottom";this.startOnAxis=!1;this.gridPosition="middle";this.safeDistance=30;this.stickBalloonToCategory=!1;e.applyTheme(this,a,this.cname)},draw:function(){e.CategoryAxis.base.draw.call(this);this.generateDFObject();var a=this.chart.chartData;this.data=a;this.labelRotationR=this.labelRotation;this.type=null;if(e.ifArray(a)){var b,c=this.chart;"scrollbar"!=this.id?(e.setCN(c,this.set,"category-axis"),e.setCN(c,this.labelsSet,"category-axis"),e.setCN(c,this.axisLine.axisSet,"category-axis")):this.bcn=this.id+"-";var d=this.start,g=this.labelFrequency,h=0,f=this.end-d+1,k=this.gridCountR,l=this.showFirstLabel,m=this.showLastLabel,p,n="",n=e.extractPeriod(this.minPeriod),r=e.getPeriodDuration(n.period,n.count),w,z,u,q,D=this.rotate;p=this.firstDayOfWeek;var v=this.boldPeriodBeginning;b=e.resetDateToMin(new Date(a[a.length-1].time+1.05*r),this.minPeriod,1,p).getTime();this.firstTime=c.firstTime;var t;this.endTime>b&&(this.endTime=b);q=this.minorGridEnabled;z=this.gridAlpha;var x=0,B=0;if(this.widthField)for(b=this.start;b<=this.end;b++)if(t=this.data[b]){var A=Number(this.data[b].dataContext[this.widthField]);isNaN(A)||(x+=A,t.widthValue=A)}if(this.parseDates&&!this.equalSpacing)this.lastTime=a[a.length-1].time,this.maxTime=e.resetDateToMin(new Date(this.lastTime+1.05*r),this.minPeriod,1,p).getTime(),this.timeDifference=this.endTime-this.startTime,this.parseDatesDraw();else if(!this.parseDates){if(this.cellWidth=this.getStepWidth(f),f<k&&(k=f),h+=this.start,this.stepWidth=this.getStepWidth(f),0<k)for(v=Math.floor(f/k),r=this.chooseMinorFrequency(v),f=h,f/2==Math.round(f/2)&&f--,0>f&&(f=0),k=0,this.widthField&&(f=this.start),this.end-f+1>=this.autoRotateCount&&(this.labelRotationR=this.autoRotateAngle),b=f;b<=this.end+2;b++){p=!1;0<=b&&b<this.data.length?(w=this.data[b],n=w.category,p=w.forceShow):n="";if(q&&!isNaN(r))if(b/r==Math.round(b/r)||p)b/v==Math.round(b/v)||p||(this.gridAlpha=this.minorGridAlpha,n=void 0);else continue;else if(b/v!=Math.round(b/v)&&!p)continue;f=this.getCoordinate(b-h);u=0;"start"==this.gridPosition&&(f-=this.cellWidth/2,u=this.cellWidth/2);p=!0;a=u;"start"==this.tickPosition&&(a=0,p=!1,u=0);if(b==d&&!l||b==this.end&&!m)n=void 0;Math.round(k/g)!=k/g&&(n=void 0);k++;A=this.cellWidth;D&&(A=NaN,this.ignoreAxisWidth||!c.autoMargins)&&(A="right"==this.position?c.marginRight:c.marginLeft,A-=this.tickLength+10);this.labelFunction&&w&&(n=this.labelFunction(n,w,this));n=e.fixBrakes(n);t=!1;this.boldLabels&&(t=!0);b>this.end&&"start"==this.tickPosition&&(n=" ");this.rotate&&this.inside&&(u-=2);isNaN(w.widthValue)||(w.percentWidthValue=w.widthValue/x*100,A=this.rotate?this.height*w.widthValue/x:this.width*w.widthValue/x,f=B,B+=A,u=A/2);u=new this.axisItemRenderer(this,f,n,p,A,u,void 0,t,a,!1,w.labelColor,w.className);u.serialDataItem=w;this.pushAxisItem(u);this.gridAlpha=z}}else if(this.parseDates&&this.equalSpacing){h=this.start;this.startTime=this.data[this.start].time;this.endTime=this.data[this.end].time;this.timeDifference=this.endTime-this.startTime;b=this.choosePeriod(0);g=b.period;w=b.count;b=e.getPeriodDuration(g,w);b<r&&(g=n.period,w=n.count,b=r);z=g;"WW"==z&&(z="DD");this.currentDateFormat=this.dateFormatsObject[z];this.stepWidth=this.getStepWidth(f);k=Math.ceil(this.timeDifference/b)+1;n=e.resetDateToMin(new Date(this.startTime-b),g,w,p).getTime();this.cellWidth=this.getStepWidth(f);f=Math.round(n/b);d=-1;f/2==Math.round(f/2)&&(d=-2,n-=b);f=this.start;f/2==Math.round(f/2)&&f--;0>f&&(f=0);B=this.end+2;B>=this.data.length&&(B=this.data.length);a=!1;a=!l;this.previousPos=-1e3;20<this.labelRotationR&&(this.safeDistance=5);A=f;if(this.data[f].time!=e.resetDateToMin(new Date(this.data[f].time),g,w,p).getTime()){t=0;var G=n;for(b=f;b<B;b++)r=this.data[b].time,this.checkPeriodChange(g,w,r,G)&&(t++,2<=t&&(A=b,b=B),G=r)}q&&1<w&&(r=this.chooseMinorFrequency(w),e.getPeriodDuration(g,r));if(0<this.gridCountR)for(b=f;b<B;b++)if(r=this.data[b].time,this.checkPeriodChange(g,w,r,n)&&b>=A){f=this.getCoordinate(b-this.start);q=!1;this.nextPeriod[z]&&(q=this.checkPeriodChange(this.nextPeriod[z],1,r,n,z))&&e.resetDateToMin(new Date(r),this.nextPeriod[z],1,p).getTime()!=r&&(q=!1);t=!1;q&&this.markPeriodChange?(q=this.dateFormatsObject[this.nextPeriod[z]],t=!0):q=this.dateFormatsObject[z];n=e.formatDate(new Date(r),q,c);if(b==d&&!l||b==k&&!m)n=" ";a?a=!1:(v||(t=!1),f-this.previousPos>this.safeDistance*Math.cos(this.labelRotationR*Math.PI/180)&&(this.labelFunction&&(n=this.labelFunction(n,new Date(r),this,g,w,u)),this.boldLabels&&(t=!0),u=new this.axisItemRenderer(this,f,n,void 0,void 0,void 0,void 0,t),q=u.graphics(),this.pushAxisItem(u),q=q.getBBox().width,e.isModern||(q-=f),this.previousPos=f+q));u=n=r}}for(b=l=0;b<this.data.length;b++)if(t=this.data[b])this.parseDates&&!this.equalSpacing?(m=t.time,d=this.cellWidth,"MM"==this.minPeriod&&(d=864e5*e.daysInMonth(new Date(m))*this.stepWidth,t.cellWidth=d),m=Math.round((m-this.startTime)*this.stepWidth+d/2)):m=this.getCoordinate(b-h),t.x[this.id]=m;if(this.widthField)for(b=this.start;b<=this.end;b++)t=this.data[b],d=t.widthValue,t.percentWidthValue=d/x*100,this.rotate?(m=this.height*d/x/2+l,l=this.height*d/x+l):(m=this.width*d/x/2+l,l=this.width*d/x+l),t.x[this.id]=m;x=this.guides.length;for(b=0;b<x;b++)if(l=this.guides[b],p=v=v=q=d=NaN,m=l.above,l.toCategory&&(v=c.getCategoryIndexByValue(l.toCategory),isNaN(v)||(d=this.getCoordinate(v-h),l.expand&&(d+=this.cellWidth/2),u=new this.axisItemRenderer(this,d,"",!0,NaN,NaN,l),this.pushAxisItem(u,m))),l.category&&(p=c.getCategoryIndexByValue(l.category),isNaN(p)||(q=this.getCoordinate(p-h),l.expand&&(q-=this.cellWidth/2),v=(d-q)/2,u=new this.axisItemRenderer(this,q,l.label,!0,NaN,v,l),this.pushAxisItem(u,m))),p=c.dataDateFormat,l.toDate&&(!p||l.toDate instanceof Date||(l.toDate=l.toDate.toString()+" |"),l.toDate=e.getDate(l.toDate,p),this.equalSpacing?(v=c.getClosestIndex(this.data,"time",l.toDate.getTime(),!1,0,this.data.length-1),isNaN(v)||(d=this.getCoordinate(v-h))):d=(l.toDate.getTime()-this.startTime)*this.stepWidth,u=new this.axisItemRenderer(this,d,"",!0,NaN,NaN,l),this.pushAxisItem(u,m)),l.date&&(!p||l.date instanceof Date||(l.date=l.date.toString()+" |"),l.date=e.getDate(l.date,p),this.equalSpacing?(p=c.getClosestIndex(this.data,"time",l.date.getTime(),!1,0,this.data.length-1),isNaN(p)||(q=this.getCoordinate(p-h))):q=(l.date.getTime()-this.startTime)*this.stepWidth,v=(d-q)/2,p=!0,l.toDate&&(p=!1),u="H"==this.orientation?new this.axisItemRenderer(this,q,l.label,p,2*v,NaN,l):new this.axisItemRenderer(this,q,l.label,!1,NaN,v,l),this.pushAxisItem(u,m)),0<d||0<q){p=!1;if(this.rotate){if(d<this.height||q<this.height)p=!0}else if(d<this.width||q<this.width)p=!0;p&&(d=new this.guideFillRenderer(this,q,d,l),q=d.graphics(),this.pushAxisItem(d,m),l.graphics=q,q.index=b,l.balloonText&&this.addEventListeners(q,l))}if(c=c.chartCursor)D?c.fixHeight(this.cellWidth):(c.fixWidth(this.cellWidth),c.fullWidth&&this.balloon&&(this.balloon.minWidth=this.cellWidth));this.previousHeight=y}this.axisCreated=!0;this.set.translate(this.x,this.y);this.labelsSet.translate(this.x,this.y);this.labelsSet.show();this.positionTitle();(D=this.axisLine.set)&&D.toFront();var y=this.getBBox().height;2<y-this.previousHeight&&this.autoWrap&&!this.parseDates&&(this.axisCreated=this.chart.marginsUpdated=!1)},xToIndex:function(a){var b=this.data,c=this.chart,d=c.rotate,g=this.stepWidth,h;if(this.parseDates&&!this.equalSpacing)a=this.startTime+Math.round(a/g)-this.minDuration()/2,h=c.getClosestIndex(b,"time",a,!1,this.start,this.end+1);else if(this.widthField)for(c=Infinity,g=this.start;g<=this.end;g++){var f=this.data[g];f&&(f=Math.abs(f.x[this.id]-a),f<c&&(c=f,h=g))}else this.startOnAxis||(a-=g/2),h=this.start+Math.round(a/g);h=e.fitToBounds(h,0,b.length-1);var k;b[h]&&(k=b[h].x[this.id]);d?k>this.height+1&&h--:k>this.width+1&&h--;0>k&&h++;return h=e.fitToBounds(h,0,b.length-1)},dateToCoordinate:function(a){return this.parseDates&&!this.equalSpacing?(a.getTime()-this.startTime)*this.stepWidth:this.parseDates&&this.equalSpacing?(a=this.chart.getClosestIndex(this.data,"time",a.getTime(),!1,0,this.data.length-1),this.getCoordinate(a-this.start)):NaN},categoryToCoordinate:function(a){if(this.chart){var b=this.chart.getCategoryIndexByValue(a);if(!isNaN(b))return this.getCoordinate(b-this.start);if(this.parseDates)return this.dateToCoordinate(new Date(a))}else return NaN},coordinateToDate:function(a){return this.equalSpacing?(a=this.xToIndex(a),new Date(this.data[a].time)):new Date(this.startTime+a/this.stepWidth)},coordinateToValue:function(a){a=this.xToIndex(a);if(a=this.data[a])return this.parseDates?a.time:a.category},getCoordinate:function(a){a*=this.stepWidth;this.startOnAxis||(a+=this.stepWidth/2);return Math.round(a)},formatValue:function(a,b){b||(b=this.currentDateFormat);this.parseDates&&(a=e.formatDate(new Date(a),b,this.chart));return a},showBalloonAt:function(a){a=this.parseDates?this.dateToCoordinate(new Date(a)):this.categoryToCoordinate(a);return this.adjustBalloonCoordinate(a)},formatBalloonText:function(a,b,c){var d="",g="",h=this.chart,f=this.data[b];if(f)if(this.parseDates)d=e.formatDate(f.category,c,h),b=e.changeDate(new Date(f.category),this.minPeriod,1),g=e.formatDate(b,c,h),-1!=d.indexOf("fff")&&(d=e.formatMilliseconds(d,f.category),g=e.formatMilliseconds(g,b));else{var k;this.data[b+1]&&(k=this.data[b+1]);d=e.fixNewLines(f.category);k&&(g=e.fixNewLines(k.category))}a=a.replace(/\[\[category\]\]/g,String(d));return a=a.replace(/\[\[toCategory\]\]/g,String(g))},adjustBalloonCoordinate:function(a,b){var c=this.xToIndex(a),d=this.chart.chartCursor;if(this.stickBalloonToCategory){var e=this.data[c];e&&(a=e.x[this.id]);this.stickBalloonToStart&&(a-=this.cellWidth/2);var h=0;if(d){var f=d.limitToGraph;if(f){var k=f.valueAxis.id;f.hidden||(h=e.axes[k].graphs[f.id].y)}this.rotate?("left"==this.position?(f&&(h-=d.width),0<h&&(h=0)):0>h&&(h=0),d.fixHLine(a,h)):("top"==this.position?(f&&(h-=d.height),0<h&&(h=0)):0>h&&(h=0),d.fixVLine(a,h))}}d&&!b&&(d.setIndex(c),this.parseDates&&d.setTimestamp(this.coordinateToDate(a).getTime()));return a}})})();(function(){var k=window.AmCharts;k.AmSlicedChart=k.Class({inherits:k.AmChart,construct:function(a){this.createEvents("rollOverSlice","rollOutSlice","clickSlice","pullOutSlice","pullInSlice","rightClickSlice");k.AmSlicedChart.base.construct.call(this,a);this.colors="#FF0F00 #FF6600 #FF9E01 #FCD202 #F8FF01 #B0DE09 #04D215 #0D8ECF #0D52D1 #2A0CD0 #8A0CCF #CD0D74 #754DEB #DDDDDD #999999 #333333 #000000 #57032A #CA9726 #990000 #4B0C25".split(" ");this.alpha=1;this.groupPercent=0;this.groupedTitle="Other";this.groupedPulled=!1;this.groupedAlpha=1;this.marginLeft=0;this.marginBottom=this.marginTop=10;this.marginRight=0;this.hoverAlpha=1;this.outlineColor="#FFFFFF";this.outlineAlpha=0;this.outlineThickness=1;this.startAlpha=0;this.startDuration=1;this.startEffect="bounce";this.sequencedAnimation=!0;this.pullOutDuration=1;this.pullOutEffect="bounce";this.pullOnHover=this.pullOutOnlyOne=!1;this.labelsEnabled=!0;this.labelTickColor="#000000";this.labelTickAlpha=.2;this.hideLabelsPercent=0;this.urlTarget="_self";this.autoMarginOffset=10;this.gradientRatio=[];this.maxLabelWidth=200;this.accessibleLabel="[[title]]: [[percents]]% [[value]] [[description]]";k.applyTheme(this,a,"AmSlicedChart")},initChart:function(){k.AmSlicedChart.base.initChart.call(this);this.dataChanged&&(this.parseData(),this.dispatchDataUpdated=!0,this.dataChanged=!1,this.setLegendData(this.chartData));this.drawChart()},handleLegendEvent:function(a){var b=a.type,c=a.dataItem,d=this.legend;if(!d.data&&c){var g=c.hidden;a=a.event;switch(b){case"clickMarker":g||d.switchable||this.clickSlice(c,a);break;case"clickLabel":g||this.clickSlice(c,a,!1);break;case"rollOverItem":g||this.rollOverSlice(c,!1,a);break;case"rollOutItem":g||this.rollOutSlice(c,a);break;case"hideItem":this.hideSlice(c,a);break;case"showItem":this.showSlice(c,a)}}},invalidateVisibility:function(){this.recalculatePercents();this.initChart();var a=this.legend;a&&a.invalidateSize()},addEventListeners:function(a,b){var c=this;a.mouseover(function(a){c.rollOverSlice(b,!0,a)}).mouseout(function(a){c.rollOutSlice(b,a)}).touchend(function(a){c.rollOverSlice(b,a)}).mouseup(function(a){c.clickSlice(b,a)}).contextmenu(function(a){c.handleRightClick(b,a)})},formatString:function(a,b,c){a=k.formatValue(a,b,["value"],this.nf,"",this.usePrefixes,this.prefixesOfSmallNumbers,this.prefixesOfBigNumbers);var d=this.pf.precision;isNaN(this.tempPrec)||(this.pf.precision=this.tempPrec);a=k.formatValue(a,b,["percents"],this.pf);a=k.massReplace(a,{"[[title]]":b.title,"[[description]]":b.description});this.pf.precision=d;-1!=a.indexOf("[[")&&(a=k.formatDataContextValue(a,b.dataContext));a=c?k.fixNewLines(a):k.fixBrakes(a);return a=k.cleanFromEmpty(a)},startSlices:function(){var a;for(a=0;a<this.chartData.length;a++)0<this.startDuration&&this.sequencedAnimation?this.setStartTO(a):this.startSlice(this.chartData[a])},setStartTO:function(a){var b=this;a=setTimeout(function(){b.startSequenced.call(b)},b.startDuration/b.chartData.length*500*a);b.timeOuts.push(a)},pullSlices:function(a){var b=this.chartData,c;for(c=0;c<b.length;c++){var d=b[c];d.pulled&&this.pullSlice(d,1,a)}},startSequenced:function(){var a=this.chartData,b;for(b=0;b<a.length;b++)if(!a[b].started){this.startSlice(this.chartData[b]);break}},startSlice:function(a){a.started=!0;var b=a.wedge,c=this.startDuration,d=a.labelSet;b&&0<c&&(0<a.alpha&&b.show(),b.translate(a.startX,a.startY),this.animatable.push(b),b.animate({opacity:1,translate:"0,0"},c,this.startEffect));d&&0<c&&(0<a.alpha&&d.show(),d.translate(a.startX,a.startY),d.animate({opacity:1,translate:"0,0"},c,this.startEffect))},showLabels:function(){var a=this.chartData,b;for(b=0;b<a.length;b++){var c=a[b];if(0<c.alpha){var d=c.label;d&&d.show();(c=c.tick)&&c.show()}}},showSlice:function(a){isNaN(a)?a.hidden=!1:this.chartData[a].hidden=!1;this.invalidateVisibility()},hideSlice:function(a){isNaN(a)?a.hidden=!0:this.chartData[a].hidden=!0;this.hideBalloon();this.invalidateVisibility()},rollOverSlice:function(a,b,c){isNaN(a)||(a=this.chartData[a]);clearTimeout(this.hoverInt);if(!a.hidden){this.pullOnHover&&this.pullSlice(a,1);1>this.hoverAlpha&&a.wedge&&a.wedge.attr({opacity:this.hoverAlpha});var d=a.balloonX,g=a.balloonY;a.pulled&&(d+=a.pullX,g+=a.pullY);var f=this.formatString(this.balloonText,a,!0),h=this.balloonFunction;h&&(f=h(a,f));h=k.adjustLuminosity(a.color,-.15);f?this.showBalloon(f,h,b,d,g):this.hideBalloon();0===a.value&&this.hideBalloon();this.fire({type:"rollOverSlice",dataItem:a,chart:this,event:c})}},rollOutSlice:function(a,b){isNaN(a)||(a=this.chartData[a]);a.wedge&&a.wedge.attr({opacity:1});this.hideBalloon();this.fire({type:"rollOutSlice",dataItem:a,chart:this,event:b})},clickSlice:function(a,b,c){this.checkTouchDuration(b)&&(isNaN(a)||(a=this.chartData[a]),a.pulled?this.pullSlice(a,0):this.pullSlice(a,1),k.getURL(a.url,this.urlTarget),c||this.fire({type:"clickSlice",dataItem:a,chart:this,event:b}))},handleRightClick:function(a,b){isNaN(a)||(a=this.chartData[a]);this.fire({type:"rightClickSlice",dataItem:a,chart:this,event:b})},drawTicks:function(){var a=this.chartData,b;for(b=0;b<a.length;b++){var c=a[b];if(c.label&&!c.skipTick){var d=c.ty,d=k.line(this.container,[c.tx0,c.tx,c.tx2],[c.ty0,d,d],this.labelTickColor,this.labelTickAlpha);k.setCN(this,d,this.type+"-tick");k.setCN(this,d,c.className,!0);c.tick=d;c.wedge.push(d)}}},initialStart:function(){var a=this,b=a.startDuration,c=setTimeout(function(){a.showLabels.call(a)},1e3*b);a.timeOuts.push(c);a.chartCreated?a.pullSlices(!0):(a.startSlices(),0<b?(b=setTimeout(function(){a.pullSlices.call(a)},1200*b),a.timeOuts.push(b)):a.pullSlices(!0))},pullSlice:function(a,b,c){var d=this.pullOutDuration;!0===c&&(d=0);if(c=a.wedge)0<d?(c.animate({translate:b*a.pullX+","+b*a.pullY},d,this.pullOutEffect),a.labelSet&&a.labelSet.animate({translate:b*a.pullX+","+b*a.pullY},d,this.pullOutEffect)):(a.labelSet&&a.labelSet.translate(b*a.pullX,b*a.pullY),c.translate(b*a.pullX,b*a.pullY));1==b?(a.pulled=!0,this.pullOutOnlyOne&&this.pullInAll(a.index),a={type:"pullOutSlice",dataItem:a,chart:this}):(a.pulled=!1,a={type:"pullInSlice",dataItem:a,chart:this});this.fire(a)},pullInAll:function(a){var b=this.chartData,c;for(c=0;c<this.chartData.length;c++)c!=a&&b[c].pulled&&this.pullSlice(b[c],0)},pullOutAll:function(){var a=this.chartData,b;for(b=0;b<a.length;b++)a[b].pulled||this.pullSlice(a[b],1)},parseData:function(){var a=[];this.chartData=a;var b=this.dataProvider;isNaN(this.pieAlpha)||(this.alpha=this.pieAlpha);if(void 0!==b){var c=b.length,d=0,g,f,h;for(g=0;g<c;g++){f={};var e=b[g];f.dataContext=e;null!==e[this.valueField]&&(f.value=Number(e[this.valueField]));(h=e[this.titleField])||(h="");f.title=h;f.pulled=k.toBoolean(e[this.pulledField],!1);(h=e[this.descriptionField])||(h="");f.description=h;f.labelRadius=Number(e[this.labelRadiusField]);f.switchable=!0;f.className=e[this.classNameField];f.url=e[this.urlField];h=e[this.patternField];!h&&this.patterns&&(h=this.patterns[g]);f.pattern=h;f.visibleInLegend=k.toBoolean(e[this.visibleInLegendField],!0);h=e[this.alphaField];f.alpha=void 0!==h?Number(h):this.alpha;h=e[this.colorField];void 0!==h&&(f.color=h);f.labelColor=k.toColor(e[this.labelColorField]);d+=f.value;f.hidden=!1;a[g]=f}for(g=b=0;g<c;g++)f=a[g],f.percents=f.value/d*100,f.percents<this.groupPercent&&b++;1<b&&(this.groupValue=0,this.removeSmallSlices(),a.push({title:this.groupedTitle,value:this.groupValue,percents:this.groupValue/d*100,pulled:this.groupedPulled,color:this.groupedColor,url:this.groupedUrl,description:this.groupedDescription,alpha:this.groupedAlpha,pattern:this.groupedPattern,className:this.groupedClassName,dataContext:{}}));c=this.baseColor;c||(c=this.pieBaseColor);d=this.brightnessStep;d||(d=this.pieBrightnessStep);for(g=0;g<a.length;g++)c?h=k.adjustLuminosity(c,g*d/100):(h=this.colors[g],void 0===h&&(h=k.randomColor())),void 0===a[g].color&&(a[g].color=h);this.recalculatePercents()}},recalculatePercents:function(){var a=this.chartData,b=0,c,d;for(c=0;c<a.length;c++)d=a[c],!d.hidden&&0<d.value&&(b+=d.value);for(c=0;c<a.length;c++)d=this.chartData[c],d.percents=!d.hidden&&0<d.value?100*d.value/b:0},removeSmallSlices:function(){var a=this.chartData,b;for(b=a.length-1;0<=b;b--)a[b].percents<this.groupPercent&&(this.groupValue+=a[b].value,a.splice(b,1))},animateAgain:function(){var a=this;a.startSlices();for(var b=0;b<a.chartData.length;b++){var c=a.chartData[b];c.started=!1;var d=c.wedge;d&&(d.setAttr("opacity",a.startAlpha),d.translate(c.startX,c.startY));if(d=c.labelSet)d.setAttr("opacity",a.startAlpha),d.translate(c.startX,c.startY)}b=a.startDuration;0<b?(b=setTimeout(function(){a.pullSlices.call(a)},1200*b),a.timeOuts.push(b)):a.pullSlices()},measureMaxLabel:function(){var a=this.chartData,b=0,c;for(c=0;c<a.length;c++){var d=a[c],g=this.formatString(this.labelText,d),f=this.labelFunction;f&&(g=f(d,g));d=k.text(this.container,g,this.color,this.fontFamily,this.fontSize);g=d.getBBox().width;g>b&&(b=g);d.remove()}return b}})})();(function(){var k=window.AmCharts;k.AmPieChart=k.Class({inherits:k.AmSlicedChart,construct:function(a){this.type="pie";k.AmPieChart.base.construct.call(this,a);this.cname="AmPieChart";this.pieBrightnessStep=30;this.minRadius=10;this.depth3D=0;this.startAngle=90;this.angle=this.innerRadius=0;this.startRadius="500%";this.pullOutRadius="20%";this.labelRadius=20;this.labelText="[[title]]: [[percents]]%";this.balloonText="[[title]]: [[percents]]% ([[value]])\n[[description]]";this.previousScale=1;this.adjustPrecision=!1;this.gradientType="radial";k.applyTheme(this,a,this.cname)},drawChart:function(){k.AmPieChart.base.drawChart.call(this);var a=this.chartData;if(k.ifArray(a)){if(0<this.realWidth&&0<this.realHeight){k.VML&&(this.startAlpha=1);var b=this.startDuration,c=this.container,d=this.updateWidth();this.realWidth=d;var g=this.updateHeight();this.realHeight=g;var f=k.toCoordinate,h=f(this.marginLeft,d),e=f(this.marginRight,d),z=f(this.marginTop,g)+this.getTitleHeight(),n=f(this.marginBottom,g),A,B,l,x=k.toNumber(this.labelRadius),p=this.measureMaxLabel();p>this.maxLabelWidth&&(p=this.maxLabelWidth);this.labelText&&this.labelsEnabled||(x=p=0);A=void 0===this.pieX?(d-h-e)/2+h:f(this.pieX,this.realWidth);B=void 0===this.pieY?(g-z-n)/2+z:f(this.pieY,g);l=f(this.radius,d,g);l||(d=0<=x?d-h-e-2*p:d-h-e,g=g-z-n,l=Math.min(d,g),g<d&&(l/=1-this.angle/90,l>d&&(l=d)),g=k.toCoordinate(this.pullOutRadius,l),l=(0<=x?l-1.8*(x+g):l-1.8*g)/2);l<this.minRadius&&(l=this.minRadius);g=f(this.pullOutRadius,l);z=k.toCoordinate(this.startRadius,l);f=f(this.innerRadius,l);f>=l&&(f=l-1);n=k.fitToBounds(this.startAngle,0,360);0<this.depth3D&&(n=270<=n?270:90);n-=90;360<n&&(n-=360);d=l-l*this.angle/90;for(h=p=0;h<a.length;h++)e=a[h],!0!==e.hidden&&(p+=k.roundTo(e.percents,this.pf.precision));p=k.roundTo(p,this.pf.precision);this.tempPrec=NaN;this.adjustPrecision&&100!=p&&(this.tempPrec=this.pf.precision+1);for(var E,h=0;h<a.length;h++)if(e=a[h],!0!==e.hidden&&(this.showZeroSlices||0!==e.percents)){var r=360*e.percents/100,p=Math.sin((n+r/2)/180*Math.PI),C=d/l*-Math.cos((n+r/2)/180*Math.PI),q=this.outlineColor;q||(q=e.color);var v=this.alpha;isNaN(e.alpha)||(v=e.alpha);q={fill:e.color,stroke:q,"stroke-width":this.outlineThickness,"stroke-opacity":this.outlineAlpha,"fill-opacity":v};e.url&&(q.cursor="pointer");q=k.wedge(c,A,B,n,r,l,d,f,this.depth3D,q,this.gradientRatio,e.pattern,this.path,this.gradientType);k.setCN(this,q,"pie-item");k.setCN(this,q.wedge,"pie-slice");k.setCN(this,q,e.className,!0);this.addEventListeners(q,e);e.startAngle=n;a[h].wedge=q;0<b&&(this.chartCreated||q.setAttr("opacity",this.startAlpha));e.ix=p;e.iy=C;e.wedge=q;e.index=h;e.label=null;v=c.set();if(this.labelsEnabled&&this.labelText&&e.percents>=this.hideLabelsPercent){var m=n+r/2;0>m&&(m+=360);360<m&&(m-=360);var t=x;isNaN(e.labelRadius)||(t=e.labelRadius,0>t&&(e.skipTick=!0));var r=A+p*(l+t),D=B+C*(l+t),w,u=0;isNaN(E)&&350<m&&1<a.length-h&&(E=h-1+Math.floor((a.length-h)/2));if(0<=t){var y;90>=m&&0<=m?(y=0,w="start",u=8):90<=m&&180>m?(y=1,w="start",u=8):180<=m&&270>m?(y=2,w="end",u=-8):270<=m&&354>=m?(y=3,w="end",u=-8):354<=m&&(h>E?(y=0,w="start",u=8):(y=3,w="end",u=-8));e.labelQuarter=y}else w="middle";m=this.formatString(this.labelText,e);(t=this.labelFunction)&&(m=t(e,m));t=e.labelColor;t||(t=this.color);""!==m&&(m=k.wrappedText(c,m,t,this.fontFamily,this.fontSize,w,!1,this.maxLabelWidth),k.setCN(this,m,"pie-label"),k.setCN(this,m,e.className,!0),m.translate(r+1.5*u,D),m.node.style.pointerEvents="none",e.ty=D,e.textX=r+1.5*u,v.push(m),this.axesSet.push(v),e.labelSet=v,e.label=m);e.tx=r;e.tx2=r+u;e.tx0=A+p*l;e.ty0=B+C*l}r=f+(l-f)/2;e.pulled&&(r+=this.pullOutRadiusReal);this.accessible&&this.accessibleLabel&&(D=this.formatString(this.accessibleLabel,e),this.makeAccessible(q,D));e.balloonX=p*r+A;e.balloonY=C*r+B;e.startX=Math.round(p*z);e.startY=Math.round(C*z);e.pullX=Math.round(p*g);e.pullY=Math.round(C*g);this.graphsSet.push(q);if(0===e.alpha||0<b&&!this.chartCreated)q.hide(),v&&v.hide();n+=360*e.percents/100;360<n&&(n-=360)}0<x&&this.arrangeLabels();this.pieXReal=A;this.pieYReal=B;this.radiusReal=l;this.innerRadiusReal=f;0<x&&this.drawTicks();this.initialStart();this.setDepths()}(a=this.legend)&&a.invalidateSize()}else this.cleanChart();this.dispDUpd()},setDepths:function(){var a=this.chartData,b;for(b=0;b<a.length;b++){var c=a[b],d=c.wedge,c=c.startAngle;0<=c&&180>c?d.toFront():180<=c&&d.toBack()}},arrangeLabels:function(){var a=this.chartData,b=a.length,c,d;for(d=b-1;0<=d;d--)c=a[d],0!==c.labelQuarter||c.hidden||this.checkOverlapping(d,c,0,!0,0);for(d=0;d<b;d++)c=a[d],1!=c.labelQuarter||c.hidden||this.checkOverlapping(d,c,1,!1,0);for(d=b-1;0<=d;d--)c=a[d],2!=c.labelQuarter||c.hidden||this.checkOverlapping(d,c,2,!0,0);for(d=0;d<b;d++)c=a[d],3!=c.labelQuarter||c.hidden||this.checkOverlapping(d,c,3,!1,0)},checkOverlapping:function(a,b,c,d,g){var f,h,e=this.chartData,k=e.length,n=b.label;if(n){if(!0===d)for(h=a+1;h<k;h++)e[h].labelQuarter==c&&(f=this.checkOverlappingReal(b,e[h],c))&&(h=k);else for(h=a-1;0<=h;h--)e[h].labelQuarter==c&&(f=this.checkOverlappingReal(b,e[h],c))&&(h=0);!0===f&&100>g&&isNaN(b.labelRadius)&&(f=b.ty+3*b.iy,b.ty=f,n.translate(b.textX,f),this.checkOverlapping(a,b,c,d,g+1))}},checkOverlappingReal:function(a,b,c){var d=!1,g=a.label,f=b.label;a.labelQuarter!=c||a.hidden||b.hidden||!f||(g=g.getBBox(),c={},c.width=g.width,c.height=g.height,c.y=a.ty,c.x=a.tx,a=f.getBBox(),f={},f.width=a.width,f.height=a.height,f.y=b.ty,f.x=b.tx,k.hitTest(c,f)&&(d=!0));return d}})})();AmCharts.translations["export"]||(AmCharts.translations["export"]={}),AmCharts.translations["export"].en||(AmCharts.translations["export"].en={"fallback.save.text":"CTRL + C to copy the data into the clipboard.","fallback.save.image":"Rightclick -> Save picture as... to save the image.","capturing.delayed.menu.label":"{{duration}}","capturing.delayed.menu.title":"Click to cancel","menu.label.print":"Print","menu.label.undo":"Undo","menu.label.redo":"Redo","menu.label.cancel":"Cancel","menu.label.save.image":"Download as ...","menu.label.save.data":"Save as ...","menu.label.draw":"Annotate ...","menu.label.draw.change":"Change ...","menu.label.draw.add":"Add ...","menu.label.draw.shapes":"Shape ...","menu.label.draw.colors":"Color ...","menu.label.draw.widths":"Size ...","menu.label.draw.opacities":"Opacity ...","menu.label.draw.text":"Text","menu.label.draw.modes":"Mode ...","menu.label.draw.modes.pencil":"Pencil","menu.label.draw.modes.line":"Line","menu.label.draw.modes.arrow":"Arrow"}),function(){AmCharts["export"]=function(a,b){var c={name:"export",version:"1.4.18",libs:{async:!0,autoLoad:!0,reload:!1,resources:[{"pdfmake/pdfmake.js":["pdfmake/vfs_fonts.js"],"jszip/jszip.js":["xlsx/xlsx.js"]},"fabric.js/fabric.js","FileSaver.js/FileSaver.js"],namespaces:{"pdfmake.js":"pdfMake","jszip.js":"JSZip","xlsx.js":"XLSX","fabric.js":"fabric","FileSaver.js":"saveAs"}},config:{},setup:{chart:a,hasBlob:!1,wrapper:!1},drawing:{enabled:!1,undos:[],redos:[],buffer:{position:{x1:0,y1:0,x2:0,y2:0,xD:0,yD:0}},handler:{undo:function(a,b){var d=c.drawing.undos.pop();if(d){d.selectable=!0,c.drawing.redos.push(d),"added"==d.action&&c.setup.fabric.remove(d.target);var e=JSON.parse(d.state);d.target.set(e),d.target instanceof fabric.Group&&c.drawing.handler.change({color:e.cfg.color,width:e.cfg.width,opacity:e.cfg.opacity},!0,d.target),c.setup.fabric.renderAll(),d.state!=d.target.recentState||b||c.drawing.handler.undo(d,!0)}},redo:function(a,b){var d=c.drawing.redos.pop();if(d){d.selectable=!0,c.drawing.undos.push(d),"added"==d.action&&c.setup.fabric.add(d.target);var e=JSON.parse(d.state);d.target.recentState=d.state,d.target.set(e),d.target instanceof fabric.Group&&c.drawing.handler.change({color:e.cfg.color,width:e.cfg.width,opacity:e.cfg.opacity},!0,d.target),c.setup.fabric.renderAll(),"addified"==d.action&&c.drawing.handler.redo()}},done:function(a){c.drawing.buffer.enabled=!1,c.drawing.undos=[],c.drawing.redos=[],c.createMenu(c.config.menu),c.setup.fabric.deactivateAll(),c.setup.wrapper&&(c.setup.chart.containerDiv.removeChild(c.setup.wrapper),c.setup.wrapper=!1)},add:function(a){var b=c.deepMerge({top:c.setup.fabric.height/2,left:c.setup.fabric.width/2},a||{}),d=-1!=b.url.indexOf(".svg")?fabric.loadSVGFromURL:fabric.Image.fromURL;d(b.url,function(a,d){var e=void 0!==d?fabric.util.groupSVGElements(a,d):a,f=!1;(e.height>c.setup.fabric.height||e.width>c.setup.fabric.width)&&(f=c.setup.fabric.height/2/e.height),b.top>c.setup.fabric.height&&(b.top=c.setup.fabric.height/2),b.left>c.setup.fabric.width&&(b.left=c.setup.fabric.width/2),e.set({originX:"center",originY:"center",top:b.top,left:b.left,width:f?e.width*f:e.width,height:f?e.height*f:e.height,fill:c.drawing.color}),c.setup.fabric.add(e)})},change:function(a,b,d){var f,g,h,e=c.deepMerge({},a||{}),i=d||c.drawing.buffer.target,j=i?i._objects?i._objects:[i]:null;if(e.mode&&(c.drawing.mode=e.mode),e.width&&(c.drawing.width=e.width,c.drawing.fontSize=3*e.width),e.fontSize&&(c.drawing.fontSize=e.fontSize),e.color&&(c.drawing.color=e.color),e.opacity&&(c.drawing.opacity=e.opacity),h=new fabric.Color(c.drawing.color).getSource(),h.pop(),h.push(c.drawing.opacity),c.drawing.color="rgba("+h.join()+")",c.setup.fabric.freeDrawingBrush.color=c.drawing.color,c.setup.fabric.freeDrawingBrush.width=c.drawing.width,i){for(f=JSON.parse(i.recentState).cfg,f&&(e.color=e.color||f.color,e.width=e.width||f.width,e.opacity=e.opacity||f.opacity,e.fontSize=e.fontSize||3*e.width,h=new fabric.Color(e.color).getSource(),h.pop(),h.push(e.opacity),e.color="rgba("+h.join()+")"),g=0;g<j.length;g++)j[g]instanceof fabric.Text||j[g]instanceof fabric.PathGroup||j[g]instanceof fabric.Triangle?((e.color||e.opacity)&&j[g].set({fill:e.color}),e.fontSize&&j[g].set({fontSize:e.fontSize})):(j[g]instanceof fabric.Path||j[g]instanceof fabric.Line)&&(i instanceof fabric.Group?(e.color||e.opacity)&&j[g].set({stroke:e.color}):((e.color||e.opacity)&&j[g].set({stroke:e.color}),e.width&&j[g].set({strokeWidth:e.width})));b||(f=JSON.stringify(c.deepMerge(i.saveState().originalState,{cfg:{color:e.color,width:e.width,opacity:e.opacity}})),i.recentState=f,c.drawing.redos=[],c.drawing.undos.push({action:"modified",target:i,state:f})),c.setup.fabric.renderAll()}},text:function(a){var b=c.deepMerge({text:c.i18l("menu.label.draw.text"),top:c.setup.fabric.height/2,left:c.setup.fabric.width/2,fontSize:c.drawing.fontSize,fontFamily:c.setup.chart.fontFamily||"Verdana",fill:c.drawing.color},a||{});b.click=function(){};var d=new fabric.IText(b.text,b);return c.setup.fabric.add(d),c.setup.fabric.setActiveObject(d),d.selectAll(),d.enterEditing(),d},line:function(a){var d,e,f,g,b=c.deepMerge({x1:c.setup.fabric.width/2-c.setup.fabric.width/10,x2:c.setup.fabric.width/2+c.setup.fabric.width/10,y1:c.setup.fabric.height/2,y2:c.setup.fabric.height/2,angle:90,strokeLineCap:c.drawing.lineCap,arrow:c.drawing.arrow,color:c.drawing.color,width:c.drawing.width,group:[]},a||{}),h=new fabric.Line([b.x1,b.y1,b.x2,b.y2],{stroke:b.color,strokeWidth:b.width,strokeLineCap:b.strokeLineCap});if(b.group.push(h),b.arrow&&(b.angle=b.angle?b.angle:c.getAngle(b.x1,b.y1,b.x2,b.y2),"start"==b.arrow?(f=b.y1+b.width/2,g=b.x1+b.width/2):"middle"==b.arrow?(f=b.y2+b.width/2-(b.y2-b.y1)/2,g=b.x2+b.width/2-(b.x2-b.x1)/2):(f=b.y2+b.width/2,g=b.x2+b.width/2),e=new fabric.Triangle({top:f,left:g,fill:b.color,height:7*b.width,width:7*b.width,angle:b.angle,originX:"center",originY:"bottom"}),b.group.push(e)),"config"!=b.action){if(b.arrow){var i=new fabric.Group(b.group);return i.set({cfg:b,fill:b.color,action:b.action,selectable:!0,known:"change"==b.action}),"change"==b.action&&c.setup.fabric.setActiveObject(i),c.setup.fabric.add(i),i}return c.setup.fabric.add(h),h}for(d=0;d<b.group.length;d++)b.group[d].noUndo=!0,c.setup.fabric.add(b.group[d]);return b}}},defaults:{position:"top-right",fileName:"amCharts",action:"download",overflow:!0,path:(a.path||"")+"plugins/export/",formats:{JPG:{mimeType:"image/jpg",extension:"jpg",capture:!0},PNG:{mimeType:"image/png",extension:"png",capture:!0},SVG:{mimeType:"text/xml",extension:"svg",capture:!0},PDF:{mimeType:"application/pdf",extension:"pdf",capture:!0},CSV:{mimeType:"text/plain",extension:"csv"},JSON:{mimeType:"text/plain",extension:"json"},XLSX:{mimeType:"application/octet-stream",extension:"xlsx"}},fabric:{backgroundColor:"#FFFFFF",removeImages:!0,selection:!1,drawing:{enabled:!0,arrow:"end",lineCap:"butt",mode:"pencil",modes:["pencil","line","arrow"],color:"#000000",colors:["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF"],shapes:["11.svg","14.svg","16.svg","17.svg","20.svg","27.svg"],width:1,fontSize:11,widths:[1,5,10,15],opacity:1,opacities:[1,.8,.6,.4,.2],menu:void 0,autoClose:!0},border:{fill:"",fillOpacity:0,stroke:"#000000",strokeWidth:1,strokeOpacity:1}},pdfMake:{pageSize:"A4",pageOrientation:"portrait",images:{},content:["Saved from:",window.location.href,{image:"reference",fit:[523.28,769.89]}]},menu:void 0,divId:null,menuReviver:null,menuWalker:null,fallback:!0,keyListener:!0,fileListener:!0},i18l:function(a,b){var d=b?langugage:c.setup.chart.language?c.setup.chart.language:"en",e=AmCharts.translations[c.name][d]||AmCharts.translations[c.name].en;return e[a]||a},download:function(a,b,d){if(window.saveAs&&c.setup.hasBlob){c.toBlob({data:a,type:b},function(a){saveAs(a,d)})}else if(c.config.fallback&&"text/plain"==b){var f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("textarea");g.innerHTML=c.i18l("fallback.save.text"),f.appendChild(g),f.appendChild(h),g.setAttribute("class","amcharts-export-fallback-message"),f.setAttribute("class","amcharts-export-fallback"),c.setup.chart.containerDiv.appendChild(f),h.setAttribute("readonly",""),h.value=a,h.focus(),h.select(),c.createMenu([{class:"export-main export-close",label:"Done",click:function(){c.createMenu(c.config.menu),c.setup.chart.containerDiv.removeChild(f)}}])}else{if(!c.config.fallback||"image"!=b.split("/")[0])throw new Error("Unable to create file. Ensure saveAs (FileSaver.js) is supported.");var f=document.createElement("div"),g=document.createElement("div"),i=c.toImage({data:a});g.innerHTML=c.i18l("fallback.save.image"),f.appendChild(g),f.appendChild(i),g.setAttribute("class","amcharts-export-fallback-message"),f.setAttribute("class","amcharts-export-fallback"),c.setup.chart.containerDiv.appendChild(f),c.createMenu([{class:"export-main export-close",label:"Done",click:function(){c.createMenu(c.config.menu),c.setup.chart.containerDiv.removeChild(f)}}])}return a},loadResource:function(a,b){function k(){if(b)for(d=0;d<b.length;d++)c.loadResource(b[d])}var d,e,f,g,h,i,j=-1!=a.indexOf("//")?a:[c.libs.path,a].join("");for(-1!=a.indexOf(".js")?(f=document.createElement("script"),f.setAttribute("type","text/javascript"),f.setAttribute("src",j),c.libs.async&&f.setAttribute("async","")):-1!=a.indexOf(".css")&&(f=document.createElement("link"),f.setAttribute("type","text/css"),f.setAttribute("rel","stylesheet"),f.setAttribute("href",j)),d=0;d<document.head.childNodes.length;d++)if(g=document.head.childNodes[d],h=g?g.src||g.href:!1,i=g?g.tagName:!1,g&&h&&-1!=h.indexOf(a)){c.libs.reload&&document.head.removeChild(g),e=!0;break}for(d in c.libs.namespaces){var l=c.libs.namespaces[d],h=a.toLowerCase(),g=d.toLowerCase();if(-1!=h.indexOf(g)&&void 0!==window[l]){e=!0;break}}(!e||c.libs.reload)&&(f.addEventListener("load",k),document.head.appendChild(f))},loadDependencies:function(){var a,b;if(c.libs.autoLoad)for(a=0;a<c.libs.resources.length;a++)if(c.libs.resources[a]instanceof Object)for(b in c.libs.resources[a])c.loadResource(b,c.libs.resources[a][b]);else c.loadResource(c.libs.resources[a])},pxToNumber:function(a,b){return!a&&b?void 0:Number(String(a).replace("px",""))||0},numberToPx:function(a){return String(a)+"px"},deepMerge:function(a,b,d){var e,f,g=b instanceof Array?"array":"object";for(e in b)"array"==g&&isNaN(e)||(f=b[e],(void 0==a[e]||d)&&(f instanceof Array?a[e]=new Array:f instanceof Function?a[e]=function(){}:f instanceof Date?a[e]=new Date:f instanceof Object?a[e]=new Object:f instanceof Number?a[e]=new Number:f instanceof String&&(a[e]=new String)),(a instanceof Object||a instanceof Array)&&(f instanceof Object||f instanceof Array)&&!(f instanceof Function||f instanceof Date||c.isElement(f))&&"chart"!=e?c.deepMerge(a[e],f,d):a instanceof Array&&!d?a.push(f):a[e]=f);return a},isElement:function(a){return a instanceof Object&&a&&1===a.nodeType},isHashbanged:function(a){var b=String(a).replace(/\"/g,"");return"url"==b.slice(0,3)?b.slice(b.indexOf("#")+1,b.length-1):!1},isPressed:function(a){return"mousemove"==a.type&&1===a.which||("touchmove"==a.type||1===a.buttons||1===a.button||1===a.which?c.drawing.buffer.isPressed=!0:c.drawing.buffer.isPressed=!1),c.drawing.buffer.isPressed},isTainted:function(a){var b=String(window.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));return a&&-1!=a.indexOf("//")&&-1==a.indexOf(b.replace(/.*:/,""))?!0:!1},isSupported:function(){return c.config.enabled&&(!(AmCharts.isIE&&AmCharts.IEversion<=9)||Array.prototype.indexOf&&document.head&&c.config.fallback!==!1)?!0:!1},getAngle:function(a,b,c,d){var g,e=c-a,f=d-b;return g=0==e?0==f?0:f>0?Math.PI/2:3*Math.PI/2:0==f?e>0?0:Math.PI:0>e?Math.atan(f/e)+Math.PI:0>f?Math.atan(f/e)+2*Math.PI:Math.atan(f/e),180*g/Math.PI},gatherAttribute:function(a,b,d,e){var f,e=e?e:0,d=d?d:3;return a&&(f=a.getAttribute(b),!f&&d>e)?c.gatherAttribute(a.parentNode,b,d,e+1):f},gatherClassName:function(a,b,d,e){var f,e=e?e:0,d=d?d:3;if(c.isElement(a)){if(f=-1!=(a.getAttribute("class")||"").split(" ").indexOf(b),!f&&d>e)return c.gatherClassName(a.parentNode,b,d,e+1);f&&(f=a)}return f},gatherElements:function(a,b,d){var e,f;for(e=0;e<a.children.length;e++){var g=a.children[e];if("clipPath"==g.tagName){var h={},i=fabric.parseTransformAttribute(c.gatherAttribute(g,"transform"));for(f=0;f<g.childNodes.length;f++)g.childNodes[f].setAttribute("fill","transparent"),h={x:c.pxToNumber(g.childNodes[f].getAttribute("x")),y:c.pxToNumber(g.childNodes[f].getAttribute("y")),width:c.pxToNumber(g.childNodes[f].getAttribute("width")),height:c.pxToNumber(g.childNodes[f].getAttribute("height"))};a.clippings[g.id]={svg:g,bbox:h,transform:i}}else if("pattern"==g.tagName){var j={node:g,source:g.getAttribute("xlink:href"),width:Number(g.getAttribute("width")),height:Number(g.getAttribute("height")),repeat:"repeat"};for(f=0;f<g.childNodes.length;f++)"rect"==g.childNodes[f].tagName&&(j.fill=g.childNodes[f].getAttribute("fill"));b.removeImages&&c.isTainted(j.source)?a.patterns[g.id]=j.fill?j.fill:"transparent":(d.included++,a.patterns[j.node.id]=j)}else"image"==g.tagName&&(d.included++,fabric.Image.fromURL(g.getAttribute("xlink:href"),function(a){d.loaded++}))}return a},gatherPosition:function(a,b){var f,d=c.drawing.buffer.position,e=fabric.util.invertTransform(c.setup.fabric.viewportTransform);return"touchmove"==a.type&&("touches"in a?a=a.touches[0]:"changedTouches"in a&&(a=a.changedTouches[0])),f=fabric.util.transformPoint(c.setup.fabric.getPointer(a,!0),e),1==b&&(d.x1=f.x,d.y1=f.y),d.x2=f.x,d.y2=f.y,d.xD=d.x1-d.x2<0?-1*(d.x1-d.x2):d.x1-d.x2,d.yD=d.y1-d.y2<0?-1*(d.y1-d.y2):d.y1-d.y2,d},capture:function(a,b){var d,e=c.deepMerge(c.deepMerge({},c.config.fabric),a||{}),f=[],g={x:0,y:0,pX:0,pY:0,width:c.setup.chart.divRealWidth,height:c.setup.chart.divRealHeight},h={loaded:0,included:0};fabric.ElementsParser.prototype.resolveGradient=function(a,b){var c=a.get(b);if(/^url\(/.test(c)){var d=c.slice(c.indexOf("#")+1,c.length-1);fabric.gradientDefs[this.svgUid][d]&&a.set(b,fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][d],a))}},c.handleCallback(e.beforeCapture,e);var i=c.setup.chart.containerDiv.getElementsByTagName("svg");for(d=0;d<i.length;d++){var j={svg:i[d],parent:i[d].parentNode,children:i[d].getElementsByTagName("*"),offset:{x:0,y:0},patterns:{},clippings:{}};j=c.gatherElements(j,e,h),f.push(j)}if(c.config.legend&&c.setup.chart.legend&&"outside"==c.setup.chart.legend.position){var j={svg:c.setup.chart.legend.container.container,parent:c.setup.chart.legend.container.container.parentNode,children:c.setup.chart.legend.container.container.getElementsByTagName("*"),offset:{x:0,y:0},legend:{type:-1!=["top","left"].indexOf(c.config.legend.position)?"unshift":"push",position:c.config.legend.position,width:c.config.legend.width?c.config.legend.width:c.setup.chart.legend.container.width,height:c.config.legend.height?c.config.legend.height:c.setup.chart.legend.container.height},patterns:{},clippings:{}};-1!=["left","right"].indexOf(j.legend.position)?(g.width+=j.legend.width,g.height=j.legend.height>g.height?j.legend.height:g.height):-1!=["top","bottom"].indexOf(j.legend.position)&&(g.height+=j.legend.height),j=c.gatherElements(j,e,h),f[j.legend.type](j)}if(c.drawing.buffer.enabled="draw"==e.action,c.setup.wrapper=document.createElement("div"),c.setup.wrapper.setAttribute("class",c.setup.chart.classNamePrefix+"-export-canvas"),c.setup.chart.containerDiv.appendChild(c.setup.wrapper),"stock"==c.setup.chart.type){var k={top:0,right:0,bottom:0,left:0};c.setup.chart.leftContainer&&(g.width-=c.setup.chart.leftContainer.offsetWidth,k.left=c.setup.chart.leftContainer.offsetWidth+2*c.setup.chart.panelsSettings.panelSpacing),c.setup.chart.rightContainer&&(g.width-=c.setup.chart.rightContainer.offsetWidth,k.right=c.setup.chart.rightContainer.offsetWidth+2*c.setup.chart.panelsSettings.panelSpacing),c.setup.chart.periodSelector&&-1!=["top","bottom"].indexOf(c.setup.chart.periodSelector.position)&&(g.height-=c.setup.chart.periodSelector.offsetHeight+c.setup.chart.panelsSettings.panelSpacing,k[c.setup.chart.periodSelector.position]+=c.setup.chart.periodSelector.offsetHeight+c.setup.chart.panelsSettings.panelSpacing),c.setup.chart.dataSetSelector&&-1!=["top","bottom"].indexOf(c.setup.chart.dataSetSelector.position)&&(g.height-=c.setup.chart.dataSetSelector.offsetHeight,k[c.setup.chart.dataSetSelector.position]+=c.setup.chart.dataSetSelector.offsetHeight),c.setup.wrapper.style.paddingTop=c.numberToPx(k.top),c.setup.wrapper.style.paddingRight=c.numberToPx(k.right),c.setup.wrapper.style.paddingBottom=c.numberToPx(k.bottom),c.setup.wrapper.style.paddingLeft=c.numberToPx(k.left)}for(c.setup.canvas=document.createElement("canvas"),c.setup.wrapper.appendChild(c.setup.canvas),c.setup.fabric=new fabric.Canvas(c.setup.canvas,c.deepMerge({width:g.width,height:g.height,isDrawingMode:!0},e)),c.deepMerge(c.setup.fabric,e),c.deepMerge(c.setup.fabric.freeDrawingBrush,e.drawing),c.deepMerge(c.drawing,e.drawing),c.drawing.handler.change(e.drawing),c.setup.fabric.on("mouse:down",function(a){c.gatherPosition(a.e,1);c.drawing.buffer.pressedTS=Number(new Date),c.isPressed(a.e)}),c.setup.fabric.on("mouse:move",function(a){var b=c.gatherPosition(a.e,2);if(c.isPressed(a.e),c.drawing.buffer.isPressed&&!c.drawing.buffer.line&&!c.drawing.buffer.isSelected&&"pencil"!=c.drawing.mode&&(b.xD>5||b.xD>5)&&(c.drawing.buffer.hasLine=!0,c.setup.fabric.isDrawingMode=!1,c.setup.fabric._onMouseUpInDrawingMode(a),c.drawing.buffer.line=c.drawing.handler.line({x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2,arrow:"line"==c.drawing.mode?!1:c.drawing.arrow,action:"config"})),c.drawing.buffer.line){var e,f,g,h=c.drawing.buffer.line;for(h.x2=b.x2,h.y2=b.y2,d=0;d<h.group.length;d++)e=h.group[d],e instanceof fabric.Line?e.set({x2:h.x2,y2:h.y2}):e instanceof fabric.Triangle&&(h.angle=c.getAngle(h.x1,h.y1,h.x2,h.y2)+90,"start"==h.arrow?(f=h.y1+h.width/2,g=h.x1+h.width/2):"middle"==h.arrow?(f=h.y2+h.width/2-(h.y2-h.y1)/2,g=h.x2+h.width/2-(h.x2-h.x1)/2):(f=h.y2+h.width/2,g=h.x2+h.width/2),e.set({top:f,left:g,angle:h.angle}));c.setup.fabric.renderAll()}}),c.setup.fabric.on("mouse:up",function(a){if(Number(new Date)-c.drawing.buffer.pressedTS<200){var b=c.setup.fabric.findTarget(a.e);b&&b.selectable&&c.setup.fabric.setActiveObject(b)}if(c.drawing.buffer.line){for(d=0;d<c.drawing.buffer.line.group.length;d++)c.drawing.buffer.line.group[d].remove();delete c.drawing.buffer.line.action,delete c.drawing.buffer.line.group,c.drawing.handler.line(c.drawing.buffer.line)}c.drawing.buffer.line=!1,c.drawing.buffer.hasLine=!1,c.drawing.buffer.isPressed=!1}),c.setup.fabric.on("object:selected",function(a){c.drawing.buffer.isSelected=!0,c.drawing.buffer.target=a.target,c.setup.fabric.isDrawingMode=!1}),c.setup.fabric.on("selection:cleared",function(a){c.drawing.buffer.onMouseDown=c.setup.fabric.freeDrawingBrush.onMouseDown,c.drawing.buffer.target=!1,c.drawing.buffer.isSelected&&(c.setup.fabric._isCurrentlyDrawing=!1,c.setup.fabric.freeDrawingBrush.onMouseDown=function(){}),setTimeout(function(){c.drawing.buffer.isSelected=!1,c.setup.fabric.isDrawingMode=!0,c.setup.fabric.freeDrawingBrush.onMouseDown=c.drawing.buffer.onMouseDown},10)}),c.setup.fabric.on("path:created",function(a){var b=a.path;return Number(new Date)-c.drawing.buffer.pressedTS<200||c.drawing.buffer.hasLine?(c.setup.fabric.remove(b),void c.setup.fabric.renderAll()):void 0}),c.setup.fabric.on("object:added",function(a){var b=a.target,d=c.deepMerge(b.saveState().originalState,{cfg:{color:c.drawing.color,width:c.drawing.width,opacity:c.drawing.opacity,fontSize:c.drawing.fontSize}});return Number(new Date)-c.drawing.buffer.pressedTS<200&&!b.noUndo?(c.setup.fabric.remove(b),void c.setup.fabric.renderAll()):(d=JSON.stringify(d),b.recentState=d,!b.selectable||b.known||b.noUndo||(c.drawing.undos.push({action:"added",target:b,state:d}),c.drawing.undos.push({action:"addified",target:b,state:d}),c.drawing.redos=[]),b.known=!0,void(c.setup.fabric.isDrawingMode=!0))}),c.setup.fabric.on("object:modified",function(a){var b=a.target,d=JSON.parse(b.recentState),e=c.deepMerge(b.saveState().originalState,{cfg:d.cfg});e=JSON.stringify(e),b.recentState=e,c.drawing.undos.push({action:"modified",target:b,state:e}),c.drawing.redos=[]}),c.setup.fabric.on("text:changed",function(a){var b=a.target;clearTimeout(b.timer),b.timer=setTimeout(function(){var a=JSON.stringify(b.saveState().originalState);b.recentState=a,c.drawing.redos=[],c.drawing.undos.push({action:"modified",target:b,state:a})},250)}),c.drawing.buffer.enabled?(c.setup.wrapper.setAttribute("class",c.setup.chart.classNamePrefix+"-export-canvas active"),c.setup.wrapper.style.backgroundColor=e.backgroundColor,c.setup.wrapper.style.display="block"):(c.setup.wrapper.setAttribute("class",c.setup.chart.classNamePrefix+"-export-canvas"),c.setup.wrapper.style.display="none"),d=0;d<f.length;d++){var j=f[d],l=c.gatherClassName(j.parent,c.setup.chart.classNamePrefix+"-legend-div",1),m=c.gatherClassName(j.parent,c.setup.chart.classNamePrefix+"-stock-panel-div"),n=c.gatherClassName(j.parent,c.setup.chart.classNamePrefix+"-scrollbar-chart-div");"stock"==c.setup.chart.type&&c.setup.chart.legendSettings.position?-1!=["top","bottom"].indexOf(c.setup.chart.legendSettings.position)?j.parent.style.top&&j.parent.style.left?(j.offset.y=c.pxToNumber(j.parent.style.top),j.offset.x=c.pxToNumber(j.parent.style.left)):(j.offset.x=g.x,j.offset.y=g.y,g.y+=c.pxToNumber(j.parent.style.height),m?(g.pY=c.pxToNumber(m.style.marginTop),j.offset.y+=g.pY):n&&(j.offset.y+=g.pY)):-1!=["left","right"].indexOf(c.setup.chart.legendSettings.position)&&(j.offset.y=c.pxToNumber(j.parent.style.top)+g.pY,j.offset.x=c.pxToNumber(j.parent.style.left)+g.pX,l?g.pY+=c.pxToNumber(m.style.height)+c.setup.chart.panelsSettings.panelSpacing:n&&(j.offset.y-=c.setup.chart.panelsSettings.panelSpacing)):("absolute"==j.parent.style.position?(j.offset.absolute=!0,j.offset.top=c.pxToNumber(j.parent.style.top),j.offset.right=c.pxToNumber(j.parent.style.right,!0),j.offset.bottom=c.pxToNumber(j.parent.style.bottom,!0),j.offset.left=c.pxToNumber(j.parent.style.left),j.offset.width=c.pxToNumber(j.parent.style.width),j.offset.height=c.pxToNumber(j.parent.style.height)):j.parent.style.top&&j.parent.style.left?(j.offset.y=c.pxToNumber(j.parent.style.top),j.offset.x=c.pxToNumber(j.parent.style.left)):j.legend?"left"==j.legend.position?g.x+=j.legend.width:"right"==j.legend.position?j.offset.x+=g.width-j.legend.width:"top"==j.legend.position?g.y+=j.legend.height:"bottom"==j.legend.position&&(j.offset.y+=g.height-j.legend.height):(j.offset.x=g.x,j.offset.y=g.y+g.pY,g.y+=c.pxToNumber(j.parent.style.height)),l&&m&&m.style.marginTop?(g.y+=c.pxToNumber(m.style.marginTop),j.offset.y+=c.pxToNumber(m.style.marginTop)):c.setup.chart.legend&&-1!=["left","right"].indexOf(c.setup.chart.legend.position)&&(j.offset.y=c.pxToNumber(j.parent.style.top),j.offset.x=c.pxToNumber(j.parent.style.left))),fabric.parseSVGDocument(j.svg,function(a){return function(d,i){var j,k=fabric.util.groupSVGElements(d,i),l=[],m={selectable:!1};for(a.offset.absolute?(void 0!==a.offset.bottom?m.top=g.height-a.offset.height-a.offset.bottom:m.top=a.offset.top,void 0!==a.offset.right?m.left=g.width-a.offset.width-a.offset.right:m.left=a.offset.left):(m.top=a.offset.y,m.left=a.offset.x),j=0;j<k.paths.length;j++){var n=null;if(k.paths[j]){if(e.removeImages&&c.isTainted(k.paths[j]["xlink:href"]))continue;if(k.paths[j].fill instanceof Object){if("radial"==k.paths[j].fill.type)if("pie"==c.setup.chart.type){var o=k.paths[j],q=(o.getCenterPoint(),o.group.getCenterPoint()),r={x:o.pathOffset.x-q.x,y:o.pathOffset.y-q.y};k.paths[j].fill.gradientTransform[4]=o.pathOffset.x-r.x,k.paths[j].fill.gradientTransform[5]=o.pathOffset.y-r.y}else k.paths[j].fill.coords.r2=-1*k.paths[j].fill.coords.r1,k.paths[j].fill.coords.r1=0,k.paths[j].set({opacity:k.paths[j].fillOpacity})}else if((n=c.isHashbanged(k.paths[j].fill))&&a.patterns&&a.patterns[n]){var s=a.patterns[n];fabric.Image.fromURL(s.source,function(a,b){return function(c){h.loaded++;var d=null,e=new fabric.StaticCanvas(void 0,{backgroundColor:a.fill});e.add(c),d=new fabric.Pattern({source:function(){return e.setDimensions({width:a.width,height:a.height}),e.getElement()},repeat:"repeat"}),k.paths[b].set({fill:d,opacity:k.paths[b].fillOpacity})}}(s,j))}if((n=c.isHashbanged(k.paths[j].clipPath))&&a.clippings&&a.clippings[n]&&(!function(b,c){var d=k.paths[b].toSVG;k.paths[b].toSVG=function(b){return d.apply(this,[function(d){return b(d,a.clippings[c])}])}}(j,n),k.paths[j].set({clipTo:function(b,d){return function(b){var e=a.clippings[d],f=this.transformMatrix||[1,0,0,1,0,0],g={top:e.bbox.y,left:e.bbox.x,width:e.bbox.width,height:e.bbox.height};"map"==c.setup.chart.type&&(g.top+=e.transform[5],g.left+=e.transform[4]),e.bbox.x&&f[4]&&e.bbox.y&&f[5]&&(g.top-=f[5],g.left-=f[4]),b.rect(g.left,g.top,g.width,g.height)}}(j,n)})),k.paths[j].TSPANWORKAROUND){for(var t=fabric.parseAttributes(k.paths[j].svg,fabric.Text.ATTRIBUTE_NAMES),i=fabric.util.object.extend({},t),u=[],v=0;v<k.paths[j].svg.childNodes.length;v++){var w=k.paths[j].svg.childNodes[v],x=fabric.Text.fromElement(w,i);x.set({left:0}),u.push(x)}k.paths[j].set({opacity:0});var y=new fabric.Group(u,{top:-1*k.paths[j].top});k.paths[j]=y}}l.push(k.paths[j])}if(k.paths=l,k.set(m),c.setup.fabric.add(k),a.svg.parentNode&&a.svg.parentNode.getElementsByTagName){var z=a.svg.parentNode.getElementsByClassName(c.setup.chart.classNamePrefix+"-balloon-div");for(j=0;j<z.length;j++)if(e.balloonFunction instanceof Function)e.balloonFunction.apply(c,[z[j],a]);else{var A=z[j],B=fabric.parseStyleAttribute(A),C=fabric.parseStyleAttribute(A.childNodes[0]),D=new fabric.Text(A.innerText||A.textContent||A.innerHTML,{selectable:!1,top:B.top+a.offset.y,left:B.left+a.offset.x,fill:C.color,fontSize:C.fontSize,fontFamily:C.fontFamily,textAlign:C["text-align"]});c.setup.fabric.add(D)}}if(a.svg.nextSibling&&"A"==a.svg.nextSibling.tagName){var A=a.svg.nextSibling,B=fabric.parseStyleAttribute(A),D=new fabric.Text(A.innerText||A.textContent||A.innerHTML,{selectable:!1,top:B.top+a.offset.y,left:B.left+a.offset.x,fill:B.color,fontSize:B.fontSize,fontFamily:B.fontFamily,opacity:B.opacity});c.setup.fabric.add(D)}if(f.pop(),!f.length)var E=setInterval(function(){h.loaded==h.included&&(clearTimeout(E),c.handleBorder(e),c.handleCallback(e.afterCapture,e),c.setup.fabric.renderAll(),c.handleCallback(b,e))},AmCharts.updateRate)}}(j),function(a,b){var d,f=c.gatherAttribute(a,"class"),g=c.gatherAttribute(a,"visibility"),h=c.gatherAttribute(a,"clip-path");if(b.className=String(f),b.classList=String(f).split(" "),b.clipPath=h,b.svg=a,"text"==a.tagName&&a.childNodes.length>1&&(b.TSPANWORKAROUND=!0),"hidden"==g)b.opacity=0;else{var i=["fill","stroke"];for(d=0;d<i.length;d++){var j=i[d],k=String(a.getAttribute(j)||""),l=Number(a.getAttribute(j+"-opacity")||"1"),m=fabric.Color.fromHex(k).getSource();-1==b.classList.indexOf(c.setup.chart.classNamePrefix+"-guide-fill")||k||(l=0,m=fabric.Color.fromHex("#000000").getSource()),m&&(m.pop(),m.push(l),b[j]="rgba("+m.join()+")",b[j+c.capitalize("opacity")]=l)}}c.handleCallback(e.reviver,b,a)})}},toCanvas:function(a,b){var e=(c.deepMerge({},a||{}),c.setup.canvas);return c.handleCallback(b,e),e},toImage:function(a,b){var d=c.deepMerge({format:"png",quality:1,multiplier:this.config.multiplier},a||{}),e=d.data,f=document.createElement("img");return d.data||(e=d.lossless||"svg"==d.format?c.toSVG(c.deepMerge(d,{getBase64:!0})):c.setup.fabric.toDataURL(d)),f.setAttribute("src",e),c.handleCallback(b,f),f},toBlob:function(a,b){var e,d=c.deepMerge({data:"empty",type:"text/plain"},a||{}),f=/^data:.+;base64,(.*)$/.exec(d.data);return f&&(d.data=f[0],d.type=d.data.slice(5,d.data.indexOf(",")-7),d.data=c.toByteArray({data:d.data.slice(d.data.indexOf(",")+1,d.data.length)})),e=d.getByteArray?d.data:new Blob([d.data],{type:d.type}),c.handleCallback(b,e),e},toJPG:function(a,b){var d=c.deepMerge({format:"jpeg",quality:1,multiplier:this.config.multiplier},a||{});d.format=d.format.toLowerCase();var e=c.setup.fabric.toDataURL(d);return c.handleCallback(b,e),e},toPNG:function(a,b){var d=c.deepMerge({format:"png",quality:1,multiplier:this.config.multiplier},a||{}),e=c.setup.fabric.toDataURL(d);return c.handleCallback(b,e),e},toSVG:function(a,b){var d=[],e=c.deepMerge({reviver:function(a,b){var c=new RegExp(/\bstyle=(['"])(.*?)\1/),e=c.exec(a)[0].slice(7,-1),f=e.split(";"),g=[];for(i1=0;i1<f.length;i1++)if(f[i1]){var h=f[i1].replace(/\s/g,"").split(":"),i=h[0],j=h[1];if(-1!=["fill","stroke"].indexOf(i))if(j=fabric.Color.fromRgba(j),j&&j._source){var k="#"+j.toHex(),l=j._source[3];g.push([i,k].join(":")),g.push([i+"-opacity",l].join(":"))}else g.push(f[i1]);else"opactiy"!=i&&g.push(f[i1])}if(a=a.replace(e,g.join(";")),b){var m=2,n=a.slice(-m);"/>"!=n&&(m=3,n=a.slice(-m));var o=a.slice(0,a.length-m),p=' clip-path="url(#'+b.svg.id+')" ',q=(new XMLSerializer).serializeToString(b.svg);a=o+p+n,d.push(q)}return a}},a||{}),f=c.setup.fabric.toSVG(e,e.reviver);if(d.length){var g=f.slice(0,f.length-6),h=f.slice(-6);f=g+d.join("")+h}return e.getBase64&&(f="data:image/svg+xml;base64,"+btoa(f)),c.handleCallback(b,f),f},toPDF:function(a,b){var d=c.deepMerge(c.deepMerge({multiplier:2},c.config.pdfMake),a||{},!0);d.images.reference=c.toPNG(d);var e=new pdfMake.createPdf(d);return b&&e.getDataUrl(function(a){return function(){a.apply(c,arguments)}}(b)),e},toPRINT:function(a,b){var d,e=c.deepMerge({delay:1,lossless:!1},a||{}),f=c.toImage(e),g=[],h=document.body.childNodes;for(f.setAttribute("style","width: 100%; max-height: 100%;"),d=0;d<h.length;d++)c.isElement(h[d])&&(g[d]=h[d].style.display,h[d].style.display="none");return document.body.appendChild(f),window.print(),setTimeout(function(){for(d=0;d<h.length;d++)c.isElement(h[d])&&(h[d].style.display=g[d]);document.body.removeChild(f),c.handleCallback(b,f)},e.delay),f},toJSON:function(a,b){var d=c.deepMerge({dateFormat:c.config.dateFormat||"dateObject"},a||{},!0);d.data=d.data?d.data:c.getChartData(d);var e=JSON.stringify(d.data,void 0,"\t");return c.handleCallback(b,e),e},toCSV:function(a,b){function j(a,b){return"string"==typeof a&&(f.escape&&(a=a.replace('"','""')),f.quotes&&(a=['"',a,'"'].join(""))),a}var d,e,f=c.deepMerge({data:c.getChartData(a),delimiter:",",quotes:!0,escape:!0,withHeader:!0},a||{},!0),g="",h=[],i=[];for(l in f.data[0])i.push(j(l)),h.push(l);f.withHeader&&(g+=i.join(f.delimiter)+"\n");for(d in f.data)if(i=[],!isNaN(d)){for(e in h)if(!isNaN(e)){var k=h[e],l=f.data[d][k];i.push(j(l,k))}g+=i.join(f.delimiter)+"\n"}return c.handleCallback(b,g),g},toXLSX:function(a,b){function g(a,b){b&&(a+=1462);var c=Date.parse(a);return(c-new Date(Date.UTC(1899,11,30)))/864e5}function h(a,b){for(var c={},d={s:{c:1e7,r:1e7},e:{c:0,r:0}},e=0;e!=a.length;++e)for(var f=0;f!=a[e].length;++f){d.s.r>e&&(d.s.r=e),d.s.c>f&&(d.s.c=f),d.e.r<e&&(d.e.r=e),d.e.c<f&&(d.e.c=f);var h={v:a[e][f]};if(null!=h.v){var i=XLSX.utils.encode_cell({c:f,r:e});"number"==typeof h.v?h.t="n":"boolean"==typeof h.v?h.t="b":h.v instanceof Date?(h.t="n",h.z=XLSX.SSF._table[14],h.v=g(h.v)):h.t="s",c[i]=h}}return d.s.c<1e7&&(c["!ref"]=XLSX.utils.encode_range(d)),c}var d=c.deepMerge({name:"amCharts",dateFormat:c.config.dateFormat||"dateObject",withHeader:!0,stringify:!1},a||{},!0),e="",f={SheetNames:[],Sheets:{}};return d.data=d.data?d.data:c.getChartData(d),f.SheetNames.push(d.name),f.Sheets[d.name]=h(c.toArray(d)),e=XLSX.write(f,{bookType:"xlsx",bookSST:!0,type:"base64"}),e="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+e,c.handleCallback(b,e),e},toArray:function(a,b){var d,e,f=c.deepMerge({data:c.getChartData(a),withHeader:!1,stringify:!0},a||{},!0),g=[],h=[];for(e in f.data[0])h.push(e);f.withHeader&&g.push(h);for(d in f.data){var i=[];if(!isNaN(d)){for(e in h)if(!isNaN(e)){var e=h[e],j=f.data[d][e];j=null==j?"":f.stringify?String(j):j,i.push(j)}g.push(i)}}return c.handleCallback(b,g),g},toByteArray:function(a,b){function l(a){var b=a.charCodeAt(0);return b===f?62:b===g?63:h>b?-1:h+10>b?b-h+26+26:j+26>b?b-j:i+26>b?b-i+26:void 0}function m(a){function k(a){h[j++]=a}var b,c,d,f,g,h;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=a.length;g="="===a.charAt(i-2)?2:"="===a.charAt(i-1)?1:0,h=new e(3*a.length/4-g),d=g>0?a.length-4:a.length;var j=0;for(b=0,c=0;d>b;b+=4,c+=3)f=l(a.charAt(b))<<18|l(a.charAt(b+1))<<12|l(a.charAt(b+2))<<6|l(a.charAt(b+3)),k((16711680&f)>>16),k((65280&f)>>8),k(255&f);return 2===g?(f=l(a.charAt(b))<<2|l(a.charAt(b+1))>>4,k(255&f)):1===g&&(f=l(a.charAt(b))<<10|l(a.charAt(b+1))<<4|l(a.charAt(b+2))>>2,k(f>>8&255),k(255&f)),h}var d=c.deepMerge({},a||{}),e="undefined"!=typeof Uint8Array?Uint8Array:Array,f="+".charCodeAt(0),g="/".charCodeAt(0),h="0".charCodeAt(0),i="a".charCodeAt(0),j="A".charCodeAt(0),k=m(d.data);return c.handleCallback(b,k),k},handleCallback:function(a){var b,d=Array();if(a&&a instanceof Function){for(b=0;b<arguments.length;b++)b>0&&d.push(arguments[b]);a.apply(c,d)}},handleBorder:function(a){if(c.config.border instanceof Object){var b=c.deepMerge(c.defaults.fabric.border,a.border||{},!0),d=new fabric.Rect;b.width=c.setup.fabric.width-b.strokeWidth,b.height=c.setup.fabric.height-b.strokeWidth,d.set(b),c.setup.fabric.add(d)}},handleDropbox:function(a){if(c.drawing.buffer.enabled)if(a.preventDefault(),a.stopPropagation(),"dragover"==a.type)c.setup.wrapper.setAttribute("class",c.setup.chart.classNamePrefix+"-export-canvas active dropbox");else if(c.setup.wrapper.setAttribute("class",c.setup.chart.classNamePrefix+"-export-canvas active"),"drop"==a.type&&a.dataTransfer.files.length)for(var b=0;b<a.dataTransfer.files.length;b++){var d=new FileReader;d.onloadend=function(b){return function(){c.drawing.handler.add({url:d.result,top:a.layerY-10*b,left:a.layerX-10*b})}}(b),d.readAsDataURL(a.dataTransfer.files[b])}},getChartData:function(a){function i(a,e,f){function g(a,c){return-1!=b.dataFields.indexOf(a)?g([a,".",c].join("")):a}a&&b.exportTitles&&"gantt"!=c.setup.chart.type&&(d=g(a,f),b.dataFieldsMap[d]=a,b.dataFields.push(d),b.titles[d]=e||d)}var d,e,f,g,b=c.deepMerge({data:[],titles:{},dateFields:[],dataFields:[],dataFieldsMap:{},exportTitles:c.config.exportTitles,exportFields:c.config.exportFields,exportSelection:c.config.exportSelection,columnNames:c.config.columnNames},a||{},!0),h=["valueField","openField","closeField","highField","lowField","xField","yField"];if(0==b.data.length)if("stock"==c.setup.chart.type){for(b.data=c.setup.chart.mainDataSet.dataProvider,i(c.setup.chart.mainDataSet.categoryField),b.dateFields.push(c.setup.chart.mainDataSet.categoryField),e=0;e<c.setup.chart.mainDataSet.fieldMappings.length;e++){var j=c.setup.chart.mainDataSet.fieldMappings[e];for(f=0;f<c.setup.chart.panels.length;f++){var k=c.setup.chart.panels[f];for(g=0;g<k.stockGraphs.length;g++){var l=k.stockGraphs[g];for(i4=0;i4<h.length;i4++)l[h[i4]]==j.toField&&i(j.fromField,l.title,h[i4])}}}for(e=0;e<c.setup.chart.comparedGraphs.length;e++){var l=c.setup.chart.comparedGraphs[e];for(f=0;f<l.dataSet.dataProvider.length;f++)for(g=0;g<l.dataSet.fieldMappings.length;g++){var j=l.dataSet.fieldMappings[g],d=l.dataSet.id+"_"+j.toField;f<b.data.length&&(b.data[f][d]=l.dataSet.dataProvider[f][j.fromField],b.titles[d]||i(d,l.dataSet.title))}}}else if("gantt"==c.setup.chart.type){i(c.setup.chart.categoryField),b.dateFields.push(c.setup.chart.categoryField);var m=c.setup.chart.segmentsField;for(e=0;e<c.setup.chart.dataProvider.length;e++){var n=c.setup.chart.dataProvider[e];if(n[m])for(f=0;f<n[m].length;f++)n[m][f][c.setup.chart.categoryField]=n[c.setup.chart.categoryField],b.data.push(n[m][f])}for(e=0;e<c.setup.chart.graphs.length;e++){var l=c.setup.chart.graphs[e];for(f=0;f<h.length;f++){var o=h[f],p=l[o];l.title;i(p,l.title,o)}}}else if(-1!=["pie","funnel"].indexOf(c.setup.chart.type))b.data=c.setup.chart.dataProvider,i(c.setup.chart.titleField),b.dateFields.push(c.setup.chart.titleField),i(c.setup.chart.valueField);else if("map"!=c.setup.chart.type)for(b.data=c.setup.chart.dataProvider,c.setup.chart.categoryAxis&&(i(c.setup.chart.categoryField,c.setup.chart.categoryAxis.title),c.setup.chart.categoryAxis.parseDates!==!1&&b.dateFields.push(c.setup.chart.categoryField)),e=0;e<c.setup.chart.graphs.length;e++){var l=c.setup.chart.graphs[e];for(f=0;f<h.length;f++){var o=h[f],p=l[o];i(p,l.title,o)}}return c.processData(b)},processData:function(b){var e,f,d=c.deepMerge({data:[],titles:{},dateFields:[],dataFields:[],dataFieldsMap:{},dataDateFormat:c.setup.chart.dataDateFormat,dateFormat:c.config.dateFormat||c.setup.chart.dataDateFormat||"YYYY-MM-DD",exportTitles:c.config.exportTitles,exportFields:c.config.exportFields,exportSelection:c.config.exportSelection,columnNames:c.config.columnNames,processData:c.config.processData},b||{},!0);if(d.data.length){for(e=0;e<d.data.length;e++)for(f in d.data[e])-1==d.dataFields.indexOf(f)&&(d.dataFields.push(f),d.dataFieldsMap[f]=f);void 0!==d.exportFields&&(d.dataFields=d.dataFields.filter(function(a){return-1!=d.exportFields.indexOf(a)}));var g=[];for(e=0;e<d.data.length;e++){var h={},i=!1;for(f=0;f<d.dataFields.length;f++){var j=d.dataFields[f],k=d.dataFieldsMap[j],l=d.columnNames&&d.columnNames[j]||d.titles[j]||j,m=d.data[e][k];null==m&&(m=void 0),d.exportTitles&&"gantt"!=c.setup.chart.type&&l in h&&(l+=["( ",j," )"].join("")),-1!=d.dateFields.indexOf(k)&&(d.dataDateFormat&&(m instanceof String||"string"==typeof m)?m=AmCharts.stringToDate(m,d.dataDateFormat):d.dateFormat&&(m instanceof Number||"number"==typeof m)&&(m=new Date(m)),d.exportSelection&&(m instanceof Date?(m<a.startDate||m>a.endDate)&&(i=!0):(e<a.startIndex||e>a.endIndex)&&(i=!0)),d.dateFormat&&"dateObject"!=d.dateFormat&&m instanceof Date&&(m=AmCharts.formatDate(m,d.dateFormat))),h[l]=m}i||g.push(h)}d.data=g}return void 0!==d.processData?d.processData(d.data):d.data},capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()},createMenu:function(b,d){function f(b,d){var e,g,h=document.createElement("ul");for(e=0;e<b.length;e++){var i="string"==typeof b[e]?{format:b[e]}:b[e],j=document.createElement("li"),k=document.createElement("a"),l=document.createElement("img"),m=document.createElement("span"),n=String(i.action?i.action:i.format).toLowerCase();if(i.format=String(i.format).toUpperCase(),c.config.formats[i.format]?i=c.deepMerge({label:i.icon?"":i.format,format:i.format,mimeType:c.config.formats[i.format].mimeType,extension:c.config.formats[i.format].extension,capture:c.config.formats[i.format].capture,action:c.config.action,fileName:c.config.fileName},i):i.label||(i.label=i.label?i.label:c.i18l("menu.label."+n)),(-1==["CSV","JSON","XLSX"].indexOf(i.format)||-1==["map","gauge"].indexOf(c.setup.chart.type))&&(c.setup.hasBlob||"UNDEFINED"==i.format||!i.mimeType||"image"==i.mimeType.split("/")[0]||"text/plain"==i.mimeType)){if("draw"==i.action)c.config.fabric.drawing.enabled?(i.menu=i.menu?i.menu:c.config.fabric.drawing.menu,i.click=function(a){return function(){this.capture(a,function(){this.createMenu(a.menu)})}}(i)):i.menu=[];else if(!i.populated&&i.action&&-1!=i.action.indexOf("draw.")){var o=i.action.split(".")[1],p=i[o]||c.config.fabric.drawing[o]||[];for(i.menu=[],i.populated=!0,g=0;g<p.length;g++){var q={label:p[g]};if("shapes"==o){var r=-1==p[g].indexOf("//"),s=(r?c.config.path+"shapes/":"")+p[g];q.action="add",q.url=s,q.icon=s,q.ignore=r,q["class"]="export-drawing-shape"}else"colors"==o?(q.style="background-color: "+p[g],q.action="change",q.color=p[g],q["class"]="export-drawing-color"):"widths"==o?(q.action="change",q.width=p[g],q.label=document.createElement("span"),q.label.style.width=c.numberToPx(p[g]),q.label.style.height=c.numberToPx(p[g]),q["class"]="export-drawing-width"):"opacities"==o?(q.style="opacity: "+p[g],q.action="change",q.opacity=p[g],q.label=100*p[g]+"%",q["class"]="export-drawing-opacity"):"modes"==o&&(q.label=c.i18l("menu.label.draw.modes."+p[g]),q.click=function(a){return function(){c.drawing.mode=a}}(p[g]),q["class"]="export-drawing-mode");i.menu.push(q)}}else i.click||i.menu||i.items||(c.drawing.handler[n]instanceof Function?(i.action=n,i.click=function(a){return function(){this.drawing.handler[a.action](a)}}(i)):c.drawing.buffer.enabled?i.click=function(a){return function(){this.config.drawing.autoClose&&this.drawing.handler.done(),this["to"+a.format](a,function(b){"download"==a.action&&this.download(b,a.mimeType,[a.fileName,a.extension].join("."))})}}(i):"UNDEFINED"!=i.format&&(i.click=function(a){return function(){if(a.capture||"print"==a.action||"PRINT"==a.format)this.capture(a,function(){this.config.drawing.autoClose&&this.drawing.handler.done(),this["to"+a.format](a,function(b){"download"==a.action&&this.download(b,a.mimeType,[a.fileName,a.extension].join("."))})});else{if(!this["to"+a.format])throw new Error("Invalid format. Could not determine output type.");this["to"+a.format](a,function(b){this.download(b,a.mimeType,[a.fileName,a.extension].join("."))})}}}(i)));(void 0===i.menu||i.menu.length)&&(k.setAttribute("href","#"),k.addEventListener("click",function(a,b){return function(d){d.preventDefault();var e=[d,b];return("draw"==b.action||"PRINT"==b.format||"UNDEFINED"!=b.format&&b.capture)&&!c.drawing.enabled&&(b.delay=b.delay?b.delay:c.config.delay,b.delay)?void c.delay(b,a):void a.apply(c,e)}}(i.click||function(a){a.preventDefault()},i)),j.appendChild(k),c.isElement(i.label)?m.appendChild(i.label):m.innerHTML=i.label,i["class"]&&(j.className=i["class"]),i.style&&j.setAttribute("style",i.style),i.icon&&(l.setAttribute("src",(i.ignore||-1!=i.icon.slice(0,10).indexOf("//")?"":a.pathToImages)+i.icon),k.appendChild(l)),i.label&&k.appendChild(m),i.title&&k.setAttribute("title",i.title),c.config.menuReviver&&(j=c.config.menuReviver.apply(c,[i,j])),i.elements={li:j,a:k,img:l,span:m},(i.menu||i.items)&&"draw"!=i.action?f(i.menu||i.items,j).childNodes.length&&h.appendChild(j):h.appendChild(j))}}return h.childNodes.length&&d.appendChild(h),h}return d||("string"==typeof c.config.divId?c.config.divId=d=document.getElementById(c.config.divId):d=c.isElement(c.config.divId)?c.config.divId:c.setup.chart.containerDiv),c.isElement(c.setup.menu)?c.setup.menu.innerHTML="":c.setup.menu=document.createElement("div"),c.setup.menu.setAttribute("class",c.setup.chart.classNamePrefix+"-export-menu "+c.setup.chart.classNamePrefix+"-export-menu-"+c.config.position+" amExportButton"),c.config.menuWalker&&(f=c.config.menuWalker),f.apply(this,[b,c.setup.menu]),c.setup.menu.childNodes.length&&d.appendChild(c.setup.menu),c.setup.menu},delay:function(a,b){var e,f,d=c.deepMerge({delay:3,precision:2},a||{}),g=Number(new Date),h=c.createMenu([{label:c.i18l("capturing.delayed.menu.label").replace("{{duration}}",AmCharts.toFixed(d.delay,d.precision)),title:c.i18l("capturing.delayed.menu.title"),class:"export-delayed-capturing",click:function(){clearTimeout(e),clearTimeout(f),c.createMenu(c.config.menu)}}]),i=h.getElementsByTagName("a")[0];e=setInterval(function(){var a=d.delay-(Number(new Date)-g)/1e3;0>=a?(clearTimeout(e),"draw"!=d.action&&c.createMenu(c.config.menu)):i&&(i.innerHTML=c.i18l("capturing.delayed.menu.label").replace("{{duration}}",AmCharts.toFixed(a,2)))},10),f=setTimeout(function(){b.apply(c,arguments)},1e3*d.delay)},migrateSetup:function(a){function c(a){var d;for(d in a){var e=a[d];"export"==d.slice(0,6)&&e?b.menu.push(d.slice(6)):"userCFG"==d?c(e):"menuItems"==d?b.menu=e:"libs"==d?b.libs=e:"string"==typeof d&&(b[d]=e)}}var b={enabled:!0,migrated:!0,libs:{autoLoad:!0},menu:[]};return c(a),b},loadListeners:function(){function a(a){a&&(a.set({top:a.top+10,left:a.left+10}),c.setup.fabric.add(a))}c.config.keyListener&&"attached"!=c.config.keyListener&&(c.config.keyListener="attached",document.addEventListener("keydown",function(b){var d=c.drawing.buffer.target;8!=b.keyCode&&46!=b.keyCode||!d?27==b.keyCode&&c.drawing.enabled?(b.preventDefault(),c.drawing.handler.done()):67==b.keyCode&&(b.metaKey||b.ctrlKey)&&d?c.drawing.buffer.copy=d:88==b.keyCode&&(b.metaKey||b.ctrlKey)&&d?(c.drawing.buffer.copy=d,c.setup.fabric.remove(d)):86==b.keyCode&&(b.metaKey||b.ctrlKey)?c.drawing.buffer.copy&&a(c.drawing.buffer.copy.clone(a)):90==b.keyCode&&(b.metaKey||b.ctrlKey)&&(b.preventDefault(),b.shiftKey?c.drawing.handler.redo():c.drawing.handler.undo()):(b.preventDefault(),c.setup.fabric.remove(d))})),c.config.fileListener&&(c.setup.chart.containerDiv.addEventListener("dragover",c.handleDropbox),c.setup.chart.containerDiv.addEventListener("dragleave",c.handleDropbox),c.setup.chart.containerDiv.addEventListener("drop",c.handleDropbox))},init:function(){clearTimeout(c.timer),c.timer=setInterval(function(){c.setup.chart.containerDiv&&(clearTimeout(c.timer),c.config.enabled&&(c.setup.chart.AmExport=c,c.config.overflow&&(c.setup.chart.div.style.overflow="visible"),c.loadListeners(),c.createMenu(c.config.menu)))},AmCharts.updateRate)},construct:function(){c.drawing.handler.cancel=c.drawing.handler.done;try{c.setup.hasBlob=!!new Blob}catch(a){}window.safari=window.safari?window.safari:{},c.defaults.fabric.drawing.fontSize=c.setup.chart.fontSize||11,c.config.drawing=c.deepMerge(c.defaults.fabric.drawing,c.config.drawing||{},!0),c.config.border&&(c.config.border=c.deepMerge(c.defaults.fabric.border,c.config.border||{},!0)),c.deepMerge(c.defaults.fabric,c.config,!0),c.deepMerge(c.defaults.fabric,c.config.fabric||{},!0),c.deepMerge(c.defaults.pdfMake,c.config,!0),c.deepMerge(c.defaults.pdfMake,c.config.pdfMake||{},!0),c.deepMerge(c.libs,c.config.libs||{},!0),c.config.drawing=c.defaults.fabric.drawing,c.config.fabric=c.defaults.fabric,c.config.pdfMake=c.defaults.pdfMake,c.config=c.deepMerge(c.defaults,c.config,!0),c.config.fabric.drawing.enabled&&void 0===c.config.fabric.drawing.menu&&(c.config.fabric.drawing.menu=[],c.deepMerge(c.config.fabric.drawing.menu,[{class:"export-drawing",menu:[{label:c.i18l("menu.label.draw.add"),menu:[{label:c.i18l("menu.label.draw.shapes"),action:"draw.shapes"},{label:c.i18l("menu.label.draw.text"),action:"text"}]},{label:c.i18l("menu.label.draw.change"),menu:[{label:c.i18l("menu.label.draw.modes"),action:"draw.modes"},{label:c.i18l("menu.label.draw.colors"),action:"draw.colors"},{label:c.i18l("menu.label.draw.widths"),action:"draw.widths"},{label:c.i18l("menu.label.draw.opacities"),action:"draw.opacities"},"UNDO","REDO"]},{label:c.i18l("menu.label.save.image"),menu:["PNG","JPG","SVG","PDF"]},"PRINT","CANCEL"]}])),void 0===c.config.menu&&(c.config.menu=[],c.deepMerge(c.config,{menu:[{class:"export-main",menu:[{label:c.i18l("menu.label.save.image"),menu:["PNG","JPG","SVG","PDF"]},{label:c.i18l("menu.label.save.data"),menu:["CSV","XLSX","JSON"]},{label:c.i18l("menu.label.draw"),action:"draw",menu:c.config.fabric.drawing.menu},{format:"PRINT",label:c.i18l("menu.label.print")}]}]})),c.libs.path||(c.libs.path=c.config.path+"libs/"),c.isSupported()&&(c.loadDependencies(c.libs.resources,c.libs.reload),c.setup.chart.addClassNames=!0,c.setup.chart[c.name]=c,c.init())}};if(b)c.config=b;else if(c.setup.chart[c.name])c.config=c.setup.chart[c.name];else{if(!c.setup.chart.amExport&&!c.setup.chart.exportConfig)return;c.config=c.migrateSetup(c.setup.chart.amExport||c.setup.chart.exportConfig)}return c.construct(),c.deepMerge(this,c)}}(),AmCharts.addInitHandler(function(a){new AmCharts["export"](a)},["pie","serial","xy","funnel","radar","gauge","stock","map","gantt"]);AmCharts.maps.turkeyLow={svg:{defs:{"amcharts:ammap":{projection:"mercator",leftLongitude:"25.663689",topLatitude:"42.099732",rightLongitude:"44.819611",bottomLatitude:"35.805510"}},g:{path:[{id:"TR-01",title:"Adana",d:"M445.07,206.98l-3.09,8.85l-2.93,3.51l3.24,1.66l-2.8,3.97l2.49,5.4l-1.16,3.6l-2.89,2.9l0,0l-5.49,2.81l-2.15,3.22l-1.29,4.13l-0.47,4.38l2.33,10.57l-1.24,9.1l0,0l-2.23,2.65l0.25,2.58l0,0l-8.98,8.59l-4.99,-0.04l-1.64,1.05l-0.84,1.74l0.91,-0.42l0.01,1.18l0.04,-1.49l1.01,-0.55l0.12,1.52l1.81,-0.22l-0.21,-0.74l1.08,0.75l-3.2,2.23l-0.78,3.14l-2.95,2.12l-5.13,-1.28l-3.83,2.67l-13.85,-8.74l-4.12,-0.62l0,0l2.14,-1.06l0.16,-0.96l2.74,0.23l0.02,-1.1l0.69,0.67l1.29,-1.71l2.84,0.73l0.81,-1.54l-0.68,-6.76l-1.35,-6l-3.01,-1.78l-1.69,-0.01l-0.92,-2.32l-2.19,-1.27l0.02,-1.54l2.02,-1.89l-0.08,-1.23l-6.09,-7.11l-0.7,-3.67l0,0l2.63,-2.09l-0.76,-1.45l1,-1.36l1.56,-7.07l5.05,0.61l3.29,-5l4.54,-2.7l0,0l5.44,1.9l1.32,-0.34l1.27,1.69l7.13,0.43l1.23,-2.07l1.29,-9.35l3.28,-1.42l4.36,-4.7l6.58,-2.48l2.52,-6.52l3.65,-4.99l5.12,-1.5L445.07,206.98z"},{id:"TR-02",title:"Adıyaman",d:"M557.34,211.25L560.65,210.16L562.28,213.06L560.51,217.44L558.17,219.93L558.17,219.93L555.13,220.54L553.85,221.67L552.53,225.31L550.31,226.26L551.07,226.96L550.5,230.03L548.37,230L547.13,231.21L549.63,231.16L549.68,233.75L547.98,234.29L547.76,235.72L546.51,236.56L543.84,237.09L545.26,239.12L536.98,240.81L530.27,246.67L528.2,247.75L521.34,248.27L520.25,249.99L518.28,249.65L517.42,251.74L513.61,249.68L513.61,249.68L507.98,247.29L500.39,247.03L498.7,245.18L494.37,246.53L492.58,245.69L492.58,245.69L491.16,242.02L487.24,241.6L486.56,239.64L487.9,237.67L488.17,234.54L490.73,231.87L490.58,227.29L493.86,225.42L495.32,222.79L495.32,222.79L496.18,223.72L495.74,225.54L498.9,224.82L499.94,227.31L501.98,226.18L506.37,227.12L511.05,226.22L515.06,222.49L514.35,219.18L513,217.35L513.39,216.26L520.59,213.52L522.23,211.24L523.65,210.7L527.74,210.43L533.63,213.31L534.34,214.44L536.39,214.83L543.31,219.58L551.77,216.19L552.22,214.81z"},{id:"TR-03",title:"Afyonkarahisar",d:"M197.93,155.58L201.16,156.17L203.21,161.1L206.07,162.46L209.29,165.73L211.01,161.7L219.13,162.58L220.1,160.57L217.09,158.56L216.86,157.4L219.32,157.21L222.53,158.57L223.09,156.97L225.05,156.63L226.24,153.52L227.64,152.6L231.5,155.27L235.07,154.26L239.56,158.44L240.17,161.3L243.67,162.28L245.44,164.99L245.44,164.99L246.6,167.25L251.9,168.16L252.46,169.08L246.51,170.29L247.3,171.78L246.8,177.3L243.41,183.6L243.85,185.37L246.08,187.39L233.78,195.4L232.57,199.15L232.57,199.15L231.28,199.36L229.41,196.4L226.87,194.4L221.3,195.28L218.19,198.31L214.49,199.98L211.4,205.32L205.47,209.07L200.02,210.43L193.19,217.98L189.17,219.83L186.04,223.81L186.24,227.34L184.09,231.67L184.09,231.67L184.09,231.67L184.09,231.67L176.29,231.34L176.29,231.34L168.61,226.97L167.25,223.92L167.58,221.08L172.81,216.2L174.84,212.93L179.23,212.71L181.13,209.61L183.89,207.36L181.44,200.62L178.8,199.52L177.66,197.74L175.9,197.54L174.53,195.98L172.89,195.96L170.82,194.56L170.82,194.56L175.51,188.43L177.06,187.54L176.06,183.52L179.99,180.14L180.59,177.56L180.59,177.56L182.67,176.97L185.3,173.47L188.15,172.29L190.61,168.38L190.13,161.23L193.48,159.04L196.21,158.92z"},{id:"TR-04",title:"Ağrı",d:"M696.57,119.95L720.27,114.16L727.69,115.34L727.69,115.34L730.8,116.17L733.68,119.58L734.22,126.6L736.63,126.38L738.27,123.8L739.98,123.35L743.35,125.98L750.5,126.65L754.1,129.36L760.44,129.36L764.7,130.7L768.46,130.24L773.84,132.57L777.67,132.1L777.67,132.1L777.93,135.97L775.62,138.34L776.36,141.68L775.29,143.37L775.7,146.38L770.23,148.58L767.8,146.27L764.15,147.28L761.07,146.53L759.66,148.28L759.66,148.28L752.85,149.36L749.84,154.23L746.59,157.1L743.35,156.69L739.05,154.42L733.83,148.81L728.43,148.44L723.74,149.83L723.57,157.8L719.51,161.08L716.36,166.67L716.36,166.67L714.13,167.41L713.88,170.23L708.62,172.56L703.87,171.89L703.87,171.89L703.66,165.45L704.47,161.45L700.32,152.3L699.77,148.89L696.33,148.95L694.78,144.89L691.28,141.28L691.28,141.28L692.8,138.45L696.19,135.78L696.86,134.29L693.92,131.22L688.58,128.44L686.67,124.1L687.86,122.87z"},{id:"TR-68",title:"Aksaray",d:"M339.42,165.56L340.54,166.54L342.7,165.59L343.48,166.68L345.95,166.34L347.52,169.37L347.5,171.72L351.81,176.04L354.06,176.89L356.71,176.37L356.71,176.37L357.78,177.33L357.57,181.22L356.05,184.03L356.43,186.63L360.96,189.05L363.89,193.54L364.33,197.28L365.93,198.82L365.93,198.82L362.83,200.63L362.04,206.44L358.67,211.42L356.57,213.02L352.19,214.12L348.83,217.44L348.83,217.44L322.76,223.62L319.88,220.41L318.14,216.56L314.1,213.63L313.65,209.27L311.55,205.72L314.54,196.16L317.66,192.72L318.96,188.78L324.27,187.06L324.27,187.06L328.23,186.97L334.99,184.3L337.63,178.64L336.35,174.43L338.05,171.82L338.23,168.38z"},{id:"TR-05",title:"Amasya",d:"M390.29,56.95L395.39,57.58L397.04,59.66L402.46,58.75L405.21,60.2L406.65,59.15L407.21,60.39L408.58,59.37L410.16,63.18L413.21,64.71L412.87,66.4L413.67,67.45L417.98,67.62L419.47,69.06L424.55,67.85L431.46,70.68L433.12,65.71L434.37,65.27L435.35,63.17L440.88,65.21L441.17,66.3L439.52,68.21L444.23,70.11L444.23,70.11L444.73,71.88L448.1,73.67L444.85,76.59L445.09,79.04L444,81.05L438.38,81.49L438.66,82.76L441.34,83.2L439.3,84.88L438.42,87.08L432.98,89.57L431.82,91.2L428,89.79L428.09,88.85L426.44,87.98L420.85,88.27L419.78,91.36L417.24,92.98L417.07,94.69L414.6,96.36L409.83,97.44L405.06,100.49L405.06,100.49L402.34,100.98L402.34,100.98L404.72,96.97L402.68,95.46L404.02,92.64L403.37,90.73L405.29,89.93L405.3,88.22L406.91,87.09L407.49,85.03L405.08,80.8L400.5,79.71L400.68,76.02L394.94,75.61L390.97,76.75L387.11,73.81L386.73,70.42L389.7,64.86L387.15,61.6L390.26,59.16z"},{id:"TR-06",title:"Ankara",d:"M284.94,76.9L288.86,76.63L296.2,80.95L301.08,82.14L301.74,83.7L300.79,87.28L304.55,87.31L309.93,89.46L314.51,97.01L316.84,95.86L318.42,93.37L321.02,93.86L322.2,95.35L325.63,94.94L332.2,96.08L333,97.12L333,97.12L330.53,97.61L330.6,99.05L328.52,101.1L329.07,101.76L327.93,104.09L328.62,105.38L327.77,109.79L328.87,111.44L326.48,113.73L319.79,116.09L317.33,122.83L316.03,123.23L316.45,126.79L313.27,132.11L318.91,136.95L319.65,143.87L319.15,146.34L320.71,147.08L320.71,147.08L322.79,150.29L321.69,151.39L324.27,152.98L327.07,157.98L330.04,159.16L334.42,162.97L334.65,164.32L338.72,164.58L339.42,165.56L339.42,165.56L338.23,168.38L338.05,171.82L336.35,174.43L337.63,178.64L334.99,184.3L328.23,186.97L324.27,187.06L324.27,187.06L319.79,180.15L318.51,172.87L318.83,166.91L313,163.26L310.73,160.42L309.9,155.46L312.84,153.86L312.16,152.34L309.03,153.36L305.45,156.69L304.25,155.84L304.6,151.93L303.91,151.25L297.7,152.99L296.49,154.83L295.72,159.26L292.97,160.63L292.61,164.61L289.22,166.69L285.18,164.8L282.86,168.21L281.57,168.72L278.99,168.41L275.49,165.78L272.98,166.9L271.92,165.66L268.77,170.03L264.67,169.61L262.77,167.73L259.23,160.73L258.16,160.27L258.16,160.27L258.5,157.76L264.7,150.97L264.57,149.89L261.8,148.74L262.56,147.24L261.51,145.73L262.18,141.66L260.5,141.06L260.88,139.67L259,137.72L257.61,132.14L254.96,128.44L256.6,123.84L257.83,122.76L255.82,123.08L256.69,121.89L256.13,121.29L253.91,121.63L252.5,120.41L251.2,118.54L251.08,116.61L249.35,115.82L250.01,113.93L247.99,114.38L248.38,112.11L246.42,113.7L242.93,112.93L241.52,113.89L239.79,112.62L237.25,114.07L236.68,113.04L238.32,112.51L236.83,111.58L234.7,112.47L231.72,111.58L228.67,112.45L225.38,111.11L224.67,112.16L221.66,112.54L221.25,113.53L218.08,113.43L214.64,111.62L213.59,106.88L213.59,106.88L217.68,104.37L226.1,94.96L230.41,95.62L237.74,94.35L238.73,95.03L239.38,97.53L245.66,98.3L251.93,97.02L258.04,97.25L261.01,94.86L263.86,94.36L267.26,94.85L269.07,96.73L271.99,96.38L272.88,94.49L270.48,91.01L271.7,87.19L273.76,85.72L281.6,83.25L281.72,81.95L280.2,80.13L280.38,78.55L281.67,77.48z"},{id:"TR-07",title:"Antalya",d:"M234.84,249.39l3.26,3.2l8.94,2.08l2.8,-0.4l3.47,-2.07l1.72,0.1l1.06,2.91l2.15,2.11l2.3,6.9l4.26,5.95l7.46,3.44l1.44,1.74l0.85,4.4l4.95,3.32l0,0l-0.87,5.4l0.5,1.84l6.02,6.21l0,0l3.47,10.46l-2.32,6.31l0.76,2.27L285.2,319l0,0l-3.06,-0.45l-7.74,-6.25l-5.6,-9.47l-5.93,-6.3l-1.35,0.55l-1.15,-1.47l-7.73,-2.37l-1.41,-1.69l-3.13,-0.64l-4.68,-3.32l-6.83,-2.53l-0.04,-0.9l-2.36,-1.44l-13.37,-2.48l-10.1,0.54l-2.56,-1.96l-2.74,1.43l-2.33,3.03l-0.82,9.07l1.48,1.55l-3.51,6.36l0.07,1.36l-1.21,0.36l-0.16,1.79l2.17,3.3l-2.61,1.09l0.87,1.77l-3.31,3.43l0.18,-3.03l-1.82,0.07l-3.52,-2.28l-3.88,0.03l-1.51,0.66l-0.01,1.45l-0.5,-0.3l-1.02,1.62l-2.4,-1.47l-0.27,1.11l-2.66,1.91l-2.29,-0.88l-1.87,1.96l-1.88,0l-1.67,1.63l1.25,-0.23l-2.17,1.57l-0.75,-0.38l0.92,-0.69l-2.29,-0.27l-1.85,1.36L164,315.5l0.81,-0.24l-0.2,-1.11l-2.54,0.46l1.98,-0.94l-9.06,-0.98l0.19,-1.78l-1.14,-0.28l-0.86,0.09l-0.61,1.69l-3.63,-3.28l0,0l1.99,-1.36l-0.12,-3.42l0.88,-0.38l-0.46,-2.36l3.11,-1.68l5.13,-0.3l2.29,-2.03l2.16,-3.75l3.88,-2.45l1.29,-3.22l-0.02,-6.16l2.39,-4.18l-0.53,-2.24l-1.6,-1.35l0,0l3.61,-3.28l-0.72,-3.76l0.98,-1.82l4.4,-3.96l3.25,-1.15l6.59,-5l5.73,-0.38l7.07,4.3l12.51,0.42l1.54,-0.98l3.17,-6.5l-1.13,-1.58l0,0l2.65,0.05l3.58,2.99l4.11,-3.11L234.84,249.39z"},{id:"TR-75",title:"Ardahan",d:"M704.38,27.79L707.6,29.14L710.1,28.75L708.69,33.61L710.64,34.96L711.33,33.56L712.7,33.38L712.7,34.58L715.52,36.14L717.71,40.28L720.81,41.25L722.51,43.39L725.63,44.15L725.61,45L722.16,46.94L724.91,47.02L726.51,51.22L731.34,49.75L735.41,51.22L736.51,54.08L735.37,55.44L736.36,57.07L736.27,59.11L738.41,60.01L738.41,60.01L736.75,61.72L732.43,62.12L730.56,63.2L724.09,62.81L721.04,64.08L718.98,63.05L716.69,65.56L713.02,67.48L712.6,69.4L708.28,74.13L707.75,77.56L704.05,77.75L702.72,79.12L702.72,79.12L700.98,78.73L698.46,73.47L691.4,71.83L688.54,66.18L688.54,66.18L691.06,63.97L691.88,61.56L689.95,59.85L688.61,56.75L690.53,55.29L691.32,52.08L696.42,49.48L700.1,45.27L698.52,41.55L696.47,39.82L696.71,36.76L696.71,36.76L696.71,34.92L699.17,32.92L699.34,29.82L700.36,28.72z"},{id:"TR-08",title:"Artvin",d:"M674.73,32.21L677.24,33.73L682.91,32.6L684.05,33.9L687.26,33.79L689.13,35.21L692.06,35.24L694.06,36.79L696.71,36.76L696.71,36.76L696.47,39.82L698.52,41.55L700.1,45.27L696.42,49.48L691.32,52.08L690.53,55.29L688.61,56.75L689.95,59.85L691.88,61.56L691.06,63.97L688.54,66.18L688.54,66.18L685.17,63.02L675.98,62.71L670.66,67.75L671.17,73.27L668.54,75.84L668.11,78.89L666.47,80.37L664.79,80.44L664.38,77.37L663.55,77.02L656.05,80.23L650.74,84.12L649.17,83.82L648.54,81.61L648.48,77.92L650.08,76.99L650.05,76.17L647.7,73.66L640.26,70.37L640.26,70.37L643.9,65.41L644.71,62.32L649.46,56.91L652.17,55.15L646.44,47.44L646.24,44.59L644.93,42.31L644.93,42.31L650.67,39.98L656.78,32.36L660.35,34.12L663.58,33.67L663.52,34.88L666.65,35.57L668.17,37.12L670.68,35.56L672.55,33z"},{id:"TR-09",title:"Aydın",d:"M122.71,217.11l2.78,1.23l1.6,1.78l4.54,0.83l-1.47,2.83l-3.01,0.33l0.47,5.59l1.39,2.07l4.44,2.83l-2.42,3.04l-0.77,3.4l-6.33,5.29l-0.46,4.15l-0.72,0.47l0,0l-1.34,0.24l-5.47,-3.93l-9.13,-0.37l-0.67,-2.07l-5.33,4.28l-7.36,-0.58l-5,0.87l-2.98,-2.65l-2.62,0.16l-4.28,-1.81l-3.01,0.48l-2.59,1.97l-0.68,3.81l0,0l-1.55,0.56l-0.92,1.81l-1.07,-0.37l-0.08,1.79l-1.59,-0.69l-1.63,1.04l-2.25,-0.95l1.47,-2.57l-0.08,-3.53l-1.09,-0.76l-0.31,-3.01l-1,0.02l2.13,-2.22l-3.96,-2.27l-4.97,-1.47l1.11,-1.58l2.76,0.46l5.61,-2.25l1.47,-4.37l-1.34,-1.63l1.3,-2.9l0,0l3.31,1.46l0.79,2.37l2.82,-2.22l0.7,-4.28l3.48,-2.26l2.73,-0.09l5.31,2.74l11.81,-3.62l10.18,-0.95l1.94,-1.47l0.69,-1.72l3.05,-0.98l3.43,1.75l1.2,-2.21l0,0L122.71,217.11z"},{id:"TR-10",title:"Balıkesir",d:"M39.86,147.5l1.65,0.23l-1.93,1l1.22,0.38l0.52,1.29l1.32,-0.5l-0.22,0.8l-2.77,0.36l-0.31,-2.83l-0.76,-0.34L39.86,147.5zM80.89,87.59l1.28,0.81l-0.73,1.33l1.24,0.13l0.11,1.09l-3.68,-0.91l0.2,-1.05L80.38,89l-0.36,-1.45L80.89,87.59zM86.4,86.63l1,-0.06l0.31,1.09l3.08,-0.53l7.17,2.02l-0.63,1.69l-4.97,3.2l2.3,1.88l7.69,-2.01l0,0l1.98,3.08l0.03,2.14l-3.13,5.41l1.91,1.66l0.08,4.18l1.39,1.84l0.46,2.84l1.89,1.73l-0.04,3.27l1.63,2.37l1.62,1.12l3.78,0.27l2.06,2.51l4.63,2.66l2.71,-0.74l1.55,-1.63l1.41,0.34l0.64,5.77l1.42,-0.05l0.91,2.28l8.3,0.92l0,0l0.19,1.58l-2.87,3.04l0.91,6.6l-6.14,7.04l-7.27,1.33l1.6,4.04l0,0l-3.51,-0.37l-7.12,3.9l-4.3,-0.8l-2.78,2.41l-1.84,0.28l-4.29,-6.25l-4.53,-3.46l-1.32,-3.7l-1.35,-1.35l-4.29,2.89l-3.52,-3.59l-6.36,1.04l-4.66,-3.72l-2.49,1.53l0,0l0,0l0,0l-6.55,1.61l-3.18,-0.94l-3.6,1.1l-3.16,3.6l-6.95,2.23l-2.64,3.66l0,0l-1.92,-4.84l-4.57,-1.04l1.77,-2.43l0.17,1.03l-1.03,0.31l1.67,0.94l-0.36,-1.23l1.63,-1.79l4.29,-2.98l-0.28,-2.17l2.29,-0.37l0.11,-1.95l2.96,-0.41l0.93,-3.65l-1.08,-1.6l-1.93,-0.18l-1.75,1.49l-2.57,-0.72l-5.45,0.87l0,0l0.28,-3l2.56,-3.56l4.38,-0.99l3.29,-2.38l3.8,0.43l3.54,1.88l2.91,-0.23l6.42,1.77l3.4,-3.37l4.99,-2.95L77,125l0.67,-5.49l-2.53,-4.3l0.12,-3.36l-3.36,-3.08l2.79,-4.33l3.07,-2.2l0.54,-1.89l-0.71,-1.58l0,0l3.77,-1.48l1.89,1.1l3.35,0.1l5.02,-3.63l-2.39,-1.44l-1.07,0.89l-2.06,-2.5l0.12,-1.13l-2.53,-1.23l-0.14,-1.58L86.4,86.63zM77.31,86.43l0.78,0.46l-1.16,1.06l0.47,0.74l-1.95,1.06l0.34,-2.85l0.82,-0.93L77.31,86.43zM81.7,79l4.26,1.79l-5.54,3.19l-3.25,-1.2L77.3,80L81.7,79z"},{id:"TR-74",title:"Bartın",d:"M292.27,14.25L292.88,16.38L294.42,17.48L293.57,19.77L294.56,21.24L297.13,21.19L299.45,20.03L300.94,20.8L297.73,29L297.73,29L295.69,29.39L294.6,31.33L288.91,33.75L288.54,35.04L290.3,39.94L288.98,43.04L286.87,41.52L284.53,42.84L282.1,41.83L278.24,44.63L272.94,43.21L272.94,43.21L274.5,39.9L274.5,37.53L272.6,35.3L272.62,32.42L269.8,31.98L267.39,28.08L267.39,28.08L273.68,21.37L275.88,21.32L277.89,19.7L279.1,20.28L282.6,16.87L285.6,16.31L285.88,15.47L289.75,15.3z"},{id:"TR-72",title:"Batman",d:"M654.42,191.45L659.86,194.75L658.99,200.29L660.7,206.22L662.74,208.7L662.74,208.7L659.49,215.09L652.91,217.81L647.77,222.77L647.27,224.78L656.76,232.02L658.02,234.27L663.07,235.95L665.39,235.47L667.57,236.94L667.57,236.94L667.57,236.94L667.57,236.94L667.57,236.94L667.57,236.94L665.41,238.81L659.39,239.37L655.09,243.12L648.76,246.22L637.34,247.21L634.03,235.86L634.03,235.86L636.12,232.76L633.21,231.49L634.01,228.64L638.49,222.16L640.8,215.63L643.38,212.99L640.94,211.14L641.21,204.34L645.57,196.02L649.21,194.84L649.21,194.84L652.34,194.28z"},{id:"TR-69",title:"Bayburt",d:"M617.08,85.55L615.5,91.26L616.31,94.09L613.6,102.14L615.13,103.69L621.57,103.74L621.71,106.16L619.85,108.79L612.11,113.41L606.67,113.15L606.67,113.15L591.33,112.6L588.26,114.21L585.04,117.37L585.04,117.37L581.27,113.48L585.72,107.78L588.67,100.67L588.45,93.6L589.68,90.07L604.06,87.62L604.06,87.62L612.78,86.68L612.78,86.68z"},{id:"TR-11",title:"Bilecik",d:"M177.6,87.16L180.34,92.21L181.38,92.5L182.86,90.94L184.54,93.87L186.67,95.27L189.07,95.74L193.24,94.3L195.19,95.42L198.54,93.88L200.29,95.69L202.25,95.55L202.25,95.55L206.93,107.27L206.93,107.27L203.61,108.48L198.14,114.03L195.99,115.12L195.13,116.88L192.69,118.64L190.88,122.48L184.4,123.66L181.04,127.83L179.88,131.68L179.88,131.68L173.8,131.43L172.25,130.65L168.78,127.68L167.08,122.02L167.08,122.02L170.79,118.58L168.45,116.04L168.25,114.7L169.47,113.48L168.79,107.5L171.22,105.92L170.78,102.53L172.31,100.88L172.96,95.31L174.77,93.37L174.42,89.08z"},{id:"TR-12",title:"Bingöl",d:"M609.82,140.96L616.98,140.4L619.88,141.4L619.88,141.4L618.99,143.53L620.51,144.88L623.19,145.39L636.51,143.82L641.53,148.57L641.53,148.57L639.8,150.83L639.67,153.77L643.49,160.41L646.99,162.41L647.56,164.37L646.88,165.92L642.31,167.85L639.65,171.02L638.88,176.6L639.46,182.77L639.46,182.77L632.05,185.27L629.45,189.23L626.84,190.58L620.8,187.61L620.06,190.39L618.87,191.09L615.06,188.55L611.65,188.25L609.01,191.06L608.88,194L607.96,194.96L603.78,195.85L603.78,195.85L598.75,185.88L601.11,184.09L602.29,181.93L606.37,181.72L607.41,180.93L606.84,179.04L603.08,176.34L601.89,172.98L602.16,170.87L601.29,170.08L603.23,166.69L603.16,163.82L605.99,160.42L606.04,158.43L604.78,157.68L601.48,159.39L596.83,160.15L592.79,162.92L588.86,162.88L588.86,162.88L590.85,155.66L593.48,153.38L592.29,149.13L599.85,149.65z"},{id:"TR-13",title:"Bitlis",d:"M716.36,166.67L719.49,169.22L720.52,171.61L725.62,173.91L725.81,175.36L723.6,178.54L717.93,181.92L713.89,185.67L707.42,195.34L707.06,201.49L702.41,204.7L702.42,205.91L704.08,207.17L704.49,209.58L702.63,219.71L702.63,219.71L701.96,220.87L699.71,221.77L700.05,222.73L698.67,223.98L697.99,222.68L694.93,221.64L684.73,210.08L680.52,209.97L677.1,212.05L675.53,212.09L674.62,211.74L674.48,210.48L670.03,211.28L668.31,210.67L667.06,208.72L662.74,208.7L662.74,208.7L660.7,206.22L658.99,200.29L659.86,194.75L654.42,191.45L654.42,191.45L654.68,190.56L657.71,189.09L665.56,189.51L672.64,191.17L673.79,188.4L679.61,183.12L679.29,179.68L681.5,178.63L682.32,175.71L683.78,174.06L693.77,171.02L703.87,171.89L703.87,171.89L708.62,172.56L713.88,170.23L714.13,167.41z"},{id:"TR-14",title:"Bolu",d:"M270.92,55.58L275.94,56.29L275.94,56.29L278.01,63.18L278.06,66.6L282.81,66.48L285.9,71.19L284.94,76.9L284.94,76.9L281.67,77.48L280.38,78.55L280.2,80.13L281.72,81.95L281.6,83.25L273.76,85.72L271.7,87.19L270.48,91.01L272.88,94.49L271.99,96.38L269.07,96.73L267.26,94.85L263.86,94.36L261.01,94.86L258.04,97.25L251.93,97.02L245.66,98.3L239.38,97.53L238.73,95.03L237.74,94.35L230.41,95.62L226.1,94.96L217.68,104.37L213.59,106.88L213.59,106.88L211.59,106.07L206.93,107.27L206.93,107.27L202.25,95.55L202.25,95.55L203.05,93.73L202.76,87.7L209.49,87.95L215.16,86.75L217.48,84.5L215.62,81L217.09,78.56L217.09,78.56L223.7,79.44L228.29,78.75L231.24,74.22L232.5,70.24L238.79,67.45L239.75,59.9L239.75,59.9L244.46,58.1L252.1,58.06L255.34,59.59z"},{id:"TR-15",title:"Burdur",d:"M184.09,231.67L189.03,232.19L196.49,229.46L197.77,231.13L196.91,233.87L197.59,235.22L201.19,235.89L204.81,235.37L210.28,238.33L211.03,243.5L214.28,246.85L214.78,250.17L216.32,250.55L216.32,250.55L217.45,252.13L214.27,258.63L212.74,259.61L200.23,259.19L193.16,254.89L187.43,255.26L180.84,260.27L177.59,261.42L173.19,265.39L172.21,267.2L172.93,270.97L169.32,274.25L169.32,274.25L165.88,272.99L161.42,274.84L158.42,282.12L157.35,281.85L156.85,283.23L154.14,282.41L155.3,279.79L153,279.77L152.07,278.65L152.07,278.65L153.95,274.3L152.54,271.99L152.9,270.6L157.08,267.88L157.66,262.48L159.15,259.09L165.27,252.73L164.46,251.05L159.93,248.43L159.7,247.31L161.26,245.1L159.88,241.43L160.61,240.39L163.71,239.46L167.77,240.43L166.99,237.69L167.52,236.92L173.48,234.92L176.29,231.34L176.29,231.34z"},{id:"TR-16",title:"Bursa",d:"M119.51,84.47l-1.24,2.96l-0.24,-3L119.51,84.47zM156.01,84.99l4.47,0.88l10.38,-3.28l7.23,1.88l0,0l-0.49,2.69l0,0l-3.18,1.92l0.35,4.29l-1.81,1.94l-0.65,5.57l-1.53,1.66l0.44,3.39l-2.43,1.58l0.69,5.98l-1.22,1.22l0.2,1.34l2.34,2.54l-3.71,3.44l0,0l-5.11,0.31l-1.75,-1.57l-3.66,-1.28l-1.53,6.22l-4.36,3.88l-0.77,2.53l-2.89,2.14l-1.02,1.84l-8.42,-0.23l0,0l-8.3,-0.92l-0.91,-2.28l-1.42,0.05l-0.64,-5.77l-1.41,-0.34l-1.55,1.63l-2.71,0.74l-4.63,-2.66l-2.06,-2.51l-3.78,-0.27l-1.62,-1.12l-1.63,-2.37l0.04,-3.27l-1.89,-1.73l-0.46,-2.84l-1.39,-1.84l-0.08,-4.18l-1.91,-1.66l3.13,-5.41l-0.03,-2.14l-1.98,-3.08l0,0l15.35,-0.33L124,95.5l5.36,-1.77l7.6,2.06l3.25,-0.43l1.59,-2.95l2.46,-0.26l-2.93,-2.9l-2.28,-0.07l-2.29,1.08l0,0l0.63,-5.44l8.85,1.83l4.93,-1.76L156.01,84.99z"},{id:"TR-17",title:"Çanakkale",d:"M16.34,123.48l0.87,2.2l-1.06,0.68l-3.83,-1.96l0.01,-0.81L16.34,123.48zM11.69,102.27l1.14,1.08l-0.39,3.61l1.88,-0.72l-0.74,1.62l-10.49,2.16L0,108.23l0.26,-1.51l4.7,-3.04L11.69,102.27zM67.96,90.72l1.09,2.1l-1.19,0.65l0.91,1.54l4.66,2.66l4.17,1.11l0,0l0.71,1.58l-0.54,1.89l-3.07,2.2l-2.79,4.33l3.36,3.08l-0.12,3.36l2.53,4.3L77,125l-0.98,1.49l-4.99,2.95l-3.4,3.37l-6.42,-1.77l-2.91,0.23l-3.54,-1.88l-3.8,-0.43l-3.29,2.38l-4.38,0.99l-2.56,3.56l-0.28,3l0,0l-6.91,1.55l-4.05,1.55l-0.36,0.86l-3.35,-0.31l-1.94,1.28l-0.72,-0.6l-3.62,1.09l-2.68,-1.01l1.4,-6.12l1.34,-1.1l0.96,-2.66l-0.92,-5.46l0.98,-3.33l-1.15,-1.15l1.82,-8.17l0.74,-0.78l2.93,0.41l2.08,-0.87l1.86,-4.38l1.83,-1.01l-0.21,-4.25l5.18,-1.47l1.68,-2.94l1.39,-0.15l6.25,-6.6l6.49,-0.21l2.02,1.3l3.3,-0.49L59,91.13l2.68,-0.48l2.1,0.92l3.33,-2.14L67.96,90.72zM46.42,74.15l5.96,-0.28l3.1,1.05l-3.32,7.79l0.05,2.95l0,0l-9.46,4.83l-0.03,1.85l-2.46,0.98l-0.36,2.04l-1.76,2.33l-3.11,1.64l-3.69,3.75l-2.74,0.94l0.91,3.26l-3.6,3.19l-4.96,2.17l4.06,-8.13l0.42,-2.65l-2.14,-2.47l0.77,-0.8l-1.21,-0.79l4.64,-2.43l5.13,-4.13l6.26,-3.37l3.61,-0.21l2.17,-2.76l0.95,0.67l2.74,-2.02l-1.19,-3.83l-3.76,0.52l0,0L46.42,74.15z"},{id:"TR-18",title:"Çankırı",d:"M300.98,51.79L303.9,52.51L306.71,56.98L311.1,56.62L317.32,59.55L323.4,56.26L325.81,58.69L327.56,59.01L334.18,57.41L339.1,55.11L339.22,57.01L336.47,62.04L336.59,63.65L340.59,68.37L348.16,70.47L348.16,70.47L347.32,75.77L351.17,79.12L349.94,81.82L350.59,84.47L349.76,86.36L351.25,88.01L351.54,91.63L348.2,97.29L346.17,99.27L343.21,100.41L343.21,100.41L338.7,99.97L336.66,97.82L333,97.12L333,97.12L332.2,96.08L325.63,94.94L322.2,95.35L321.02,93.86L318.42,93.37L316.84,95.86L314.51,97.01L309.93,89.46L304.55,87.31L300.79,87.28L301.74,83.7L301.08,82.14L296.2,80.95L288.86,76.63L284.94,76.9L284.94,76.9L285.9,71.19L282.81,66.48L278.06,66.6L278.01,63.18L275.94,56.29L275.94,56.29L285.44,58.23L286.85,60.47L289.6,57.93L294.31,59.77L295.34,55.47L294.31,52.91L298.62,52.86L300.03,51.6z"},{id:"TR-19",title:"Çorum",d:"M384.07,43.11L383.93,45.57L386.69,51.46L384.6,55.17L386.48,56.51L390.29,56.95L390.29,56.95L390.26,59.16L387.15,61.6L389.7,64.86L386.73,70.42L387.11,73.81L390.97,76.75L394.94,75.61L400.68,76.02L400.5,79.71L405.08,80.8L407.49,85.03L406.91,87.09L405.3,88.22L405.29,89.93L403.37,90.73L404.02,92.64L402.68,95.46L404.72,96.97L402.34,100.98L402.34,100.98L398.8,102.05L396.66,104.65L394.23,102.76L393.05,103.17L395.22,106.66L393.16,108.42L395.18,111.96L394.29,113.42L383.65,114.21L383.34,111.88L382.49,111.34L378.89,115.16L373.67,115.46L370.92,116.67L368.27,116.09L366.54,114.31L364.83,113.91L360.98,116.65L359.84,118.54L354.87,117.92L351.28,119L350.88,117.2L350.88,117.2L351.16,116.3L348.44,111.97L348.99,109.45L347.98,106.92L348.65,104.62L344.71,103.25L343.21,100.41L343.21,100.41L346.17,99.27L348.2,97.29L351.54,91.63L351.25,88.01L349.76,86.36L350.59,84.47L349.94,81.82L351.17,79.12L347.32,75.77L348.16,70.47L348.16,70.47L354.63,68.83L357.87,61.24L360.26,60.05L358.86,56.53L356.67,55.52L353.92,55.88L353.53,50.25L358.04,46.67L358.31,44.39L360.88,44.92L361.13,46.49L363.59,44.28L363.59,44.28L365.63,43.25L368.96,45.25L370.19,48.07L372.57,49.63L375.14,49.76L377.81,47.63L380.7,47.57z"},{id:"TR-20",title:"Denizli",d:"M170.82,194.56L172.89,195.96L174.53,195.98L175.9,197.54L177.66,197.74L178.8,199.52L181.44,200.62L183.89,207.36L181.13,209.61L179.23,212.71L174.84,212.93L172.81,216.2L167.58,221.08L167.25,223.92L168.61,226.97L176.29,231.34L176.29,231.34L173.48,234.92L167.52,236.92L166.99,237.69L167.77,240.43L163.71,239.46L160.61,240.39L159.88,241.43L161.26,245.1L159.7,247.31L159.93,248.43L164.46,251.05L165.27,252.73L159.15,259.09L157.66,262.48L157.08,267.88L152.9,270.6L152.54,271.99L153.95,274.3L152.07,278.65L152.07,278.65L149.8,280.16L146.04,280.73L143.14,279.56L141.98,276.35L142.07,272.58L139.15,268.39L138.77,264.79L134.68,265.4L132.12,264.52L130.33,260.91L127.05,258.94L127.18,256.14L125.57,254L123.45,253.69L122.74,250.96L122.74,250.96L123.46,250.49L123.92,246.35L130.26,241.05L131.02,237.65L133.45,234.61L129.01,231.78L127.62,229.71L127.15,224.12L130.16,223.78L131.63,220.95L127.09,220.12L125.49,218.34L122.71,217.11L122.71,217.11L127.3,214.42L128.74,210.94L131.19,208.91L131.19,208.91L145.12,209.02L146.49,212.41L147.04,209.93L148.24,209.59L147.92,208.21L151.37,204.25L162.97,206.8L164.26,205.11L163.88,199.27z"},{id:"TR-21",title:"Diyarbakır",d:"M639.46,182.77L641.71,184.48L644.44,183.25L644,186.32L645.07,190.63L647.08,192.21L648.94,191.84L649.21,194.84L649.21,194.84L645.57,196.02L641.21,204.34L640.94,211.14L643.38,212.99L640.8,215.63L638.49,222.16L634.01,228.64L633.21,231.49L636.12,232.76L634.03,235.86L634.03,235.86L633,238.14L629.28,239.11L620.86,236.67L620.25,239.15L621.14,242.46L620.39,243.84L611.57,241.6L611.01,243.5L604.32,246.13L602.33,245.95L597.6,243.1L591.97,245.77L589.58,245.71L589.58,245.71L586.62,242.18L586.12,232.01L584.39,227.63L580.88,228.5L578.36,231.25L575.58,228.11L569.86,227.11L566.55,223.25L558.17,219.93L558.17,219.93L560.51,217.44L562.28,213.06L560.65,210.16L557.34,211.25L557.34,211.25L555.81,210.37L557.13,209.03L557.66,205.37L557.66,205.37L564.28,203.27L566.11,204.41L568.31,203.88L570.94,206.66L572.81,207.16L574.19,203.13L579.41,203.5L584.73,200.95L587.82,202.36L589.47,197.83L591.14,196.66L600.16,196.65L603.78,195.85L603.78,195.85L607.96,194.96L608.88,194L609.01,191.06L611.65,188.25L615.06,188.55L618.87,191.09L620.06,190.39L620.8,187.61L626.84,190.58L629.45,189.23L632.05,185.27z"},{id:"TR-81",title:"Düzce",d:"M233.31,54.23L234.99,60.09L237.51,60.59L239.75,59.9L239.75,59.9L238.79,67.45L232.5,70.24L231.24,74.22L228.29,78.75L223.7,79.44L217.09,78.56L217.09,78.56L218.48,75.76L214.63,73.82L214.29,72.72L214.76,70.74L216.7,68.96L215.26,66.81L212.75,66.98L212.23,65.99L213.68,63.88L216.31,63.41L219.22,61.08L221.27,58.23L219.69,56.84L219.69,56.84z"},{id:"TR-22",title:"Edirne",d:"M53.8,5.66L53.52,15.1L54.99,18.26L53.44,21.65L53.83,24.46L51.38,27.75L52.37,28.67L54.06,26.81L55.21,27.9L53.03,30.73L53.41,32.2L51.14,36.11L52.28,40.45L51.05,42.86L52.39,44.01L52.39,44.01L53.17,48.89L50.78,53.06L46.69,57.12L42.36,57.78L41.5,58.83L43.56,60.73L42.46,68.99L46.42,74.15L46.42,74.15L43.42,80.24L43.42,80.24L38.99,80.63L35.85,83.04L32.61,81.73L30.84,82.64L29.3,82.14L26.29,83.09L19.77,83.14L16.57,81.23L15.21,75.57L19,74.77L19.77,72L22.78,69.45L22.36,68.16L23.08,68.07L23.08,66.81L24.12,67.26L24.63,65.46L25.89,66.56L25.69,64.56L28.62,63.82L27.25,61.62L28.96,59.7L27.3,58.55L26.69,56.82L27.61,54.86L26.36,54.67L27.75,52.96L26.49,51.25L27.18,50.68L27.18,46.96L30.37,47.05L35.26,42.31L38,43.14L39.9,41.71L38.37,27.41L35.74,26.67L34.04,24.93L34.38,24.11L29.46,22.49L27.42,20.39L28.95,15.93L36.13,15.59L37.82,12.89L37.04,9.92L39.65,6.97L44.97,8.16L46.47,6.41L48.7,7.54L49.83,6.37z"},{id:"TR-23",title:"Elazığ",d:"M588.86,162.88L592.79,162.92L596.83,160.15L601.48,159.39L604.78,157.68L606.04,158.43L605.99,160.42L603.16,163.82L603.23,166.69L601.29,170.08L602.16,170.87L601.89,172.98L603.08,176.34L606.84,179.04L607.41,180.93L606.37,181.72L602.29,181.93L601.11,184.09L598.75,185.88L603.78,195.85L603.78,195.85L600.16,196.65L591.14,196.66L589.47,197.83L587.82,202.36L584.73,200.95L579.41,203.5L574.19,203.13L572.81,207.16L570.94,206.66L568.31,203.88L566.11,204.41L564.28,203.27L557.66,205.37L557.66,205.37L555.86,202.79L549.77,204.1L546.73,202.06L543.79,197.8L538.17,198.86L528.58,195.83L525.55,192.99L525.11,188.28L527.4,185.11L529.39,184.07L529.55,181.54L531.11,181.73L532.2,180.8L535.89,181.9L536.75,181.2L534.36,173.32L535.39,172.28L535.17,170.24L538.46,166.66L538.46,166.66L539.98,167.54L541.22,166.77L541.22,166.77L542.6,168.13L542.91,169.88L540.98,173.19L541.54,174.56L545.56,175.9L549.88,173.64L562.21,175.71L564.13,177.77L566.92,178.74L567.66,180.46L569.34,179.66L571.54,180.82L572.48,180.51L573.36,178.04L579.35,177.96L582.86,177L584.59,177.7L585.29,174.7L587.24,172.68L588.57,167.7L586.93,165.23z"},{id:"TR-24",title:"Erzincan",d:"M541.32,110.96L550.75,111.89L550.75,111.89L553.86,114.38L560.81,116.19L560.7,118.52L563.63,118.78L570.2,121.94L578.75,121.12L585.04,117.37L585.04,117.37L588.26,114.21L591.33,112.6L606.67,113.15L606.67,113.15L603.5,115.87L603.12,119.17L609.3,118.93L610.28,120.1L615.83,122.25L616.59,124.96L615.07,127.44L615.2,128.89L621.36,132.02L621.82,133.16L620.73,136.49L623.32,139.34L622.62,140.55L619.88,141.4L619.88,141.4L616.98,140.4L609.82,140.96L609.82,140.96L606.77,137.91L600.84,136.78L595.87,138.62L594.12,137.45L586.36,135.51L584.56,136.24L582.93,141.62L581.26,142.76L572.46,141.5L566.45,143.31L558.94,142.16L550.58,146.13L545.85,149.93L545.52,151.59L546.54,154.58L544.34,156.13L541.2,156.79L540.41,157.87L541.62,158.94L540.31,161.41L541.22,166.77L541.22,166.77L539.98,167.54L538.46,166.66L538.46,166.66L534.58,162.67L531.35,162.78L528.74,161.14L525.7,162.86L523.2,160.87L523.2,160.87L526.23,154.93L523.15,149.67L525.94,148.97L526.51,147.18L523.61,145.45L522.29,141.96L524.17,138.09L523.32,132.98L525.05,127.64L529.6,124.28L525.46,120.83L525.33,118.57L527.86,116.38L532.58,116.86L535.79,114.04L540.06,113.57z"},{id:"TR-25",title:"Erzurum",d:"M640.26,70.37L647.7,73.66L650.05,76.17L650.08,76.99L648.48,77.92L648.54,81.61L649.17,83.82L650.74,84.12L656.05,80.23L663.55,77.02L664.38,77.37L664.79,80.44L666.47,80.37L668.11,78.89L668.54,75.84L671.17,73.27L670.66,67.75L675.98,62.71L685.17,63.02L688.54,66.18L688.54,66.18L691.4,71.83L698.46,73.47L700.98,78.73L702.72,79.12L702.72,79.12L702.87,80.51L698.63,83.91L696.36,87.27L695.23,91.24L696.3,93.38L695.4,94.9L693.67,95.78L689.8,95.39L682.49,97.1L680.32,99.58L680.63,101.05L685.69,104.99L686.22,106.34L689.06,106.62L691.92,108.86L693.07,112.34L697.86,114.51L698.55,116.78L696.57,119.95L696.57,119.95L687.86,122.87L686.67,124.1L688.58,128.44L693.92,131.22L696.86,134.29L696.19,135.78L692.8,138.45L691.28,141.28L691.28,141.28L684.6,146.34L683.62,151.03L678.69,152.22L678.59,154.44L674.49,157.26L666.94,159.28L659.87,159.47L658.91,154.59L651.99,149.76L644.02,149.52L641.53,148.57L641.53,148.57L636.51,143.82L623.19,145.39L620.51,144.88L618.99,143.53L619.88,141.4L619.88,141.4L622.62,140.55L623.32,139.34L620.73,136.49L621.82,133.16L621.36,132.02L615.2,128.89L615.07,127.44L616.59,124.96L615.83,122.25L610.28,120.1L609.3,118.93L603.12,119.17L603.5,115.87L606.67,113.15L606.67,113.15L612.11,113.41L619.85,108.79L621.71,106.16L621.57,103.74L615.13,103.69L613.6,102.14L616.31,94.09L615.5,91.26L617.08,85.55L617.08,85.55L627.88,80.52L635.55,73.29z"},{id:"TR-26",title:"Eskişehir",d:"M213.59,106.88L214.64,111.62L218.08,113.43L221.25,113.53L221.66,112.54L224.67,112.16L225.38,111.11L228.67,112.45L231.72,111.58L234.7,112.47L236.83,111.58L238.32,112.51L236.68,113.04L237.25,114.07L239.79,112.62L241.52,113.89L242.93,112.93L246.42,113.7L248.38,112.11L247.99,114.38L250.01,113.93L249.35,115.82L251.08,116.61L251.2,118.54L252.5,120.41L253.91,121.63L256.13,121.29L256.69,121.89L255.82,123.08L257.83,122.76L256.6,123.84L254.96,128.44L257.61,132.14L259,137.72L260.88,139.67L260.5,141.06L262.18,141.66L261.51,145.73L262.56,147.24L261.8,148.74L264.57,149.89L264.7,150.97L258.5,157.76L258.16,160.27L258.16,160.27L257.39,161.14L254.85,161.3L253.08,163.97L245.44,164.99L245.44,164.99L243.67,162.28L240.17,161.3L239.56,158.44L235.07,154.26L231.5,155.27L227.64,152.6L226.24,153.52L225.05,156.63L223.09,156.97L222.53,158.57L219.32,157.21L216.86,157.4L217.09,158.56L220.1,160.57L219.13,162.58L211.01,161.7L209.29,165.73L206.07,162.46L203.21,161.1L201.16,156.17L197.93,155.58L197.93,155.58L195.47,155.21L195.23,152.28L193.14,150.58L194.06,148.55L193.32,144.91L194.45,143.04L193.56,138.69L188.98,136.25L186.13,133.58L187.4,132.03L186.75,131.23L182.28,132.26L179.88,131.68L179.88,131.68L181.04,127.83L184.4,123.66L190.88,122.48L192.69,118.64L195.13,116.88L195.99,115.12L198.14,114.03L203.61,108.48L206.93,107.27L206.93,107.27L211.59,106.07z"},{id:"TR-27",title:"Gaziantep",d:"M492.58,245.69L494.37,246.53L498.7,245.18L500.39,247.03L507.98,247.29L513.61,249.68L513.61,249.68L512.75,250.73L511.64,250.01L508.99,250.36L504.88,255.14L505.41,256.09L504.33,256.58L503.46,259.32L505.19,261.56L503.54,261.29L503.25,262.31L505.07,265.75L504.43,269.41L506.62,270.83L509.19,270.23L508.71,273.72L510.33,274.93L510.24,276.86L511.98,279.16L511.21,281.61L511.21,281.61L507.68,282.29L501.14,285.87L495.97,285.88L491.9,288.34L491.9,288.34L490.38,285.16L488.43,284.3L484.54,284.73L483.05,284.08L482.18,280.26L481.08,279.13L473.67,277.27L472.42,273.1L470.51,272.66L468.96,273.09L466.36,276.33L462.3,278.22L460.06,283.35L460.06,283.35L454.77,281.61L454.77,281.61L452.48,278.18L447.97,276.8L446.37,273.65L446.37,273.65L455.6,262.69L455.6,262.69L458.12,262.32L458.76,260.65L461.15,259.78L464.79,255.98L467.51,257.25L470.6,260.72L473.51,261.01L478.21,254.94L488.12,253.86L487.88,251.58L490.31,251.36z"},{id:"TR-28",title:"Giresun",d:"M558.77,56.74L558.71,74.1L558.71,74.1L553.62,76.2L550.26,75.86L545.97,78.35L541.05,86.42L550.42,90.59L552.08,92.63L551.43,99.21L549.59,101.84L548.23,101.37L547.13,102.18L547.64,106.14L550.67,110L550.75,111.89L550.75,111.89L541.32,110.96L541.32,110.96L535.52,110.62L532.77,109.33L531.45,105.55L528.88,107.35L527.94,106.35L526.27,107.22L523.03,105.05L518.79,104.23L516.53,100.27L516.32,93.75L517.2,89.82L512.66,87.89L512.66,87.89L512.93,84.23L511.48,81.84L512.42,80.05L510.03,78.67L508.45,74.7L510.62,72.94L510.02,70.56L513.06,66.13L514.07,62.84L514.07,62.84L517.94,64.16L521.71,63.83L524.79,65.78L526.2,64.96L527.76,65.69L532.04,65.32L535.92,62.29L538.44,63.71L539.64,63.5L543.68,60.31L546.1,60.18L548.65,58.42L552.22,59.04z"},{id:"TR-29",title:"Gümüşhane",d:"M558.71,74.1L561.29,75.55L567.27,76.88L569.6,79.47L571.18,79.79L571.71,81.74L574.4,81.55L576.94,83.85L581.26,83.67L583.41,81.31L583.85,77.35L586.1,77.15L586.69,78.77L585.87,82.01L590.4,83.81L591.34,85.7L594.57,84.27L594.01,83.16L591.18,81.88L591.17,80.45L594.19,80.01L596.38,81.59L595.91,83.53L598.09,85.16L600.53,84.57L604.06,87.62L604.06,87.62L589.68,90.07L588.45,93.6L588.67,100.67L585.72,107.78L581.27,113.48L585.04,117.37L585.04,117.37L578.75,121.12L570.2,121.94L563.63,118.78L560.7,118.52L560.81,116.19L553.86,114.38L550.75,111.89L550.75,111.89L550.67,110L547.64,106.14L547.13,102.18L548.23,101.37L549.59,101.84L551.43,99.21L552.08,92.63L550.42,90.59L541.05,86.42L545.97,78.35L550.26,75.86L553.62,76.2z"},{id:"TR-30",title:"Hakkâri",d:"M736.31,232.72L741.01,233.76L748.63,231.57L754.4,232.12L759.56,230.83L762.33,232.22L763.59,234.76L769.15,235.28L771.13,233.78L774.89,234.06L776.8,233.05L776.8,233.05L781.07,232.58L783.83,235.23L784.18,236.64L781.73,239.69L783.64,241.82L782.25,249.81L784.52,250.77L785.41,252.97L788.06,253.49L788.74,255.36L791.38,257.06L791.89,258.9L789.6,261.13L790.67,265.5L789.58,264.19L786.09,264.18L784.54,263.02L777.65,269.1L772.57,270.7L773.32,271.73L771.83,272.95L771.4,274.64L768.59,273.06L767.59,270.02L765.82,267.97L767.49,264.71L769.56,264.36L769.29,260.23L767.66,258.34L763.42,256.24L759.28,256.57L759.02,255.92L757.97,257.51L756.44,257.82L754.78,261.33L752.02,261.45L751.25,262.94L750.2,261.14L745.5,260.78L743.46,261.61L740.33,259.54L737.94,260.35L731.25,255.96L731.25,255.96L731,248.34L729.08,244.58L735.01,237.93z"},{id:"TR-31",title:"Hatay",d:"M429.62,271.1L433.5,270.32L440.19,273.41L443.28,272.94L446.37,273.65L446.37,273.65L447.97,276.8L452.48,278.18L454.77,281.61L454.77,281.61L455.14,283.2L452.66,286.07L453.28,288.01L451.13,290.6L451.77,294.27L449.83,299.44L450.73,302.65L451.62,304.14L452.37,304.04L452.41,307.53L452.7,306.85L454.58,306.92L454.52,308.93L456.12,309.12L455.49,310.21L456.14,311.57L454.83,312.45L453.19,311.96L452.99,313.14L448.18,311.82L446.69,314.04L443.14,313.07L443.82,314.33L442.52,315.65L443.52,319.96L442.91,323.69L441.31,324.71L439.44,323.59L439.35,326.57L437.77,326.08L435.49,326.86L433.69,333.9L432.1,331.17L427.37,330.18L427.59,327.3L423.88,327.84L426.51,323.46L423.09,316.16L418.29,308.89L418.25,307.71L421.3,305.22L423.51,301.47L426.37,300.04L428.95,296.83L435.25,293.71L436.13,291.28L435.21,286.02L435.75,283.84L432.12,278.81L427.64,276.32L427.64,276.32L427.39,273.74z"},{id:"TR-33",title:"Mersin",d:"M378.11,248.9l0.7,3.67l6.09,7.11l0.08,1.23l-2.02,1.89l-0.02,1.54l2.19,1.27l0.92,2.32l1.69,0.01l3.01,1.78l1.35,6l0.68,6.76l-0.81,1.54l-2.84,-0.73l-1.29,1.71l-0.69,-0.67l-0.02,1.1l-2.74,-0.23l-0.16,0.96l-2.14,1.06l0,0l-1.6,-2.51l-4.33,-1.97l-4.51,0.05l-3.77,2.1l-5.46,5.34l-6.61,4.43l-4.18,5.66l-3.63,2.86l-0.24,4.66l-1.18,1.3l-1.48,-0.01l-1.95,3.22l-1.12,-2.77l-2.84,-1.52l-1.12,2.05l-1.06,0.1l-0.76,2.2l-4.13,2.97l-0.57,2.03l-1.49,-3.08l-2.29,0.95l-1.27,2.51l-3.9,-1.63l-2.78,1.54l-1.96,-1.33l-2.3,1.17l-6.1,-0.38l-2.83,3.48l-1.23,-1.25l-4.23,-0.49l-3.1,1.54l-2.91,2.87l-5.66,-1.4l-4.3,-2.87l0,0l1.84,-3.45l-0.76,-2.27l2.32,-6.31l-3.47,-10.46l0,0l4.68,0.11l8.81,3.31l5.4,0.89l5.63,-1.92l3.95,-3.63l-2.68,-3.21l-3.1,-1.9l-2.14,-3.46l0.55,-4.46l-1.53,-3.28l2.91,-1.21l1.91,1.67l3.16,-3.04l6.49,-1.42l3.28,0.23l2.76,-1.25l3.38,1.87l7.03,-4.1l0,0l7.89,-1.09l7.9,-2.78l1.48,-1.34l-0.22,-3l6.72,-2.06l7.58,-4.07l-1.54,-2.77l1.06,-2.14l0,0l3.35,-0.08L378.11,248.9z"},{id:"TR-76",title:"Iğdır",d:"M743.81,108.2L746.35,110.61L748.58,110.46L754.3,113.71L765.99,113.31L769.53,112.36L775.46,114.96L780.93,120.1L780.92,121.09L782.67,122.61L782.74,124.43L786.9,126.15L786.57,127.23L788.96,128.79L789.1,130.21L791.36,131.96L791.21,133.3L792,133.65L791.53,134.98L787.66,130.47L785.68,130.24L783.56,126.67L777.67,132.1L777.67,132.1L773.84,132.57L768.46,130.24L764.7,130.7L760.44,129.36L754.1,129.36L750.5,126.65L743.35,125.98L739.98,123.35L738.27,123.8L736.63,126.38L734.22,126.6L733.68,119.58L730.8,116.17L727.69,115.34L727.69,115.34L731.95,108.42L736.49,109.26L743.79,108.14L743.79,108.14z"},{id:"TR-32",title:"Isparta",d:"M184.09,231.67L186.24,227.34L186.04,223.81L189.17,219.83L193.19,217.98L200.02,210.43L205.47,209.07L211.4,205.32L214.49,199.98L218.19,198.31L221.3,195.28L226.87,194.4L229.41,196.4L231.28,199.36L232.57,199.15L232.57,199.15L233.47,202.22L236.06,205.52L241.24,209.86L244.22,210.93L245.23,213.75L244.93,217.84L241.92,220.06L241.41,222.74L238.19,225.18L237.81,228.32L239.69,232.85L239.66,234.78L239.4,235.56L236.07,236.75L235.02,238.42L236.14,244.18L234.84,249.39L234.84,249.39L226.65,250.48L222.54,253.59L218.96,250.6L216.32,250.55L216.32,250.55L214.78,250.17L214.28,246.85L211.03,243.5L210.28,238.33L204.81,235.37L201.19,235.89L197.59,235.22L196.91,233.87L197.77,231.13L196.49,229.46L189.03,232.19z"},{id:"TR-34",title:"Istanbul",d:"M149.16,48.24l13.17,3.21l0.97,-0.56l9.4,2.24l3.93,-0.05l0,0l0.09,2.6l-2.37,3.93l-1.63,0.55l-4.18,-0.92l-2.36,3.82l-3.88,-1l-3.13,0.58l-7.01,8.76l0,0l-1.03,-0.72l-2.56,0.6l1.22,-2.52l-5.9,-2.58l-1.44,-2.14L138.81,62l-0.64,-2.35l1.87,-1.48l0.64,-2.98l1.15,-0.78L140.88,53l0.69,-1.95l3.24,-2.5L149.16,48.24zM103.83,29.47l3.97,4.12l14.47,7.7l2.63,0.46l11.03,5.02l5.3,0.2l1.37,0.79l-0.02,1.47l-3.03,3.02l1.39,1.77l-3.64,6.48l-5.6,1.74l-0.73,0.96l-2.9,-1.3l-5.83,1.08l-1.03,-0.66l-0.32,-2.42l-0.93,-0.04l-1,1.8l-5.09,-3.12l-7.7,-1.98l-6.57,1.16l-3.11,1.77l0,0l-0.9,-1.97l0.17,-2.87l1.74,-3.51l-0.02,-2.43l2.39,-4.07L103.01,29l0,0L103.83,29.47z"},{id:"TR-35",title:"İzmir",d:"M42.91,192.53l1.13,0.69l0.46,3.64l-1.94,-1.1L42.91,192.53zM71.64,148.32l0.77,4.68l2.23,2.26l-0.6,4.13l3.03,8.11l-0.59,3.21l-1.56,1.55l-4.57,1.92l-2.06,-0.59l-5.27,2.76l0.34,1.32l-2.18,3.18l3.98,5.4l0.24,5.04l1.94,1.36l4.41,-0.34l1.85,0.98l1.11,2.37l2.9,-0.35l1.48,2.35l1.64,-0.26l1.55,1.51l2.78,0.34l2.03,4.02l2.69,0.08l0.8,1.34l1.13,-1.56l-0.45,-3.05l1.9,-0.41l1.43,1.19l4.04,-0.95l4.04,1.84l1.09,1.56l3.71,0.65l2.94,2.64l5.28,1.78l-0.42,3.66l2.47,2.96l0,0l-1.2,2.21l-3.43,-1.75l-3.05,0.98l-0.69,1.72l-1.94,1.47l-10.18,0.95l-11.81,3.62l-5.31,-2.74l-2.73,0.09l-3.48,2.26l-0.7,4.28l-2.82,2.22l-0.79,-2.37l-3.31,-1.46l0,0l0.27,-2.32l-1.33,-2.13l-4.55,-0.41l-6.23,-4.58l-3.15,0.51l-1.71,1.71l-1.71,-6.53l-2.41,-0.93l0.97,-1.29l-1.33,-1.17L40,210.47l-0.36,3.21l-0.74,-0.07l0.36,1.51l-0.9,0.38l-0.96,-2.05l-0.43,1.34l-1.18,-0.62l-0.61,-2.83l-5.19,-2.15l0.08,-1.89l-1.09,1.72l-1.22,0.08l-1.98,-1.97l-2.44,-0.34l0.14,-1.26l1.63,0.2l0.35,-1.67l0.92,0.15l-0.83,-2.56l3.64,3.16l0.51,-2.33l0.74,1.5l3.33,-2.79l-1.31,-2.71l1.63,1.44l1.09,-1.46l-3.38,-2.59l-1.78,1.57l0.81,-2.39l-2.12,-4.05l-0.29,-3.67l0.31,-0.98l2.33,-1.08l4.37,1.55l1.99,4.75l2.29,1.48l0.62,3.34l-2.21,-0.1l0.71,0.97l-0.87,1.37l1.37,0.46l2.42,5.6l1.19,-0.43l-1.16,-3.91l1.19,-1.94h1.26l1.23,3.29l1.49,0.61l9.19,-3.05l2.63,0.87l2.33,-2.31l1.12,0.02l-0.46,-1.34l-1.94,0.95l-1.39,-0.95l-5.21,1.57l-2.8,-3.52l-0.03,-1.62l-2.22,-1.17l0.7,-0.97l-3.74,-2.11l0.38,-1.29l-1.32,-0.34l0.83,-1.25l-1.01,-1.54l0.39,-2.25l3.69,-1.06l0.31,1.01l0.82,-0.55l1.58,0.99l0.5,-1.7l1.33,0.07l-1.9,-3.15l0.86,0.39l1.23,-0.98l0.25,1.65l1.03,-0.12l-0.17,-2.13l3.86,-1.18l-1.06,-1.34l0.84,-0.98l-0.56,-1.36l-1.36,1.5l-2.38,-1.47l-3.59,1.1l-2.74,-1.81l-0.06,-4.26l3.63,-2.31l-2.06,-3.42l-2.92,-1.31l0,0l2.64,-3.66l6.95,-2.23l3.16,-3.6l3.6,-1.1l3.18,0.94L71.64,148.32z"},{id:"TR-46",title:"Kahramanmaraş",d:"M460.16,192.18L469.64,190.13L476.5,191.42L480.91,191.05L481.98,191.92L481.98,191.92L479.98,195.05L480.02,196.97L485.78,200.16L489.14,199.81L493.45,203.2L497.15,203.9L496.54,208.48L499.89,208.96L499.97,211.28L497.93,214.49L493.22,218.63L493.85,221.86L495.32,222.79L495.32,222.79L493.86,225.42L490.58,227.29L490.73,231.87L488.17,234.54L487.9,237.67L486.56,239.64L487.24,241.6L491.16,242.02L492.58,245.69L492.58,245.69L490.31,251.36L487.88,251.58L488.12,253.86L478.21,254.94L473.51,261.01L470.6,260.72L467.51,257.25L464.79,255.98L461.15,259.78L458.76,260.65L458.12,262.32L455.6,262.69L455.6,262.69L456.03,260.09L454.37,256.82L455.57,254.19L455.21,253.22L448.37,253.13L442.89,254.86L442.05,254.09L438.44,254.18L436.77,239.23L437.92,236.88L437.92,236.88L440.81,233.98L441.98,230.38L439.49,224.97L442.29,221L439.05,219.33L441.98,215.83L445.07,206.98L445.07,206.98L456.67,202.08L458.26,195.2z"},{id:"TR-78",title:"Karabük",d:"M297.73,29L297.7,30.25L298.97,31.16L301.65,29.83L302.82,30.82L304.13,30.16L305.66,30.65L305.46,33.6L307.34,34.7L307.8,36.83L307.62,39.76L306.44,41.88L303.68,42.31L301.29,44.75L300.25,47.68L300.98,51.79L300.98,51.79L300.03,51.6L298.62,52.86L294.31,52.91L295.34,55.47L294.31,59.77L289.6,57.93L286.85,60.47L285.44,58.23L275.94,56.29L275.94,56.29L270.92,55.58L270.92,55.58L269.21,50.8L270.91,45L272.94,43.21L272.94,43.21L278.24,44.63L282.1,41.83L284.53,42.84L286.87,41.52L288.98,43.04L290.3,39.94L288.54,35.04L288.91,33.75L294.6,31.33L295.69,29.39z"},{id:"TR-70",title:"Karaman",d:"M279.5,283.06L288.63,281.43L292.85,279.53L295.5,276.85L296.78,272.09L295.96,270.63L291.92,268.35L290.92,262.84L292.29,261.02L295.26,261.13L297.37,254.84L301.43,251.29L303.8,247.85L308.12,245.57L312,245.19L316.58,248.55L325.75,245.4L326.44,255.73L333.28,265.19L335.66,271.71L335.66,271.71L328.62,275.81L325.24,273.94L322.48,275.19L319.2,274.96L312.7,276.38L309.54,279.43L307.63,277.75L304.71,278.96L306.24,282.24L305.69,286.7L307.83,290.16L310.93,292.06L313.62,295.26L309.66,298.89L304.03,300.81L298.63,299.93L289.82,296.61L285.14,296.5L285.14,296.5L279.13,290.3L278.63,288.46z"},{id:"TR-36",title:"Kars",d:"M740.2,61.19L744.76,64.37L744.91,69.07L747.7,75.23L747.62,78.72L746.53,79.45L744.48,84.38L743.44,84.68L743.71,86.29L742.78,86L743.06,87L739.88,88.35L739.45,89.32L742.44,92.25L741.26,96.4L743.36,100.36L745.02,101.1L745.09,102.79L743.84,102.88L746.41,106.25L744.17,106.72L743.79,108.14L743.79,108.14L736.49,109.26L731.95,108.42L727.69,115.34L727.69,115.34L720.27,114.16L696.57,119.95L696.57,119.95L698.55,116.78L697.86,114.51L693.07,112.34L691.92,108.86L689.06,106.62L686.22,106.34L685.69,104.99L680.63,101.05L680.32,99.58L682.49,97.1L689.8,95.39L693.67,95.78L695.4,94.9L696.3,93.38L695.23,91.24L696.36,87.27L698.63,83.91L702.87,80.51L702.72,79.12L702.72,79.12L704.05,77.75L707.75,77.56L708.28,74.13L712.6,69.4L713.02,67.48L716.69,65.56L718.98,63.05L721.04,64.08L724.09,62.81L730.56,63.2L732.43,62.12L736.75,61.72L738.41,60.01L738.41,60.01z"},{id:"TR-37",title:"Kastamonu",d:"M319.17,4.97L335.77,7.29L346.93,6.92L354.58,8.59L354.58,8.59L354.59,10.24L356.4,11.86L357,14.56L355.82,17.47L360.73,17.7L362.31,21.14L367.17,22.17L369.6,24.07L368.16,29.65L364.58,32.7L365.51,35.62L362.57,41.58L363.59,44.28L363.59,44.28L361.13,46.49L360.88,44.92L358.31,44.39L358.04,46.67L353.53,50.25L353.92,55.88L356.67,55.52L358.86,56.53L360.26,60.05L357.87,61.24L354.63,68.83L348.16,70.47L348.16,70.47L340.59,68.37L336.59,63.65L336.47,62.04L339.22,57.01L339.1,55.11L334.18,57.41L327.56,59.01L325.81,58.69L323.4,56.26L317.32,59.55L311.1,56.62L306.71,56.98L303.9,52.51L300.98,51.79L300.98,51.79L300.25,47.68L301.29,44.75L303.68,42.31L306.44,41.88L307.62,39.76L307.8,36.83L307.34,34.7L305.46,33.6L305.66,30.65L304.13,30.16L302.82,30.82L301.65,29.83L298.97,31.16L297.7,30.25L297.73,29L297.73,29L300.94,20.8L299.45,20.03L297.13,21.19L294.56,21.24L293.57,19.77L294.42,17.48L292.88,16.38L292.27,14.25L292.27,14.25L298.63,13.2L315.66,5.34z"},{id:"TR-38",title:"Kayseri",d:"M419.76,153.07L426.92,156.17L427.95,158.78L429.87,159.9L431.66,162.59L435.82,162.71L442.4,161.03L451.5,161.68L457.36,160.76L461.5,162.5L464.15,164.74L466.12,170.08L463.01,173.02L461.02,176.74L460.4,181.73L456.75,184.97L460.16,192.18L460.16,192.18L458.26,195.2L456.67,202.08L445.07,206.98L445.07,206.98L438.6,200.49L433.48,202L429.83,206.98L427.31,213.51L420.73,215.98L416.38,220.68L413.1,222.09L411.81,231.44L410.58,233.51L403.45,233.08L402.18,231.39L400.86,231.73L395.42,229.83L395.42,229.83L397.26,224.03L396.96,214.19L394.56,212.46L388.9,211.92L387.68,207.24L384.37,204.79L382.32,201.71L382.32,201.71L383.29,198.93L388.26,196.7L392.93,190L389.08,180.88L385.74,179.03L388.71,172.08L389.32,167.73L389.32,167.73L393.47,166.06L393.75,169.57L394.57,170.15L399.86,168.09L405.63,163.92L404.22,160.24L405.31,158.57L415.59,157.19L417.65,156.13z"},{id:"TR-79",title:"Kilis",d:"M460.06,283.35L462.3,278.22L466.36,276.33L468.96,273.09L470.51,272.66L472.42,273.1L473.67,277.27L481.08,279.13L482.18,280.26L483.05,284.08L484.54,284.73L488.43,284.3L490.38,285.16L491.9,288.34L491.9,288.34L489.1,289.79L488.33,291.76L480.38,289.8L477.64,289.63L475.4,290.67L474.57,289.52L473.2,289.74L472.19,291.66L469.56,290.01L469.31,289L470.72,287.25L470.28,286.4L468.55,286.18L468.12,285.12L465.43,283.98z"},{id:"TR-71",title:"Kırıkkale",d:"M320.71,147.08L319.15,146.34L319.65,143.87L318.91,136.95L313.27,132.11L316.45,126.79L316.03,123.23L317.33,122.83L319.79,116.09L326.48,113.73L328.87,111.44L327.77,109.79L328.62,105.38L327.93,104.09L329.07,101.76L328.52,101.1L330.6,99.05L330.53,97.61L333,97.12L333,97.12L336.66,97.82L338.7,99.97L343.21,100.41L343.21,100.41L344.71,103.25L348.65,104.62L347.98,106.92L348.99,109.45L348.44,111.97L351.16,116.3L350.88,117.2L350.88,117.2L347.48,118.52L349.15,120.63L349.86,125.12L349.86,125.12L348.82,126.39L345.83,126.5L343.88,131.22L335.24,139.23L331.99,140.45L325.61,145.41z"},{id:"TR-39",title:"Kırklareli",d:"M65.51,0.31L67.29,0.43L69.07,2.54L70.31,2.65L71.46,5.52L74.69,8.09L76.36,8.08L78.5,11.11L79.06,9.29L80.72,9.11L81.02,8.09L83.07,8.3L84.16,7.07L89.81,8.73L89.13,6.6L90.46,5.69L90.65,6.31L90.81,5.52L92.95,7.36L95.64,6.4L97.64,6.94L98.86,12.3L96.42,12.11L95.82,15.36L98.39,21.01L100.86,24.08L100.16,24.76L100.66,26.19L102.52,28.39L102.52,28.39L100.87,28.25L100.5,29.58L92.09,34.57L88.55,34.96L82.2,37.29L80.04,39.15L78.38,45.54L75.51,48.5L72.34,49.65L67.51,45.88L66.41,42.87L64.66,41.57L57.68,42.54L54.63,41.94L52.39,44.01L52.39,44.01L51.05,42.86L52.28,40.45L51.14,36.11L53.41,32.2L53.03,30.73L55.21,27.9L54.06,26.81L52.37,28.67L51.38,27.75L53.83,24.46L53.44,21.65L54.99,18.26L53.52,15.1L53.8,5.66L53.8,5.66L54.44,3.71L56.24,2.68L56.19,1.3L58.01,0.66L63.53,2.51L63.5,1.29z"},{id:"TR-40",title:"Kırşehir",d:"M349.86,125.12L352.84,125.12L354.51,128.93L361.92,132.75L363.6,135.99L368.63,136.9L369.32,137.92L367.05,140.72L371.29,142.92L372.88,145.74L372.88,145.74L368.18,151.01L369.36,153.31L374.28,153.83L368.4,161.35L368.31,163.96L370.08,165.88L366.65,165.95L363.5,168.98L360.5,176.55L359.13,176.44L356.44,173.81L356.71,176.37L356.71,176.37L354.06,176.89L351.81,176.04L347.5,171.72L347.52,169.37L345.95,166.34L343.48,166.68L342.7,165.59L340.54,166.54L339.42,165.56L339.42,165.56L338.72,164.58L334.65,164.32L334.42,162.97L330.04,159.16L327.07,157.98L324.27,152.98L321.69,151.39L322.79,150.29L320.71,147.08L320.71,147.08L325.61,145.41L331.99,140.45L335.24,139.23L343.88,131.22L345.83,126.5L348.82,126.39z"},{id:"TR-41",title:"Kocaeli",d:"M191.5,49.87l3.16,1.28l0,0l-1.55,1.07l-2.76,4.8l0.53,1.56l-0.6,1.37l2.95,6.37l-1.4,2.56l-3.1,1.26l0.76,5.31l-3.21,1.38l-2.18,5.36l-6,2.29l0,0l-7.23,-1.88l-10.38,3.28l-4.47,-0.88l0,0l0.78,-1.69l-0.12,-5.87l0,0l2.46,-2.48l2.07,2.92l10.17,-2.33l4.4,0.82l0.96,-1.5l-1.04,-1.04l-5.47,1.1l-2.18,-1.69l-4.7,-0.6l-1.8,0.9l-3.35,-0.73l-4.24,1.47l-1.45,-0.45l-0.34,-2.44l0,0l7.01,-8.76l3.13,-0.58l3.88,1l2.36,-3.82l4.18,0.92l1.63,-0.55l2.37,-3.93l-0.09,-2.6l0,0l9.93,-0.18l1.85,-0.77l0.24,-1.46l1.55,-1.17L191.5,49.87z"},{id:"TR-42",title:"Konya",d:"M258.16,160.27L259.23,160.73L262.77,167.73L264.67,169.61L268.77,170.03L271.92,165.66L272.98,166.9L275.49,165.78L278.99,168.41L281.57,168.72L282.86,168.21L285.18,164.8L289.22,166.69L292.61,164.61L292.97,160.63L295.72,159.26L296.49,154.83L297.7,152.99L303.91,151.25L304.6,151.93L304.25,155.84L305.45,156.69L309.03,153.36L312.16,152.34L312.84,153.86L309.9,155.46L310.73,160.42L313,163.26L318.83,166.91L318.51,172.87L319.79,180.15L324.27,187.06L324.27,187.06L318.96,188.78L317.66,192.72L314.54,196.16L311.55,205.72L313.65,209.27L314.1,213.63L318.14,216.56L319.88,220.41L322.76,223.62L348.83,217.44L348.83,217.44L352.12,223L355.97,225.17L361.33,233.01L362.61,236.62L362.34,238.58L358.27,243.56L361.31,244.99L360.32,248.19L364.07,249.02L366.53,252.46L366.53,252.46L365.46,254.6L367.01,257.36L359.42,261.43L352.7,263.5L352.92,266.5L351.45,267.84L343.55,270.62L335.66,271.71L335.66,271.71L333.28,265.19L326.44,255.73L325.75,245.4L316.58,248.55L312,245.19L308.12,245.57L303.8,247.85L301.43,251.29L297.37,254.84L295.26,261.13L292.29,261.02L290.92,262.84L291.92,268.35L295.96,270.63L296.78,272.09L295.5,276.85L292.85,279.53L288.63,281.43L279.5,283.06L279.5,283.06L274.55,279.74L273.7,275.34L272.27,273.6L264.8,270.16L260.54,264.21L258.24,257.31L256.09,255.2L255.03,252.29L253.31,252.19L249.84,254.26L247.04,254.67L238.1,252.59L234.84,249.39L234.84,249.39L236.14,244.18L235.02,238.42L236.07,236.75L239.4,235.56L239.66,234.78L239.69,232.85L237.81,228.32L238.19,225.18L241.41,222.74L241.92,220.06L244.93,217.84L245.23,213.75L244.22,210.93L241.24,209.86L236.06,205.52L233.47,202.22L232.57,199.15L232.57,199.15L233.78,195.4L246.08,187.39L243.85,185.37L243.41,183.6L246.8,177.3L247.3,171.78L246.51,170.29L252.46,169.08L251.9,168.16L246.6,167.25L245.44,164.99L245.44,164.99L253.08,163.97L254.85,161.3L257.39,161.14z"},{id:"TR-43",title:"Kütahya",d:"M137.59,135.87L146.01,136.1L147.02,134.25L149.91,132.11L150.68,129.58L155.03,125.7L156.57,119.48L160.22,120.76L161.97,122.33L167.08,122.02L167.08,122.02L168.78,127.68L172.25,130.65L173.8,131.43L179.88,131.68L179.88,131.68L182.28,132.26L186.75,131.23L187.4,132.03L186.13,133.58L188.98,136.25L193.56,138.69L194.45,143.04L193.32,144.91L194.06,148.55L193.14,150.58L195.23,152.28L195.47,155.21L197.93,155.58L197.93,155.58L196.21,158.92L193.48,159.04L190.13,161.23L190.61,168.38L188.15,172.29L185.3,173.47L182.67,176.97L180.59,177.56L180.59,177.56L178.17,176.67L176.29,172.83L166.92,171.69L162.71,172.12L154.13,175.04L150.52,178.49L146.33,177L141.4,177.54L141.4,177.54L136.76,174.08L135.23,170.2L136.45,168.56L136.34,166.27L127.73,164.68L125.54,162.86L124,159.51L124,159.51L122.4,155.48L129.67,154.14L135.81,147.1L134.9,140.5L137.78,137.45z"},{id:"TR-44",title:"Malatya",d:"M523.2,160.87L525.7,162.86L528.74,161.14L531.35,162.78L534.58,162.67L538.46,166.66L538.46,166.66L535.17,170.24L535.39,172.28L534.36,173.32L536.75,181.2L535.89,181.9L532.2,180.8L531.11,181.73L529.55,181.54L529.39,184.07L527.4,185.11L525.11,188.28L525.55,192.99L528.58,195.83L538.17,198.86L543.79,197.8L546.73,202.06L549.77,204.1L555.86,202.79L557.66,205.37L557.66,205.37L557.13,209.03L555.81,210.37L557.34,211.25L557.34,211.25L552.22,214.81L551.77,216.19L543.31,219.58L536.39,214.83L534.34,214.44L533.63,213.31L527.74,210.43L523.65,210.7L522.23,211.24L520.59,213.52L513.39,216.26L513,217.35L514.35,219.18L515.06,222.49L511.05,226.22L506.37,227.12L501.98,226.18L499.94,227.31L498.9,224.82L495.74,225.54L496.18,223.72L495.32,222.79L495.32,222.79L493.85,221.86L493.22,218.63L497.93,214.49L499.97,211.28L499.89,208.96L496.54,208.48L497.15,203.9L493.45,203.2L489.14,199.81L485.78,200.16L480.02,196.97L479.98,195.05L481.98,191.92L481.98,191.92L484.36,189.84L485.77,184.9L492.12,181.57L488.13,176.41L490.54,172.14L488.29,167.94L488.65,167L500.58,168.93L501.66,167.38L500.15,164.46L501.41,163.02L507.17,164.25L516.82,164.11L520.72,161.37z"},{id:"TR-45",title:"Manisa",d:"M71.64,148.32L74.13,146.79L78.79,150.5L85.14,149.47L88.67,153.06L92.96,150.17L94.31,151.53L95.63,155.23L100.15,158.69L104.44,164.94L106.29,164.66L109.07,162.25L113.37,163.04L120.49,159.14L124,159.51L124,159.51L125.54,162.86L127.73,164.68L136.34,166.27L136.45,168.56L135.23,170.2L136.76,174.08L141.4,177.54L141.4,177.54L138.9,183.02L135.33,185.08L132.71,185.28L131.66,186.64L129.74,198.64L126.98,203.18L131.19,208.91L131.19,208.91L128.74,210.94L127.3,214.42L122.71,217.11L122.71,217.11L117.75,215L117.75,215L115.28,212.04L115.7,208.38L110.42,206.6L107.48,203.96L103.76,203.31L102.68,201.75L98.64,199.91L94.6,200.86L93.17,199.67L91.27,200.08L91.71,203.13L90.59,204.69L89.79,203.36L87.1,203.28L85.07,199.25L82.29,198.92L80.74,197.4L79.1,197.66L77.62,195.31L74.72,195.66L73.61,193.29L71.75,192.31L67.34,192.65L65.4,191.28L65.16,186.24L61.18,180.83L63.36,177.65L63.02,176.34L68.29,173.58L70.35,174.17L74.92,172.25L76.48,170.7L77.07,167.49L74.04,159.38L74.64,155.25L72.41,152.99z"},{id:"TR-47",title:"Mardin",d:"M634.03,235.86L637.34,247.21L648.76,246.22L655.09,243.12L659.39,239.37L665.41,238.81L667.57,236.94L667.57,236.94L668.06,240.06L670.78,243.17L669.04,244.8L668.57,246.73L665.74,247.77L659.65,248.15L658.81,249.7L657.51,260.33L658,261.41L659.93,260.74L661.03,264.23L660.66,266.96L660.66,266.96L654.77,268.85L645.05,268.83L642.96,269.7L640.79,268.02L630.27,266.13L627.21,267.39L624.39,266.36L614.82,271.37L609.71,272.18L607.57,274.75L602.34,277.59L602.34,277.59L601.78,275.28L599.6,273.68L598.93,269.15L596.73,265.73L596.56,263.97L594.98,264.13L593.27,262.42L592.84,259.11L590.25,252.83L590.04,250.13L591.25,248.48L589.58,245.71L589.58,245.71L591.97,245.77L597.6,243.1L602.33,245.95L604.32,246.13L611.01,243.5L611.57,241.6L620.39,243.84L621.14,242.46L620.25,239.15L620.86,236.67L629.28,239.11L633,238.14z"},{id:"TR-48",title:"Muğla",d:"M72.29,251.37l0.68,-3.81l2.59,-1.97l3.01,-0.48l4.28,1.81l2.62,-0.16l2.98,2.65l5,-0.87l7.36,0.58l5.33,-4.28l0.67,2.07l9.13,0.37l5.47,3.93l1.34,-0.24l0,0l0.72,2.73l2.12,0.31l1.61,2.14l-0.14,2.8l3.28,1.97l1.79,3.61l2.56,0.88l4.09,-0.61l0.38,3.59l2.92,4.19l-0.08,3.78l1.15,3.21l2.9,1.17l3.75,-0.58l2.28,-1.51l0,0l0.93,1.12l2.3,0.02l-1.17,2.62l2.71,0.82l0.51,-1.38l1.07,0.27l3,-7.28l4.46,-1.85l3.44,1.26l0,0l1.6,1.35l0.53,2.24l-2.39,4.18l0.02,6.16l-1.29,3.22l-3.88,2.45l-2.16,3.75l-2.29,2.03l-5.13,0.3l-3.11,1.68l0.46,2.36l-0.88,0.38l0.12,3.42l-1.99,1.36l0,0l-1.79,-1.77l-2.45,-0.65l-1.05,-0.9l0.36,-0.92l-1.95,-0.55l1.3,-1.41l-0.24,-2.38l-0.96,-0.66l0.97,-1.21l0.01,-2.19l-1.38,-0.36l-0.22,-0.91l-1.53,0.51v0.87l-1.66,-0.28l1.39,-0.86l-0.17,-2.97l1.46,0.26l0.07,-1.61l1,0.59l-0.55,0.74l1.13,-0.27l0.26,-1.11l-1.05,-1.52l-1.72,-0.29l-1.46,-1.74l-0.98,0.3l-2.76,-2.36l-1.31,2.92l-1.41,0.16l0.17,1.32l-0.75,0.44l0.68,1.31l0.45,-0.62l1.16,0.43l-2.48,2.62l-0.91,-1.94l1.1,-0.56l-1.39,-1.11l-0.99,0.43l0.46,-0.96l-0.79,-0.92l-2.54,-0.89l-2.24,0.66l-0.9,-1.59l-1.24,1l0.26,-1.3l-0.69,-0.34l1.07,-1.06l-0.84,-0.46l0.7,-0.7l-1.82,-1.94l-1.51,-0.7l-0.57,2.3l-0.71,-0.75l-0.75,0.43l-0.03,-1.53l-1.6,0.28l-0.2,-3.28l-3.13,1.61l0.33,0.77l1.61,-0.11l-1,2.39l-3.66,-1.48v1.05l-1.6,-0.01l-0.37,-1.06l1.94,-0.43l-1.85,-1.32l-1.31,2.35l2.85,3.84l-2.13,-0.06l-1.29,2.07l-2.49,0.32l-2.47,4.73l-1.27,-0.17l-2,1.66l-0.45,-0.76l-1.17,1.37l-0.83,-2.71l3.99,0.15l1.37,-2.03l-0.57,-0.86l-1.17,0.28l0.73,-1.22l-1.21,-0.83l-0.68,1.09l-2.44,-0.49l3.65,-2.18l1.76,-0.35l0.16,1.07l1.15,-0.95l-1.78,-1.34l1.88,-2.38l-2,0.08l-0.79,1.6l-4.55,0.53l-0.86,0.87l-8.33,-1.02l-1.7,1.89l-0.55,3.22L79,289.2l-3.99,1.57l-4.76,-1.64l-0.04,-1.25l2.42,-0.2l0.41,-1.88l7.35,-0.74l1.36,-2.4l2.54,1.29l4.83,-1.39l9.37,0.65l0.48,-2.03l-2.19,0.03l0.78,-0.38l-0.96,-0.55l2.34,-1.06l-0.19,-1.19l-1.46,-0.46l1.17,-0.25l-0.88,-0.84l3.06,-0.79l2.63,0.83l0.12,1.01l-0.17,-2.11l1.81,-0.22l0.41,-2.25l1.41,0.5l-0.14,-0.77l3.49,-1.35l-0.24,-1.12l-9.22,0.89l0.59,0.93l-0.68,0.23l-0.38,-0.87l-4.66,-0.18l-1.28,0.8l-2.27,-0.64l-5.46,2l-3.03,-0.7l-1.95,1.25L79,273.31l-0.38,0.98l-1.92,-0.94l-1.54,0.33l-2.42,-2.65l-0.44,0.95l-0.69,-0.62l-0.84,1.61l0.22,-1.5l-2.13,0.68l-1.13,3.04l-1.65,-0.4l-1.55,-4.91l2.8,-2.77l-1.59,-0.02l-0.07,-0.89l0.84,-0.57l1.6,1.24l0.47,-2.23l0.88,1.47l0.83,-1.3l1.04,0.56l-0.06,1.31l1.75,-0.43l1.67,2.45l2.73,-2.43l1.79,-0.41L77.65,265l-0.44,-2.03l1.56,-1l0.75,0.62l-0.53,1.09l0.61,-0.23l-0.63,-1.67l1.57,-3.32l-2.34,0.11l-1.42,2.58l-0.96,-0.53l1.08,-1.04l-0.62,-1.13l-2.18,1.48l1.67,-3.68L74.79,255l-1.25,2.24l-2.26,-1.06l-0.25,-1.72l2.03,-1.3L72.29,251.37z"},{id:"TR-49",title:"Muş",d:"M691.28,141.28L694.78,144.89L696.33,148.95L699.77,148.89L700.32,152.3L704.47,161.45L703.66,165.45L703.87,171.89L703.87,171.89L693.77,171.02L683.78,174.06L682.32,175.71L681.5,178.63L679.29,179.68L679.61,183.12L673.79,188.4L672.64,191.17L665.56,189.51L657.71,189.09L654.68,190.56L654.42,191.45L654.42,191.45L652.34,194.28L649.21,194.84L649.21,194.84L648.94,191.84L647.08,192.21L645.07,190.63L644,186.32L644.44,183.25L641.71,184.48L639.46,182.77L639.46,182.77L638.88,176.6L639.65,171.02L642.31,167.85L646.88,165.92L647.56,164.37L646.99,162.41L643.49,160.41L639.67,153.77L639.8,150.83L641.53,148.57L641.53,148.57L644.02,149.52L651.99,149.76L658.91,154.59L659.87,159.47L666.94,159.28L674.49,157.26L678.59,154.44L678.69,152.22L683.62,151.03L684.6,146.34z"},{id:"TR-50",title:"Nevşehir",d:"M372.88,145.74L373.46,147.39L376.65,148.82L382.01,149.65L385.78,152.7L386.49,155.07L385.78,157.16L387.45,160.82L387.38,164.21L389.32,167.73L389.32,167.73L388.71,172.08L385.74,179.03L389.08,180.88L392.93,190L388.26,196.7L383.29,198.93L382.32,201.71L382.32,201.71L376.96,201.44L373.5,203.99L371.7,204.06L367.72,202.25L365.93,198.82L365.93,198.82L364.33,197.28L363.89,193.54L360.96,189.05L356.43,186.63L356.05,184.03L357.57,181.22L357.78,177.33L356.71,176.37L356.71,176.37L356.44,173.81L359.13,176.44L360.5,176.55L363.5,168.98L366.65,165.95L370.08,165.88L368.31,163.96L368.4,161.35L374.28,153.83L369.36,153.31L368.18,151.01z"},{id:"TR-51",title:"Niğde",d:"M365.93,198.82L367.72,202.25L371.7,204.06L373.5,203.99L376.96,201.44L382.32,201.71L382.32,201.71L384.37,204.79L387.68,207.24L388.9,211.92L394.56,212.46L396.96,214.19L397.26,224.03L395.42,229.83L395.42,229.83L390.89,232.54L387.6,237.54L382.55,236.93L380.99,243.99L379.98,245.35L380.74,246.81L378.11,248.9L378.11,248.9L369.88,252.37L366.53,252.46L366.53,252.46L364.07,249.02L360.32,248.19L361.31,244.99L358.27,243.56L362.34,238.58L362.61,236.62L361.33,233.01L355.97,225.17L352.12,223L348.83,217.44L348.83,217.44L352.19,214.12L356.57,213.02L358.67,211.42L362.04,206.44L362.83,200.63z"},{id:"TR-52",title:"Ordu",d:"M476.94,52.92L480.82,52.9L481,54.08L485.16,55.22L491.04,59.63L493.89,58.22L496.93,53.42L497.78,54.55L501.27,54.46L500.88,57.47L502.09,59.34L504.62,60.11L505.02,61.51L514.07,62.84L514.07,62.84L513.06,66.13L510.02,70.56L510.62,72.94L508.45,74.7L510.03,78.67L512.42,80.05L511.48,81.84L512.93,84.23L512.66,87.89L512.66,87.89L510.71,89.46L507.7,89.79L507.09,91.95L503.39,95.43L501.35,94.07L499.7,95.44L495.43,94.63L495.43,94.63L496.33,92.57L493.7,91.03L495.6,88.12L495.24,87.22L490.42,85.85L484.18,85.94L477.42,79.75L475.73,79.11L475.43,77.98L472.96,76.94L468.9,78.27L466.63,76.63L464.28,76.73L463.44,75.69L463.38,73L458.57,71.41L458.31,69.97L456.44,68.78L456.44,68.78L456.7,67.38L461.59,64.7L462.76,62.79L466.7,62.59L467.97,61.63L469.79,59.46L469.2,57.04L470.93,55.39L474.06,55.52L475.71,52.93L475.71,52.93z"},{id:"TR-80",title:"Osmaniye",d:"M437.92,236.88L436.77,239.23L438.44,254.18L442.05,254.09L442.89,254.86L448.37,253.13L455.21,253.22L455.57,254.19L454.37,256.82L456.03,260.09L455.6,262.69L455.6,262.69L446.37,273.65L446.37,273.65L443.28,272.94L440.19,273.41L433.5,270.32L429.62,271.1L429.62,271.1L430.87,262L428.53,251.42L429,247.04L430.29,242.91L432.44,239.69z"},{id:"TR-53",title:"Rize",d:"M644.93,42.31L646.24,44.59L646.44,47.44L652.17,55.15L649.46,56.91L644.71,62.32L643.9,65.41L640.26,70.37L640.26,70.37L635.55,73.29L627.88,80.52L617.08,85.55L617.08,85.55L612.78,86.68L612.78,86.68L611.3,82.42L613.98,77.61L610.77,72.69L611.77,68.26L609.7,66.23L609.42,63.31L605.85,62.07L605.85,62.07L608.54,59.44L613.31,58.56L614.99,59.38L622.18,56.23L625.9,52.07L628.91,50.89L631.31,51.2L636.34,49.13z"},{id:"TR-54",title:"Sakarya",d:"M205.1,53.76L210.56,56.1L219.69,56.84L219.69,56.84L221.27,58.23L219.22,61.08L216.31,63.41L213.68,63.88L212.23,65.99L212.75,66.98L215.26,66.81L216.7,68.96L214.76,70.74L214.29,72.72L214.63,73.82L218.48,75.76L217.09,78.56L217.09,78.56L215.62,81L217.48,84.5L215.16,86.75L209.49,87.95L202.76,87.7L203.05,93.73L202.25,95.55L202.25,95.55L200.29,95.69L198.54,93.88L195.19,95.42L193.24,94.3L189.07,95.74L186.67,95.27L184.54,93.87L182.86,90.94L181.38,92.5L180.34,92.21L177.6,87.16L177.6,87.16L178.09,84.47L178.09,84.47L184.09,82.17L186.27,76.82L189.48,75.44L188.72,70.13L191.83,68.87L193.23,66.31L190.28,59.94L190.88,58.58L190.35,57.01L193.12,52.21L194.66,51.14L194.66,51.14z"},{id:"TR-55",title:"Samsun",d:"M426.16,20.5l4.05,3.2l1.87,2.83l0.87,9.14l4.28,5.6l4.18,2.36l0.26,1.67l1.89,1.69l2.68,0.45l3.68,-1.68l4.47,-6.23l0.98,1.14l7.86,1.49l5.22,3.07l1.28,1.48l0.39,3.89l5.57,2.34l0,0l-1.65,2.59l-3.13,-0.13l-1.72,1.65l0.59,2.41l-1.82,2.17l-1.27,0.97l-3.94,0.19l-1.17,1.92l-4.89,2.67l-0.26,1.41l0,0l-1.94,-1.5l-2.53,0.09l-3.43,1.41l-1.58,-0.31l-2.73,1.64l0,0l-4.72,-1.91l1.65,-1.91l-0.29,-1.1l-5.52,-2.03l-0.98,2.09l-1.26,0.45l-1.65,4.96l-6.92,-2.83l-5.08,1.21l-1.49,-1.45l-4.31,-0.17l-0.8,-1.05l0.34,-1.69l-3.05,-1.53l-1.58,-3.81l-1.37,1.02l-0.56,-1.24l-1.44,1.05l-2.75,-1.45l-5.42,0.91l-1.64,-2.08l-5.1,-0.63l0,0l-3.81,-0.44l-1.88,-1.34l2.08,-3.71l-2.75,-5.89l0.14,-2.45l0,0l6.97,-3.81l0.91,3.49l2.11,1.44l0.15,2.05l4.8,1.92l2,-0.65l1.22,-1.87l-0.56,-3.73l1.76,-0.38l3.31,1.38L406,36.12l-4.32,-2.11l-1.34,-4.27l1.92,-3.96l1.78,-1.53l0,0l3.47,1.8l4.38,-0.13L426.16,20.5z"},{id:"TR-63",title:"Şanlıurfa",d:"M558.17,219.93L566.55,223.25L569.86,227.11L575.58,228.11L578.36,231.25L580.88,228.5L584.39,227.63L586.12,232.01L586.62,242.18L589.58,245.71L589.58,245.71L591.25,248.48L590.04,250.13L590.25,252.83L592.84,259.11L593.27,262.42L594.98,264.13L596.56,263.97L596.73,265.73L598.93,269.15L599.6,273.68L601.78,275.28L602.34,277.59L602.34,277.59L600.22,279.28L595.41,280.38L594.06,281.86L585.31,285.5L560.14,290.01L552.37,287.91L540.61,288L532.87,280.98L526.05,277.99L520.16,276.89L511.66,280.18L511.21,281.61L511.21,281.61L511.98,279.16L510.24,276.86L510.33,274.93L508.71,273.72L509.19,270.23L506.62,270.83L504.43,269.41L505.07,265.75L503.25,262.31L503.54,261.29L505.19,261.56L503.46,259.32L504.33,256.58L505.41,256.09L504.88,255.14L508.99,250.36L511.64,250.01L512.75,250.73L513.61,249.68L513.61,249.68L517.42,251.74L518.28,249.65L520.25,249.99L521.34,248.27L528.2,247.75L530.27,246.67L536.98,240.81L545.26,239.12L543.84,237.09L546.51,236.56L547.76,235.72L547.98,234.29L549.68,233.75L549.63,231.16L547.13,231.21L548.37,230L550.5,230.03L551.07,226.96L550.31,226.26L552.53,225.31L553.85,221.67L555.13,220.54z"},{id:"TR-56",title:"Siirt",d:"M662.74,208.7L667.06,208.72L668.31,210.67L670.03,211.28L674.48,210.48L674.62,211.74L675.53,212.09L677.1,212.05L680.52,209.97L684.73,210.08L694.93,221.64L697.99,222.68L698.67,223.98L700.05,222.73L699.71,221.77L701.96,220.87L702.63,219.71L702.63,219.71L705.6,223.48L707.46,224.43L709.4,229.38L711.1,230.69L711.1,230.69L711.34,238.27L705.98,236.31L701.18,236.05L696.6,233.55L694.92,234.11L688.09,240.4L685.61,241.46L682.26,241.42L680.52,240.07L677.56,241.35L674.47,240.11L671.06,240.43L667.57,236.94L667.57,236.94L665.39,235.47L663.07,235.95L658.02,234.27L656.76,232.02L647.27,224.78L647.77,222.77L652.91,217.81L659.49,215.09z"},{id:"TR-57",title:"Sinop",d:"M384.3,0.67L386.65,0.78L388.17,2.63L387.91,3.61L389.38,4.45L393.93,3.68L394.65,5.14L392.1,4.59L390.06,7.59L389.84,10.2L391.44,13.74L394.48,16.69L394.51,18.5L397.45,21.53L404.04,24.25L404.04,24.25L402.27,25.78L400.35,29.74L401.68,34.01L406,36.12L406.74,42.94L403.42,41.56L401.67,41.95L402.23,45.67L401.01,47.55L399.01,48.2L394.21,46.28L394.06,44.23L391.95,42.79L391.04,39.31L384.07,43.11L384.07,43.11L380.7,47.57L377.81,47.63L375.14,49.76L372.57,49.63L370.19,48.07L368.96,45.25L365.63,43.25L363.59,44.28L363.59,44.28L362.57,41.58L365.51,35.62L364.58,32.7L368.16,29.65L369.6,24.07L367.17,22.17L362.31,21.14L360.73,17.7L355.82,17.47L357,14.56L356.4,11.86L354.59,10.24L354.58,8.59L354.58,8.59L359.27,8.83L364.95,7.13L367.16,8.69L377.08,8.61L382.12,4.68L383.91,1.72L383.72,0.53z"},{id:"TR-73",title:"Şırnak",d:"M711.1,230.69L715.72,232.06L719.02,234.64L728.5,236.24L730.85,235.73L733.72,232.57L736.31,232.72L736.31,232.72L735.01,237.93L729.08,244.58L731,248.34L731.25,255.96L731.25,255.96L730.35,255.9L729.41,257.22L726.56,255.03L721.6,253.56L717.77,254.61L715.05,256.76L709.96,255.11L709.59,253.76L708.19,253.18L705.48,256.68L703.86,256.83L704.19,257.99L700.92,261.63L699.48,265.23L694.89,265.65L690.06,267.52L688.68,263.38L689.55,260.81L687.14,258.28L683.91,258.39L684.76,256.74L684.15,256.4L676.88,263.48L666.89,266.26L660.66,266.96L660.66,266.96L661.03,264.23L659.93,260.74L658,261.41L657.51,260.33L658.81,249.7L659.65,248.15L665.74,247.77L668.57,246.73L669.04,244.8L670.78,243.17L668.06,240.06L667.57,236.94L667.57,236.94L667.57,236.94L667.57,236.94L671.06,240.43L674.47,240.11L677.56,241.35L680.52,240.07L682.26,241.42L685.61,241.46L688.09,240.4L694.92,234.11L696.6,233.55L701.18,236.05L705.98,236.31L711.34,238.27z"},{id:"TR-58",title:"Sivas",d:"M512.66,87.89L517.2,89.82L516.32,93.75L516.53,100.27L518.79,104.23L523.03,105.05L526.27,107.22L527.94,106.35L528.88,107.35L531.45,105.55L532.77,109.33L535.52,110.62L541.32,110.96L541.32,110.96L540.06,113.57L535.79,114.04L532.58,116.86L527.86,116.38L525.33,118.57L525.46,120.83L529.6,124.28L525.05,127.64L523.32,132.98L524.17,138.09L522.29,141.96L523.61,145.45L526.51,147.18L525.94,148.97L523.15,149.67L526.23,154.93L523.2,160.87L523.2,160.87L520.72,161.37L516.82,164.11L507.17,164.25L501.41,163.02L500.15,164.46L501.66,167.38L500.58,168.93L488.65,167L488.29,167.94L490.54,172.14L488.13,176.41L492.12,181.57L485.77,184.9L484.36,189.84L481.98,191.92L481.98,191.92L480.91,191.05L476.5,191.42L469.64,190.13L460.16,192.18L460.16,192.18L456.75,184.97L460.4,181.73L461.02,176.74L463.01,173.02L466.12,170.08L464.15,164.74L461.5,162.5L457.36,160.76L451.5,161.68L442.4,161.03L435.82,162.71L431.66,162.59L429.87,159.9L427.95,158.78L426.92,156.17L419.76,153.07L419.76,153.07L423.31,148.09L424.1,141.35L427.3,140.1L429.81,141.28L431.78,140.94L436.07,136.56L435.3,131.07L431.8,126.9L432.42,122.28L428.96,120.91L428.77,117.75L428.77,117.75L431.54,119.92L433.1,120.09L433.91,117.27L435.79,116.29L448.94,116.6L453.46,114.98L454.91,112.99L455.66,107.29L457.28,106.71L458.91,103.59L460.83,102.62L470.26,102.42L472.15,103.73L478.24,103.27L480.11,104.34L482.63,104.3L483.91,105.59L485.72,105.46L486.09,103.13L491.5,100.9L490.89,99.61L493.63,97.53L495.43,94.63L495.43,94.63L499.7,95.44L501.35,94.07L503.39,95.43L507.09,91.95L507.7,89.79L510.71,89.46z"},{id:"TR-59",title:"Tekirdağ",d:"M52.39,44.01L54.63,41.94L57.68,42.54L64.66,41.57L66.41,42.87L67.51,45.88L72.34,49.65L75.51,48.5L78.38,45.54L80.04,39.15L82.2,37.29L88.55,34.96L92.09,34.57L100.5,29.58L100.87,28.25L102.52,28.39L102.52,28.39L103.01,29L103.01,29L99.86,44.65L97.47,48.72L97.49,51.15L95.74,54.66L95.58,57.53L96.47,59.49L96.47,59.49L94.92,62.8L91.57,62.71L86.49,60.02L76.48,62.25L74.69,65.68L74.09,69.27L69.49,73.59L67.58,77.44L62.61,81.12L57.04,82.69L54.94,84.99L52.22,85.67L52.22,85.67L52.17,82.72L55.49,74.92L52.38,73.87L46.42,74.15L46.42,74.15L42.46,68.99L43.56,60.73L41.5,58.83L42.36,57.78L46.69,57.12L50.78,53.06L53.17,48.89z"},{id:"TR-60",title:"Tokat",d:"M444.23,70.11L446.96,68.47L448.54,68.78L451.98,67.37L454.5,67.28L456.44,68.78L456.44,68.78L458.31,69.97L458.57,71.41L463.38,73L463.44,75.69L464.28,76.73L466.63,76.63L468.9,78.27L472.96,76.94L475.43,77.98L475.73,79.11L477.42,79.75L484.18,85.94L490.42,85.85L495.24,87.22L495.6,88.12L493.7,91.03L496.33,92.57L495.43,94.63L495.43,94.63L493.63,97.53L490.89,99.61L491.5,100.9L486.09,103.13L485.72,105.46L483.91,105.59L482.63,104.3L480.11,104.34L478.24,103.27L472.15,103.73L470.26,102.42L460.83,102.62L458.91,103.59L457.28,106.71L455.66,107.29L454.91,112.99L453.46,114.98L448.94,116.6L435.79,116.29L433.91,117.27L433.1,120.09L431.54,119.92L428.77,117.75L428.77,117.75L427.23,116.27L426.44,109.95L418.82,109.67L414.42,110.62L412.92,109.6L408.4,109.01L408.26,105.9L405.52,103.63L405.06,100.49L405.06,100.49L409.83,97.44L414.6,96.36L417.07,94.69L417.24,92.98L419.78,91.36L420.85,88.27L426.44,87.98L428.09,88.85L428,89.79L431.82,91.2L432.98,89.57L438.42,87.08L439.3,84.88L441.34,83.2L438.66,82.76L438.38,81.49L444,81.05L445.09,79.04L444.85,76.59L448.1,73.67L444.73,71.88z"},{id:"TR-61",title:"Trabzon",d:"M569.31,55.3L571.55,55.86L574.95,59.53L578.09,61.01L581.15,60.24L585.64,61.66L587.43,63.34L594.34,63.13L597.75,65.59L602.27,64.74L605.85,62.07L605.85,62.07L609.42,63.31L609.7,66.23L611.77,68.26L610.77,72.69L613.98,77.61L611.3,82.42L612.78,86.68L612.78,86.68L604.06,87.62L604.06,87.62L600.53,84.57L598.09,85.16L595.91,83.53L596.38,81.59L594.19,80.01L591.17,80.45L591.18,81.88L594.01,83.16L594.57,84.27L591.34,85.7L590.4,83.81L585.87,82.01L586.69,78.77L586.1,77.15L583.85,77.35L583.41,81.31L581.26,83.67L576.94,83.85L574.4,81.55L571.71,81.74L571.18,79.79L569.6,79.47L567.27,76.88L561.29,75.55L558.71,74.1L558.71,74.1L558.77,56.74L558.77,56.74L562.92,58.15L568.68,54.96z"},{id:"TR-62",title:"Tunceli",d:"M541.22,166.77L540.31,161.41L541.62,158.94L540.41,157.87L541.2,156.79L544.34,156.13L546.54,154.58L545.52,151.59L545.85,149.93L550.58,146.13L558.94,142.16L566.45,143.31L572.46,141.5L581.26,142.76L582.93,141.62L584.56,136.24L586.36,135.51L594.12,137.45L595.87,138.62L600.84,136.78L606.77,137.91L609.82,140.96L609.82,140.96L599.85,149.65L592.29,149.13L593.48,153.38L590.85,155.66L588.86,162.88L588.86,162.88L586.93,165.23L588.57,167.7L587.24,172.68L585.29,174.7L584.59,177.7L582.86,177L579.35,177.96L573.36,178.04L572.48,180.51L571.54,180.82L569.34,179.66L567.66,180.46L566.92,178.74L564.13,177.77L562.21,175.71L549.88,173.64L545.56,175.9L541.54,174.56L540.98,173.19L542.91,169.88L542.6,168.13z"},{id:"TR-64",title:"Uşak",d:"M141.4,177.54L146.33,177L150.52,178.49L154.13,175.04L162.71,172.12L166.92,171.69L176.29,172.83L178.17,176.67L180.59,177.56L180.59,177.56L179.99,180.14L176.06,183.52L177.06,187.54L175.51,188.43L170.82,194.56L170.82,194.56L163.88,199.27L164.26,205.11L162.97,206.8L151.37,204.25L147.92,208.21L148.24,209.59L147.04,209.93L146.49,212.41L145.12,209.02L131.19,208.91L131.19,208.91L126.98,203.18L129.74,198.64L131.66,186.64L132.71,185.28L135.33,185.08L138.9,183.02z"},{id:"TR-65",title:"Van",d:"M759.68,148.95L761.35,150.84L761.54,152.77L762.49,153.18L761.73,154.85L762.22,157.51L765.08,159.04L767.02,161.36L767.47,163.39L766.17,164.56L766.95,167.28L765.28,168.83L766.43,171.06L766.06,171.88L767.25,172.8L766.93,174.21L768.39,176.26L770.62,176.89L771.19,178.54L768.96,183.47L769.82,185.43L769.37,186.98L771.51,188.66L770.99,193.23L771.65,195.57L770.73,197.6L771.39,199.52L770.72,200.37L771.46,201.49L773.09,201.34L773.92,202.22L776.73,200.79L777.33,202.17L779.34,203.07L778.71,205.01L774.77,207.81L774.34,213.28L772.66,213.98L773.36,215.52L771.77,215.75L770.93,218.85L768.25,222.92L768.66,224.04L767.47,226.87L769.26,227.94L771.46,227.47L774.37,228.2L774.62,230.39L775.87,231.57L776.83,231.1L776.8,233.05L776.8,233.05L774.89,234.06L771.13,233.78L769.15,235.28L763.59,234.76L762.33,232.22L759.56,230.83L754.4,232.12L748.63,231.57L741.01,233.76L736.31,232.72L736.31,232.72L733.72,232.57L730.85,235.73L728.5,236.24L719.02,234.64L715.72,232.06L711.1,230.69L711.1,230.69L709.4,229.38L707.46,224.43L705.6,223.48L702.63,219.71L702.63,219.71L704.49,209.58L704.08,207.17L702.42,205.91L702.41,204.7L707.06,201.49L707.42,195.34L713.89,185.67L717.93,181.92L723.6,178.54L725.81,175.36L725.62,173.91L720.52,171.61L719.49,169.22L716.36,166.67L716.36,166.67L719.51,161.08L723.57,157.8L723.74,149.83L728.43,148.44L733.83,148.81L739.05,154.42L743.35,156.69L746.59,157.1L749.84,154.23L752.85,149.36L759.66,148.28L759.66,148.28z"},{id:"TR-77",title:"Yalova",d:"M155.46,77.77L156.68,77.44L156.68,77.44L156.8,83.3L156.01,84.99L156.01,84.99L151.17,84.9L146.24,86.66L137.39,84.83L136.76,90.27L136.76,90.27L128.85,87.05L128.83,86.07L137.58,80.2L149.26,79.41L152.12,78.6L153.58,77.09z"},{id:"TR-66",title:"Yozgat",d:"M405.06,100.49L405.52,103.63L408.26,105.9L408.4,109.01L412.92,109.6L414.42,110.62L418.82,109.67L426.44,109.95L427.23,116.27L428.77,117.75L428.77,117.75L428.96,120.91L432.42,122.28L431.8,126.9L435.3,131.07L436.07,136.56L431.78,140.94L429.81,141.28L427.3,140.1L424.1,141.35L423.31,148.09L419.76,153.07L419.76,153.07L417.65,156.13L415.59,157.19L405.31,158.57L404.22,160.24L405.63,163.92L399.86,168.09L394.57,170.15L393.75,169.57L393.47,166.06L389.32,167.73L389.32,167.73L387.38,164.21L387.45,160.82L385.78,157.16L386.49,155.07L385.78,152.7L382.01,149.65L376.65,148.82L373.46,147.39L372.88,145.74L372.88,145.74L371.29,142.92L367.05,140.72L369.32,137.92L368.63,136.9L363.6,135.99L361.92,132.75L354.51,128.93L352.84,125.12L349.86,125.12L349.86,125.12L349.15,120.63L347.48,118.52L350.88,117.2L350.88,117.2L351.28,119L354.87,117.92L359.84,118.54L360.98,116.65L364.83,113.91L366.54,114.31L368.27,116.09L370.92,116.67L373.67,115.46L378.89,115.16L382.49,111.34L383.34,111.88L383.65,114.21L394.29,113.42L395.18,111.96L393.16,108.42L395.22,106.66L393.05,103.17L394.23,102.76L396.66,104.65L398.8,102.05L402.34,100.98L402.34,100.98z"},{id:"TR-67",title:"Zonguldak",d:"M267.39,28.08L269.8,31.98L272.62,32.42L272.6,35.3L274.5,37.53L274.5,39.9L272.94,43.21L272.94,43.21L270.91,45L269.21,50.8L270.92,55.58L270.92,55.58L255.34,59.59L252.1,58.06L244.46,58.1L239.75,59.9L239.75,59.9L237.51,60.59L234.99,60.09L233.31,54.23L233.31,54.23L237.46,49.31L238.01,45.76L236.84,44.81L237.1,43.56L245.94,40.08L256.54,32.94L262.14,30.7L263.96,28.99z"}]}}};!function(){"use strict";function t(t,n,i){return t*(i-n)+n}function n(t){var n=1-t;return n*=n*n*n,1-n}function i(t,n,i,e){this._object=t,this._key=n,this._from=i,this._to=e}function e(t,i,e,r,o){this._finished=!1,this._startTime=null,this._duration=t,this._easing=null==i?n:i,this._onComplete=e,this._tweens=r,this._chart=o}function r(){this._animating=!1,this._animations=[],this._onBeforeFrames=[],this._onAfterFrames=[]}function o(t){return t!==t}function a(t,n){for(var i=0;i<t.length;++i)n(t[i])}function u(t,n){for(var i=0;i<t.length;++i)if(t[i]===n)return;t.push(n)}function s(t,n,i){n[i]||(n[i]=!0,t.push(i))}function l(t,n,i,e){a(e,function(e){var r=i[e];null!=r&&s(t,n,r)})}function h(t,n,i){l(n,i,t,["alphaField","valueField"])}function f(t,n,i){h(t,n,i)}function c(t,n,i){h(t,n,i),l(n,i,t,["labelRadiusField"])}function _(t,n,i){l(n,i,t,["alphaField","bulletSizeField","closeField","dashLengthField","errorField","highField","lowField","openField","valueField"])}function p(t,n,i){a(t,function(t){_(t,n,i)})}function m(t,n,i){l(n,i,t,["widthField"])}function d(t){var n=[],i={};return"funnel"===t.type?f(t,n,i):"pie"===t.type?c(t,n,i):"serial"===t.type?(m(t.categoryAxis,n,i),p(t.graphs,n,i)):"radar"===t.type&&p(t.graphs,n,i),n}function v(t){return"funnel"===t.type||"pie"===t.type?t.titleField:"serial"===t.type||"radar"===t.type?t.categoryField:void 0}function F(t,n){var i=t[n];return null==i?null:(i=+i,o(i)?null:i)}function g(t,n){var i=t[n];return null==i?null:""+i}function y(t,n){var i={};return a(t,function(t){var e=g(t,n);null!=e&&(i[e]=t)}),i}function w(t,n,e,r){var o=[];return a(t,function(t){var u=g(t,n);if(null!=u&&u in e){var s=e[u];a(r,function(n){var e=F(s,n),r=F(t,n);null!=e&&null!=r&&o.push(new i(t,n,e,r))})}}),o}function A(t,n){var i=this,r=v(i),o=d(i),a=y(i.dataProvider,r),u=w(t,r,a,o);i.dataProvider=t;var s=new e(n.duration,n.easing,n.complete,u,i);return C.animate(s),s}if("undefined"==typeof requestAnimationFrame)var T=1e3/60,k=function(t){setTimeout(function(){t._onFrame((new Date).getTime())},T)};else var k=function(t){requestAnimationFrame(function(n){t._onFrame(n)})};i.prototype.interpolate=function(n){this._object[this._key]=t(n,this._from,this._to)},e.prototype.cancel=function(){this._finished=!0,this._startTime=null,this._duration=null,this._easing=null,this._onComplete=null,this._tweens=null,this._chart=null},e.prototype._onFrame=function(t){if(this._finished)return!0;if(null===this._startTime)return this._startTime=t,!1;var n=t-this._startTime;return n<this._duration?(this._tick(n/this._duration),!1):(this._end(1),this.cancel(),!0)},e.prototype._tick=function(t){t=this._easing(t);for(var n=this._tweens,i=0;i<n.length;++i)n[i].interpolate(t);u(b,this._chart)},e.prototype._end=function(t){this._tick(t),null!=this._onComplete&&this._onComplete()},r.prototype.animate=function(t){this._animations.push(t),this._animating||(this._animating=!0,k(this))},r.prototype.onBeforeFrame=function(t){this._onBeforeFrames.push(t)},r.prototype.onAfterFrame=function(t){this._onAfterFrames.push(t)},r.prototype._onFrame=function(t){for(var n=this._onBeforeFrames,i=0;i<n.length;++i)n[i](t);for(var e=this._animations,i=0;i<e.length;++i){var r=e[i];r._onFrame(t)&&(e.splice(i,1),--i)}for(var o=this._onAfterFrames,i=0;i<o.length;++i)o[i](t);0===e.length?this._animating=!1:k(this)};var C=new r,b=[];C.onAfterFrame(function(){for(var t=0;t<b.length;++t)b[t].validateData();b.length=0}),AmCharts.addInitHandler(function(t){t.animateData=A},["funnel","pie","serial","radar"])}();AmCharts.themes.light={themeName:"light",AmChart:{color:"#000000",backgroundColor:"#FFFFFF"},AmCoordinateChart:{colors:["#67b7dc","#fdd400","#84b761","#cc4748","#cd82ad","#2f4074","#448e4d","#b7b83f","#b9783f","#b93e3d","#913167"]},AmStockChart:{colors:["#67b7dc","#fdd400","#84b761","#cc4748","#cd82ad","#2f4074","#448e4d","#b7b83f","#b9783f","#b93e3d","#913167"]},AmSlicedChart:{colors:["#67b7dc","#fdd400","#84b761","#cc4748","#cd82ad","#2f4074","#448e4d","#b7b83f","#b9783f","#b93e3d","#913167"],outlineAlpha:1,outlineThickness:2,labelTickColor:"#000000",labelTickAlpha:.3},AmRectangularChart:{zoomOutButtonColor:"#000000",zoomOutButtonRollOverAlpha:.15,zoomOutButtonImage:"lens"},AxisBase:{axisColor:"#000000",axisAlpha:.3,gridAlpha:.1,gridColor:"#000000"},ChartScrollbar:{backgroundColor:"#000000",backgroundAlpha:.12,graphFillAlpha:.5,graphLineAlpha:0,selectedBackgroundColor:"#FFFFFF",selectedBackgroundAlpha:.4,gridAlpha:.15},ChartCursor:{cursorColor:"#000000",color:"#FFFFFF",cursorAlpha:.5},AmLegend:{color:"#000000"},AmGraph:{lineAlpha:.9},GaugeArrow:{color:"#000000",alpha:.8,nailAlpha:0,innerRadius:"40%",nailRadius:15,startWidth:15,borderAlpha:.8,nailBorderAlpha:0},GaugeAxis:{tickColor:"#000000",tickAlpha:1,tickLength:15,minorTickLength:8,axisThickness:3,axisColor:"#000000",axisAlpha:1,bandAlpha:.8},TrendLine:{lineColor:"#c03246",lineAlpha:.8},AreasSettings:{alpha:.8,color:"#67b7dc",colorSolid:"#003767",unlistedAreasAlpha:.4,unlistedAreasColor:"#000000",outlineColor:"#FFFFFF",outlineAlpha:.5,outlineThickness:.5,rollOverColor:"#3c5bdc",rollOverOutlineColor:"#FFFFFF",selectedOutlineColor:"#FFFFFF",selectedColor:"#f15135",unlistedAreasOutlineColor:"#FFFFFF",unlistedAreasOutlineAlpha:.5},LinesSettings:{color:"#000000",alpha:.8},ImagesSettings:{alpha:.8,labelColor:"#000000",color:"#000000",labelRollOverColor:"#3c5bdc"},ZoomControl:{buttonFillAlpha:.7,buttonIconColor:"#a7a7a7"},SmallMap:{mapColor:"#000000",rectangleColor:"#f15135",backgroundColor:"#FFFFFF",backgroundAlpha:.7,borderThickness:1,borderAlpha:.8},PeriodSelector:{color:"#000000"},PeriodButton:{color:"#000000",background:"transparent",opacity:.7,border:"1px solid rgba(0, 0, 0, .3)",MozBorderRadius:"5px",borderRadius:"5px",margin:"1px",outline:"none",boxSizing:"border-box"},PeriodButtonSelected:{color:"#000000",backgroundColor:"#b9cdf5",border:"1px solid rgba(0, 0, 0, .3)",MozBorderRadius:"5px",borderRadius:"5px",margin:"1px",outline:"none",opacity:1,boxSizing:"border-box"},PeriodInputField:{color:"#000000",background:"transparent",border:"1px solid rgba(0, 0, 0, .3)",outline:"none"},DataSetSelector:{color:"#000000",selectedBackgroundColor:"#b9cdf5",rollOverBackgroundColor:"#a8b0e4"},DataSetCompareList:{color:"#000000",lineHeight:"100%",boxSizing:"initial",webkitBoxSizing:"initial",border:"1px solid rgba(0, 0, 0, .3)"},DataSetSelect:{border:"1px solid rgba(0, 0, 0, .3)",outline:"none"}};
